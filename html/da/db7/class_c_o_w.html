<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ppl_util: COW&lt; Derived &gt; 模板类 参考</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ppl_util
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- 制作者 Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','搜索');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">载入中...</div>
<div class="SRStatus" id="Searching">搜索中...</div>
<div class="SRStatus" id="NoMatches">未找到</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">类</a> &#124;
<a href="#pub-types">Public 类型</a> &#124;
<a href="#pub-methods">Public 成员函数</a> &#124;
<a href="#pub-static-methods">静态 Public 成员函数</a> &#124;
<a href="#pro-methods">Protected 成员函数</a> &#124;
<a href="#pri-attribs">Private 属性</a> &#124;
<a href="../../d0/da6/class_c_o_w-members.html">所有成员列表</a>  </div>
  <div class="headertitle"><div class="title">COW&lt; Derived &gt; 模板类 参考</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="../../d1/dd0/cow_8h_source.html">cow.h</a>&gt;</code></p>
<div class="dynheader">
类 COW&lt; Derived &gt; 继承关系图:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d3/df7/class_c_o_w__inherit__graph.svg" width="296" height="274"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
<center><span class="legend">[<a href="../../graph_legend.html">图例</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
类</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d95/class_c_o_w_1_1chameleon__ptr.html">chameleon_ptr</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">It works as <a class="el" href="../../d9/d38/class_c_o_w_1_1immutable__ptr.html">immutable_ptr</a> if it is const and as <a class="el" href="../../df/d67/class_c_o_w_1_1mutable__ptr.html">mutable_ptr</a> if it is non const.  <a href="../../d2/d95/class_c_o_w_1_1chameleon__ptr.html#details">更多...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d38/class_c_o_w_1_1immutable__ptr.html">immutable_ptr</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dcf/class_c_o_w_1_1intrusive__ptr.html">intrusive_ptr</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d67/class_c_o_w_1_1mutable__ptr.html">mutable_ptr</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-types" name="pub-types"></a>
Public 类型</h2></td></tr>
<tr class="memitem:adfc3e84da89b27b9efa22c1e0691fa87"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/db7/class_c_o_w.html#adfc3e84da89b27b9efa22c1e0691fa87">MutablePtr</a> = <a class="el" href="../../df/d67/class_c_o_w_1_1mutable__ptr.html">mutable_ptr</a>&lt; Derived &gt;</td></tr>
<tr class="separator:adfc3e84da89b27b9efa22c1e0691fa87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0844a1c7ef409ff7301a0e805b097f4"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/db7/class_c_o_w.html#aa0844a1c7ef409ff7301a0e805b097f4">Ptr</a> = <a class="el" href="../../d9/d38/class_c_o_w_1_1immutable__ptr.html">immutable_ptr</a>&lt; Derived &gt;</td></tr>
<tr class="separator:aa0844a1c7ef409ff7301a0e805b097f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad421fc164de8618b83d51b65e26a4830"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/db7/class_c_o_w.html#ad421fc164de8618b83d51b65e26a4830">WrappedPtr</a> = <a class="el" href="../../d2/d95/class_c_o_w_1_1chameleon__ptr.html">chameleon_ptr</a>&lt; Derived &gt;</td></tr>
<tr class="separator:ad421fc164de8618b83d51b65e26a4830"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public 成员函数</h2></td></tr>
<tr class="memitem:aace49c45a99318b57d3a1600635b8e89"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/db7/class_c_o_w.html#aace49c45a99318b57d3a1600635b8e89">use_count</a> () const</td></tr>
<tr class="separator:aace49c45a99318b57d3a1600635b8e89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acedef9a1098c617ad7cce08beda367d5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/db7/class_c_o_w.html#aa0844a1c7ef409ff7301a0e805b097f4">Ptr</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/db7/class_c_o_w.html#acedef9a1098c617ad7cce08beda367d5">get_ptr</a> () const</td></tr>
<tr class="separator:acedef9a1098c617ad7cce08beda367d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c0a81f654bf5a407ac29dd0edb27bb5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/db7/class_c_o_w.html#adfc3e84da89b27b9efa22c1e0691fa87">MutablePtr</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/db7/class_c_o_w.html#a8c0a81f654bf5a407ac29dd0edb27bb5">get_ptr</a> ()</td></tr>
<tr class="separator:a8c0a81f654bf5a407ac29dd0edb27bb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b5fe4e17cc0aefcc974d3af422918d1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/db7/class_c_o_w.html#adfc3e84da89b27b9efa22c1e0691fa87">MutablePtr</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/db7/class_c_o_w.html#a8b5fe4e17cc0aefcc974d3af422918d1">mutate</a> () const &amp;&amp;</td></tr>
<tr class="separator:a8b5fe4e17cc0aefcc974d3af422918d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade206b8984a3bec01eb7412e6076e813"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/db7/class_c_o_w.html#adfc3e84da89b27b9efa22c1e0691fa87">MutablePtr</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/db7/class_c_o_w.html#ade206b8984a3bec01eb7412e6076e813">assume_mutable</a> () const</td></tr>
<tr class="separator:ade206b8984a3bec01eb7412e6076e813"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99c0ad5c2ddd8b7522956be31b953aba"><td class="memItemLeft" align="right" valign="top">Derived &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/db7/class_c_o_w.html#a99c0ad5c2ddd8b7522956be31b953aba">assume_mutable_ref</a> () const</td></tr>
<tr class="separator:a99c0ad5c2ddd8b7522956be31b953aba"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
静态 Public 成员函数</h2></td></tr>
<tr class="memitem:aa14023f47995d24ce0ea777e90a4cb23"><td class="memTemplParams" colspan="2">template&lt;typename... Args&gt; </td></tr>
<tr class="memitem:aa14023f47995d24ce0ea777e90a4cb23"><td class="memTemplItemLeft" align="right" valign="top">static <a class="el" href="../../da/db7/class_c_o_w.html#adfc3e84da89b27b9efa22c1e0691fa87">MutablePtr</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../da/db7/class_c_o_w.html#aa14023f47995d24ce0ea777e90a4cb23">create</a> (Args &amp;&amp;... <a class="el" href="../../d8/d08/structargs.html">args</a>)</td></tr>
<tr class="separator:aa14023f47995d24ce0ea777e90a4cb23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e4d809f9f16a3aae70f2ad22e8aa2d2"><td class="memTemplParams" colspan="2">template&lt;typename <a class="el" href="../../d5/d6f/exp_8c.html#a0acb682b8260ab1c60b918599864e2e5">T</a> &gt; </td></tr>
<tr class="memitem:a8e4d809f9f16a3aae70f2ad22e8aa2d2"><td class="memTemplItemLeft" align="right" valign="top">static <a class="el" href="../../da/db7/class_c_o_w.html#adfc3e84da89b27b9efa22c1e0691fa87">MutablePtr</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../da/db7/class_c_o_w.html#a8e4d809f9f16a3aae70f2ad22e8aa2d2">create</a> (std::initializer_list&lt; <a class="el" href="../../d5/d6f/exp_8c.html#a0acb682b8260ab1c60b918599864e2e5">T</a> &gt; &amp;&amp;<a class="el" href="../../db/da8/threadlocal_8cc.html#a9ce2ec4812a92cb6ab39f6e81e9173a9">arg</a>)</td></tr>
<tr class="separator:a8e4d809f9f16a3aae70f2ad22e8aa2d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected 成员函数</h2></td></tr>
<tr class="memitem:adcb4ac757e9f4c458d04530fc4a21368"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/db7/class_c_o_w.html#adcb4ac757e9f4c458d04530fc4a21368">COW</a> ()</td></tr>
<tr class="separator:adcb4ac757e9f4c458d04530fc4a21368"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ff317a28ec404a9e90ed0fd32bbf630"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/db7/class_c_o_w.html#a7ff317a28ec404a9e90ed0fd32bbf630">COW</a> (<a class="el" href="../../da/db7/class_c_o_w.html">COW</a> const &amp;)</td></tr>
<tr class="separator:a7ff317a28ec404a9e90ed0fd32bbf630"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aceff3043789d12d8f512d90511c88d11"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/db7/class_c_o_w.html">COW</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/db7/class_c_o_w.html#aceff3043789d12d8f512d90511c88d11">operator=</a> (<a class="el" href="../../da/db7/class_c_o_w.html">COW</a> const &amp;)</td></tr>
<tr class="separator:aceff3043789d12d8f512d90511c88d11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a304ae13388fc1ef08b568f2c73c6485e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/db7/class_c_o_w.html#a304ae13388fc1ef08b568f2c73c6485e">add_ref</a> ()</td></tr>
<tr class="separator:a304ae13388fc1ef08b568f2c73c6485e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac945929c99cd5b25c75e78907ee3ccc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/db7/class_c_o_w.html#aac945929c99cd5b25c75e78907ee3ccc">release_ref</a> ()</td></tr>
<tr class="separator:aac945929c99cd5b25c75e78907ee3ccc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a8a1ca0391807c6e9ef4a742c617dc4"><td class="memItemLeft" align="right" valign="top">Derived *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/db7/class_c_o_w.html#a0a8a1ca0391807c6e9ef4a742c617dc4">derived</a> ()</td></tr>
<tr class="separator:a0a8a1ca0391807c6e9ef4a742c617dc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab699c258e0b3c5e066ca118abc470d21"><td class="memItemLeft" align="right" valign="top">const Derived *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/db7/class_c_o_w.html#ab699c258e0b3c5e066ca118abc470d21">derived</a> () const</td></tr>
<tr class="separator:ab699c258e0b3c5e066ca118abc470d21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad047853e449e6932f2bc7b8020e1b273"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/db7/class_c_o_w.html#adfc3e84da89b27b9efa22c1e0691fa87">MutablePtr</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/db7/class_c_o_w.html#ad047853e449e6932f2bc7b8020e1b273">shallow_mutate</a> () const</td></tr>
<tr class="separator:ad047853e449e6932f2bc7b8020e1b273"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private 属性</h2></td></tr>
<tr class="memitem:a99ea8f05f0564ac618b0620716b84949"><td class="memItemLeft" align="right" valign="top">std::atomic_uint&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/db7/class_c_o_w.html#a99ea8f05f0564ac618b0620716b84949">ref_counter</a></td></tr>
<tr class="separator:a99ea8f05f0564ac618b0620716b84949"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">详细描述</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;typename Derived&gt;<br />
class COW&lt; Derived &gt;</div><p>Copy-on-write shared ptr. Allows to work with shared immutable objects and sometimes unshare and mutate you own unique copy.</p>
<p>Usage: class Column : public COW&lt;Column&gt; { private: friend class COW&lt;Column&gt;; / Leave all constructors in private section. They will be available through 'create' method. Column(); / Provide 'clone' method. It can be virtual if you want polymorphic behaviour. virtual Column * clone() const; public: / Correctly use const qualifiers in your interface. virtual ~Column() {} }; It will provide 'create' and 'mutate' methods. And 'Ptr' and 'MutablePtr' types. Ptr is refcounted pointer to immutable object. MutablePtr is refcounted noncopyable pointer to mutable object. MutablePtr can be assigned to Ptr through move assignment.</p>
<p>'create' method creates MutablePtr: you cannot share mutable objects. To share, move-assign to immutable pointer. 'mutate' method allows to create mutable noncopyable object from immutable object: either by cloning or by using directly, if it is not shared. These methods are thread-safe.</p>
<p>Example:</p>
<p>/ Creating and assigning to immutable ptr. Column::Ptr x = Column::create(1); / Sharing single immutable object in two ptrs. Column::Ptr y = x; / Now x and y are shared. / Change value of x. { / Creating mutable ptr. It can clone an object under the hood if it was shared. Column::MutablePtr mutate_x = std::move(*x).<a class="el" href="../../da/db7/class_c_o_w.html#a8b5fe4e17cc0aefcc974d3af422918d1">mutate()</a>; / Using non-const methods of an object. mutate_x-&gt;set(2); / Assigning pointer 'x' to mutated object. x = std::move(mutate_x); } / Now x and y are unshared and have different values. Note. You may have heard that <a class="el" href="../../da/db7/class_c_o_w.html">COW</a> is bad practice. Actually it is, if your values are small or if copying is done implicitly. This is the case for string implementations.</p>
<p>In contrast, <a class="el" href="../../da/db7/class_c_o_w.html">COW</a> is intended for the cases when you need to share states of large objects, (when you usually will use std::shared_ptr) but you also want precise control over modification of this shared state.</p>
<p>Caveats:</p><ul>
<li>after a call to 'mutate' method, you can still have a reference to immutable ptr somewhere.</li>
<li>as '<a class="el" href="../../df/d67/class_c_o_w_1_1mutable__ptr.html">mutable_ptr</a>' should be unique, it's refcount is redundant - probably it would be better to use std::unique_ptr for it somehow. </li>
</ul>
</div><h2 class="groupheader">成员类型定义说明</h2>
<a id="adfc3e84da89b27b9efa22c1e0691fa87" name="adfc3e84da89b27b9efa22c1e0691fa87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adfc3e84da89b27b9efa22c1e0691fa87">&#9670;&#160;</a></span>MutablePtr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="../../da/db7/class_c_o_w.html#adfc3e84da89b27b9efa22c1e0691fa87">MutablePtr</a> =  <a class="el" href="../../df/d67/class_c_o_w_1_1mutable__ptr.html">mutable_ptr</a>&lt;Derived&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aa0844a1c7ef409ff7301a0e805b097f4" name="aa0844a1c7ef409ff7301a0e805b097f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0844a1c7ef409ff7301a0e805b097f4">&#9670;&#160;</a></span>Ptr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="../../da/db7/class_c_o_w.html#aa0844a1c7ef409ff7301a0e805b097f4">Ptr</a> =  <a class="el" href="../../d9/d38/class_c_o_w_1_1immutable__ptr.html">immutable_ptr</a>&lt;Derived&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad421fc164de8618b83d51b65e26a4830" name="ad421fc164de8618b83d51b65e26a4830"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad421fc164de8618b83d51b65e26a4830">&#9670;&#160;</a></span>WrappedPtr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="../../da/db7/class_c_o_w.html#ad421fc164de8618b83d51b65e26a4830">WrappedPtr</a> =  <a class="el" href="../../d2/d95/class_c_o_w_1_1chameleon__ptr.html">chameleon_ptr</a>&lt;Derived&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Use this type in class members for compositions.</p>
<p>NOTE: For classes with WrappedPtr members, you must reimplement 'mutate' method, so it will call 'mutate' of all subobjects (do deep mutate). It will guarantee, that mutable object have all subobjects unshared.</p>
<p>NOTE: If you override 'mutate' method in inherited classes, don't forget to make it virtual in base class or to make it call a virtual method. (<a class="el" href="../../da/db7/class_c_o_w.html">COW</a> itself doesn't force any methods to be virtual).</p>
<p>See example in "cow_compositions.cpp". </p>

</div>
</div>
<h2 class="groupheader">构造及析构函数说明</h2>
<a id="adcb4ac757e9f4c458d04530fc4a21368" name="adcb4ac757e9f4c458d04530fc4a21368"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adcb4ac757e9f4c458d04530fc4a21368">&#9670;&#160;</a></span>COW() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/db7/class_c_o_w.html">COW</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a7ff317a28ec404a9e90ed0fd32bbf630" name="a7ff317a28ec404a9e90ed0fd32bbf630"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ff317a28ec404a9e90ed0fd32bbf630">&#9670;&#160;</a></span>COW() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/db7/class_c_o_w.html">COW</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../da/db7/class_c_o_w.html">COW</a>&lt; Derived &gt; const &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">成员函数说明</h2>
<a id="aceff3043789d12d8f512d90511c88d11" name="aceff3043789d12d8f512d90511c88d11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aceff3043789d12d8f512d90511c88d11">&#9670;&#160;</a></span>operator=()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/db7/class_c_o_w.html">COW</a> &amp; operator= </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../da/db7/class_c_o_w.html">COW</a>&lt; Derived &gt; const &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a304ae13388fc1ef08b568f2c73c6485e" name="a304ae13388fc1ef08b568f2c73c6485e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a304ae13388fc1ef08b568f2c73c6485e">&#9670;&#160;</a></span>add_ref()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void add_ref </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../da/db7/class_c_o_w_a304ae13388fc1ef08b568f2c73c6485e_icgraph.svg" width="258" height="115"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="aac945929c99cd5b25c75e78907ee3ccc" name="aac945929c99cd5b25c75e78907ee3ccc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac945929c99cd5b25c75e78907ee3ccc">&#9670;&#160;</a></span>release_ref()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void release_ref </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a0a8a1ca0391807c6e9ef4a742c617dc4" name="a0a8a1ca0391807c6e9ef4a742c617dc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a8a1ca0391807c6e9ef4a742c617dc4">&#9670;&#160;</a></span>derived() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Derived * derived </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../da/db7/class_c_o_w_a0a8a1ca0391807c6e9ef4a742c617dc4_icgraph.svg" width="100%" height="383"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="ab699c258e0b3c5e066ca118abc470d21" name="ab699c258e0b3c5e066ca118abc470d21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab699c258e0b3c5e066ca118abc470d21">&#9670;&#160;</a></span>derived() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const Derived * derived </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aace49c45a99318b57d3a1600635b8e89" name="aace49c45a99318b57d3a1600635b8e89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aace49c45a99318b57d3a1600635b8e89">&#9670;&#160;</a></span>use_count()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int use_count </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../da/db7/class_c_o_w_aace49c45a99318b57d3a1600635b8e89_icgraph.svg" width="366" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="aa14023f47995d24ce0ea777e90a4cb23" name="aa14023f47995d24ce0ea777e90a4cb23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa14023f47995d24ce0ea777e90a4cb23">&#9670;&#160;</a></span>create() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../da/db7/class_c_o_w.html#adfc3e84da89b27b9efa22c1e0691fa87">MutablePtr</a> create </td>
          <td>(</td>
          <td class="paramtype">Args &amp;&amp;...&#160;</td>
          <td class="paramname"><em>args</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../da/db7/class_c_o_w_aa14023f47995d24ce0ea777e90a4cb23_icgraph.svg" width="176" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a8e4d809f9f16a3aae70f2ad22e8aa2d2" name="a8e4d809f9f16a3aae70f2ad22e8aa2d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e4d809f9f16a3aae70f2ad22e8aa2d2">&#9670;&#160;</a></span>create() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../da/db7/class_c_o_w.html#adfc3e84da89b27b9efa22c1e0691fa87">MutablePtr</a> create </td>
          <td>(</td>
          <td class="paramtype">std::initializer_list&lt; <a class="el" href="../../d5/d6f/exp_8c.html#a0acb682b8260ab1c60b918599864e2e5">T</a> &gt; &amp;&amp;&#160;</td>
          <td class="paramname"><em>arg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../da/db7/class_c_o_w_a8e4d809f9f16a3aae70f2ad22e8aa2d2_cgraph.svg" width="176" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="acedef9a1098c617ad7cce08beda367d5" name="acedef9a1098c617ad7cce08beda367d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acedef9a1098c617ad7cce08beda367d5">&#9670;&#160;</a></span>get_ptr() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/db7/class_c_o_w.html#aa0844a1c7ef409ff7301a0e805b097f4">Ptr</a> get_ptr </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../da/db7/class_c_o_w_acedef9a1098c617ad7cce08beda367d5_cgraph.svg" width="186" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../da/db7/class_c_o_w_acedef9a1098c617ad7cce08beda367d5_icgraph.svg" width="515" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a8c0a81f654bf5a407ac29dd0edb27bb5" name="a8c0a81f654bf5a407ac29dd0edb27bb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c0a81f654bf5a407ac29dd0edb27bb5">&#9670;&#160;</a></span>get_ptr() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/db7/class_c_o_w.html#adfc3e84da89b27b9efa22c1e0691fa87">MutablePtr</a> get_ptr </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../da/db7/class_c_o_w_a8c0a81f654bf5a407ac29dd0edb27bb5_cgraph.svg" width="186" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ad047853e449e6932f2bc7b8020e1b273" name="ad047853e449e6932f2bc7b8020e1b273"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad047853e449e6932f2bc7b8020e1b273">&#9670;&#160;</a></span>shallow_mutate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/db7/class_c_o_w.html#adfc3e84da89b27b9efa22c1e0691fa87">MutablePtr</a> shallow_mutate </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../da/db7/class_c_o_w_ad047853e449e6932f2bc7b8020e1b273_cgraph.svg" width="516" height="138"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../da/db7/class_c_o_w_ad047853e449e6932f2bc7b8020e1b273_icgraph.svg" width="235" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a8b5fe4e17cc0aefcc974d3af422918d1" name="a8b5fe4e17cc0aefcc974d3af422918d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b5fe4e17cc0aefcc974d3af422918d1">&#9670;&#160;</a></span>mutate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/db7/class_c_o_w.html#adfc3e84da89b27b9efa22c1e0691fa87">MutablePtr</a> mutate </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const &amp;&amp;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../da/db7/class_c_o_w_a8b5fe4e17cc0aefcc974d3af422918d1_cgraph.svg" width="627" height="138"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ade206b8984a3bec01eb7412e6076e813" name="ade206b8984a3bec01eb7412e6076e813"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade206b8984a3bec01eb7412e6076e813">&#9670;&#160;</a></span>assume_mutable()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/db7/class_c_o_w.html#adfc3e84da89b27b9efa22c1e0691fa87">MutablePtr</a> assume_mutable </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../da/db7/class_c_o_w_ade206b8984a3bec01eb7412e6076e813_cgraph.svg" width="355" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../da/db7/class_c_o_w_ade206b8984a3bec01eb7412e6076e813_icgraph.svg" width="404" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a99c0ad5c2ddd8b7522956be31b953aba" name="a99c0ad5c2ddd8b7522956be31b953aba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99c0ad5c2ddd8b7522956be31b953aba">&#9670;&#160;</a></span>assume_mutable_ref()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Derived &amp; assume_mutable_ref </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../da/db7/class_c_o_w_a99c0ad5c2ddd8b7522956be31b953aba_cgraph.svg" width="266" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<h2 class="groupheader">类成员变量说明</h2>
<a id="a99ea8f05f0564ac618b0620716b84949" name="a99ea8f05f0564ac618b0620716b84949"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99ea8f05f0564ac618b0620716b84949">&#9670;&#160;</a></span>ref_counter</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::atomic_uint ref_counter</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<hr/>该类的文档由以下文件生成:<ul>
<li>/Users/dabowang/be_all/vec/common/<a class="el" href="../../d1/dd0/cow_8h_source.html">cow.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
制作者&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6
</small></address>
</body>
</html>
