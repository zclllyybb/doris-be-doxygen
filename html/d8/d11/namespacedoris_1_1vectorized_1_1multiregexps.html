<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>be_all: doris::vectorized::multiregexps 命名空间参考</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">be_all
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- 制作者 Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','搜索');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">载入中...</div>
<div class="SRStatus" id="Searching">搜索中...</div>
<div class="SRStatus" id="NoMatches">未找到</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d6/d94/namespacedoris.html">doris</a></li><li class="navelem"><a class="el" href="../../d3/d1e/namespacedoris_1_1vectorized.html">vectorized</a></li><li class="navelem"><a class="el" href="../../d8/d11/namespacedoris_1_1vectorized_1_1multiregexps.html">multiregexps</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">类</a> &#124;
<a href="#typedef-members">类型定义</a> &#124;
<a href="#func-members">函数</a>  </div>
  <div class="headertitle"><div class="title">doris::vectorized::multiregexps 命名空间参考</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
类</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d6e/classdoris_1_1vectorized_1_1multiregexps_1_1_deferred_constructed_regexps.html">DeferredConstructedRegexps</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/da2/structdoris_1_1vectorized_1_1multiregexps_1_1_global_cache_table.html">GlobalCacheTable</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d0a/structdoris_1_1vectorized_1_1multiregexps_1_1_hyperscan_deleter.html">HyperscanDeleter</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d96/classdoris_1_1vectorized_1_1multiregexps_1_1_regexps.html">Regexps</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Database is thread safe across multiple threads and Scratch is not but we can copy it whenever we use it in the searcher.  <a href="../../d3/d96/classdoris_1_1vectorized_1_1multiregexps_1_1_regexps.html#details">更多...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
类型定义</h2></td></tr>
<tr class="memitem:a75303ec454ffb6a5909762b85e3172f3"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d11/namespacedoris_1_1vectorized_1_1multiregexps.html#a75303ec454ffb6a5909762b85e3172f3">CompilerError</a> = std::unique_ptr&lt; hs_compile_error_t, <a class="el" href="../../d6/d0a/structdoris_1_1vectorized_1_1multiregexps_1_1_hyperscan_deleter.html">HyperscanDeleter</a>&lt; decltype(&amp;hs_free_compile_error), &amp;hs_free_compile_error &gt; &gt;</td></tr>
<tr class="memdesc:a75303ec454ffb6a5909762b85e3172f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper unique pointers to correctly delete the allocated space when hyperscan cannot compile something and we throw an exception.  <br /></td></tr>
<tr class="separator:a75303ec454ffb6a5909762b85e3172f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38c09bab5b7729494e7d53b9d1f1e210"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d11/namespacedoris_1_1vectorized_1_1multiregexps.html#a38c09bab5b7729494e7d53b9d1f1e210">ScratchPtr</a> = std::unique_ptr&lt; hs_scratch_t, <a class="el" href="../../d6/d0a/structdoris_1_1vectorized_1_1multiregexps_1_1_hyperscan_deleter.html">HyperscanDeleter</a>&lt; decltype(&amp;hs_free_scratch), &amp;hs_free_scratch &gt; &gt;</td></tr>
<tr class="separator:a38c09bab5b7729494e7d53b9d1f1e210"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a0c43fb5454a62237c562c69580d386"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d11/namespacedoris_1_1vectorized_1_1multiregexps.html#a1a0c43fb5454a62237c562c69580d386">DataBasePtr</a> = std::unique_ptr&lt; hs_database_t, <a class="el" href="../../d6/d0a/structdoris_1_1vectorized_1_1multiregexps_1_1_hyperscan_deleter.html">HyperscanDeleter</a>&lt; decltype(&amp;hs_free_database), &amp;hs_free_database &gt; &gt;</td></tr>
<tr class="separator:a1a0c43fb5454a62237c562c69580d386"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af16260e02b86d819e4e65d39a54c566e"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d11/namespacedoris_1_1vectorized_1_1multiregexps.html#af16260e02b86d819e4e65d39a54c566e">DeferredConstructedRegexpsPtr</a> = std::shared_ptr&lt; <a class="el" href="../../d4/d6e/classdoris_1_1vectorized_1_1multiregexps_1_1_deferred_constructed_regexps.html">DeferredConstructedRegexps</a> &gt;</td></tr>
<tr class="separator:af16260e02b86d819e4e65d39a54c566e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
函数</h2></td></tr>
<tr class="memitem:a41158d2c25d3e43f2571731fa6836842"><td class="memTemplParams" colspan="2">template&lt;bool save_indices, bool WithEditDistance&gt; </td></tr>
<tr class="memitem:a41158d2c25d3e43f2571731fa6836842"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="../../d3/d96/classdoris_1_1vectorized_1_1multiregexps_1_1_regexps.html">Regexps</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d8/d11/namespacedoris_1_1vectorized_1_1multiregexps.html#a41158d2c25d3e43f2571731fa6836842">constructRegexps</a> (const std::vector&lt; <a class="el" href="../../d3/d1e/namespacedoris_1_1vectorized.html#a5573b97b9e5129f61d289e037d7e806c">String</a> &gt; &amp;str_patterns, std::optional&lt; <a class="el" href="../../d3/d1e/namespacedoris_1_1vectorized.html#a16bda7e33183fb876dbb944cbb556702">UInt32</a> &gt; edit_distance)</td></tr>
<tr class="separator:a41158d2c25d3e43f2571731fa6836842"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58a2fd0216c72d66bd96c245d1086926"><td class="memTemplParams" colspan="2">template&lt;bool save_indices, bool WithEditDistance&gt; </td></tr>
<tr class="memitem:a58a2fd0216c72d66bd96c245d1086926"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="../../d8/d11/namespacedoris_1_1vectorized_1_1multiregexps.html#af16260e02b86d819e4e65d39a54c566e">DeferredConstructedRegexpsPtr</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d8/d11/namespacedoris_1_1vectorized_1_1multiregexps.html#a58a2fd0216c72d66bd96c245d1086926">getOrSet</a> (const std::vector&lt; <a class="el" href="../../d1/d47/structdoris_1_1_string_ref.html">StringRef</a> &gt; &amp;patterns, std::optional&lt; <a class="el" href="../../d3/d1e/namespacedoris_1_1vectorized.html#a16bda7e33183fb876dbb944cbb556702">UInt32</a> &gt; edit_distance)</td></tr>
<tr class="separator:a58a2fd0216c72d66bd96c245d1086926"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">类型定义说明</h2>
<a id="a75303ec454ffb6a5909762b85e3172f3" name="a75303ec454ffb6a5909762b85e3172f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75303ec454ffb6a5909762b85e3172f3">&#9670;&#160;</a></span>CompilerError</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="../../d8/d11/namespacedoris_1_1vectorized_1_1multiregexps.html#a75303ec454ffb6a5909762b85e3172f3">CompilerError</a> =  std::unique_ptr&lt;hs_compile_error_t, <a class="el" href="../../d6/d0a/structdoris_1_1vectorized_1_1multiregexps_1_1_hyperscan_deleter.html">HyperscanDeleter</a>&lt;decltype(&amp;hs_free_compile_error), &amp;hs_free_compile_error&gt; &gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Helper unique pointers to correctly delete the allocated space when hyperscan cannot compile something and we throw an exception. </p>

</div>
</div>
<a id="a38c09bab5b7729494e7d53b9d1f1e210" name="a38c09bab5b7729494e7d53b9d1f1e210"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38c09bab5b7729494e7d53b9d1f1e210">&#9670;&#160;</a></span>ScratchPtr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="../../d8/d11/namespacedoris_1_1vectorized_1_1multiregexps.html#a38c09bab5b7729494e7d53b9d1f1e210">ScratchPtr</a> =  std::unique_ptr&lt;hs_scratch_t, <a class="el" href="../../d6/d0a/structdoris_1_1vectorized_1_1multiregexps_1_1_hyperscan_deleter.html">HyperscanDeleter</a>&lt;decltype(&amp;hs_free_scratch), &amp;hs_free_scratch&gt; &gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a1a0c43fb5454a62237c562c69580d386" name="a1a0c43fb5454a62237c562c69580d386"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a0c43fb5454a62237c562c69580d386">&#9670;&#160;</a></span>DataBasePtr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="../../d8/d11/namespacedoris_1_1vectorized_1_1multiregexps.html#a1a0c43fb5454a62237c562c69580d386">DataBasePtr</a> =  std::unique_ptr&lt;hs_database_t, <a class="el" href="../../d6/d0a/structdoris_1_1vectorized_1_1multiregexps_1_1_hyperscan_deleter.html">HyperscanDeleter</a>&lt;decltype(&amp;hs_free_database), &amp;hs_free_database&gt; &gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af16260e02b86d819e4e65d39a54c566e" name="af16260e02b86d819e4e65d39a54c566e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af16260e02b86d819e4e65d39a54c566e">&#9670;&#160;</a></span>DeferredConstructedRegexpsPtr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="../../d8/d11/namespacedoris_1_1vectorized_1_1multiregexps.html#af16260e02b86d819e4e65d39a54c566e">DeferredConstructedRegexpsPtr</a> =  std::shared_ptr&lt;<a class="el" href="../../d4/d6e/classdoris_1_1vectorized_1_1multiregexps_1_1_deferred_constructed_regexps.html">DeferredConstructedRegexps</a>&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">函数说明</h2>
<a id="a41158d2c25d3e43f2571731fa6836842" name="a41158d2c25d3e43f2571731fa6836842"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41158d2c25d3e43f2571731fa6836842">&#9670;&#160;</a></span>constructRegexps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d3/d96/classdoris_1_1vectorized_1_1multiregexps_1_1_regexps.html">Regexps</a> constructRegexps </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="../../d3/d1e/namespacedoris_1_1vectorized.html#a5573b97b9e5129f61d289e037d7e806c">String</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>str_patterns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::optional&lt; <a class="el" href="../../d3/d1e/namespacedoris_1_1vectorized.html#a16bda7e33183fb876dbb944cbb556702">UInt32</a> &gt;&#160;</td>
          <td class="paramname"><em>edit_distance</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Common pointers</p>
<p>Pointer for external edit distance compilation</p>
<p>Hyperscan currently does not support UTF8 matching with edit distance.</p>
<p>HS_EXT_FLAG_EDIT_DISTANCE is a compile flag responsible for Levenstein distance.</p>
<p>We mark the patterns to provide the callback results.</p>
<p>CompilerError is a unique_ptr, so correct memory free after the exception is thrown.</p>
<p>We allocate the scratch space only once, then copy it across multiple threads with hs_clone_scratch function which is faster than allocating scratch space each time in each thread.</p>
<p>If not HS_SUCCESS, it is guaranteed that the memory would not be allocated for scratch.</p>

</div>
</div>
<a id="a58a2fd0216c72d66bd96c245d1086926" name="a58a2fd0216c72d66bd96c245d1086926"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58a2fd0216c72d66bd96c245d1086926">&#9670;&#160;</a></span>getOrSet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d8/d11/namespacedoris_1_1vectorized_1_1multiregexps.html#af16260e02b86d819e4e65d39a54c566e">DeferredConstructedRegexpsPtr</a> getOrSet </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="../../d1/d47/structdoris_1_1_string_ref.html">StringRef</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>patterns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::optional&lt; <a class="el" href="../../d3/d1e/namespacedoris_1_1vectorized.html#a16bda7e33183fb876dbb944cbb556702">UInt32</a> &gt;&#160;</td>
          <td class="paramname"><em>edit_distance</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>If WithEditDistance is False, edit_distance must be nullopt. Also, we use templates here because each instantiation of function template has its own copy of local static variables which must not be the same for different hyperscan compilations. </p>
<p>Different variables for different pattern parameters, thread-safe in C++11</p>
<p>Lock cache to find compiled regexp for given pattern vector + edit distance.</p>
<p>Pattern compilation is expensive and we don't want to block other threads reading from / inserting into the cache while we hold the cache lock during pattern compilation. Therefore, when a cache entry is created or replaced, only set the regexp constructor method and compile outside the cache lock. Note that the string patterns and the edit distance is passed into the constructor lambda by value, i.e. copied - it is not an option to reference the corresponding string patterns / edit distance key in the cache table bucket because the cache entry may already be evicted at the time the compilation starts.</p>
<p>insert new entry</p>
<p>replace existing entry</p>
<div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d8/d11/namespacedoris_1_1vectorized_1_1multiregexps_a58a2fd0216c72d66bd96c245d1086926_cgraph.svg" width="344" height="66"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d8/d11/namespacedoris_1_1vectorized_1_1multiregexps_a58a2fd0216c72d66bd96c245d1086926_icgraph.svg" width="318" height="144"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
制作者&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6
</small></address>
</body>
</html>
