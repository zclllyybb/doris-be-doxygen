\hypertarget{telemetry_8h}{}\doxysection{/\+Users/dabowang/doris/be/src/util/telemetry/telemetry.h 文件参考}
\label{telemetry_8h}\index{/Users/dabowang/doris/be/src/util/telemetry/telemetry.h@{/Users/dabowang/doris/be/src/util/telemetry/telemetry.h}}
{\ttfamily \#include \char`\"{}opentelemetry/trace/provider.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}util/telemetry/open\+\_\+telemetry\+\_\+scop\+\_\+wrapper.\+hpp\char`\"{}}\newline
telemetry.\+h 的引用(Include)关系图\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=322pt]{da/db8/telemetry_8h__incl}
\end{center}
\end{figure}
此图展示该文件直接或间接的被哪些文件引用了\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/d8d/telemetry_8h__dep__incl}
\end{center}
\end{figure}
\doxysubsection*{命名空间}
\begin{DoxyCompactItemize}
\item 
namespace \mbox{\hyperlink{namespacedoris}{doris}}
\begin{DoxyCompactList}\small\item\em Utilities for collecting timings. \end{DoxyCompactList}\item 
namespace \mbox{\hyperlink{namespacedoris_1_1telemetry}{doris\+::telemetry}}
\end{DoxyCompactItemize}
\doxysubsection*{宏定义}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{telemetry_8h_ac8fdc6ce37d8bb7b6428d21b60e44e6f}{INIT\+\_\+\+AND\+\_\+\+SCOPE\+\_\+\+GET\+\_\+\+NEXT\+\_\+\+SPAN}}(tracer,  get\+\_\+next\+\_\+span,  \mbox{\hyperlink{signal__handler_8h_a8f8f80d37794cde9472343e4487ba3eb}{name}})
\begin{DoxyCompactList}\small\item\em Used to initialize get\+\_\+next\+\_\+span and add Scope. \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{telemetry_8h_a9a59e66b2ea1ac89d12cb36c134ed6ae}{INIT\+\_\+\+AND\+\_\+\+SCOPE\+\_\+\+SEND\+\_\+\+SPAN}}(tracer,  send\+\_\+span,  \mbox{\hyperlink{signal__handler_8h_a8f8f80d37794cde9472343e4487ba3eb}{name}})~    \mbox{\hyperlink{telemetry_8h_ac8fdc6ce37d8bb7b6428d21b60e44e6f}{INIT\+\_\+\+AND\+\_\+\+SCOPE\+\_\+\+GET\+\_\+\+NEXT\+\_\+\+SPAN}}(tracer, send\+\_\+span, \mbox{\hyperlink{signal__handler_8h_a8f8f80d37794cde9472343e4487ba3eb}{name}})
\item 
\#define \mbox{\hyperlink{telemetry_8h_a5c673112172be52fc85cd82133bac19d}{START\+\_\+\+AND\+\_\+\+SCOPE\+\_\+\+SPAN}}(tracer,  span,  \mbox{\hyperlink{signal__handler_8h_a8f8f80d37794cde9472343e4487ba3eb}{name}})
\item 
\#define \mbox{\hyperlink{telemetry_8h_a60cdb9f715eb5d4dd762c77e5fb01588}{START\+\_\+\+AND\+\_\+\+SCOPE\+\_\+\+SPAN\+\_\+\+IF}}(enable,  tracer,  \mbox{\hyperlink{signal__handler_8h_a8f8f80d37794cde9472343e4487ba3eb}{name}})~    Open\+Telemetry\+Scope\+Wrapper(enable, tracer, \mbox{\hyperlink{signal__handler_8h_a8f8f80d37794cde9472343e4487ba3eb}{name}})
\item 
\#define \mbox{\hyperlink{telemetry_8h_a705085278532ed703d5fcda4090415a1}{INIT\+\_\+\+AND\+\_\+\+SCOPE\+\_\+\+REENTRANT\+\_\+\+SPAN\+\_\+\+IF}}(enable,  tracer,  reentrant\+\_\+span,  \mbox{\hyperlink{signal__handler_8h_a8f8f80d37794cde9472343e4487ba3eb}{name}})~    Open\+Telemetry\+Scope\+Wrapper(enable, tracer, reentrant\+\_\+span, \mbox{\hyperlink{signal__handler_8h_a8f8f80d37794cde9472343e4487ba3eb}{name}})
\end{DoxyCompactItemize}
\doxysubsection*{函数}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{namespacedoris_1_1telemetry_a5e4d9d179b63fc6ac411df03cb55f9af}{init\+\_\+tracer}} ()
\item 
Opentelemetry\+Tracer \& \mbox{\hyperlink{namespacedoris_1_1telemetry_a1dd17b86c23ce20db63533896ca35af8}{get\+\_\+noop\+\_\+tracer}} ()
\item 
Opentelemetry\+Tracer \mbox{\hyperlink{namespacedoris_1_1telemetry_ab9934daefaf5461368b73e2561d0d528}{get\+\_\+tracer}} (const std\+::string \&tracer\+\_\+name)
\item 
bool \mbox{\hyperlink{namespacedoris_1_1telemetry_ac3ec43b8bb2989ad7bc08f03e46923cb}{is\+\_\+current\+\_\+span\+\_\+valid}} ()
\begin{DoxyCompactList}\small\item\em Returns true if the active pan stack is not empty. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{宏定义说明}
\mbox{\Hypertarget{telemetry_8h_ac8fdc6ce37d8bb7b6428d21b60e44e6f}\label{telemetry_8h_ac8fdc6ce37d8bb7b6428d21b60e44e6f}} 
\index{telemetry.h@{telemetry.h}!INIT\_AND\_SCOPE\_GET\_NEXT\_SPAN@{INIT\_AND\_SCOPE\_GET\_NEXT\_SPAN}}
\index{INIT\_AND\_SCOPE\_GET\_NEXT\_SPAN@{INIT\_AND\_SCOPE\_GET\_NEXT\_SPAN}!telemetry.h@{telemetry.h}}
\doxysubsubsection{\texorpdfstring{INIT\_AND\_SCOPE\_GET\_NEXT\_SPAN}{INIT\_AND\_SCOPE\_GET\_NEXT\_SPAN}}
{\footnotesize\ttfamily \#define INIT\+\_\+\+AND\+\_\+\+SCOPE\+\_\+\+GET\+\_\+\+NEXT\+\_\+\+SPAN(\begin{DoxyParamCaption}\item[{}]{tracer,  }\item[{}]{get\+\_\+next\+\_\+span,  }\item[{}]{\mbox{\hyperlink{signal__handler_8h_a8f8f80d37794cde9472343e4487ba3eb}{name}} }\end{DoxyParamCaption})}

{\bfseries 值\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{do}\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ if\ (\mbox{\hyperlink{compiler__util_8h_a9acc330d508b9a3b775cfdf7ce405e7d}{UNLIKELY}}(!get\_next\_span))\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ get\_next\_span\ =\ tracer-\/>StartSpan(\mbox{\hyperlink{signal__handler_8h_a8f8f80d37794cde9472343e4487ba3eb}{name}});\ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \}\ \textcolor{keywordflow}{while}\ (\textcolor{keyword}{false});\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{namespacedoris_ae97071b9406ecba0fd404b41cdfbeaa9}{OpentelemetryScope}}\ scope\ \{get\_next\_span\};}

\end{DoxyCode}


Used to initialize get\+\_\+next\+\_\+span and add Scope. 

\mbox{\Hypertarget{telemetry_8h_a9a59e66b2ea1ac89d12cb36c134ed6ae}\label{telemetry_8h_a9a59e66b2ea1ac89d12cb36c134ed6ae}} 
\index{telemetry.h@{telemetry.h}!INIT\_AND\_SCOPE\_SEND\_SPAN@{INIT\_AND\_SCOPE\_SEND\_SPAN}}
\index{INIT\_AND\_SCOPE\_SEND\_SPAN@{INIT\_AND\_SCOPE\_SEND\_SPAN}!telemetry.h@{telemetry.h}}
\doxysubsubsection{\texorpdfstring{INIT\_AND\_SCOPE\_SEND\_SPAN}{INIT\_AND\_SCOPE\_SEND\_SPAN}}
{\footnotesize\ttfamily \#define INIT\+\_\+\+AND\+\_\+\+SCOPE\+\_\+\+SEND\+\_\+\+SPAN(\begin{DoxyParamCaption}\item[{}]{tracer,  }\item[{}]{send\+\_\+span,  }\item[{}]{\mbox{\hyperlink{signal__handler_8h_a8f8f80d37794cde9472343e4487ba3eb}{name}} }\end{DoxyParamCaption})~    \mbox{\hyperlink{telemetry_8h_ac8fdc6ce37d8bb7b6428d21b60e44e6f}{INIT\+\_\+\+AND\+\_\+\+SCOPE\+\_\+\+GET\+\_\+\+NEXT\+\_\+\+SPAN}}(tracer, send\+\_\+span, \mbox{\hyperlink{signal__handler_8h_a8f8f80d37794cde9472343e4487ba3eb}{name}})}

\mbox{\Hypertarget{telemetry_8h_a5c673112172be52fc85cd82133bac19d}\label{telemetry_8h_a5c673112172be52fc85cd82133bac19d}} 
\index{telemetry.h@{telemetry.h}!START\_AND\_SCOPE\_SPAN@{START\_AND\_SCOPE\_SPAN}}
\index{START\_AND\_SCOPE\_SPAN@{START\_AND\_SCOPE\_SPAN}!telemetry.h@{telemetry.h}}
\doxysubsubsection{\texorpdfstring{START\_AND\_SCOPE\_SPAN}{START\_AND\_SCOPE\_SPAN}}
{\footnotesize\ttfamily \#define START\+\_\+\+AND\+\_\+\+SCOPE\+\_\+\+SPAN(\begin{DoxyParamCaption}\item[{}]{tracer,  }\item[{}]{span,  }\item[{}]{\mbox{\hyperlink{signal__handler_8h_a8f8f80d37794cde9472343e4487ba3eb}{name}} }\end{DoxyParamCaption})}

{\bfseries 值\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{auto}\ span\ =\ tracer-\/>StartSpan(\mbox{\hyperlink{signal__handler_8h_a8f8f80d37794cde9472343e4487ba3eb}{name}});\ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ OpentelemetryScope\ scope\ \{span\};}

\end{DoxyCode}
Start a span with the specified tracer, name, and variable name, and create a Scope for this span.

span represents the execution time of an operation unit, the time of its construction is the start time, the time of its destructuring is the end time, you can also call the End method to let span terminate, like \char`\"{}span-\/$>$\+End();\char`\"{}

We can add Event and Attribute to span. Event will record the timestamp and event content, and Attribute can record key-\/value pairs. For example\+: span-\/\texorpdfstring{$>$}{>}Add\+Event(\char`\"{}event content\char`\"{}); span-\/\texorpdfstring{$>$}{>}Set\+Attribute(\char`\"{}key\char`\"{}, \char`\"{}value\char`\"{});

Scope will add the span to a thread-\/local stack during construction, and remove the span from the stack during destructuring. When starting a span, the top-\/of-\/stack span will be the parent span by default, and the top-\/of-\/stack span can be obtained via the opentelemetry\+::trace\+::\+Tracer\+::\+Get\+Current\+Span() method. \mbox{\Hypertarget{telemetry_8h_a60cdb9f715eb5d4dd762c77e5fb01588}\label{telemetry_8h_a60cdb9f715eb5d4dd762c77e5fb01588}} 
\index{telemetry.h@{telemetry.h}!START\_AND\_SCOPE\_SPAN\_IF@{START\_AND\_SCOPE\_SPAN\_IF}}
\index{START\_AND\_SCOPE\_SPAN\_IF@{START\_AND\_SCOPE\_SPAN\_IF}!telemetry.h@{telemetry.h}}
\doxysubsubsection{\texorpdfstring{START\_AND\_SCOPE\_SPAN\_IF}{START\_AND\_SCOPE\_SPAN\_IF}}
{\footnotesize\ttfamily \#define START\+\_\+\+AND\+\_\+\+SCOPE\+\_\+\+SPAN\+\_\+\+IF(\begin{DoxyParamCaption}\item[{}]{enable,  }\item[{}]{tracer,  }\item[{}]{\mbox{\hyperlink{signal__handler_8h_a8f8f80d37794cde9472343e4487ba3eb}{name}} }\end{DoxyParamCaption})~    Open\+Telemetry\+Scope\+Wrapper(enable, tracer, \mbox{\hyperlink{signal__handler_8h_a8f8f80d37794cde9472343e4487ba3eb}{name}})}

\mbox{\Hypertarget{telemetry_8h_a705085278532ed703d5fcda4090415a1}\label{telemetry_8h_a705085278532ed703d5fcda4090415a1}} 
\index{telemetry.h@{telemetry.h}!INIT\_AND\_SCOPE\_REENTRANT\_SPAN\_IF@{INIT\_AND\_SCOPE\_REENTRANT\_SPAN\_IF}}
\index{INIT\_AND\_SCOPE\_REENTRANT\_SPAN\_IF@{INIT\_AND\_SCOPE\_REENTRANT\_SPAN\_IF}!telemetry.h@{telemetry.h}}
\doxysubsubsection{\texorpdfstring{INIT\_AND\_SCOPE\_REENTRANT\_SPAN\_IF}{INIT\_AND\_SCOPE\_REENTRANT\_SPAN\_IF}}
{\footnotesize\ttfamily \#define INIT\+\_\+\+AND\+\_\+\+SCOPE\+\_\+\+REENTRANT\+\_\+\+SPAN\+\_\+\+IF(\begin{DoxyParamCaption}\item[{}]{enable,  }\item[{}]{tracer,  }\item[{}]{reentrant\+\_\+span,  }\item[{}]{\mbox{\hyperlink{signal__handler_8h_a8f8f80d37794cde9472343e4487ba3eb}{name}} }\end{DoxyParamCaption})~    Open\+Telemetry\+Scope\+Wrapper(enable, tracer, reentrant\+\_\+span, \mbox{\hyperlink{signal__handler_8h_a8f8f80d37794cde9472343e4487ba3eb}{name}})}

