\hypertarget{parquet__pred__cmp_8h_source}{}\doxysection{parquet\+\_\+pred\+\_\+cmp.\+h}
\label{parquet__pred__cmp_8h_source}\index{/Users/dabowang/doris/be/src/vec/exec/format/parquet/parquet\_pred\_cmp.h@{/Users/dabowang/doris/be/src/vec/exec/format/parquet/parquet\_pred\_cmp.h}}
\mbox{\hyperlink{parquet__pred__cmp_8h}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Licensed\ to\ the\ Apache\ Software\ Foundation\ (ASF)\ under\ one}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ or\ more\ contributor\ license\ agreements.\ \ See\ the\ NOTICE\ file}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ distributed\ with\ this\ work\ for\ additional\ information}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ regarding\ copyright\ ownership.\ \ The\ ASF\ licenses\ this\ file}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ to\ you\ under\ the\ Apache\ License,\ Version\ 2.0\ (the}}
\DoxyCodeLine{00006\ \textcolor{comment}{//\ "{}License"{});\ you\ may\ not\ use\ this\ file\ except\ in\ compliance}}
\DoxyCodeLine{00007\ \textcolor{comment}{//\ with\ the\ License.\ \ You\ may\ obtain\ a\ copy\ of\ the\ License\ at}}
\DoxyCodeLine{00008\ \textcolor{comment}{//}}
\DoxyCodeLine{00009\ \textcolor{comment}{//\ \ \ http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{00010\ \textcolor{comment}{//}}
\DoxyCodeLine{00011\ \textcolor{comment}{//\ Unless\ required\ by\ applicable\ law\ or\ agreed\ to\ in\ writing,}}
\DoxyCodeLine{00012\ \textcolor{comment}{//\ software\ distributed\ under\ the\ License\ is\ distributed\ on\ an}}
\DoxyCodeLine{00013\ \textcolor{comment}{//\ "{}AS\ IS"{}\ BASIS,\ WITHOUT\ WARRANTIES\ OR\ CONDITIONS\ OF\ ANY}}
\DoxyCodeLine{00014\ \textcolor{comment}{//\ KIND,\ either\ express\ or\ implied.\ \ See\ the\ License\ for\ the}}
\DoxyCodeLine{00015\ \textcolor{comment}{//\ specific\ language\ governing\ permissions\ and\ limitations}}
\DoxyCodeLine{00016\ \textcolor{comment}{//\ under\ the\ License.}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ <cstring>}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{exec_2olap__common_8h}{exec/olap\_common.h}}"{}}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{endian_8h}{gutil/endian.h}}"{}}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{parquet__common_8h}{parquet\_common.h}}"{}}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{data__type__decimal_8h}{vec/data\_types/data\_type\_decimal.h}}"{}}}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{format__common_8h}{vec/exec/format/format\_common.h}}"{}}}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacedoris_1_1vectorized}{doris::vectorized}}\ \{}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00031\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classdoris_1_1vectorized_1_1_parquet_predicate}{ParquetPredicate}}\ \{}
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\#define\ FOR\_REINTERPRET\_TYPES(M)\ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00033\ \textcolor{preprocessor}{\ \ \ \ M(TYPE\_BOOLEAN,\ tparquet::Type::BOOLEAN)\ \(\backslash\)}}
\DoxyCodeLine{00034\ \textcolor{preprocessor}{\ \ \ \ M(TYPE\_TINYINT,\ tparquet::Type::INT32)\ \ \ \(\backslash\)}}
\DoxyCodeLine{00035\ \textcolor{preprocessor}{\ \ \ \ M(TYPE\_SMALLINT,\ tparquet::Type::INT32)\ \ \(\backslash\)}}
\DoxyCodeLine{00036\ \textcolor{preprocessor}{\ \ \ \ M(TYPE\_INT,\ tparquet::Type::INT32)\ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00037\ \textcolor{preprocessor}{\ \ \ \ M(TYPE\_BIGINT,\ tparquet::Type::INT64)\ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00038\ \textcolor{preprocessor}{\ \ \ \ M(TYPE\_FLOAT,\ tparquet::Type::FLOAT)\ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00039\ \textcolor{preprocessor}{\ \ \ \ M(TYPE\_DOUBLE,\ tparquet::Type::DOUBLE)}}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00042\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structdoris_1_1vectorized_1_1_parquet_predicate_1_1_scan_predicate}{ScanPredicate}}\ \{}
\DoxyCodeLine{00043\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structdoris_1_1vectorized_1_1_parquet_predicate_1_1_scan_predicate_acb88fd24d308826dd96c10fcd1faacd2}{ScanPredicate}}()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00044\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structdoris_1_1vectorized_1_1_parquet_predicate_1_1_scan_predicate_aa5bdb4b1dbc592e455c37ba9db0145cc}{\string~ScanPredicate}}()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedoris_acea2ffc3003c9e3f12465e6ed8864c06}{SQLFilterOp}}\ \mbox{\hyperlink{structdoris_1_1vectorized_1_1_parquet_predicate_1_1_scan_predicate_afde7117e56a1e82a4ff9ad2ed3286840}{op}};}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ std::vector<const\ void*>\ \mbox{\hyperlink{structdoris_1_1vectorized_1_1_parquet_predicate_1_1_scan_predicate_ab1430cd872e93a6c4e27a1284dad1ff8}{values}};}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structdoris_1_1vectorized_1_1_parquet_predicate_1_1_scan_predicate_a418e7934b5363ecde8269070181b3cef}{scale}};}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structdoris_1_1vectorized_1_1_parquet_predicate_1_1_scan_predicate_aa619c0d67fa8aa057552c0395711fee8}{ScanPredicate}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structdoris_1_1vectorized_1_1_parquet_predicate_1_1_scan_predicate}{ScanPredicate}}\&\ other)\ \{}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structdoris_1_1vectorized_1_1_parquet_predicate_1_1_scan_predicate_afde7117e56a1e82a4ff9ad2ed3286840}{op}}\ =\ other.\mbox{\hyperlink{structdoris_1_1vectorized_1_1_parquet_predicate_1_1_scan_predicate_afde7117e56a1e82a4ff9ad2ed3286840}{op}};}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ v\ :\ other.\mbox{\hyperlink{structdoris_1_1vectorized_1_1_parquet_predicate_1_1_scan_predicate_ab1430cd872e93a6c4e27a1284dad1ff8}{values}})\ \{}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structdoris_1_1vectorized_1_1_parquet_predicate_1_1_scan_predicate_ab1430cd872e93a6c4e27a1284dad1ff8}{values}}.emplace\_back(v);}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structdoris_1_1vectorized_1_1_parquet_predicate_1_1_scan_predicate_a418e7934b5363ecde8269070181b3cef}{scale}}\ =\ other.\mbox{\hyperlink{structdoris_1_1vectorized_1_1_parquet_predicate_1_1_scan_predicate_a418e7934b5363ecde8269070181b3cef}{scale}};}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00056\ \ \ \ \ \};}
\DoxyCodeLine{00057\ }
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ DecimalPrimitiveType,\ \textcolor{keyword}{typename}\ DecimalPhysicalType>}
\DoxyCodeLine{00059\ \ \ \ \ \textcolor{keyword}{static}\ DecimalPrimitiveType\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_parquet_predicate_a00e14959c624a2b1f64e3fcf3efc8006}{\_decode\_primitive\_decimal}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structdoris_1_1vectorized_1_1_field_schema}{FieldSchema}}*\ col\_schema,}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ encoded\_data,}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ dest\_scale)\ \{}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ scale\ =\ col\_schema-\/>\mbox{\hyperlink{structdoris_1_1vectorized_1_1_field_schema_a9275f01bc1c1d145c1bd6cb0205cf891}{parquet\_schema}}.scale;}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedoris_1_1vectorized_aeaa392671300adb30bdafd242ac2d21b}{Int128}}\ \mbox{\hyperlink{util_2types_8h_adae7202c63102b0934c3ac5be41b0dae}{value}}\ =\ *\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }DecimalPhysicalType*\textcolor{keyword}{>}(encoded\_data.data());}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (dest\_scale\ >\ scale)\ \{}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{util_2types_8h_adae7202c63102b0934c3ac5be41b0dae}{value}}\ *=\ DecimalScaleParams::get\_scale\_factor<DecimalPrimitiveType>(dest\_scale\ -\/\ scale);}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (dest\_scale\ <\ scale)\ \{}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{util_2types_8h_adae7202c63102b0934c3ac5be41b0dae}{value}}\ /=\ DecimalScaleParams::get\_scale\_factor<DecimalPrimitiveType>(scale\ -\/\ dest\_scale);}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (DecimalPrimitiveType)\mbox{\hyperlink{util_2types_8h_adae7202c63102b0934c3ac5be41b0dae}{value}};}
\DoxyCodeLine{00070\ \ \ \ \ \}}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00072\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ DecimalPrimitiveType>}
\DoxyCodeLine{00073\ \ \ \ \ \textcolor{keyword}{static}\ DecimalPrimitiveType\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_parquet_predicate_ad243f19c8dc95f623d3b6b9543862802}{\_decode\_binary\_decimal}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structdoris_1_1vectorized_1_1_field_schema}{FieldSchema}}*\ col\_schema,}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ encoded\_data,}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ dest\_scale)\ \{}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ scale\ =\ col\_schema-\/>\mbox{\hyperlink{structdoris_1_1vectorized_1_1_field_schema_a9275f01bc1c1d145c1bd6cb0205cf891}{parquet\_schema}}.scale;}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ buf\_start\ =\ encoded\_data.data();}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedoris_1_1vectorized_aeaa392671300adb30bdafd242ac2d21b}{Int128}}\ \mbox{\hyperlink{util_2types_8h_adae7202c63102b0934c3ac5be41b0dae}{value}}\ =\ buf\_start[0]\ \&\ 0x80\ ?\ -\/1\ :\ 0;}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{memcpy__aarch64_8cpp_a156c5821f16ed93be8c7d315303f7b2a}{memcpy}}(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keywordtype}{char}*\textcolor{keyword}{>}(\&\mbox{\hyperlink{util_2types_8h_adae7202c63102b0934c3ac5be41b0dae}{value}})\ +\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{namespacedoris_1_1vectorized_aeaa392671300adb30bdafd242ac2d21b}{Int128}})\ -\/\ encoded\_data.size(),\ buf\_start,}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ encoded\_data.size());}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{util_2types_8h_adae7202c63102b0934c3ac5be41b0dae}{value}}\ =\ BigEndian::ToHost128(\mbox{\hyperlink{util_2types_8h_adae7202c63102b0934c3ac5be41b0dae}{value}});}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (dest\_scale\ >\ scale)\ \{}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{util_2types_8h_adae7202c63102b0934c3ac5be41b0dae}{value}}\ *=\ DecimalScaleParams::get\_scale\_factor<DecimalPrimitiveType>(dest\_scale\ -\/\ scale);}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (dest\_scale\ <\ scale)\ \{}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{util_2types_8h_adae7202c63102b0934c3ac5be41b0dae}{value}}\ /=\ DecimalScaleParams::get\_scale\_factor<DecimalPrimitiveType>(scale\ -\/\ dest\_scale);}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (DecimalPrimitiveType)\mbox{\hyperlink{util_2types_8h_adae7202c63102b0934c3ac5be41b0dae}{value}};}
\DoxyCodeLine{00088\ \ \ \ \ \}}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00090\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ CppType>}
\DoxyCodeLine{00091\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_parquet_predicate_a4eb96e7df0971ba627fffa197bec66e5}{\_filter\_by\_min\_max}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespacedoris_acea2ffc3003c9e3f12465e6ed8864c06}{SQLFilterOp}}\ op,}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::vector<CppType>\&\ predicate\_values,\ CppType\&\ min\_value,}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ CppType\&\ max\_value)\ \{}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (predicate\_values.empty())\ \{}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (op)\ \{}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{namespacedoris_acea2ffc3003c9e3f12465e6ed8864c06ab9cc2312a6994c15deacb5df862af267}{FILTER\_IN}}:}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ CppType\&\ in\_value\ :\ predicate\_values)\ \{}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (in\_value\ >=\ min\_value\ \&\&\ in\_value\ <=\ max\_value)\ \{}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{namespacedoris_acea2ffc3003c9e3f12465e6ed8864c06a6c7014ba678e4bb3533fc7a1cb0421cc}{FILTER\_LESS}}:}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ min\_value\ >=\ predicate\_values[0];}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{namespacedoris_acea2ffc3003c9e3f12465e6ed8864c06a7ef8c41f015cc6269cb62da4515b7417}{FILTER\_LESS\_OR\_EQUAL}}:}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ min\_value\ >\ predicate\_values[0];}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{namespacedoris_acea2ffc3003c9e3f12465e6ed8864c06ae88a5a28e3a5a587a008afa0fa3b0fff}{FILTER\_LARGER}}:}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ max\_value\ <=\ predicate\_values[0];}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{namespacedoris_acea2ffc3003c9e3f12465e6ed8864c06ae52525db3f5063810fdbcacc602370ec}{FILTER\_LARGER\_OR\_EQUAL}}:}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ max\_value\ <\ predicate\_values[0];}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00116\ \ \ \ \ \}}
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00118\ \ \ \ \ \textcolor{keyword}{template}\ <PrimitiveType\ primitive\_type>}
\DoxyCodeLine{00119\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_parquet_predicate_a6bc8ee247556e8a1f79653a5ca2bac0a}{\_filter\_by\_min\_max}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classdoris_1_1_column_value_range}{ColumnValueRange<primitive\_type>}}\&\ col\_val\_range,}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structdoris_1_1vectorized_1_1_parquet_predicate_1_1_scan_predicate}{ScanPredicate}}\&\ predicate,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structdoris_1_1vectorized_1_1_field_schema}{FieldSchema}}*\ col\_schema,}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ encoded\_min,\ \textcolor{keyword}{const}\ std::string\&\ encoded\_max,}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cctz::time\_zone\&\ ctz)\ \{}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \textcolor{keyword}{using\ }CppType\ =\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{structdoris_1_1_primitive_type_traits}{PrimitiveTypeTraits<primitive\_type>::CppType}};}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ std::vector<CppType>\ predicate\_values;}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ v\ :\ predicate.\mbox{\hyperlink{structdoris_1_1vectorized_1_1_parquet_predicate_1_1_scan_predicate_ab1430cd872e93a6c4e27a1284dad1ff8}{values}})\ \{}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \ \ \ \ predicate\_values.emplace\_back(*\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }CppType*\textcolor{keyword}{>}(v));}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00128\ }
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ CppType\ min\_value;}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ CppType\ max\_value;}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ tparquet::Type::type\ physical\_type\ =\ col\_schema-\/>\mbox{\hyperlink{structdoris_1_1vectorized_1_1_field_schema_a396dde35f4e1212c46e1e26510f53bae}{physical\_type}};}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (col\_val\_range.\mbox{\hyperlink{classdoris_1_1_column_value_range_a8d73c1e36227c8dcf7caff20f7984852}{type}}())\ \{}
\DoxyCodeLine{00133\ \textcolor{preprocessor}{\#define\ DISPATCH(REINTERPRET\_TYPE,\ PARQUET\_TYPE)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00134\ \textcolor{preprocessor}{\ \ \ \ case\ REINTERPRET\_TYPE:\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00135\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ if\ (col\_schema-\/>physical\_type\ !=\ PARQUET\_TYPE)\ return\ false;\ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00136\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ min\_value\ =\ *reinterpret\_cast<const\ CppType*>(encoded\_min.data());\ \(\backslash\)}}
\DoxyCodeLine{00137\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ max\_value\ =\ *reinterpret\_cast<const\ CppType*>(encoded\_max.data());\ \(\backslash\)}}
\DoxyCodeLine{00138\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ break;}}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{parquet__pred__cmp_8h_a7ff549f10a6c5bbebdd96c07e60c47af}{FOR\_REINTERPRET\_TYPES}}(\mbox{\hyperlink{aggregate__function__approx__count__distinct_8cpp_ad70cacff0398f52fd2d84da6cf7b6db1}{DISPATCH}})}
\DoxyCodeLine{00140\ \textcolor{preprocessor}{\#undef\ DISPATCH}}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{namespacedoris_a240c1924416689e5700ff0d9f30539d9a15f033692a37f9224d09a64c34ede12e}{TYPE\_VARCHAR}}:}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \ \ \ \ [[fallthrough]];}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{namespacedoris_a240c1924416689e5700ff0d9f30539d9a2c8735de6cf799483eefed0e90a386f5}{TYPE\_CHAR}}:}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \ \ \ \ [[fallthrough]];}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{namespacedoris_a240c1924416689e5700ff0d9f30539d9addb4be6b1cc25112defabef75f73427a}{TYPE\_STRING}}:}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<CppType,\ StringRef>)\ \{}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ min\_value\ =\ \mbox{\hyperlink{structdoris_1_1_string_ref}{StringRef}}(encoded\_min);}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ max\_value\ =\ \mbox{\hyperlink{structdoris_1_1_string_ref}{StringRef}}(encoded\_max);}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{namespacedoris_a240c1924416689e5700ff0d9f30539d9a65cb0fcd0127e62c9296f5fdb88c5dd5}{TYPE\_DECIMALV2}}:}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<CppType,\ DecimalV2Value>)\ \{}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ max\_precision\ =\ max\_decimal\_precision<Decimal<\_\_int128\_t>>();}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (col\_schema-\/>\mbox{\hyperlink{structdoris_1_1vectorized_1_1_field_schema_a9275f01bc1c1d145c1bd6cb0205cf891}{parquet\_schema}}.precision\ <\ 1\ ||}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ col\_schema-\/>\mbox{\hyperlink{structdoris_1_1vectorized_1_1_field_schema_a9275f01bc1c1d145c1bd6cb0205cf891}{parquet\_schema}}.precision\ >\ max\_precision\ ||}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ col\_schema-\/>\mbox{\hyperlink{structdoris_1_1vectorized_1_1_field_schema_a9275f01bc1c1d145c1bd6cb0205cf891}{parquet\_schema}}.scale\ >\ max\_precision)\ \{}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ v2\_scale\ =\ \mbox{\hyperlink{classdoris_1_1_decimal_v2_value_ac238a1a6c2dbfd18bfc1e961be2e72f9}{DecimalV2Value::SCALE}};}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (physical\_type\ ==\ tparquet::Type::FIXED\_LEN\_BYTE\_ARRAY)\ \{}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ min\_value\ =\ \mbox{\hyperlink{classdoris_1_1_decimal_v2_value}{DecimalV2Value}}(}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_decode\_binary\_decimal<Int128>(col\_schema,\ encoded\_min,\ v2\_scale));}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ max\_value\ =\ \mbox{\hyperlink{classdoris_1_1_decimal_v2_value}{DecimalV2Value}}(}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_decode\_binary\_decimal<Int128>(col\_schema,\ encoded\_max,\ v2\_scale));}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (physical\_type\ ==\ tparquet::Type::INT32)\ \{}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ min\_value\ =\ \mbox{\hyperlink{classdoris_1_1_decimal_v2_value}{DecimalV2Value}}(\_decode\_primitive\_decimal<Int128,\ Int32>(}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ col\_schema,\ encoded\_min,\ v2\_scale));}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ max\_value\ =\ \mbox{\hyperlink{classdoris_1_1_decimal_v2_value}{DecimalV2Value}}(\_decode\_primitive\_decimal<Int128,\ Int32>(}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ col\_schema,\ encoded\_max,\ v2\_scale));}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (physical\_type\ ==\ tparquet::Type::INT64)\ \{}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ min\_value\ =\ \mbox{\hyperlink{classdoris_1_1_decimal_v2_value}{DecimalV2Value}}(\_decode\_primitive\_decimal<Int128,\ Int64>(}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ col\_schema,\ encoded\_min,\ v2\_scale));}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ max\_value\ =\ \mbox{\hyperlink{classdoris_1_1_decimal_v2_value}{DecimalV2Value}}(\_decode\_primitive\_decimal<Int128,\ Int64>(}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ col\_schema,\ encoded\_max,\ v2\_scale));}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{namespacedoris_a240c1924416689e5700ff0d9f30539d9a449da3c1bac18ee97fa7c922330f1cc2}{TYPE\_DECIMAL32}}:}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ \ \ \ \ [[fallthrough]];}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{namespacedoris_a240c1924416689e5700ff0d9f30539d9a530c228ef71cfba79bae20817da7c364}{TYPE\_DECIMAL64}}:}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ \ \ \ \ [[fallthrough]];}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{namespacedoris_a240c1924416689e5700ff0d9f30539d9ab1b6cc074010fcf6eddb346ffe994e8a}{TYPE\_DECIMAL128I}}:}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<CppType,\ int32\_t>\ ||\ std::is\_same\_v<CppType,\ int64\_t>\ ||}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::is\_same\_v<CppType,\ \_\_int128\_t>)\ \{}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ max\_precision\ =\ max\_decimal\_precision<Decimal<CppType>>();}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (col\_schema-\/>\mbox{\hyperlink{structdoris_1_1vectorized_1_1_field_schema_a9275f01bc1c1d145c1bd6cb0205cf891}{parquet\_schema}}.precision\ <\ 1\ ||}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ col\_schema-\/>\mbox{\hyperlink{structdoris_1_1vectorized_1_1_field_schema_a9275f01bc1c1d145c1bd6cb0205cf891}{parquet\_schema}}.precision\ >\ max\_precision\ ||}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ col\_schema-\/>\mbox{\hyperlink{structdoris_1_1vectorized_1_1_field_schema_a9275f01bc1c1d145c1bd6cb0205cf891}{parquet\_schema}}.scale\ >\ max\_precision)\ \{}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00196\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (physical\_type\ ==\ tparquet::Type::FIXED\_LEN\_BYTE\_ARRAY)\ \{}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ min\_value\ =\ \_decode\_binary\_decimal<CppType>(col\_schema,\ encoded\_min,}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ predicate.\mbox{\hyperlink{structdoris_1_1vectorized_1_1_parquet_predicate_1_1_scan_predicate_a418e7934b5363ecde8269070181b3cef}{scale}});}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ max\_value\ =\ \_decode\_binary\_decimal<CppType>(col\_schema,\ encoded\_max,}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ predicate.\mbox{\hyperlink{structdoris_1_1vectorized_1_1_parquet_predicate_1_1_scan_predicate_a418e7934b5363ecde8269070181b3cef}{scale}});}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (physical\_type\ ==\ tparquet::Type::INT32)\ \{}
\DoxyCodeLine{00203\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ min\_value\ =\ \_decode\_primitive\_decimal<CppType,\ Int32>(col\_schema,\ encoded\_min,}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ predicate.\mbox{\hyperlink{structdoris_1_1vectorized_1_1_parquet_predicate_1_1_scan_predicate_a418e7934b5363ecde8269070181b3cef}{scale}});}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ max\_value\ =\ \_decode\_primitive\_decimal<CppType,\ Int32>(col\_schema,\ encoded\_max,}
\DoxyCodeLine{00206\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ predicate.\mbox{\hyperlink{structdoris_1_1vectorized_1_1_parquet_predicate_1_1_scan_predicate_a418e7934b5363ecde8269070181b3cef}{scale}});}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (physical\_type\ ==\ tparquet::Type::INT64)\ \{}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ min\_value\ =\ \_decode\_primitive\_decimal<CppType,\ Int64>(col\_schema,\ encoded\_min,}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ predicate.\mbox{\hyperlink{structdoris_1_1vectorized_1_1_parquet_predicate_1_1_scan_predicate_a418e7934b5363ecde8269070181b3cef}{scale}});}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ max\_value\ =\ \_decode\_primitive\_decimal<CppType,\ Int64>(col\_schema,\ encoded\_max,}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ predicate.\mbox{\hyperlink{structdoris_1_1vectorized_1_1_parquet_predicate_1_1_scan_predicate_a418e7934b5363ecde8269070181b3cef}{scale}});}
\DoxyCodeLine{00212\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00213\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00216\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00218\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00219\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{namespacedoris_a240c1924416689e5700ff0d9f30539d9abee4b8bf9a35792598bc9f3e286341e9}{TYPE\_DATE}}:}
\DoxyCodeLine{00220\ \ \ \ \ \ \ \ \ \ \ \ \ [[fallthrough]];}
\DoxyCodeLine{00221\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{namespacedoris_a240c1924416689e5700ff0d9f30539d9a97540e5c2c2392e65583859cfc00190a}{TYPE\_DATEV2}}:}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (physical\_type\ ==\ tparquet::Type::INT32)\ \{}
\DoxyCodeLine{00223\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ int64\_t\ min\_date\_value\ =}
\DoxyCodeLine{00224\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}int64\_t\textcolor{keyword}{>}(*\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }int32\_t*\textcolor{keyword}{>}(encoded\_min.data()));}
\DoxyCodeLine{00225\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ int64\_t\ max\_date\_value\ =}
\DoxyCodeLine{00226\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}int64\_t\textcolor{keyword}{>}(*\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }int32\_t*\textcolor{keyword}{>}(encoded\_max.data()));}
\DoxyCodeLine{00227\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<CppType,\ VecDateTimeValue>\ ||}
\DoxyCodeLine{00228\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::is\_same\_v<CppType,\ DateV2Value<DateV2ValueType>>)\ \{}
\DoxyCodeLine{00229\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ min\_value.from\_unixtime(min\_date\_value\ *\ 24\ *\ 60\ *\ 60,\ ctz);}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ max\_value.from\_unixtime(max\_date\_value\ *\ 24\ *\ 60\ *\ 60,\ ctz);}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{namespacedoris_a240c1924416689e5700ff0d9f30539d9a1f4a72362c30b890547f3fdc2f85a506}{TYPE\_DATETIME}}:}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ \ \ \ \ [[fallthrough]];}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{namespacedoris_a240c1924416689e5700ff0d9f30539d9a2fcff03f0d42e4cd86dcbefb1fba38bd}{TYPE\_DATETIMEV2}}:}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (physical\_type\ ==\ tparquet::Type::INT96)\ \{}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structdoris_1_1vectorized_1_1_parquet_int96}{ParquetInt96}}\ datetime96\_min\ =}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\mbox{\hyperlink{structdoris_1_1vectorized_1_1_parquet_int96}{ParquetInt96}}*\textcolor{keyword}{>}(encoded\_min.data());}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ int64\_t\ micros\_min\ =\ datetime96\_min.\mbox{\hyperlink{structdoris_1_1vectorized_1_1_parquet_int96_a4d57bace05617ae39f683100c0bd39aa}{to\_timestamp\_micros}}();}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structdoris_1_1vectorized_1_1_parquet_int96}{ParquetInt96}}\ datetime96\_max\ =}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\mbox{\hyperlink{structdoris_1_1vectorized_1_1_parquet_int96}{ParquetInt96}}*\textcolor{keyword}{>}(encoded\_max.data());}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ int64\_t\ micros\_max\ =\ datetime96\_max.\mbox{\hyperlink{structdoris_1_1vectorized_1_1_parquet_int96_a4d57bace05617ae39f683100c0bd39aa}{to\_timestamp\_micros}}();}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<CppType,\ VecDateTimeValue>\ ||}
\DoxyCodeLine{00249\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::is\_same\_v<CppType,\ DateV2Value<DateTimeV2ValueType>>)\ \{}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ min\_value.from\_unixtime(micros\_min\ /\ 1000000,\ ctz);}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ max\_value.from\_unixtime(micros\_max\ /\ 1000000,\ ctz);}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<CppType,\ DateV2Value<DateTimeV2ValueType>>)\ \{}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ min\_value.set\_microsecond(micros\_min\ \%\ 1000000);}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ max\_value.set\_microsecond(micros\_max\ \%\ 1000000);}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00256\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00258\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00259\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (physical\_type\ ==\ tparquet::Type::INT64)\ \{}
\DoxyCodeLine{00260\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ int64\_t\ date\_value\_min\ =\ *\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }int64\_t*\textcolor{keyword}{>}(encoded\_min.data());}
\DoxyCodeLine{00261\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ int64\_t\ date\_value\_max\ =\ *\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }int64\_t*\textcolor{keyword}{>}(encoded\_max.data());}
\DoxyCodeLine{00262\ }
\DoxyCodeLine{00263\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ int64\_t\ second\_mask\ =\ 1;}
\DoxyCodeLine{00264\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ int64\_t\ scale\_to\_nano\_factor\ =\ 1;}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cctz::time\_zone\ resolved\_ctz\ =\ ctz;}
\DoxyCodeLine{00266\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ schema\ =\ col\_schema-\/>\mbox{\hyperlink{structdoris_1_1vectorized_1_1_field_schema_a9275f01bc1c1d145c1bd6cb0205cf891}{parquet\_schema}};}
\DoxyCodeLine{00267\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (schema.\_\_isset.logicalType\ \&\&\ schema.logicalType.\_\_isset.TIMESTAMP)\ \{}
\DoxyCodeLine{00268\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ timestamp\_info\ =\ schema.logicalType.TIMESTAMP;}
\DoxyCodeLine{00269\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!timestamp\_info.isAdjustedToUTC)\ \{}
\DoxyCodeLine{00270\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ should\ set\ timezone\ to\ utc+0}}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ resolved\_ctz\ =\ cctz::utc\_time\_zone();}
\DoxyCodeLine{00272\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00273\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ time\_unit\ =\ timestamp\_info.unit;}
\DoxyCodeLine{00274\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (time\_unit.\_\_isset.MILLIS)\ \{}
\DoxyCodeLine{00275\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ second\_mask\ =\ 1000;}
\DoxyCodeLine{00276\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ scale\_to\_nano\_factor\ =\ 1000000;}
\DoxyCodeLine{00277\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (time\_unit.\_\_isset.MICROS)\ \{}
\DoxyCodeLine{00278\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ second\_mask\ =\ 1000000;}
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ scale\_to\_nano\_factor\ =\ 1000;}
\DoxyCodeLine{00280\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (time\_unit.\_\_isset.NANOS)\ \{}
\DoxyCodeLine{00281\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ second\_mask\ =\ 1000000000;}
\DoxyCodeLine{00282\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ scale\_to\_nano\_factor\ =\ 1;}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (schema.\_\_isset.converted\_type)\ \{}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ converted\_type\ =\ schema.converted\_type;}
\DoxyCodeLine{00286\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (converted\_type\ ==\ tparquet::ConvertedType::TIMESTAMP\_MILLIS)\ \{}
\DoxyCodeLine{00287\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ second\_mask\ =\ 1000;}
\DoxyCodeLine{00288\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ scale\_to\_nano\_factor\ =\ 1000000;}
\DoxyCodeLine{00289\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (converted\_type\ ==\ tparquet::ConvertedType::TIMESTAMP\_MICROS)\ \{}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ second\_mask\ =\ 1000000;}
\DoxyCodeLine{00291\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ scale\_to\_nano\_factor\ =\ 1000;}
\DoxyCodeLine{00292\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00293\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00294\ }
\DoxyCodeLine{00295\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<CppType,\ VecDateTimeValue>\ ||}
\DoxyCodeLine{00296\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::is\_same\_v<CppType,\ DateV2Value<DateTimeV2ValueType>>)\ \{}
\DoxyCodeLine{00297\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ min\_value.from\_unixtime(date\_value\_min\ /\ second\_mask,\ resolved\_ctz);}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ max\_value.from\_unixtime(date\_value\_max\ /\ second\_mask,\ resolved\_ctz);}
\DoxyCodeLine{00299\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<CppType,\ DateV2Value<DateTimeV2ValueType>>)\ \{}
\DoxyCodeLine{00300\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ min\_value.set\_microsecond((date\_value\_min\ \%\ second\_mask)\ *}
\DoxyCodeLine{00301\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ scale\_to\_nano\_factor\ /\ 1000);}
\DoxyCodeLine{00302\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ max\_value.set\_microsecond((date\_value\_max\ \%\ second\_mask)\ *}
\DoxyCodeLine{00303\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ scale\_to\_nano\_factor\ /\ 1000);}
\DoxyCodeLine{00304\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00305\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00306\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00307\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00308\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00309\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00310\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00311\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00312\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00313\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00314\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00315\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_parquet_predicate_a4eb96e7df0971ba627fffa197bec66e5}{\_filter\_by\_min\_max}}(predicate.\mbox{\hyperlink{structdoris_1_1vectorized_1_1_parquet_predicate_1_1_scan_predicate_afde7117e56a1e82a4ff9ad2ed3286840}{op}},\ predicate\_values,\ min\_value,\ max\_value);}
\DoxyCodeLine{00316\ \ \ \ \ \}}
\DoxyCodeLine{00317\ }
\DoxyCodeLine{00318\ \ \ \ \ \textcolor{keyword}{template}\ <PrimitiveType\ primitive\_type>}
\DoxyCodeLine{00319\ \ \ \ \ \textcolor{keyword}{static}\ std::vector<ScanPredicate>\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_parquet_predicate_a8cbc64958ae98c9d10f47dbf21ab59bd}{\_value\_range\_to\_predicate}}(}
\DoxyCodeLine{00320\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdoris_1_1_column_value_range}{ColumnValueRange<primitive\_type>}}\&\ col\_val\_range)\ \{}
\DoxyCodeLine{00321\ \ \ \ \ \ \ \ \ \textcolor{keyword}{using\ }CppType\ =\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{structdoris_1_1_primitive_type_traits}{PrimitiveTypeTraits<primitive\_type>::CppType}};}
\DoxyCodeLine{00322\ \ \ \ \ \ \ \ \ std::vector<ScanPredicate>\ predicates;}
\DoxyCodeLine{00323\ }
\DoxyCodeLine{00324\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (col\_val\_range.\mbox{\hyperlink{classdoris_1_1_column_value_range_ab5f4f3a81c5d7a9c3da4a45ab19ccfbf}{is\_fixed\_value\_range}}())\ \{}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structdoris_1_1vectorized_1_1_parquet_predicate_1_1_scan_predicate}{ScanPredicate}}\ in\_predicate;}
\DoxyCodeLine{00326\ \ \ \ \ \ \ \ \ \ \ \ \ in\_predicate.\mbox{\hyperlink{structdoris_1_1vectorized_1_1_parquet_predicate_1_1_scan_predicate_afde7117e56a1e82a4ff9ad2ed3286840}{op}}\ =\ \mbox{\hyperlink{namespacedoris_acea2ffc3003c9e3f12465e6ed8864c06ab9cc2312a6994c15deacb5df862af267}{SQLFilterOp::FILTER\_IN}};}
\DoxyCodeLine{00327\ \ \ \ \ \ \ \ \ \ \ \ \ in\_predicate.\mbox{\hyperlink{structdoris_1_1vectorized_1_1_parquet_predicate_1_1_scan_predicate_a418e7934b5363ecde8269070181b3cef}{scale}}\ =\ col\_val\_range.\mbox{\hyperlink{classdoris_1_1_column_value_range_a9c0c3d4d52bf7ca84b377d167c7929dd}{scale}}();}
\DoxyCodeLine{00328\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ \mbox{\hyperlink{util_2types_8h_adae7202c63102b0934c3ac5be41b0dae}{value}}\ :\ col\_val\_range.\mbox{\hyperlink{classdoris_1_1_column_value_range_aad053bd6d3f7b18d48024197ef8b1fe9}{get\_fixed\_value\_set}}())\ \{}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ in\_predicate.\mbox{\hyperlink{structdoris_1_1vectorized_1_1_parquet_predicate_1_1_scan_predicate_ab1430cd872e93a6c4e27a1284dad1ff8}{values}}.emplace\_back(\&\mbox{\hyperlink{util_2types_8h_adae7202c63102b0934c3ac5be41b0dae}{value}});}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00331\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!in\_predicate.\mbox{\hyperlink{structdoris_1_1vectorized_1_1_parquet_predicate_1_1_scan_predicate_ab1430cd872e93a6c4e27a1284dad1ff8}{values}}.empty())\ \{}
\DoxyCodeLine{00332\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ predicates.emplace\_back(in\_predicate);}
\DoxyCodeLine{00333\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00334\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ predicates;}
\DoxyCodeLine{00335\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00336\ }
\DoxyCodeLine{00337\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ CppType\ high\_value\ =\ col\_val\_range.\mbox{\hyperlink{classdoris_1_1_column_value_range_aa842622b97e4c0ed3dbf2680e4821ace}{get\_range\_max\_value}}();}
\DoxyCodeLine{00338\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ CppType\ low\_value\ =\ col\_val\_range.\mbox{\hyperlink{classdoris_1_1_column_value_range_aa23d851ddd1a9175a82783ab32b2042a}{get\_range\_min\_value}}();}
\DoxyCodeLine{00339\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespacedoris_acea2ffc3003c9e3f12465e6ed8864c06}{SQLFilterOp}}\ high\_op\ =\ col\_val\_range.\mbox{\hyperlink{classdoris_1_1_column_value_range_a63847f181b3e64d48b166e93c4832eb5}{get\_range\_high\_op}}();}
\DoxyCodeLine{00340\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespacedoris_acea2ffc3003c9e3f12465e6ed8864c06}{SQLFilterOp}}\ low\_op\ =\ col\_val\_range.\mbox{\hyperlink{classdoris_1_1_column_value_range_aaa417e134fc5bb442956b2174a34e037}{get\_range\_low\_op}}();}
\DoxyCodeLine{00341\ }
\DoxyCodeLine{00342\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ orc\ can\ only\ push\ down\ is\_null.\ When\ col\_value\_range.\_contain\_null\ =\ true,\ only\ indicating\ that}}
\DoxyCodeLine{00343\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ value\ can\ be\ null,\ not\ equals\ null,\ so\ ignore\ \_contain\_null\ in\ col\_value\_range}}
\DoxyCodeLine{00344\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (col\_val\_range.\mbox{\hyperlink{classdoris_1_1_column_value_range_aa944e9d26da15be82ec32fb6726bc5c6}{is\_high\_value\_maximum}}()\ \&\&\ high\_op\ ==\ \mbox{\hyperlink{namespacedoris_acea2ffc3003c9e3f12465e6ed8864c06a7ef8c41f015cc6269cb62da4515b7417}{SQLFilterOp::FILTER\_LESS\_OR\_EQUAL}}\ \&\&}
\DoxyCodeLine{00345\ \ \ \ \ \ \ \ \ \ \ \ \ col\_val\_range.\mbox{\hyperlink{classdoris_1_1_column_value_range_a249e15c1779b9d29d0d4dc203013e2f6}{is\_low\_value\_mininum}}()\ \&\&\ low\_op\ ==\ \mbox{\hyperlink{namespacedoris_acea2ffc3003c9e3f12465e6ed8864c06ae52525db3f5063810fdbcacc602370ec}{SQLFilterOp::FILTER\_LARGER\_OR\_EQUAL}})\ \{}
\DoxyCodeLine{00346\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ predicates;}
\DoxyCodeLine{00347\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00348\ }
\DoxyCodeLine{00349\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (low\_value\ <\ high\_value)\ \{}
\DoxyCodeLine{00350\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!col\_val\_range.\mbox{\hyperlink{classdoris_1_1_column_value_range_a249e15c1779b9d29d0d4dc203013e2f6}{is\_low\_value\_mininum}}()\ ||}
\DoxyCodeLine{00351\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedoris_acea2ffc3003c9e3f12465e6ed8864c06ae52525db3f5063810fdbcacc602370ec}{SQLFilterOp::FILTER\_LARGER\_OR\_EQUAL}}\ !=\ low\_op)\ \{}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structdoris_1_1vectorized_1_1_parquet_predicate_1_1_scan_predicate}{ScanPredicate}}\ low\_predicate;}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ low\_predicate.\mbox{\hyperlink{structdoris_1_1vectorized_1_1_parquet_predicate_1_1_scan_predicate_a418e7934b5363ecde8269070181b3cef}{scale}}\ =\ col\_val\_range.\mbox{\hyperlink{classdoris_1_1_column_value_range_a9c0c3d4d52bf7ca84b377d167c7929dd}{scale}}();}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ low\_predicate.\mbox{\hyperlink{structdoris_1_1vectorized_1_1_parquet_predicate_1_1_scan_predicate_afde7117e56a1e82a4ff9ad2ed3286840}{op}}\ =\ low\_op;}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ low\_predicate.\mbox{\hyperlink{structdoris_1_1vectorized_1_1_parquet_predicate_1_1_scan_predicate_ab1430cd872e93a6c4e27a1284dad1ff8}{values}}.emplace\_back(col\_val\_range.\mbox{\hyperlink{classdoris_1_1_column_value_range_a1332cea5706d59e9aa7fed39eeb2e10e}{get\_range\_min\_value\_ptr}}());}
\DoxyCodeLine{00356\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ predicates.emplace\_back(low\_predicate);}
\DoxyCodeLine{00357\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00358\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!col\_val\_range.\mbox{\hyperlink{classdoris_1_1_column_value_range_aa944e9d26da15be82ec32fb6726bc5c6}{is\_high\_value\_maximum}}()\ ||}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedoris_acea2ffc3003c9e3f12465e6ed8864c06a7ef8c41f015cc6269cb62da4515b7417}{SQLFilterOp::FILTER\_LESS\_OR\_EQUAL}}\ !=\ high\_op)\ \{}
\DoxyCodeLine{00360\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structdoris_1_1vectorized_1_1_parquet_predicate_1_1_scan_predicate}{ScanPredicate}}\ high\_predicate;}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ high\_predicate.\mbox{\hyperlink{structdoris_1_1vectorized_1_1_parquet_predicate_1_1_scan_predicate_a418e7934b5363ecde8269070181b3cef}{scale}}\ =\ col\_val\_range.\mbox{\hyperlink{classdoris_1_1_column_value_range_a9c0c3d4d52bf7ca84b377d167c7929dd}{scale}}();}
\DoxyCodeLine{00362\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ high\_predicate.\mbox{\hyperlink{structdoris_1_1vectorized_1_1_parquet_predicate_1_1_scan_predicate_afde7117e56a1e82a4ff9ad2ed3286840}{op}}\ =\ high\_op;}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ high\_predicate.\mbox{\hyperlink{structdoris_1_1vectorized_1_1_parquet_predicate_1_1_scan_predicate_ab1430cd872e93a6c4e27a1284dad1ff8}{values}}.emplace\_back(col\_val\_range.\mbox{\hyperlink{classdoris_1_1_column_value_range_a652f9598349d616e89674c25dad77c34}{get\_range\_max\_value\_ptr}}());}
\DoxyCodeLine{00364\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ predicates.emplace\_back(high\_predicate);}
\DoxyCodeLine{00365\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00366\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00367\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ predicates;}
\DoxyCodeLine{00368\ \ \ \ \ \}}
\DoxyCodeLine{00369\ }
\DoxyCodeLine{00370\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00371\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_parquet_predicate_aa49390585d2f23a205f2ef7639c5ecce}{filter\_by\_min\_max}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespacedoris_a9f9a89210e8050f18684d17d9a9e5c49}{ColumnValueRangeType}}\&\ col\_val\_range,}
\DoxyCodeLine{00372\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structdoris_1_1vectorized_1_1_field_schema}{FieldSchema}}*\ col\_schema,\ \textcolor{keyword}{const}\ std::string\&\ encoded\_min,}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ encoded\_max,\ \textcolor{keyword}{const}\ cctz::time\_zone\&\ ctz)\ \{}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ need\_filter\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \ \ std::visit(}
\DoxyCodeLine{00376\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\&](\textcolor{keyword}{auto}\&\&\ range)\ \{}
\DoxyCodeLine{00377\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<ScanPredicate>\ filters\ =\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_parquet_predicate_a8cbc64958ae98c9d10f47dbf21ab59bd}{\_value\_range\_to\_predicate}}(range);}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ filter\ :\ filters)\ \{}
\DoxyCodeLine{00379\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ need\_filter\ |=\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_parquet_predicate_a4eb96e7df0971ba627fffa197bec66e5}{\_filter\_by\_min\_max}}(range,\ filter,\ col\_schema,\ encoded\_min,}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ encoded\_max,\ ctz);}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (need\_filter)\ \{}
\DoxyCodeLine{00382\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00384\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \},}
\DoxyCodeLine{00386\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ col\_val\_range);}
\DoxyCodeLine{00387\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ need\_filter;}
\DoxyCodeLine{00388\ \ \ \ \ \}}
\DoxyCodeLine{00389\ \};}
\DoxyCodeLine{00390\ }
\DoxyCodeLine{00391\ \}\ \textcolor{comment}{//\ namespace\ doris::vectorized}}

\end{DoxyCode}
