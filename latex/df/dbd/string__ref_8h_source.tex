\hypertarget{string__ref_8h_source}{}\doxysection{string\+\_\+ref.\+h}
\label{string__ref_8h_source}\index{/Users/dabowang/be\_all/vec/common/string\_ref.h@{/Users/dabowang/be\_all/vec/common/string\_ref.h}}
\mbox{\hyperlink{string__ref_8h}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Licensed\ to\ the\ Apache\ Software\ Foundation\ (ASF)\ under\ one}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ or\ more\ contributor\ license\ agreements.\ \ See\ the\ NOTICE\ file}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ distributed\ with\ this\ work\ for\ additional\ information}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ regarding\ copyright\ ownership.\ \ The\ ASF\ licenses\ this\ file}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ to\ you\ under\ the\ Apache\ License,\ Version\ 2.0\ (the}}
\DoxyCodeLine{00006\ \textcolor{comment}{//\ "{}License"{});\ you\ may\ not\ use\ this\ file\ except\ in\ compliance}}
\DoxyCodeLine{00007\ \textcolor{comment}{//\ with\ the\ License.\ \ You\ may\ obtain\ a\ copy\ of\ the\ License\ at}}
\DoxyCodeLine{00008\ \textcolor{comment}{//}}
\DoxyCodeLine{00009\ \textcolor{comment}{//\ \ \ http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{00010\ \textcolor{comment}{//}}
\DoxyCodeLine{00011\ \textcolor{comment}{//\ Unless\ required\ by\ applicable\ law\ or\ agreed\ to\ in\ writing,}}
\DoxyCodeLine{00012\ \textcolor{comment}{//\ software\ distributed\ under\ the\ License\ is\ distributed\ on\ an}}
\DoxyCodeLine{00013\ \textcolor{comment}{//\ "{}AS\ IS"{}\ BASIS,\ WITHOUT\ WARRANTIES\ OR\ CONDITIONS\ OF\ ANY}}
\DoxyCodeLine{00014\ \textcolor{comment}{//\ KIND,\ either\ express\ or\ implied.\ \ See\ the\ License\ for\ the}}
\DoxyCodeLine{00015\ \textcolor{comment}{//\ specific\ language\ governing\ permissions\ and\ limitations}}
\DoxyCodeLine{00016\ \textcolor{comment}{//\ under\ the\ License.}}
\DoxyCodeLine{00017\ \textcolor{comment}{//\ This\ file\ is\ copied\ from}}
\DoxyCodeLine{00018\ \textcolor{comment}{//\ https://github.com/ClickHouse/ClickHouse/blob/master/base/base/StringRef.h}}
\DoxyCodeLine{00019\ \textcolor{comment}{//\ and\ modified\ by\ Doris}}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ <climits>}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ <functional>}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ <ostream>}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#include\ <string>}}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#include\ <string\_view>}}
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{gutil_2hash_2city_8h}{gutil/hash/city.h}}"{}}}
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{hash128to64_8h}{gutil/hash/hash128to64.h}}"{}}}
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{udf_8h}{udf/udf.h}}"{}}}
\DoxyCodeLine{00033\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{cpu__info_8h}{util/cpu\_info.h}}"{}}}
\DoxyCodeLine{00034\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{hash__util_8hpp}{util/hash\_util.hpp}}"{}}}
\DoxyCodeLine{00035\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{slice_8h}{util/slice.h}}"{}}}
\DoxyCodeLine{00036\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{string__ref_8h}{vec/common/string\_ref.h}}"{}}}
\DoxyCodeLine{00037\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{unaligned_8h}{vec/common/unaligned.h}}"{}}}
\DoxyCodeLine{00038\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{vec_2core_2types_8h}{vec/core/types.h}}"{}}}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00040\ \textcolor{preprocessor}{\#if\ defined(\_\_SSE2\_\_)}}
\DoxyCodeLine{00041\ \textcolor{preprocessor}{\#include\ <emmintrin.h>}}
\DoxyCodeLine{00042\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ \textcolor{preprocessor}{\#if\ defined(\_\_SSE4\_2\_\_)}}
\DoxyCodeLine{00045\ \textcolor{preprocessor}{\#include\ <nmmintrin.h>}}
\DoxyCodeLine{00046\ \textcolor{preprocessor}{\#include\ <smmintrin.h>}}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{sse__util_8hpp}{util/sse\_util.hpp}}"{}}}
\DoxyCodeLine{00049\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ \textcolor{preprocessor}{\#if\ defined(\_\_aarch64\_\_)}}
\DoxyCodeLine{00052\ \textcolor{preprocessor}{\#include\ <sse2neon.h>}}
\DoxyCodeLine{00053\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00055\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacedoris}{doris}}\ \{}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00058\ \textcolor{keyword}{namespace\ }\{}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00060\ \textcolor{preprocessor}{\#if\ defined(\_\_SSE2\_\_)\ ||\ defined(\_\_aarch64\_\_)}}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00067\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ compareSSE2(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ p1,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ p2)\ \{}
\DoxyCodeLine{00068\ \ \ \ \ \textcolor{keywordflow}{return}\ 0xFFFF\ ==}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \ \ \ \_mm\_movemask\_epi8(\_mm\_cmpeq\_epi8(\_mm\_loadu\_si128(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\mbox{\hyperlink{memcpy__aarch64_8cpp_ae568b00e462205af997f7d5d84814f70}{\_\_m128i}}*\textcolor{keyword}{>}(p1)),}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_mm\_loadu\_si128(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\mbox{\hyperlink{memcpy__aarch64_8cpp_ae568b00e462205af997f7d5d84814f70}{\_\_m128i}}*\textcolor{keyword}{>}(p2))));}
\DoxyCodeLine{00071\ \}}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ compareSSE2x4(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ p1,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ p2)\ \{}
\DoxyCodeLine{00074\ \ \ \ \ \textcolor{keywordflow}{return}\ 0xFFFF\ ==}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \ \ \ \_mm\_movemask\_epi8(\_mm\_and\_si128(}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_mm\_and\_si128(}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_mm\_cmpeq\_epi8(\_mm\_loadu\_si128(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\mbox{\hyperlink{memcpy__aarch64_8cpp_ae568b00e462205af997f7d5d84814f70}{\_\_m128i}}*\textcolor{keyword}{>}(p1)),}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_mm\_loadu\_si128(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\mbox{\hyperlink{memcpy__aarch64_8cpp_ae568b00e462205af997f7d5d84814f70}{\_\_m128i}}*\textcolor{keyword}{>}(p2))),}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_mm\_cmpeq\_epi8(}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_mm\_loadu\_si128(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\mbox{\hyperlink{memcpy__aarch64_8cpp_ae568b00e462205af997f7d5d84814f70}{\_\_m128i}}*\textcolor{keyword}{>}(p1)\ +\ 1),}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_mm\_loadu\_si128(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\mbox{\hyperlink{memcpy__aarch64_8cpp_ae568b00e462205af997f7d5d84814f70}{\_\_m128i}}*\textcolor{keyword}{>}(p2)\ +\ 1))),}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_mm\_and\_si128(}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_mm\_cmpeq\_epi8(}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_mm\_loadu\_si128(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\mbox{\hyperlink{memcpy__aarch64_8cpp_ae568b00e462205af997f7d5d84814f70}{\_\_m128i}}*\textcolor{keyword}{>}(p1)\ +\ 2),}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_mm\_loadu\_si128(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\mbox{\hyperlink{memcpy__aarch64_8cpp_ae568b00e462205af997f7d5d84814f70}{\_\_m128i}}*\textcolor{keyword}{>}(p2)\ +\ 2)),}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_mm\_cmpeq\_epi8(}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_mm\_loadu\_si128(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\mbox{\hyperlink{memcpy__aarch64_8cpp_ae568b00e462205af997f7d5d84814f70}{\_\_m128i}}*\textcolor{keyword}{>}(p1)\ +\ 3),}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_mm\_loadu\_si128(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\mbox{\hyperlink{memcpy__aarch64_8cpp_ae568b00e462205af997f7d5d84814f70}{\_\_m128i}}*\textcolor{keyword}{>}(p2)\ +\ 3)))));}
\DoxyCodeLine{00089\ \}}
\DoxyCodeLine{00090\ }
\DoxyCodeLine{00091\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ memequalSSE2Wide(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ p1,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ p2,\ \textcolor{keywordtype}{size\_t}\ size)\ \{}
\DoxyCodeLine{00098\ \ \ \ \ \textcolor{keywordflow}{if}\ (size\ <=\ 16)\ \{}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (size\ >=\ 8)\ \{}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ unaligned\_load<uint64\_t>(p1)\ ==\ unaligned\_load<uint64\_t>(p2)\ \&\&}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ unaligned\_load<uint64\_t>(p1\ +\ size\ -\/\ 8)\ ==}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ unaligned\_load<uint64\_t>(p2\ +\ size\ -\/\ 8);}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (size\ >=\ 4)\ \{}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ unaligned\_load<uint32\_t>(p1)\ ==\ unaligned\_load<uint32\_t>(p2)\ \&\&}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ unaligned\_load<uint32\_t>(p1\ +\ size\ -\/\ 4)\ ==}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ unaligned\_load<uint32\_t>(p2\ +\ size\ -\/\ 4);}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (size\ >=\ 2)\ \{}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ unaligned\_load<uint16\_t>(p1)\ ==\ unaligned\_load<uint16\_t>(p2)\ \&\&}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ unaligned\_load<uint16\_t>(p1\ +\ size\ -\/\ 2)\ ==}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ unaligned\_load<uint16\_t>(p2\ +\ size\ -\/\ 2);}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (size\ >=\ 1)\ \{}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *p1\ ==\ *p2;}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00119\ \ \ \ \ \}}
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00121\ \ \ \ \ \textcolor{keywordflow}{while}\ (size\ >=\ 64)\ \{}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (compareSSE2x4(p1,\ p2))\ \{}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ +=\ 64;}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \ \ \ \ p2\ +=\ 64;}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \ \ \ \ size\ -\/=\ 64;}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00129\ \ \ \ \ \}}
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00131\ \ \ \ \ \textcolor{keywordflow}{switch}\ (size\ /\ 16)\ \{}
\DoxyCodeLine{00132\ \ \ \ \ \textcolor{keywordflow}{case}\ 3:}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!compareSSE2(p1\ +\ 32,\ p2\ +\ 32))\ \{}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ [[fallthrough]];}
\DoxyCodeLine{00137\ \ \ \ \ \textcolor{keywordflow}{case}\ 2:}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!compareSSE2(p1\ +\ 16,\ p2\ +\ 16))\ \{}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ [[fallthrough]];}
\DoxyCodeLine{00142\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!compareSSE2(p1,\ p2))\ \{}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00146\ \ \ \ \ \}}
\DoxyCodeLine{00147\ }
\DoxyCodeLine{00148\ \ \ \ \ \textcolor{keywordflow}{return}\ compareSSE2(p1\ +\ size\ -\/\ 16,\ p2\ +\ size\ -\/\ 16);}
\DoxyCodeLine{00149\ \}}
\DoxyCodeLine{00150\ }
\DoxyCodeLine{00151\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00152\ }
\DoxyCodeLine{00153\ \textcolor{comment}{//\ Compare\ two\ strings\ using\ sse4.2\ intrinsics\ if\ they\ are\ available.\ This\ code\ assumes}}
\DoxyCodeLine{00154\ \textcolor{comment}{//\ that\ the\ trivial\ cases\ are\ already\ handled\ (i.e.\ one\ string\ is\ empty).}}
\DoxyCodeLine{00155\ \textcolor{comment}{//\ Returns:}}
\DoxyCodeLine{00156\ \textcolor{comment}{//\ \ \ <\ 0\ if\ s1\ <\ s2}}
\DoxyCodeLine{00157\ \textcolor{comment}{//\ \ \ 0\ if\ s1\ ==\ s2}}
\DoxyCodeLine{00158\ \textcolor{comment}{//\ \ \ >\ 0\ if\ s1\ >\ s2}}
\DoxyCodeLine{00159\ \textcolor{comment}{//\ The\ SSE\ code\ path\ is\ just\ under\ 2x\ faster\ than\ the\ non-\/sse\ code\ path.}}
\DoxyCodeLine{00160\ \textcolor{comment}{//\ \ \ -\/\ s1/n1:\ ptr/len\ for\ the\ first\ string}}
\DoxyCodeLine{00161\ \textcolor{comment}{//\ \ \ -\/\ s2/n2:\ ptr/len\ for\ the\ second\ string}}
\DoxyCodeLine{00162\ \textcolor{comment}{//\ \ \ -\/\ len:\ min(n1,\ n2)\ -\/\ this\ can\ be\ more\ cheaply\ passed\ in\ by\ the\ caller}}
\DoxyCodeLine{00163\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{int}\ string\_compare(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \mbox{\hyperlink{lgamma_8c_a1ff9ee3251659529629e761b307fada6}{s1}},\ int64\_t\ n1,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \mbox{\hyperlink{lgamma_8c_a6f99aff13f96e26313f4fdfb4fbe5b1d}{s2}},\ int64\_t\ n2,\ int64\_t\ len)\ \{}
\DoxyCodeLine{00164\ \ \ \ \ DCHECK\_EQ(len,\ std::min(n1,\ n2));}
\DoxyCodeLine{00165\ \textcolor{preprocessor}{\#ifdef\ \_\_SSE4\_2\_\_}}
\DoxyCodeLine{00166\ \ \ \ \ \textcolor{keywordflow}{while}\ (len\ >=\ \mbox{\hyperlink{namespacedoris_1_1sse__util_a3d634f65addf5411b1f1668b0396e835}{sse\_util::CHARS\_PER\_128\_BIT\_REGISTER}})\ \{}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{memcpy__aarch64_8cpp_ae568b00e462205af997f7d5d84814f70}{\_\_m128i}}\ xmm0\ =\ \_mm\_loadu\_si128(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\mbox{\hyperlink{memcpy__aarch64_8cpp_ae568b00e462205af997f7d5d84814f70}{\_\_m128i}}*\textcolor{keyword}{>}(\mbox{\hyperlink{lgamma_8c_a1ff9ee3251659529629e761b307fada6}{s1}}));}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{memcpy__aarch64_8cpp_ae568b00e462205af997f7d5d84814f70}{\_\_m128i}}\ xmm1\ =\ \_mm\_loadu\_si128(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\mbox{\hyperlink{memcpy__aarch64_8cpp_ae568b00e462205af997f7d5d84814f70}{\_\_m128i}}*\textcolor{keyword}{>}(\mbox{\hyperlink{lgamma_8c_a6f99aff13f96e26313f4fdfb4fbe5b1d}{s2}}));}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ chars\_match\ =\ \_mm\_cmpestri(xmm0,\ \mbox{\hyperlink{namespacedoris_1_1sse__util_a3d634f65addf5411b1f1668b0396e835}{sse\_util::CHARS\_PER\_128\_BIT\_REGISTER}},\ xmm1,}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedoris_1_1sse__util_a3d634f65addf5411b1f1668b0396e835}{sse\_util::CHARS\_PER\_128\_BIT\_REGISTER}},\ \mbox{\hyperlink{namespacedoris_1_1sse__util_ac3860f44453421574c4802e7f70c2ae7}{sse\_util::STRCMP\_MODE}});}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (chars\_match\ !=\ \mbox{\hyperlink{namespacedoris_1_1sse__util_a3d634f65addf5411b1f1668b0396e835}{sse\_util::CHARS\_PER\_128\_BIT\_REGISTER}})\ \{}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char})\mbox{\hyperlink{lgamma_8c_a1ff9ee3251659529629e761b307fada6}{s1}}[chars\_match]\ -\/\ (\textcolor{keywordtype}{unsigned}\ char)\mbox{\hyperlink{lgamma_8c_a6f99aff13f96e26313f4fdfb4fbe5b1d}{s2}}[chars\_match];}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ len\ -\/=\ \mbox{\hyperlink{namespacedoris_1_1sse__util_a3d634f65addf5411b1f1668b0396e835}{sse\_util::CHARS\_PER\_128\_BIT\_REGISTER}};}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{lgamma_8c_a1ff9ee3251659529629e761b307fada6}{s1}}\ +=\ \mbox{\hyperlink{namespacedoris_1_1sse__util_a3d634f65addf5411b1f1668b0396e835}{sse\_util::CHARS\_PER\_128\_BIT\_REGISTER}};}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{lgamma_8c_a6f99aff13f96e26313f4fdfb4fbe5b1d}{s2}}\ +=\ \mbox{\hyperlink{namespacedoris_1_1sse__util_a3d634f65addf5411b1f1668b0396e835}{sse\_util::CHARS\_PER\_128\_BIT\_REGISTER}};}
\DoxyCodeLine{00177\ \ \ \ \ \}}
\DoxyCodeLine{00178\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00179\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ \mbox{\hyperlink{lgamma_8c_a181b0d478013a93f01f2bc0e90bfe20c}{u1}},\ \mbox{\hyperlink{lgamma_8c_ac15b0b429752550f8a8778cad0ba1698}{u2}};}
\DoxyCodeLine{00180\ \ \ \ \ \textcolor{keywordflow}{while}\ (len-\/-\/\ >\ 0)\ \{}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{lgamma_8c_a181b0d478013a93f01f2bc0e90bfe20c}{u1}}\ =\ (\textcolor{keywordtype}{unsigned}\ char)*\mbox{\hyperlink{lgamma_8c_a1ff9ee3251659529629e761b307fada6}{s1}}++;}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{lgamma_8c_ac15b0b429752550f8a8778cad0ba1698}{u2}}\ =\ (\textcolor{keywordtype}{unsigned}\ char)*\mbox{\hyperlink{lgamma_8c_a6f99aff13f96e26313f4fdfb4fbe5b1d}{s2}}++;}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{lgamma_8c_a181b0d478013a93f01f2bc0e90bfe20c}{u1}}\ !=\ \mbox{\hyperlink{lgamma_8c_ac15b0b429752550f8a8778cad0ba1698}{u2}})\ \{}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{lgamma_8c_a181b0d478013a93f01f2bc0e90bfe20c}{u1}}\ -\/\ \mbox{\hyperlink{lgamma_8c_ac15b0b429752550f8a8778cad0ba1698}{u2}};}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{lgamma_8c_a181b0d478013a93f01f2bc0e90bfe20c}{u1}}\ ==\ \textcolor{charliteral}{'\(\backslash\)0'})\ \{}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ n1\ -\/\ n2;}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00189\ \ \ \ \ \}}
\DoxyCodeLine{00190\ }
\DoxyCodeLine{00191\ \ \ \ \ \textcolor{keywordflow}{return}\ n1\ -\/\ n2;}
\DoxyCodeLine{00192\ \}}
\DoxyCodeLine{00193\ }
\DoxyCodeLine{00194\ \}\ \textcolor{comment}{//\ unnamed\ namespace}}
\DoxyCodeLine{00195\ }
\DoxyCodeLine{00196\ \textcolor{keyword}{using\ namespace\ }\mbox{\hyperlink{namespacedoris__udf}{doris\_udf}};}
\DoxyCodeLine{00200\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structdoris_1_1_string_ref}{StringRef}}\ \{}
\DoxyCodeLine{00201\ \ \ \ \ \textcolor{comment}{//\ TODO:\ opening\ member\ accessing\ really\ damages.}}
\DoxyCodeLine{00202\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \mbox{\hyperlink{structdoris_1_1_string_ref_a8f64897c7ccc5c13f276d1d07c4e7095}{data}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00203\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{structdoris_1_1_string_ref_a854352f53b148adc24983a58a1866d66}{size}}\ =\ 0;}
\DoxyCodeLine{00204\ }
\DoxyCodeLine{00205\ \ \ \ \ \mbox{\hyperlink{structdoris_1_1_string_ref_ac06f8fc1d48f7d20a45f2317daf902a4}{StringRef}}()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00206\ \ \ \ \ \mbox{\hyperlink{structdoris_1_1_string_ref_a86b77ee2b0796d9348bb0c6c88b055d1}{StringRef}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ data\_,\ \textcolor{keywordtype}{size\_t}\ size\_)\ :\ \mbox{\hyperlink{structdoris_1_1_string_ref_a8f64897c7ccc5c13f276d1d07c4e7095}{data}}(data\_),\ \mbox{\hyperlink{structdoris_1_1_string_ref_a854352f53b148adc24983a58a1866d66}{size}}(size\_)\ \{\}}
\DoxyCodeLine{00207\ \ \ \ \ \mbox{\hyperlink{structdoris_1_1_string_ref_af87d464a432c62ff8fae6a6a6fe1c508}{StringRef}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*\ data\_,\ \textcolor{keywordtype}{size\_t}\ size\_)}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{structdoris_1_1_string_ref}{StringRef}}(reinterpret\_cast<const\ char*>(data\_),\ size\_)\ \{\}}
\DoxyCodeLine{00209\ }
\DoxyCodeLine{00210\ \ \ \ \ \mbox{\hyperlink{structdoris_1_1_string_ref_a3759c8aff2891c6af0e632927e79e78d}{StringRef}}(\textcolor{keyword}{const}\ std::string\&\ s)\ :\ \mbox{\hyperlink{structdoris_1_1_string_ref_a8f64897c7ccc5c13f276d1d07c4e7095}{data}}(s.\mbox{\hyperlink{structdoris_1_1_string_ref_a8f64897c7ccc5c13f276d1d07c4e7095}{data}}()),\ \mbox{\hyperlink{structdoris_1_1_string_ref_a854352f53b148adc24983a58a1866d66}{size}}(s.\mbox{\hyperlink{structdoris_1_1_string_ref_a854352f53b148adc24983a58a1866d66}{size}}())\ \{\}}
\DoxyCodeLine{00211\ \ \ \ \ \mbox{\hyperlink{structdoris_1_1_string_ref_a5118d0b2f6af8616e3549588cabeb19f}{StringRef}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structdoris__udf_1_1_string_val}{StringVal}}\&\ src)\ :\ \mbox{\hyperlink{structdoris_1_1_string_ref}{StringRef}}(src.ptr,\ src.len)\ \{\}}
\DoxyCodeLine{00212\ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{structdoris_1_1_string_ref_a3796986683f9c24c80774607d8bd5442}{StringRef}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ str)\ :\ \mbox{\hyperlink{structdoris_1_1_string_ref_a8f64897c7ccc5c13f276d1d07c4e7095}{data}}(str),\ \mbox{\hyperlink{structdoris_1_1_string_ref_a854352f53b148adc24983a58a1866d66}{size}}(strlen(str))\ \{\}}
\DoxyCodeLine{00213\ }
\DoxyCodeLine{00214\ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{structdoris_1_1_string_ref}{StringRef}}\ \mbox{\hyperlink{structdoris_1_1_string_ref_af39e6f390843b934ceac16c91be7eb76}{from\_string\_val}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structdoris__udf_1_1_string_val}{StringVal}}\&\ src)\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structdoris_1_1_string_ref_ac06f8fc1d48f7d20a45f2317daf902a4}{StringRef}}(src);\ \}}
\DoxyCodeLine{00215\ }
\DoxyCodeLine{00216\ \ \ \ \ std::string\ \mbox{\hyperlink{structdoris_1_1_string_ref_aac993ecccd3d88aafefb6b8e3caa1dee}{to\_string}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ std::string(\mbox{\hyperlink{structdoris_1_1_string_ref_a8f64897c7ccc5c13f276d1d07c4e7095}{data}},\ \mbox{\hyperlink{structdoris_1_1_string_ref_a854352f53b148adc24983a58a1866d66}{size}});\ \}}
\DoxyCodeLine{00217\ \ \ \ \ std::string\ \mbox{\hyperlink{structdoris_1_1_string_ref_ae21c3e223fb1aec0439964d01e5e0282}{debug\_string}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structdoris_1_1_string_ref_aac993ecccd3d88aafefb6b8e3caa1dee}{to\_string}}();\ \}}
\DoxyCodeLine{00218\ \ \ \ \ std::string\_view\ \mbox{\hyperlink{structdoris_1_1_string_ref_aa99a7dc6becd9e8587bb3b1e4cae0809}{to\_string\_view}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ std::string\_view(\mbox{\hyperlink{structdoris_1_1_string_ref_a8f64897c7ccc5c13f276d1d07c4e7095}{data}},\ \mbox{\hyperlink{structdoris_1_1_string_ref_a854352f53b148adc24983a58a1866d66}{size}});\ \}}
\DoxyCodeLine{00219\ \ \ \ \ \mbox{\hyperlink{structdoris_1_1_slice}{Slice}}\ \mbox{\hyperlink{structdoris_1_1_string_ref_a0fa8acdca4eb2b23032e655cbdf8d798}{to\_slice}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structdoris_1_1_slice}{doris::Slice}}(\mbox{\hyperlink{structdoris_1_1_string_ref_a8f64897c7ccc5c13f276d1d07c4e7095}{data}},\ \mbox{\hyperlink{structdoris_1_1_string_ref_a854352f53b148adc24983a58a1866d66}{size}});\ \}}
\DoxyCodeLine{00220\ }
\DoxyCodeLine{00221\ \ \ \ \ \textcolor{comment}{//\ this\ is\ just\ for\ show,\ e.g.\ print\ data\ to\ error\ log,\ to\ avoid\ print\ large\ string.}}
\DoxyCodeLine{00222\ \ \ \ \ std::string\ \mbox{\hyperlink{structdoris_1_1_string_ref_a173c0493216abe02c8b11406be50dff3}{to\_prefix}}(\textcolor{keywordtype}{size\_t}\ length)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ std::string(\mbox{\hyperlink{structdoris_1_1_string_ref_a8f64897c7ccc5c13f276d1d07c4e7095}{data}},\ std::min(length,\ \mbox{\hyperlink{structdoris_1_1_string_ref_a854352f53b148adc24983a58a1866d66}{size}}));\ \}}
\DoxyCodeLine{00223\ }
\DoxyCodeLine{00224\ \ \ \ \ \textcolor{comment}{//\ TODO:\ this\ function\ is\ dangerous!}}
\DoxyCodeLine{00225\ \ \ \ \ \mbox{\hyperlink{structdoris__udf_1_1_string_val}{StringVal}}\ \mbox{\hyperlink{structdoris_1_1_string_ref_adcb0d4f41ec3584998ed377b6fbbee1c}{to\_string\_val}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00226\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structdoris__udf_1_1_string_val}{StringVal}}(\textcolor{keyword}{reinterpret\_cast<}uint8\_t*\textcolor{keyword}{>}(\textcolor{keyword}{const\_cast<}\textcolor{keywordtype}{char}*\textcolor{keyword}{>}(\mbox{\hyperlink{structdoris_1_1_string_ref_a8f64897c7ccc5c13f276d1d07c4e7095}{data}})),\ \mbox{\hyperlink{structdoris_1_1_string_ref_a854352f53b148adc24983a58a1866d66}{size}});}
\DoxyCodeLine{00227\ \ \ \ \ \}}
\DoxyCodeLine{00228\ }
\DoxyCodeLine{00229\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structdoris_1_1_string_ref_a308e6db9f90b6e2de56b1e412248c99b}{to\_string\_val}}(\mbox{\hyperlink{structdoris__udf_1_1_string_val}{StringVal}}*\ sv)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \ \ *sv\ =\ \mbox{\hyperlink{structdoris__udf_1_1_string_val}{StringVal}}(\textcolor{keyword}{reinterpret\_cast<}uint8\_t*\textcolor{keyword}{>}(\textcolor{keyword}{const\_cast<}\textcolor{keywordtype}{char}*\textcolor{keyword}{>}(\mbox{\hyperlink{structdoris_1_1_string_ref_a8f64897c7ccc5c13f276d1d07c4e7095}{data}})),\ \mbox{\hyperlink{structdoris_1_1_string_ref_a854352f53b148adc24983a58a1866d66}{size}});}
\DoxyCodeLine{00231\ \ \ \ \ \}}
\DoxyCodeLine{00232\ }
\DoxyCodeLine{00233\ \ \ \ \ \textcolor{keyword}{explicit}\ \textcolor{keyword}{operator}\ std::string()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structdoris_1_1_string_ref_aac993ecccd3d88aafefb6b8e3caa1dee}{to\_string}}();\ \}}
\DoxyCodeLine{00234\ \ \ \ \ \textcolor{keyword}{operator}\ std::string\_view()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ std::string\_view\ \{\mbox{\hyperlink{structdoris_1_1_string_ref_a8f64897c7ccc5c13f276d1d07c4e7095}{data}},\ \mbox{\hyperlink{structdoris_1_1_string_ref_a854352f53b148adc24983a58a1866d66}{size}}\};\ \}}
\DoxyCodeLine{00235\ }
\DoxyCodeLine{00236\ \ \ \ \ \mbox{\hyperlink{structdoris_1_1_string_ref}{StringRef}}\ \mbox{\hyperlink{structdoris_1_1_string_ref_a47aae17eeb9619afa660b6cc2dd20629}{substring}}(\textcolor{keywordtype}{int}\ start\_pos,\ \textcolor{keywordtype}{int}\ new\_len)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structdoris_1_1_string_ref_ac06f8fc1d48f7d20a45f2317daf902a4}{StringRef}}(\mbox{\hyperlink{structdoris_1_1_string_ref_a8f64897c7ccc5c13f276d1d07c4e7095}{data}}\ +\ start\_pos,\ (new\_len\ <\ 0)\ ?\ (\mbox{\hyperlink{structdoris_1_1_string_ref_a854352f53b148adc24983a58a1866d66}{size}}\ -\/\ start\_pos)\ :\ new\_len);}
\DoxyCodeLine{00238\ \ \ \ \ \}}
\DoxyCodeLine{00239\ }
\DoxyCodeLine{00240\ \ \ \ \ \mbox{\hyperlink{structdoris_1_1_string_ref}{StringRef}}\ \mbox{\hyperlink{structdoris_1_1_string_ref_a65f885a38d4eae6691c63242e86119a8}{substring}}(\textcolor{keywordtype}{int}\ start\_pos)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structdoris_1_1_string_ref_a65f885a38d4eae6691c63242e86119a8}{substring}}(start\_pos,\ \mbox{\hyperlink{structdoris_1_1_string_ref_a854352f53b148adc24983a58a1866d66}{size}}\ -\/\ start\_pos);\ \}}
\DoxyCodeLine{00241\ }
\DoxyCodeLine{00242\ \ \ \ \ \textcolor{comment}{//\ Trims\ leading\ and\ trailing\ spaces.}}
\DoxyCodeLine{00243\ \ \ \ \ \mbox{\hyperlink{structdoris_1_1_string_ref}{StringRef}}\ \mbox{\hyperlink{structdoris_1_1_string_ref_a6b73ebad14b45cebfc9645ba5e4bee36}{trim}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00244\ }
\DoxyCodeLine{00245\ \ \ \ \ \textcolor{comment}{//\ support\ for\ type\_limit}}
\DoxyCodeLine{00246\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{char}\ \mbox{\hyperlink{structdoris_1_1_string_ref_a1f4099ce04f64d923b6a06506ea68a56}{MIN\_CHAR}}\ =\ 0;}
\DoxyCodeLine{00247\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{char}\ \mbox{\hyperlink{structdoris_1_1_string_ref_a4d21423ba92a29914176d67bcc7fec58}{MAX\_CHAR}}\ =\ char(}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ \ \ \ \ UCHAR\_MAX);\ \textcolor{comment}{//\ We\ will\ convert\ char\ to\ uchar\ and\ compare,\ so\ we\ define\ max\_char\ to\ unsigned\ char\ max.}}
\DoxyCodeLine{00249\ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{structdoris_1_1_string_ref}{StringRef}}\ \mbox{\hyperlink{structdoris_1_1_string_ref_ac3124cecef5bc1193fb641af86c084d0}{min\_string\_val}}();}
\DoxyCodeLine{00250\ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{structdoris_1_1_string_ref}{StringRef}}\ \mbox{\hyperlink{structdoris_1_1_string_ref_a57f621b81b9e866fb21e607c8f12d6bd}{max\_string\_val}}();}
\DoxyCodeLine{00251\ }
\DoxyCodeLine{00252\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structdoris_1_1_string_ref_a2c233b1145e148c2d11e4628943da17c}{start\_with}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structdoris_1_1_string_ref}{StringRef}}\&\ search\_string)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00253\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structdoris_1_1_string_ref_a1baa7404fdcefbff0c944c749138effc}{end\_with}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structdoris_1_1_string_ref}{StringRef}}\&\ search\_string)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00254\ }
\DoxyCodeLine{00255\ \ \ \ \ \textcolor{comment}{//\ Byte-\/by-\/byte\ comparison.\ Returns:}}
\DoxyCodeLine{00256\ \ \ \ \ \textcolor{comment}{//\ this\ <\ other:\ -\/1}}
\DoxyCodeLine{00257\ \ \ \ \ \textcolor{comment}{//\ this\ ==\ other:\ 0}}
\DoxyCodeLine{00258\ \ \ \ \ \textcolor{comment}{//\ this\ >\ other:\ 1}}
\DoxyCodeLine{00259\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structdoris_1_1_string_ref_ae025c54841da5d39154997607b3fb21b}{compare}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structdoris_1_1_string_ref}{StringRef}}\&\ other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00260\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ l\ =\ std::min(\mbox{\hyperlink{structdoris_1_1_string_ref_a854352f53b148adc24983a58a1866d66}{size}},\ other.\mbox{\hyperlink{structdoris_1_1_string_ref_a854352f53b148adc24983a58a1866d66}{size}});}
\DoxyCodeLine{00261\ }
\DoxyCodeLine{00262\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (l\ ==\ 0)\ \{}
\DoxyCodeLine{00263\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structdoris_1_1_string_ref_a854352f53b148adc24983a58a1866d66}{size}}\ ==\ other.\mbox{\hyperlink{structdoris_1_1_string_ref_a854352f53b148adc24983a58a1866d66}{size}})\ \{}
\DoxyCodeLine{00264\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structdoris_1_1_string_ref_a854352f53b148adc24983a58a1866d66}{size}}\ ==\ 0)\ \{}
\DoxyCodeLine{00266\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00267\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00268\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ DCHECK\_EQ(other.\mbox{\hyperlink{structdoris_1_1_string_ref_a854352f53b148adc24983a58a1866d66}{size}},\ 0);}
\DoxyCodeLine{00269\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{00270\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00272\ }
\DoxyCodeLine{00273\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ string\_compare(this-\/>data,\ this-\/>size,\ other.\mbox{\hyperlink{structdoris_1_1_string_ref_a8f64897c7ccc5c13f276d1d07c4e7095}{data}},\ other.\mbox{\hyperlink{structdoris_1_1_string_ref_a854352f53b148adc24983a58a1866d66}{size}},\ l);}
\DoxyCodeLine{00274\ \ \ \ \ \}}
\DoxyCodeLine{00275\ }
\DoxyCodeLine{00276\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structdoris_1_1_string_ref_aa06be28e0dd2ba7b75b65e3185115e43}{replace}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ ptr,\ \textcolor{keywordtype}{int}\ len)\ \{}
\DoxyCodeLine{00277\ \ \ \ \ \ \ \ \ this-\/>data\ =\ ptr;}
\DoxyCodeLine{00278\ \ \ \ \ \ \ \ \ this-\/>size\ =\ len;}
\DoxyCodeLine{00279\ \ \ \ \ \}}
\DoxyCodeLine{00280\ }
\DoxyCodeLine{00281\ \ \ \ \ \textcolor{comment}{//\ Find\ the\ first\ position\ char\ of\ appear,\ return\ -\/1\ if\ not\ found}}
\DoxyCodeLine{00282\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{structdoris_1_1_string_ref_ae01f7334f055e425e8c6384b0020b407}{find\_first\_of}}(\textcolor{keywordtype}{char}\ c)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00283\ }
\DoxyCodeLine{00284\ \ \ \ \ \textcolor{comment}{//\ ==}}
\DoxyCodeLine{00285\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structdoris_1_1_string_ref_a66d7cb798db5666acf94d42208970c00}{eq}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structdoris_1_1_string_ref}{StringRef}}\&\ other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00286\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>size\ !=\ other.\mbox{\hyperlink{structdoris_1_1_string_ref_a854352f53b148adc24983a58a1866d66}{size}})\ \{}
\DoxyCodeLine{00287\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00288\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00289\ \textcolor{preprocessor}{\#if\ defined(\_\_SSE2\_\_)}}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ memequalSSE2Wide(this-\/>data,\ other.\mbox{\hyperlink{structdoris_1_1_string_ref_a8f64897c7ccc5c13f276d1d07c4e7095}{data}},\ this-\/>size);}
\DoxyCodeLine{00291\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00292\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ string\_compare(this-\/>data,\ this-\/>size,\ other.\mbox{\hyperlink{structdoris_1_1_string_ref_a8f64897c7ccc5c13f276d1d07c4e7095}{data}},\ other.\mbox{\hyperlink{structdoris_1_1_string_ref_a854352f53b148adc24983a58a1866d66}{size}},\ this-\/>size)\ ==\ 0;}
\DoxyCodeLine{00293\ \ \ \ \ \}}
\DoxyCodeLine{00294\ }
\DoxyCodeLine{00295\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structdoris_1_1_string_ref_a0464240fb79952a68abb5c7214546fe1}{operator==}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structdoris_1_1_string_ref}{StringRef}}\&\ other)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structdoris_1_1_string_ref_a66d7cb798db5666acf94d42208970c00}{eq}}(other);\ \}}
\DoxyCodeLine{00296\ \ \ \ \ \textcolor{comment}{//\ !=}}
\DoxyCodeLine{00297\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structdoris_1_1_string_ref_afebfdbf30bec32e4563fcbb969214414}{ne}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structdoris_1_1_string_ref}{StringRef}}\&\ other)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ !\mbox{\hyperlink{structdoris_1_1_string_ref_a66d7cb798db5666acf94d42208970c00}{eq}}(other);\ \}}
\DoxyCodeLine{00298\ \ \ \ \ \textcolor{comment}{//\ <=}}
\DoxyCodeLine{00299\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structdoris_1_1_string_ref_aff715b6585ff69d9315e95db497fe11c}{le}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structdoris_1_1_string_ref}{StringRef}}\&\ other)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structdoris_1_1_string_ref_ae025c54841da5d39154997607b3fb21b}{compare}}(other)\ <=\ 0;\ \}}
\DoxyCodeLine{00300\ \ \ \ \ \textcolor{comment}{//\ >=}}
\DoxyCodeLine{00301\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structdoris_1_1_string_ref_ad5fc485413a2fb8ed7caab5d07bde353}{ge}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structdoris_1_1_string_ref}{StringRef}}\&\ other)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structdoris_1_1_string_ref_ae025c54841da5d39154997607b3fb21b}{compare}}(other)\ >=\ 0;\ \}}
\DoxyCodeLine{00302\ \ \ \ \ \textcolor{comment}{//\ <}}
\DoxyCodeLine{00303\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structdoris_1_1_string_ref_a590e7915d4cbfab235de43999bba4eb3}{lt}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structdoris_1_1_string_ref}{StringRef}}\&\ other)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structdoris_1_1_string_ref_ae025c54841da5d39154997607b3fb21b}{compare}}(other)\ <\ 0;\ \}}
\DoxyCodeLine{00304\ \ \ \ \ \textcolor{comment}{//\ >}}
\DoxyCodeLine{00305\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structdoris_1_1_string_ref_a409891605d8b8b82a0c65a08c31a26a0}{gt}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structdoris_1_1_string_ref}{StringRef}}\&\ other)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structdoris_1_1_string_ref_ae025c54841da5d39154997607b3fb21b}{compare}}(other)\ >\ 0;\ \}}
\DoxyCodeLine{00306\ }
\DoxyCodeLine{00307\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structdoris_1_1_string_ref_a6bc3b288724ee25954c261c604153510}{operator!=}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structdoris_1_1_string_ref}{StringRef}}\&\ other)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structdoris_1_1_string_ref_afebfdbf30bec32e4563fcbb969214414}{ne}}(other);\ \}}
\DoxyCodeLine{00308\ }
\DoxyCodeLine{00309\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structdoris_1_1_string_ref_a639c5d1a2d6dc0fa21e2ca0e210cc7d1}{operator<=}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structdoris_1_1_string_ref}{StringRef}}\&\ other)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structdoris_1_1_string_ref_aff715b6585ff69d9315e95db497fe11c}{le}}(other);\ \}}
\DoxyCodeLine{00310\ }
\DoxyCodeLine{00311\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structdoris_1_1_string_ref_a4019c279f003ad3d7bdc3bcb6ad3a8a4}{operator>=}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structdoris_1_1_string_ref}{StringRef}}\&\ other)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structdoris_1_1_string_ref_ad5fc485413a2fb8ed7caab5d07bde353}{ge}}(other);\ \}}
\DoxyCodeLine{00312\ }
\DoxyCodeLine{00313\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structdoris_1_1_string_ref_af7a31878afe77a8e7f3a1778dace620f}{operator<}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structdoris_1_1_string_ref}{StringRef}}\&\ other)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structdoris_1_1_string_ref_a590e7915d4cbfab235de43999bba4eb3}{lt}}(other);\ \}}
\DoxyCodeLine{00314\ }
\DoxyCodeLine{00315\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structdoris_1_1_string_ref_a01806c2a25bc78fd2b7fc549b2b3640e}{operator>}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structdoris_1_1_string_ref}{StringRef}}\&\ other)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structdoris_1_1_string_ref_a409891605d8b8b82a0c65a08c31a26a0}{gt}}(other);\ \}}
\DoxyCodeLine{00316\ }
\DoxyCodeLine{00317\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structdoris_1_1_string_ref_1_1_comparator}{Comparator}}\ \{}
\DoxyCodeLine{00318\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structdoris_1_1_string_ref_1_1_comparator_a11e0751d29b781a95eb26be83ff1b2ed}{operator()}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structdoris_1_1_string_ref}{StringRef}}\&\ \mbox{\hyperlink{memcpy__aarch64_8cpp_a20972992d1a551bcd609cfb231f91d8a}{a}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structdoris_1_1_string_ref}{StringRef}}\&\ b)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{memcpy__aarch64_8cpp_a20972992d1a551bcd609cfb231f91d8a}{a}}.compare(b)\ <\ 0;\ \}}
\DoxyCodeLine{00319\ \ \ \ \ \};}
\DoxyCodeLine{00320\ \};\ \textcolor{comment}{//\ class\ StringRef}}
\DoxyCodeLine{00321\ }
\DoxyCodeLine{00322\ \textcolor{comment}{//\ This\ function\ must\ be\ called\ 'hash\_value'\ to\ be\ picked\ up\ by\ boost.}}
\DoxyCodeLine{00323\ \textcolor{keyword}{inline}\ std::size\_t\ \mbox{\hyperlink{namespacedoris_aeb0d928c4739fd3061b7be2ac4047b03}{hash\_value}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structdoris_1_1_string_ref}{StringRef}}\&\ v)\ \{}
\DoxyCodeLine{00324\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdoris_1_1_hash_util_af859ad5532f11b9fb98fed728353cc75}{HashUtil::hash}}(v.\mbox{\hyperlink{structdoris_1_1_string_ref_a8f64897c7ccc5c13f276d1d07c4e7095}{data}},\ v.\mbox{\hyperlink{structdoris_1_1_string_ref_a854352f53b148adc24983a58a1866d66}{size}},\ 0);}
\DoxyCodeLine{00325\ \}}
\DoxyCodeLine{00326\ }
\DoxyCodeLine{00327\ \textcolor{keyword}{using\ }\mbox{\hyperlink{namespacedoris_a494c71c8e0815e0ec4f66099446082dc}{StringRefs}}\ =\ std::vector<StringRef>;}
\DoxyCodeLine{00328\ }
\DoxyCodeLine{00337\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structdoris_1_1_string_ref_hash64}{StringRefHash64}}\ \{}
\DoxyCodeLine{00338\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{structdoris_1_1_string_ref_hash64_a16069670a9f411adb346037f9e6dacc5}{operator()}}(\mbox{\hyperlink{structdoris_1_1_string_ref}{StringRef}}\ x)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespaceutil__hash_ad0ba022ddd9dae3ad8f79eadc9568c76}{util\_hash::CityHash64}}(x.\mbox{\hyperlink{structdoris_1_1_string_ref_a8f64897c7ccc5c13f276d1d07c4e7095}{data}},\ x.\mbox{\hyperlink{structdoris_1_1_string_ref_a854352f53b148adc24983a58a1866d66}{size}});\ \}}
\DoxyCodeLine{00339\ \};}
\DoxyCodeLine{00340\ }
\DoxyCodeLine{00341\ \textcolor{preprocessor}{\#if\ defined(\_\_SSE4\_2\_\_)\ ||\ defined(\_\_aarch64\_\_)}}
\DoxyCodeLine{00342\ }
\DoxyCodeLine{00344\ }
\DoxyCodeLine{00345\ \textcolor{keyword}{inline}\ \mbox{\hyperlink{namespacedoris_1_1vectorized_a81586a76c764e2556f67139907fa5440}{doris::vectorized::UInt64}}\ hash\_len16(\mbox{\hyperlink{namespacedoris_1_1vectorized_a81586a76c764e2556f67139907fa5440}{doris::vectorized::UInt64}}\ u,}
\DoxyCodeLine{00346\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedoris_1_1vectorized_a81586a76c764e2556f67139907fa5440}{doris::vectorized::UInt64}}\ v)\ \{}
\DoxyCodeLine{00347\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{hash128to64_8h_a277d7697b63b8321e906beccd0ce3339}{Hash128to64}}(\mbox{\hyperlink{classuint128}{uint128}}(u,\ v));}
\DoxyCodeLine{00348\ \}}
\DoxyCodeLine{00349\ }
\DoxyCodeLine{00350\ \textcolor{keyword}{inline}\ \mbox{\hyperlink{namespacedoris_1_1vectorized_a81586a76c764e2556f67139907fa5440}{doris::vectorized::UInt64}}\ shift\_mix(\mbox{\hyperlink{namespacedoris_1_1vectorized_a81586a76c764e2556f67139907fa5440}{doris::vectorized::UInt64}}\ val)\ \{}
\DoxyCodeLine{00351\ \ \ \ \ \textcolor{keywordflow}{return}\ val\ \string^\ (val\ >>\ 47);}
\DoxyCodeLine{00352\ \}}
\DoxyCodeLine{00353\ }
\DoxyCodeLine{00354\ \textcolor{keyword}{inline}\ \mbox{\hyperlink{namespacedoris_1_1vectorized_a81586a76c764e2556f67139907fa5440}{doris::vectorized::UInt64}}\ rotate\_by\_at\_least1(\mbox{\hyperlink{namespacedoris_1_1vectorized_a81586a76c764e2556f67139907fa5440}{doris::vectorized::UInt64}}\ val,\ \textcolor{keywordtype}{int}\ shift)\ \{}
\DoxyCodeLine{00355\ \ \ \ \ \textcolor{keywordflow}{return}\ (val\ >>\ shift)\ |\ (val\ <<\ (64\ -\/\ shift));}
\DoxyCodeLine{00356\ \}}
\DoxyCodeLine{00357\ }
\DoxyCodeLine{00358\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{size\_t}\ hash\_less\_than8(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \mbox{\hyperlink{uint24_8h_aa99be7b8b4274b2256b394ea7bf80762}{data}},\ \textcolor{keywordtype}{size\_t}\ size)\ \{}
\DoxyCodeLine{00359\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \mbox{\hyperlink{namespacedoris_1_1vectorized_a81586a76c764e2556f67139907fa5440}{doris::vectorized::UInt64}}\ k2\ =\ 0x9ae16a3b2f90404fULL;}
\DoxyCodeLine{00360\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \mbox{\hyperlink{namespacedoris_1_1vectorized_a81586a76c764e2556f67139907fa5440}{doris::vectorized::UInt64}}\ k3\ =\ 0xc949d7c7509e6557ULL;}
\DoxyCodeLine{00361\ }
\DoxyCodeLine{00362\ \ \ \ \ \textcolor{keywordflow}{if}\ (size\ >=\ 4)\ \{}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedoris_1_1vectorized_a81586a76c764e2556f67139907fa5440}{doris::vectorized::UInt64}}\ \mbox{\hyperlink{memcpy__aarch64_8cpp_a20972992d1a551bcd609cfb231f91d8a}{a}}\ =\ unaligned\_load<uint32\_t>(\mbox{\hyperlink{uint24_8h_aa99be7b8b4274b2256b394ea7bf80762}{data}});}
\DoxyCodeLine{00364\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ hash\_len16(size\ +\ (\mbox{\hyperlink{memcpy__aarch64_8cpp_a20972992d1a551bcd609cfb231f91d8a}{a}}\ <<\ 3),\ unaligned\_load<uint32\_t>(\mbox{\hyperlink{uint24_8h_aa99be7b8b4274b2256b394ea7bf80762}{data}}\ +\ size\ -\/\ 4));}
\DoxyCodeLine{00365\ \ \ \ \ \}}
\DoxyCodeLine{00366\ }
\DoxyCodeLine{00367\ \ \ \ \ \textcolor{keywordflow}{if}\ (size\ >\ 0)\ \{}
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ uint8\_t\ \mbox{\hyperlink{memcpy__aarch64_8cpp_a20972992d1a551bcd609cfb231f91d8a}{a}}\ =\ \mbox{\hyperlink{uint24_8h_aa99be7b8b4274b2256b394ea7bf80762}{data}}[0];}
\DoxyCodeLine{00369\ \ \ \ \ \ \ \ \ uint8\_t\ b\ =\ \mbox{\hyperlink{uint24_8h_aa99be7b8b4274b2256b394ea7bf80762}{data}}[size\ >>\ 1];}
\DoxyCodeLine{00370\ \ \ \ \ \ \ \ \ uint8\_t\ c\ =\ \mbox{\hyperlink{uint24_8h_aa99be7b8b4274b2256b394ea7bf80762}{data}}[size\ -\/\ 1];}
\DoxyCodeLine{00371\ \ \ \ \ \ \ \ \ uint32\_t\ y\ =\ \textcolor{keyword}{static\_cast<}uint32\_t\textcolor{keyword}{>}(\mbox{\hyperlink{memcpy__aarch64_8cpp_a20972992d1a551bcd609cfb231f91d8a}{a}})\ +\ (\textcolor{keyword}{static\_cast<}uint32\_t\textcolor{keyword}{>}(b)\ <<\ 8);}
\DoxyCodeLine{00372\ \ \ \ \ \ \ \ \ uint32\_t\ z\ =\ size\ +\ (\textcolor{keyword}{static\_cast<}uint32\_t\textcolor{keyword}{>}(c)\ <<\ 2);}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ shift\_mix(y\ *\ k2\ \string^\ z\ *\ k3)\ *\ k2;}
\DoxyCodeLine{00374\ \ \ \ \ \}}
\DoxyCodeLine{00375\ }
\DoxyCodeLine{00376\ \ \ \ \ \textcolor{keywordflow}{return}\ k2;}
\DoxyCodeLine{00377\ \}}
\DoxyCodeLine{00378\ }
\DoxyCodeLine{00379\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{size\_t}\ hash\_less\_than16(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \mbox{\hyperlink{uint24_8h_aa99be7b8b4274b2256b394ea7bf80762}{data}},\ \textcolor{keywordtype}{size\_t}\ size)\ \{}
\DoxyCodeLine{00380\ \ \ \ \ \textcolor{keywordflow}{if}\ (size\ >\ 8)\ \{}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedoris_1_1vectorized_a81586a76c764e2556f67139907fa5440}{doris::vectorized::UInt64}}\ \mbox{\hyperlink{memcpy__aarch64_8cpp_a20972992d1a551bcd609cfb231f91d8a}{a}}\ =\ unaligned\_load<doris::vectorized::UInt64>(\mbox{\hyperlink{uint24_8h_aa99be7b8b4274b2256b394ea7bf80762}{data}});}
\DoxyCodeLine{00382\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedoris_1_1vectorized_a81586a76c764e2556f67139907fa5440}{doris::vectorized::UInt64}}\ b\ =\ unaligned\_load<doris::vectorized::UInt64>(\mbox{\hyperlink{uint24_8h_aa99be7b8b4274b2256b394ea7bf80762}{data}}\ +\ size\ -\/\ 8);}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ hash\_len16(\mbox{\hyperlink{memcpy__aarch64_8cpp_a20972992d1a551bcd609cfb231f91d8a}{a}},\ rotate\_by\_at\_least1(b\ +\ size,\ size))\ \string^\ b;}
\DoxyCodeLine{00384\ \ \ \ \ \}}
\DoxyCodeLine{00385\ }
\DoxyCodeLine{00386\ \ \ \ \ \textcolor{keywordflow}{return}\ hash\_less\_than8(\mbox{\hyperlink{uint24_8h_aa99be7b8b4274b2256b394ea7bf80762}{data}},\ size);}
\DoxyCodeLine{00387\ \}}
\DoxyCodeLine{00388\ }
\DoxyCodeLine{00389\ \textcolor{keyword}{struct\ }CRC32Hash\ \{}
\DoxyCodeLine{00390\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{structdoris_1_1_c_r_c32_hash_a9e52129f8e861454b5caf866b5fde7a0}{operator()}}(\textcolor{keyword}{const}\ StringRef\&\ x)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00391\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ pos\ =\ x.data;}
\DoxyCodeLine{00392\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ size\ =\ x.size;}
\DoxyCodeLine{00393\ }
\DoxyCodeLine{00394\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (size\ ==\ 0)\ \{}
\DoxyCodeLine{00395\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00396\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00397\ }
\DoxyCodeLine{00398\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (size\ <\ 8)\ \{}
\DoxyCodeLine{00399\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ hash\_less\_than8(x.data,\ x.size);}
\DoxyCodeLine{00400\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00401\ }
\DoxyCodeLine{00402\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ end\ =\ pos\ +\ size;}
\DoxyCodeLine{00403\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ res\ =\ -\/1ULL;}
\DoxyCodeLine{00404\ }
\DoxyCodeLine{00405\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{do}\ \{}
\DoxyCodeLine{00406\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedoris_1_1vectorized_a81586a76c764e2556f67139907fa5440}{doris::vectorized::UInt64}}\ word\ =\ unaligned\_load<doris::vectorized::UInt64>(pos);}
\DoxyCodeLine{00407\ \ \ \ \ \ \ \ \ \ \ \ \ res\ =\ \_mm\_crc32\_u64(res,\ word);}
\DoxyCodeLine{00408\ }
\DoxyCodeLine{00409\ \ \ \ \ \ \ \ \ \ \ \ \ pos\ +=\ 8;}
\DoxyCodeLine{00410\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{while}\ (pos\ +\ 8\ <\ end);}
\DoxyCodeLine{00411\ }
\DoxyCodeLine{00412\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedoris_1_1vectorized_a81586a76c764e2556f67139907fa5440}{doris::vectorized::UInt64}}\ word\ =\ unaligned\_load<doris::vectorized::UInt64>(}
\DoxyCodeLine{00413\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ end\ -\/\ 8);\ }
\DoxyCodeLine{00414\ \ \ \ \ \ \ \ \ res\ =\ \_mm\_crc32\_u64(res,\ word);}
\DoxyCodeLine{00415\ }
\DoxyCodeLine{00416\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ res;}
\DoxyCodeLine{00417\ \ \ \ \ \}}
\DoxyCodeLine{00418\ \};}
\DoxyCodeLine{00419\ }
\DoxyCodeLine{00420\ \textcolor{keyword}{struct\ }StringRefHash\ :\ CRC32Hash\ \{\};}
\DoxyCodeLine{00421\ }
\DoxyCodeLine{00422\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00423\ }
\DoxyCodeLine{00424\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structdoris_1_1_c_r_c32_hash}{CRC32Hash}}\ \{}
\DoxyCodeLine{00425\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{structdoris_1_1_c_r_c32_hash_a9e52129f8e861454b5caf866b5fde7a0}{operator()}}(\mbox{\hyperlink{structdoris_1_1_string_ref}{StringRef}}\ \textcolor{comment}{/*\ x\ */})\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00426\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::logic\_error\ \{\textcolor{stringliteral}{"{}Not\ implemented\ CRC32Hash\ without\ SSE"{}}\};}
\DoxyCodeLine{00427\ \ \ \ \ \}}
\DoxyCodeLine{00428\ \};}
\DoxyCodeLine{00429\ }
\DoxyCodeLine{00430\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structdoris_1_1_string_ref_hash}{StringRefHash}}\ :\ \mbox{\hyperlink{structdoris_1_1_string_ref_hash64}{StringRefHash64}}\ \{\};}
\DoxyCodeLine{00431\ }
\DoxyCodeLine{00432\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ end\ of\ hash\ functions}}
\DoxyCodeLine{00433\ }
\DoxyCodeLine{00434\ \textcolor{keyword}{inline}\ std::ostream\&\ operator<<(std::ostream\&\ os,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structdoris_1_1_string_ref}{StringRef}}\&\ str)\ \{}
\DoxyCodeLine{00435\ \ \ \ \ \textcolor{keywordflow}{return}\ os\ <<\ str.\mbox{\hyperlink{structdoris_1_1_string_ref_aac993ecccd3d88aafefb6b8e3caa1dee}{to\_string}}();}
\DoxyCodeLine{00436\ \}}
\DoxyCodeLine{00437\ \}\ \textcolor{comment}{//\ namespace\ doris}}
\DoxyCodeLine{00438\ }
\DoxyCodeLine{00439\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespace_zero_traits}{ZeroTraits}}\ \{}
\DoxyCodeLine{00440\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespace_zero_traits_a0517f3cc4f3f256ce870ecd619187cca}{check}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structdoris_1_1_string_ref}{doris::StringRef}}\&\ x)\ \{}
\DoxyCodeLine{00441\ \ \ \ \ \textcolor{keywordflow}{return}\ 0\ ==\ x.\mbox{\hyperlink{structdoris_1_1_string_ref_a854352f53b148adc24983a58a1866d66}{size}};}
\DoxyCodeLine{00442\ \}}
\DoxyCodeLine{00443\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespace_zero_traits_a89ab63592e7dd40399be3e63f30d9ce0}{set}}(\mbox{\hyperlink{structdoris_1_1_string_ref}{doris::StringRef}}\&\ x)\ \{}
\DoxyCodeLine{00444\ \ \ \ \ x.\mbox{\hyperlink{structdoris_1_1_string_ref_a854352f53b148adc24983a58a1866d66}{size}}\ =\ 0;}
\DoxyCodeLine{00445\ \}}
\DoxyCodeLine{00446\ \}\ \textcolor{comment}{//\ namespace\ ZeroTraits}}
\DoxyCodeLine{00447\ }
\DoxyCodeLine{00448\ \textcolor{keyword}{template}\ <>}
\DoxyCodeLine{00449\ \textcolor{keyword}{struct\ }std::hash<\mbox{\hyperlink{namespacedoris}{doris}}::StringRef>\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{structdoris_1_1_string_ref_hash}{doris::StringRefHash}}\ \{\};}

\end{DoxyCode}
