\hypertarget{classdoris_1_1io_1_1_l_r_u_file_cache}{}\doxysection{LRUFile\+Cache类 参考}
\label{classdoris_1_1io_1_1_l_r_u_file_cache}\index{LRUFileCache@{LRUFileCache}}


{\ttfamily \#include $<$block\+\_\+lru\+\_\+file\+\_\+cache.\+h$>$}



类 LRUFile\+Cache 继承关系图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=161pt]{d8/dbc/classdoris_1_1io_1_1_l_r_u_file_cache__inherit__graph}
\end{center}
\end{figure}


LRUFile\+Cache 的协作图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=206pt]{db/daf/classdoris_1_1io_1_1_l_r_u_file_cache__coll__graph}
\end{center}
\end{figure}
\doxysubsection*{类}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structdoris_1_1io_1_1_l_r_u_file_cache_1_1_file_block_cell}{File\+Block\+Cell}}
\item 
struct \mbox{\hyperlink{structdoris_1_1io_1_1_l_r_u_file_cache_1_1_hash_cached_file_key}{Hash\+Cached\+File\+Key}}
\end{DoxyCompactItemize}
\doxysubsection*{Public 类型}
\begin{DoxyCompactItemize}
\item 
using \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a3c7d80a775cb9b2160e61a945865f534}{Query\+File\+Cache\+Context\+Holder\+Ptr}} = std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{structdoris_1_1io_1_1_i_file_cache_1_1_query_file_cache_context_holder}{Query\+File\+Cache\+Context\+Holder}} $>$
\end{DoxyCompactItemize}
\doxysubsection*{Public 成员函数}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classdoris_1_1io_1_1_l_r_u_file_cache_a1c1c8aecdaaafd83da19b9e089ca7f8d}{LRUFile\+Cache}} (const std\+::string \&cache\+\_\+base\+\_\+path, const \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_settings}{File\+Cache\+Settings}} \&cache\+\_\+settings)
\item 
\mbox{\hyperlink{structdoris_1_1io_1_1_file_blocks_holder}{File\+Blocks\+Holder}} \mbox{\hyperlink{classdoris_1_1io_1_1_l_r_u_file_cache_aa01842a257dfda4a1079d7817291181a}{get\+\_\+or\+\_\+set}} (const \mbox{\hyperlink{structdoris_1_1io_1_1_i_file_cache_1_1_key}{Key}} \&key, size\+\_\+t offset, size\+\_\+t size, bool is\+\_\+persistent, const TUnique\+Id \&query\+\_\+id) override
\item 
\mbox{\hyperlink{classdoris_1_1_status}{Status}} \mbox{\hyperlink{classdoris_1_1io_1_1_l_r_u_file_cache_a795d70c736c3b9b8296faf7959f83403}{initialize}} () override
\begin{DoxyCompactList}\small\item\em Restore cache from local filesystem. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classdoris_1_1io_1_1_l_r_u_file_cache_aa47a7087bd47c22bfda85416b3aa9b24}{remove\+\_\+if\+\_\+exists}} (const \mbox{\hyperlink{structdoris_1_1io_1_1_i_file_cache_1_1_key}{Key}} \&key, bool is\+\_\+persistent) override
\item 
void \mbox{\hyperlink{classdoris_1_1io_1_1_l_r_u_file_cache_a81306e93a8759d883c10f2335dc06d4b}{remove\+\_\+if\+\_\+releasable}} (bool is\+\_\+persistent) override
\item 
std\+::vector$<$ std\+::string $>$ \mbox{\hyperlink{classdoris_1_1io_1_1_l_r_u_file_cache_a17c021e102f9a430377feed83a3a8b13}{try\+\_\+get\+\_\+cache\+\_\+paths}} (const \mbox{\hyperlink{structdoris_1_1io_1_1_i_file_cache_1_1_key}{Key}} \&key, bool is\+\_\+persistent) override
\item 
size\+\_\+t \mbox{\hyperlink{classdoris_1_1io_1_1_l_r_u_file_cache_ad4c327f08641ee8ce840a7d54b4c9745}{get\+\_\+used\+\_\+cache\+\_\+size}} (bool is\+\_\+persistent) const override
\item 
size\+\_\+t \mbox{\hyperlink{classdoris_1_1io_1_1_l_r_u_file_cache_aa6a7fdbfb1146b13107e4e1dfd100182}{get\+\_\+file\+\_\+segments\+\_\+num}} (bool is\+\_\+persistent) const override
\item 
std\+::string \mbox{\hyperlink{classdoris_1_1io_1_1_l_r_u_file_cache_a7500355b22c1715b6d9ae0facdc05453}{dump\+\_\+structure}} (const \mbox{\hyperlink{structdoris_1_1io_1_1_i_file_cache_1_1_key}{Key}} \&key, bool is\+\_\+persistent) override
\begin{DoxyCompactList}\small\item\em For debug. \end{DoxyCompactList}\item 
size\+\_\+t \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a7223528283cd4e5872e0cc716bf9bd9d}{capacity}} () const
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{classdoris_1_1_cache}{Cache}} capacity in bytes. \end{DoxyCompactList}\item 
std\+::string \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a4d09a4047f95b0143001f69f59548d30}{get\+\_\+path\+\_\+in\+\_\+local\+\_\+cache}} (const \mbox{\hyperlink{structdoris_1_1io_1_1_i_file_cache_1_1_key}{Key}} \&key, size\+\_\+t offset, bool is\+\_\+persistent) const
\item 
std\+::string \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a5bc9e70487e1ef3e5ba3b0e577a0fa20}{get\+\_\+path\+\_\+in\+\_\+local\+\_\+cache}} (const \mbox{\hyperlink{structdoris_1_1io_1_1_i_file_cache_1_1_key}{Key}} \&key) const
\item 
std\+::string \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a219908755454cd7c7ceb5ced4da1faf7}{get\+\_\+version\+\_\+path}} () const
\item 
const std\+::string \& \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a0c437bfbf13578710df28996a11c181d}{get\+\_\+base\+\_\+path}} () const
\item 
\mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a3c7d80a775cb9b2160e61a945865f534}{Query\+File\+Cache\+Context\+Holder\+Ptr}} \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a3636e05272af94893026ac964ec401fd}{get\+\_\+query\+\_\+context\+\_\+holder}} (const TUnique\+Id \&query\+\_\+id)
\end{DoxyCompactItemize}
\doxysubsection*{静态 Public 成员函数}
\begin{DoxyCompactItemize}
\item 
static \mbox{\hyperlink{structdoris_1_1io_1_1_i_file_cache_1_1_key}{Key}} \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_af618e53b20e5e19b7b976dac4620a216}{hash}} (const std\+::string \&path)
\end{DoxyCompactItemize}
\doxysubsection*{静态 Public 属性}
\begin{DoxyCompactItemize}
\item 
static constexpr bool \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_af0b4ec01d04c96b15a98f608349cea8e}{USE\+\_\+\+CACHE\+\_\+\+VERSION2}} = true
\item 
static constexpr int \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_aa7a2ed45a456f47d8fe8151f7406caff}{KEY\+\_\+\+PREFIX\+\_\+\+LENGTH}} = 3
\end{DoxyCompactItemize}
\doxysubsection*{Protected 类型}
\begin{DoxyCompactItemize}
\item 
using \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a1d89d3b7e81c205e0aa726336753a1da}{Access\+Key\+And\+Offset}} = std\+::tuple$<$ \mbox{\hyperlink{structdoris_1_1io_1_1_i_file_cache_1_1_key}{Key}}, size\+\_\+t, bool $>$
\item 
using \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_adccb0504103447215380ee17166db1f7}{Access\+Record}} = std\+::unordered\+\_\+map$<$ \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a1d89d3b7e81c205e0aa726336753a1da}{Access\+Key\+And\+Offset}}, LRUQueue\+::\+Iterator, \mbox{\hyperlink{structdoris_1_1io_1_1_i_file_cache_1_1_key_and_offset_hash}{Key\+And\+Offset\+Hash}} $>$
\item 
using \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a8c66fc6bb666006ac6243084864487b6}{Query\+File\+Cache\+Context\+Ptr}} = std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{structdoris_1_1io_1_1_i_file_cache_1_1_query_file_cache_context}{Query\+File\+Cache\+Context}} $>$
\item 
using \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a18f35fffa11659535addfdd93902c7f4}{Query\+File\+Cache\+Context\+Map}} = std\+::unordered\+\_\+map$<$ TUnique\+Id, \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a8c66fc6bb666006ac6243084864487b6}{Query\+File\+Cache\+Context\+Ptr}} $>$
\end{DoxyCompactItemize}
\doxysubsection*{Protected 成员函数}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a8c66fc6bb666006ac6243084864487b6}{Query\+File\+Cache\+Context\+Ptr}} \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a5b2a6670f77761ee0e166c8319ed74fe}{get\+\_\+query\+\_\+context}} (const TUnique\+Id \&query\+\_\+id, std\+::lock\+\_\+guard$<$ std\+::mutex $>$ \&)
\item 
void \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a171ce34f33a2715f0697f2676892b2ae}{remove\+\_\+query\+\_\+context}} (const TUnique\+Id \&query\+\_\+id)
\item 
\mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a8c66fc6bb666006ac6243084864487b6}{Query\+File\+Cache\+Context\+Ptr}} \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a227d0732b6b1e1ec43cbb6bddcd5e5dc}{get\+\_\+or\+\_\+set\+\_\+query\+\_\+context}} (const TUnique\+Id \&query\+\_\+id, std\+::lock\+\_\+guard$<$ std\+::mutex $>$ \&)
\end{DoxyCompactItemize}
\doxysubsection*{Protected 属性}
\begin{DoxyCompactItemize}
\item 
std\+::string \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a2ba6697a12d63637494dbeec00ff3a78}{\+\_\+cache\+\_\+base\+\_\+path}}
\item 
size\+\_\+t \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_ab0288896c161455b7451327a41d33e74}{\+\_\+max\+\_\+size}} = 0
\item 
size\+\_\+t \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a19cbdfacaa469abf31575087e0473a73}{\+\_\+max\+\_\+element\+\_\+size}} = 0
\item 
size\+\_\+t \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a79ca82467b815ca27bb285d6185c1fe8}{\+\_\+persistent\+\_\+max\+\_\+size}} = 0
\item 
size\+\_\+t \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a6f6f9a282d55df2917b54cf99d501785}{\+\_\+persistent\+\_\+max\+\_\+element\+\_\+size}} = 0
\item 
size\+\_\+t \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_afa297c207d83ea0b9ebf5cee4fbad83a}{\+\_\+max\+\_\+file\+\_\+segment\+\_\+size}} = 0
\item 
size\+\_\+t \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_ad8ab93e3585b26c3ff70100f829e448b}{\+\_\+max\+\_\+query\+\_\+cache\+\_\+size}} = 0
\item 
bool \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_aa47905df0a83061082cf11f932a918df}{\+\_\+is\+\_\+initialized}} = false
\item 
std\+::mutex \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a3f0b4c278cb19f9c2b2dbdb065f51e14}{\+\_\+mutex}}
\item 
\mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a18f35fffa11659535addfdd93902c7f4}{Query\+File\+Cache\+Context\+Map}} \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a243744aff6497bffe2dfde68e4b064bd}{\+\_\+query\+\_\+map}}
\item 
bool \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a8b3d22a40257298552eb609d18cb2219}{\+\_\+enable\+\_\+file\+\_\+cache\+\_\+query\+\_\+limit}} = config\+::enable\+\_\+file\+\_\+cache\+\_\+query\+\_\+limit
\end{DoxyCompactItemize}
\doxysubsection*{Private 类型}
\begin{DoxyCompactItemize}
\item 
using \mbox{\hyperlink{classdoris_1_1io_1_1_l_r_u_file_cache_a71537e7046cc842769c9e7474a084bd8}{File\+Blocks\+By\+Offset}} = std\+::map$<$ size\+\_\+t, \mbox{\hyperlink{structdoris_1_1io_1_1_l_r_u_file_cache_1_1_file_block_cell}{File\+Block\+Cell}} $>$
\item 
using \mbox{\hyperlink{classdoris_1_1io_1_1_l_r_u_file_cache_a3ad54d3b33fc242ffb81e0c4dfeb99eb}{Cached\+Files}} = std\+::unordered\+\_\+map$<$ std\+::pair$<$ \mbox{\hyperlink{structdoris_1_1io_1_1_i_file_cache_1_1_key}{Key}}, bool $>$, \mbox{\hyperlink{classdoris_1_1io_1_1_l_r_u_file_cache_a71537e7046cc842769c9e7474a084bd8}{File\+Blocks\+By\+Offset}}, \mbox{\hyperlink{structdoris_1_1io_1_1_l_r_u_file_cache_1_1_hash_cached_file_key}{Hash\+Cached\+File\+Key}} $>$
\end{DoxyCompactItemize}
\doxysubsection*{Private 成员函数}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacedoris_1_1io_a12b7a12e387d2192f0feb8ce5f59c116}{File\+Blocks}} \mbox{\hyperlink{classdoris_1_1io_1_1_l_r_u_file_cache_a4d35604cf57218b4aec594da6fd17366}{get\+\_\+impl}} (const \mbox{\hyperlink{structdoris_1_1io_1_1_i_file_cache_1_1_key}{Key}} \&key, const TUnique\+Id \&query\+\_\+id, bool is\+\_\+persistent, const \mbox{\hyperlink{structdoris_1_1io_1_1_file_block_1_1_range}{File\+Block\+::\+Range}} \&range, std\+::lock\+\_\+guard$<$ std\+::mutex $>$ \&cache\+\_\+lock)
\item 
\mbox{\hyperlink{structdoris_1_1io_1_1_l_r_u_file_cache_1_1_file_block_cell}{File\+Block\+Cell}} $\ast$ \mbox{\hyperlink{classdoris_1_1io_1_1_l_r_u_file_cache_af0bf665f1497fb81251f9cf4c8d2fde5}{get\+\_\+cell}} (const \mbox{\hyperlink{structdoris_1_1io_1_1_i_file_cache_1_1_key}{Key}} \&key, bool is\+\_\+persistent, size\+\_\+t offset, std\+::lock\+\_\+guard$<$ std\+::mutex $>$ \&cache\+\_\+lock)
\item 
\mbox{\hyperlink{structdoris_1_1io_1_1_l_r_u_file_cache_1_1_file_block_cell}{File\+Block\+Cell}} $\ast$ \mbox{\hyperlink{classdoris_1_1io_1_1_l_r_u_file_cache_a581f197265ee91151badf10b10015dc9}{add\+\_\+cell}} (const \mbox{\hyperlink{structdoris_1_1io_1_1_i_file_cache_1_1_key}{Key}} \&key, bool is\+\_\+persistent, size\+\_\+t offset, size\+\_\+t size, \mbox{\hyperlink{classdoris_1_1io_1_1_file_block_a5d74787dedbc4e11c1ab15bf487e61f8}{File\+Block\+::\+State}} state, std\+::lock\+\_\+guard$<$ std\+::mutex $>$ \&cache\+\_\+lock)
\item 
void \mbox{\hyperlink{classdoris_1_1io_1_1_l_r_u_file_cache_a7e9e107d96582116fc575449a9cd2bda}{use\+\_\+cell}} (const \mbox{\hyperlink{structdoris_1_1io_1_1_l_r_u_file_cache_1_1_file_block_cell}{File\+Block\+Cell}} \&cell, const TUnique\+Id \&query\+\_\+id, bool is\+\_\+persistent, \mbox{\hyperlink{namespacedoris_1_1io_a12b7a12e387d2192f0feb8ce5f59c116}{File\+Blocks}} \&result, std\+::lock\+\_\+guard$<$ std\+::mutex $>$ \&cache\+\_\+lock)
\item 
bool \mbox{\hyperlink{classdoris_1_1io_1_1_l_r_u_file_cache_aa12d90e78295c706f726f3f38ba0937f}{try\+\_\+reserve}} (const \mbox{\hyperlink{structdoris_1_1io_1_1_i_file_cache_1_1_key}{Key}} \&key, const TUnique\+Id \&query\+\_\+id, bool is\+\_\+persistent, size\+\_\+t offset, size\+\_\+t size, std\+::lock\+\_\+guard$<$ std\+::mutex $>$ \&cache\+\_\+lock) override
\item 
bool \mbox{\hyperlink{classdoris_1_1io_1_1_l_r_u_file_cache_a76b1555e78804c6b63cd0038ec6ad512}{try\+\_\+reserve\+\_\+for\+\_\+main\+\_\+list}} (const \mbox{\hyperlink{structdoris_1_1io_1_1_i_file_cache_1_1_key}{Key}} \&key, \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a8c66fc6bb666006ac6243084864487b6}{Query\+File\+Cache\+Context\+Ptr}} query\+\_\+context, bool is\+\_\+persistent, size\+\_\+t offset, size\+\_\+t size, std\+::lock\+\_\+guard$<$ std\+::mutex $>$ \&cache\+\_\+lock)
\item 
void \mbox{\hyperlink{classdoris_1_1io_1_1_l_r_u_file_cache_a9842f06e7eca4524f3dfa4b09f1cbb9c}{remove}} (const \mbox{\hyperlink{structdoris_1_1io_1_1_i_file_cache_1_1_key}{Key}} \&key, bool is\+\_\+persistent, size\+\_\+t offset, std\+::lock\+\_\+guard$<$ std\+::mutex $>$ \&cache\+\_\+lock, std\+::lock\+\_\+guard$<$ std\+::mutex $>$ \&segment\+\_\+lock) override
\item 
size\+\_\+t \mbox{\hyperlink{classdoris_1_1io_1_1_l_r_u_file_cache_af09bfc1a2d83f1089bc31ec8e30048fa}{get\+\_\+available\+\_\+cache\+\_\+size}} (bool is\+\_\+persistent) const
\item 
void \mbox{\hyperlink{classdoris_1_1io_1_1_l_r_u_file_cache_ae4193c23e933aff85769c000f25bd413}{load\+\_\+cache\+\_\+info\+\_\+into\+\_\+memory}} (std\+::lock\+\_\+guard$<$ std\+::mutex $>$ \&cache\+\_\+lock)
\item 
\mbox{\hyperlink{classdoris_1_1_status}{Status}} \mbox{\hyperlink{classdoris_1_1io_1_1_l_r_u_file_cache_ad7ef7b45af02921ef194ba26333e94d1}{write\+\_\+file\+\_\+cache\+\_\+version}} () const
\item 
std\+::string \mbox{\hyperlink{classdoris_1_1io_1_1_l_r_u_file_cache_a4abbb082452ab56024d0f9bb227b09de}{read\+\_\+file\+\_\+cache\+\_\+version}} () const
\item 
\mbox{\hyperlink{namespacedoris_1_1io_a12b7a12e387d2192f0feb8ce5f59c116}{File\+Blocks}} \mbox{\hyperlink{classdoris_1_1io_1_1_l_r_u_file_cache_a678600500e1d9a7ac56f07ff7c9882dc}{split\+\_\+range\+\_\+into\+\_\+cells}} (const \mbox{\hyperlink{structdoris_1_1io_1_1_i_file_cache_1_1_key}{Key}} \&key, const TUnique\+Id \&query\+\_\+id, bool is\+\_\+persistent, size\+\_\+t offset, size\+\_\+t size, \mbox{\hyperlink{classdoris_1_1io_1_1_file_block_a5d74787dedbc4e11c1ab15bf487e61f8}{File\+Block\+::\+State}} state, std\+::lock\+\_\+guard$<$ std\+::mutex $>$ \&cache\+\_\+lock)
\item 
std\+::string \mbox{\hyperlink{classdoris_1_1io_1_1_l_r_u_file_cache_ad4bd0a5783832f110b9c43288d4cec5b}{dump\+\_\+structure\+\_\+unlocked}} (const \mbox{\hyperlink{structdoris_1_1io_1_1_i_file_cache_1_1_key}{Key}} \&key, bool is\+\_\+persistent, std\+::lock\+\_\+guard$<$ std\+::mutex $>$ \&cache\+\_\+lock)
\item 
void \mbox{\hyperlink{classdoris_1_1io_1_1_l_r_u_file_cache_afc9456e4757b4e8625c8c611859c71b9}{fill\+\_\+holes\+\_\+with\+\_\+empty\+\_\+file\+\_\+segments}} (\mbox{\hyperlink{namespacedoris_1_1io_a12b7a12e387d2192f0feb8ce5f59c116}{File\+Blocks}} \&file\+\_\+segments, const \mbox{\hyperlink{structdoris_1_1io_1_1_i_file_cache_1_1_key}{Key}} \&key, const TUnique\+Id \&query\+\_\+id, bool is\+\_\+persistent, const \mbox{\hyperlink{structdoris_1_1io_1_1_file_block_1_1_range}{File\+Block\+::\+Range}} \&range, std\+::lock\+\_\+guard$<$ std\+::mutex $>$ \&cache\+\_\+lock)
\item 
size\+\_\+t \mbox{\hyperlink{classdoris_1_1io_1_1_l_r_u_file_cache_af6e665ae416cd0bb806ccc36fd2b414b}{get\+\_\+used\+\_\+cache\+\_\+size\+\_\+unlocked}} (bool is\+\_\+persistent, std\+::lock\+\_\+guard$<$ std\+::mutex $>$ \&cache\+\_\+lock) const
\item 
size\+\_\+t \mbox{\hyperlink{classdoris_1_1io_1_1_l_r_u_file_cache_a0781f1ed534dad10e7af439ce08d6d09}{get\+\_\+available\+\_\+cache\+\_\+size\+\_\+unlocked}} (bool is\+\_\+persistent, std\+::lock\+\_\+guard$<$ std\+::mutex $>$ \&cache\+\_\+lock) const
\item 
size\+\_\+t \mbox{\hyperlink{classdoris_1_1io_1_1_l_r_u_file_cache_ac5c5b4161254a93f22dbeaf58a4eec17}{get\+\_\+file\+\_\+segments\+\_\+num\+\_\+unlocked}} (bool is\+\_\+persistent, std\+::lock\+\_\+guard$<$ std\+::mutex $>$ \&cache\+\_\+lock) const
\end{DoxyCompactItemize}
\doxysubsection*{Private 属性}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classdoris_1_1io_1_1_l_r_u_file_cache_a3ad54d3b33fc242ffb81e0c4dfeb99eb}{Cached\+Files}} \mbox{\hyperlink{classdoris_1_1io_1_1_l_r_u_file_cache_a31a366c9f070d46beffc14bcd67f2fdd}{\+\_\+files}}
\item 
\mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_1_1_l_r_u_queue}{LRUQueue}} \mbox{\hyperlink{classdoris_1_1io_1_1_l_r_u_file_cache_a850e2ffd8de08325716b5f9a9e5dcb86}{\+\_\+queue}}
\item 
\mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_1_1_l_r_u_queue}{LRUQueue}} \mbox{\hyperlink{classdoris_1_1io_1_1_l_r_u_file_cache_a6601fe68ab2b631161709dcd4517d006}{\+\_\+persistent\+\_\+queue}}
\end{DoxyCompactItemize}


\doxysubsection{详细描述}
Local cache for remote filesystem files, represented as a set of non-\/overlapping non-\/empty file segments. Implements LRU eviction policy. 

\doxysubsection{成员类型定义说明}
\mbox{\Hypertarget{classdoris_1_1io_1_1_l_r_u_file_cache_a71537e7046cc842769c9e7474a084bd8}\label{classdoris_1_1io_1_1_l_r_u_file_cache_a71537e7046cc842769c9e7474a084bd8}} 
\index{LRUFileCache@{LRUFileCache}!FileBlocksByOffset@{FileBlocksByOffset}}
\index{FileBlocksByOffset@{FileBlocksByOffset}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{FileBlocksByOffset}{FileBlocksByOffset}}
{\footnotesize\ttfamily using \mbox{\hyperlink{classdoris_1_1io_1_1_l_r_u_file_cache_a71537e7046cc842769c9e7474a084bd8}{File\+Blocks\+By\+Offset}} =  std\+::map$<$size\+\_\+t, \mbox{\hyperlink{structdoris_1_1io_1_1_l_r_u_file_cache_1_1_file_block_cell}{File\+Block\+Cell}}$>$\hspace{0.3cm}{\ttfamily [private]}}

\mbox{\Hypertarget{classdoris_1_1io_1_1_l_r_u_file_cache_a3ad54d3b33fc242ffb81e0c4dfeb99eb}\label{classdoris_1_1io_1_1_l_r_u_file_cache_a3ad54d3b33fc242ffb81e0c4dfeb99eb}} 
\index{LRUFileCache@{LRUFileCache}!CachedFiles@{CachedFiles}}
\index{CachedFiles@{CachedFiles}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{CachedFiles}{CachedFiles}}
{\footnotesize\ttfamily using \mbox{\hyperlink{classdoris_1_1io_1_1_l_r_u_file_cache_a3ad54d3b33fc242ffb81e0c4dfeb99eb}{Cached\+Files}} =  std\+::unordered\+\_\+map$<$std\+::pair$<$\mbox{\hyperlink{structdoris_1_1io_1_1_i_file_cache_1_1_key}{Key}}, bool$>$, \mbox{\hyperlink{classdoris_1_1io_1_1_l_r_u_file_cache_a71537e7046cc842769c9e7474a084bd8}{File\+Blocks\+By\+Offset}}, \mbox{\hyperlink{structdoris_1_1io_1_1_l_r_u_file_cache_1_1_hash_cached_file_key}{Hash\+Cached\+File\+Key}}$>$\hspace{0.3cm}{\ttfamily [private]}}

\mbox{\Hypertarget{classdoris_1_1io_1_1_i_file_cache_a1d89d3b7e81c205e0aa726336753a1da}\label{classdoris_1_1io_1_1_i_file_cache_a1d89d3b7e81c205e0aa726336753a1da}} 
\index{LRUFileCache@{LRUFileCache}!AccessKeyAndOffset@{AccessKeyAndOffset}}
\index{AccessKeyAndOffset@{AccessKeyAndOffset}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{AccessKeyAndOffset}{AccessKeyAndOffset}}
{\footnotesize\ttfamily using \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a1d89d3b7e81c205e0aa726336753a1da}{Access\+Key\+And\+Offset}} =  std\+::tuple$<$\mbox{\hyperlink{structdoris_1_1io_1_1_i_file_cache_1_1_key}{Key}}, size\+\_\+t, bool$>$\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}

\mbox{\Hypertarget{classdoris_1_1io_1_1_i_file_cache_adccb0504103447215380ee17166db1f7}\label{classdoris_1_1io_1_1_i_file_cache_adccb0504103447215380ee17166db1f7}} 
\index{LRUFileCache@{LRUFileCache}!AccessRecord@{AccessRecord}}
\index{AccessRecord@{AccessRecord}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{AccessRecord}{AccessRecord}}
{\footnotesize\ttfamily using \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_adccb0504103447215380ee17166db1f7}{Access\+Record}} =  std\+::unordered\+\_\+map$<$\mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a1d89d3b7e81c205e0aa726336753a1da}{Access\+Key\+And\+Offset}}, LRUQueue\+::\+Iterator, \mbox{\hyperlink{structdoris_1_1io_1_1_i_file_cache_1_1_key_and_offset_hash}{Key\+And\+Offset\+Hash}}$>$\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}

\mbox{\Hypertarget{classdoris_1_1io_1_1_i_file_cache_a8c66fc6bb666006ac6243084864487b6}\label{classdoris_1_1io_1_1_i_file_cache_a8c66fc6bb666006ac6243084864487b6}} 
\index{LRUFileCache@{LRUFileCache}!QueryFileCacheContextPtr@{QueryFileCacheContextPtr}}
\index{QueryFileCacheContextPtr@{QueryFileCacheContextPtr}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{QueryFileCacheContextPtr}{QueryFileCacheContextPtr}}
{\footnotesize\ttfamily using \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a8c66fc6bb666006ac6243084864487b6}{Query\+File\+Cache\+Context\+Ptr}} =  std\+::shared\+\_\+ptr$<$\mbox{\hyperlink{structdoris_1_1io_1_1_i_file_cache_1_1_query_file_cache_context}{Query\+File\+Cache\+Context}}$>$\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}

\mbox{\Hypertarget{classdoris_1_1io_1_1_i_file_cache_a18f35fffa11659535addfdd93902c7f4}\label{classdoris_1_1io_1_1_i_file_cache_a18f35fffa11659535addfdd93902c7f4}} 
\index{LRUFileCache@{LRUFileCache}!QueryFileCacheContextMap@{QueryFileCacheContextMap}}
\index{QueryFileCacheContextMap@{QueryFileCacheContextMap}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{QueryFileCacheContextMap}{QueryFileCacheContextMap}}
{\footnotesize\ttfamily using \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a18f35fffa11659535addfdd93902c7f4}{Query\+File\+Cache\+Context\+Map}} =  std\+::unordered\+\_\+map$<$TUnique\+Id, \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a8c66fc6bb666006ac6243084864487b6}{Query\+File\+Cache\+Context\+Ptr}}$>$\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}

\mbox{\Hypertarget{classdoris_1_1io_1_1_i_file_cache_a3c7d80a775cb9b2160e61a945865f534}\label{classdoris_1_1io_1_1_i_file_cache_a3c7d80a775cb9b2160e61a945865f534}} 
\index{LRUFileCache@{LRUFileCache}!QueryFileCacheContextHolderPtr@{QueryFileCacheContextHolderPtr}}
\index{QueryFileCacheContextHolderPtr@{QueryFileCacheContextHolderPtr}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{QueryFileCacheContextHolderPtr}{QueryFileCacheContextHolderPtr}}
{\footnotesize\ttfamily using \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a3c7d80a775cb9b2160e61a945865f534}{Query\+File\+Cache\+Context\+Holder\+Ptr}} =  std\+::unique\+\_\+ptr$<$\mbox{\hyperlink{structdoris_1_1io_1_1_i_file_cache_1_1_query_file_cache_context_holder}{Query\+File\+Cache\+Context\+Holder}}$>$\hspace{0.3cm}{\ttfamily [inherited]}}



\doxysubsection{构造及析构函数说明}
\mbox{\Hypertarget{classdoris_1_1io_1_1_l_r_u_file_cache_a1c1c8aecdaaafd83da19b9e089ca7f8d}\label{classdoris_1_1io_1_1_l_r_u_file_cache_a1c1c8aecdaaafd83da19b9e089ca7f8d}} 
\index{LRUFileCache@{LRUFileCache}!LRUFileCache@{LRUFileCache}}
\index{LRUFileCache@{LRUFileCache}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{LRUFileCache()}{LRUFileCache()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classdoris_1_1io_1_1_l_r_u_file_cache}{LRUFile\+Cache}} (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{cache\+\_\+base\+\_\+path,  }\item[{const \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_settings}{File\+Cache\+Settings}} \&}]{cache\+\_\+settings }\end{DoxyParamCaption})}

cache\+\_\+base\+\_\+path\+: the file cache path cache\+\_\+settings\+: the file cache setttings 

\doxysubsection{成员函数说明}
\mbox{\Hypertarget{classdoris_1_1io_1_1_l_r_u_file_cache_aa01842a257dfda4a1079d7817291181a}\label{classdoris_1_1io_1_1_l_r_u_file_cache_aa01842a257dfda4a1079d7817291181a}} 
\index{LRUFileCache@{LRUFileCache}!get\_or\_set@{get\_or\_set}}
\index{get\_or\_set@{get\_or\_set}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{get\_or\_set()}{get\_or\_set()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structdoris_1_1io_1_1_file_blocks_holder}{File\+Blocks\+Holder}} get\+\_\+or\+\_\+set (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structdoris_1_1io_1_1_i_file_cache_1_1_key}{Key}} \&}]{key,  }\item[{size\+\_\+t}]{offset,  }\item[{size\+\_\+t}]{size,  }\item[{bool}]{is\+\_\+persistent,  }\item[{const TUnique\+Id \&}]{query\+\_\+id }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

get the files which range contain \mbox{[}offset, offset+size-\/1\mbox{]} Get all segments which intersect with the given range.

实现了 \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a9080d155c7a2120f589d67c58a0a9a07}{IFile\+Cache}}.

函数调用图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/ddb/classdoris_1_1io_1_1_l_r_u_file_cache_aa01842a257dfda4a1079d7817291181a_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1io_1_1_l_r_u_file_cache_a795d70c736c3b9b8296faf7959f83403}\label{classdoris_1_1io_1_1_l_r_u_file_cache_a795d70c736c3b9b8296faf7959f83403}} 
\index{LRUFileCache@{LRUFileCache}!initialize@{initialize}}
\index{initialize@{initialize}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{initialize()}{initialize()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classdoris_1_1_status}{Status}} initialize (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Restore cache from local filesystem. 



实现了 \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a5f5cff6d7a886d22eaf83df239062a12}{IFile\+Cache}}.

函数调用图\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/ddb/classdoris_1_1io_1_1_l_r_u_file_cache_a795d70c736c3b9b8296faf7959f83403_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1io_1_1_l_r_u_file_cache_aa47a7087bd47c22bfda85416b3aa9b24}\label{classdoris_1_1io_1_1_l_r_u_file_cache_aa47a7087bd47c22bfda85416b3aa9b24}} 
\index{LRUFileCache@{LRUFileCache}!remove\_if\_exists@{remove\_if\_exists}}
\index{remove\_if\_exists@{remove\_if\_exists}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{remove\_if\_exists()}{remove\_if\_exists()}}
{\footnotesize\ttfamily void remove\+\_\+if\+\_\+exists (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structdoris_1_1io_1_1_i_file_cache_1_1_key}{Key}} \&}]{key,  }\item[{bool}]{is\+\_\+persistent }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

In ordinary case we remove data from cache when it\textquotesingle{}s not used by anyone. But if we have multiple replicated zero-\/copy tables on the same server it became possible to start removing something from cache when it is used by other \char`\"{}zero-\/copy\char`\"{} tables. That is why it\textquotesingle{}s not an error.

实现了 \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a05953820c1167f79f29c7633162c89e0}{IFile\+Cache}}.

函数调用图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/ddb/classdoris_1_1io_1_1_l_r_u_file_cache_aa47a7087bd47c22bfda85416b3aa9b24_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1io_1_1_l_r_u_file_cache_a81306e93a8759d883c10f2335dc06d4b}\label{classdoris_1_1io_1_1_l_r_u_file_cache_a81306e93a8759d883c10f2335dc06d4b}} 
\index{LRUFileCache@{LRUFileCache}!remove\_if\_releasable@{remove\_if\_releasable}}
\index{remove\_if\_releasable@{remove\_if\_releasable}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{remove\_if\_releasable()}{remove\_if\_releasable()}}
{\footnotesize\ttfamily void remove\+\_\+if\+\_\+releasable (\begin{DoxyParamCaption}\item[{bool}]{is\+\_\+persistent }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

Try remove all cached files by cache\+\_\+base\+\_\+path. Only releasable file segments are evicted. {\ttfamily remove\+\_\+persistent\+\_\+files} defines whether non-\/evictable by some criteria files (they do not comply with the cache eviction policy) should also be removed.

实现了 \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_ab3234e7d45625019069bd2817c54feca}{IFile\+Cache}}.

函数调用图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/ddb/classdoris_1_1io_1_1_l_r_u_file_cache_a81306e93a8759d883c10f2335dc06d4b_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1io_1_1_l_r_u_file_cache_a17c021e102f9a430377feed83a3a8b13}\label{classdoris_1_1io_1_1_l_r_u_file_cache_a17c021e102f9a430377feed83a3a8b13}} 
\index{LRUFileCache@{LRUFileCache}!try\_get\_cache\_paths@{try\_get\_cache\_paths}}
\index{try\_get\_cache\_paths@{try\_get\_cache\_paths}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{try\_get\_cache\_paths()}{try\_get\_cache\_paths()}}
{\footnotesize\ttfamily std\+::vector$<$ std\+::string $>$ try\+\_\+get\+\_\+cache\+\_\+paths (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structdoris_1_1io_1_1_i_file_cache_1_1_key}{Key}} \&}]{key,  }\item[{bool}]{is\+\_\+persistent }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



实现了 \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a795ade0b90afc69fddcc18ccde18a49f}{IFile\+Cache}}.

函数调用图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/ddb/classdoris_1_1io_1_1_l_r_u_file_cache_a17c021e102f9a430377feed83a3a8b13_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1io_1_1_l_r_u_file_cache_ad4c327f08641ee8ce840a7d54b4c9745}\label{classdoris_1_1io_1_1_l_r_u_file_cache_ad4c327f08641ee8ce840a7d54b4c9745}} 
\index{LRUFileCache@{LRUFileCache}!get\_used\_cache\_size@{get\_used\_cache\_size}}
\index{get\_used\_cache\_size@{get\_used\_cache\_size}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{get\_used\_cache\_size()}{get\_used\_cache\_size()}}
{\footnotesize\ttfamily size\+\_\+t get\+\_\+used\+\_\+cache\+\_\+size (\begin{DoxyParamCaption}\item[{bool}]{is\+\_\+persistent }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



实现了 \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_ae52850983c7b2983a900c99d42d31352}{IFile\+Cache}}.

函数调用图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/ddb/classdoris_1_1io_1_1_l_r_u_file_cache_ad4c327f08641ee8ce840a7d54b4c9745_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1io_1_1_l_r_u_file_cache_aa6a7fdbfb1146b13107e4e1dfd100182}\label{classdoris_1_1io_1_1_l_r_u_file_cache_aa6a7fdbfb1146b13107e4e1dfd100182}} 
\index{LRUFileCache@{LRUFileCache}!get\_file\_segments\_num@{get\_file\_segments\_num}}
\index{get\_file\_segments\_num@{get\_file\_segments\_num}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{get\_file\_segments\_num()}{get\_file\_segments\_num()}}
{\footnotesize\ttfamily size\+\_\+t get\+\_\+file\+\_\+segments\+\_\+num (\begin{DoxyParamCaption}\item[{bool}]{is\+\_\+persistent }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



实现了 \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a9d792866e963ac72b456d2a6e6918e4c}{IFile\+Cache}}.

函数调用图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/ddb/classdoris_1_1io_1_1_l_r_u_file_cache_aa6a7fdbfb1146b13107e4e1dfd100182_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1io_1_1_l_r_u_file_cache_a4d35604cf57218b4aec594da6fd17366}\label{classdoris_1_1io_1_1_l_r_u_file_cache_a4d35604cf57218b4aec594da6fd17366}} 
\index{LRUFileCache@{LRUFileCache}!get\_impl@{get\_impl}}
\index{get\_impl@{get\_impl}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{get\_impl()}{get\_impl()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacedoris_1_1io_a12b7a12e387d2192f0feb8ce5f59c116}{File\+Blocks}} get\+\_\+impl (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structdoris_1_1io_1_1_i_file_cache_1_1_key}{Key}} \&}]{key,  }\item[{const TUnique\+Id \&}]{query\+\_\+id,  }\item[{bool}]{is\+\_\+persistent,  }\item[{const \mbox{\hyperlink{structdoris_1_1io_1_1_file_block_1_1_range}{File\+Block\+::\+Range}} \&}]{range,  }\item[{std\+::lock\+\_\+guard$<$ std\+::mutex $>$ \&}]{cache\+\_\+lock }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

Given range = \mbox{[}left, right\mbox{]} and non-\/overlapping ordered set of file segments, find list \mbox{[}segment1, ..., segmentN\mbox{]} of segments which intersect with given range.

Note\+: it is guaranteed that there is no concurrency with files deletion, because cache files are deleted only inside \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache}{IFile\+Cache}} and under cache lock.

N -\/ last cached segment for given file key, segment\{N\}.offset \texorpdfstring{$<$}{<} range.\+left\+: segment\{N\} segment\{N\} \mbox{[}\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+ \mbox{[}\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\mbox{]} \mbox{[}\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\mbox{]} OR \mbox{[}\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\mbox{]} $^\wedge$ $^\wedge$ range.\+left range.\+left

segment\+\_\+it \texorpdfstring{$<$}{<}-- segmment\{k\}

segment\{k-\/1\} segment\{k\} \mbox{[}\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\mbox{]} \mbox{[}\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+ \mbox{[}\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+ $^\wedge$ range.\+left

segment\{k\} ... segment\{k-\/1\} segment\{k\} segment\{k\} \mbox{[}\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+ \mbox{[}\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\mbox{]} \mbox{[}\+\_\+\+\_\+\+\_\+\+\_\+ \mbox{[}\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+ \mbox{[}\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+ OR \mbox{[}\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+ OR \mbox{[}\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\mbox{]} $^\wedge$ $^\wedge$ $^\wedge$ $^\wedge$ segment\{k\}.offset range.\+left range.\+left range.\+right函数调用图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/ddb/classdoris_1_1io_1_1_l_r_u_file_cache_a4d35604cf57218b4aec594da6fd17366_cgraph}
\end{center}
\end{figure}
这是这个函数的调用关系图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=231pt]{d2/ddb/classdoris_1_1io_1_1_l_r_u_file_cache_a4d35604cf57218b4aec594da6fd17366_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1io_1_1_l_r_u_file_cache_af0bf665f1497fb81251f9cf4c8d2fde5}\label{classdoris_1_1io_1_1_l_r_u_file_cache_af0bf665f1497fb81251f9cf4c8d2fde5}} 
\index{LRUFileCache@{LRUFileCache}!get\_cell@{get\_cell}}
\index{get\_cell@{get\_cell}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{get\_cell()}{get\_cell()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structdoris_1_1io_1_1_l_r_u_file_cache_1_1_file_block_cell}{LRUFile\+Cache\+::\+File\+Block\+Cell}} $\ast$ get\+\_\+cell (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structdoris_1_1io_1_1_i_file_cache_1_1_key}{Key}} \&}]{key,  }\item[{bool}]{is\+\_\+persistent,  }\item[{size\+\_\+t}]{offset,  }\item[{std\+::lock\+\_\+guard$<$ std\+::mutex $>$ \&}]{cache\+\_\+lock }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

这是这个函数的调用关系图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/ddb/classdoris_1_1io_1_1_l_r_u_file_cache_af0bf665f1497fb81251f9cf4c8d2fde5_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1io_1_1_l_r_u_file_cache_a581f197265ee91151badf10b10015dc9}\label{classdoris_1_1io_1_1_l_r_u_file_cache_a581f197265ee91151badf10b10015dc9}} 
\index{LRUFileCache@{LRUFileCache}!add\_cell@{add\_cell}}
\index{add\_cell@{add\_cell}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{add\_cell()}{add\_cell()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structdoris_1_1io_1_1_l_r_u_file_cache_1_1_file_block_cell}{LRUFile\+Cache\+::\+File\+Block\+Cell}} $\ast$ add\+\_\+cell (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structdoris_1_1io_1_1_i_file_cache_1_1_key}{Key}} \&}]{key,  }\item[{bool}]{is\+\_\+persistent,  }\item[{size\+\_\+t}]{offset,  }\item[{size\+\_\+t}]{size,  }\item[{\mbox{\hyperlink{classdoris_1_1io_1_1_file_block_a5d74787dedbc4e11c1ab15bf487e61f8}{File\+Block\+::\+State}}}]{state,  }\item[{std\+::lock\+\_\+guard$<$ std\+::mutex $>$ \&}]{cache\+\_\+lock }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

Create a file segment cell and put it in {\ttfamily files} map by \mbox{[}key\mbox{]}\mbox{[}offset\mbox{]}.

Empty files are not cached.函数调用图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/ddb/classdoris_1_1io_1_1_l_r_u_file_cache_a581f197265ee91151badf10b10015dc9_cgraph}
\end{center}
\end{figure}
这是这个函数的调用关系图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/ddb/classdoris_1_1io_1_1_l_r_u_file_cache_a581f197265ee91151badf10b10015dc9_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1io_1_1_l_r_u_file_cache_a7e9e107d96582116fc575449a9cd2bda}\label{classdoris_1_1io_1_1_l_r_u_file_cache_a7e9e107d96582116fc575449a9cd2bda}} 
\index{LRUFileCache@{LRUFileCache}!use\_cell@{use\_cell}}
\index{use\_cell@{use\_cell}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{use\_cell()}{use\_cell()}}
{\footnotesize\ttfamily void use\+\_\+cell (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structdoris_1_1io_1_1_l_r_u_file_cache_1_1_file_block_cell}{File\+Block\+Cell}} \&}]{cell,  }\item[{const TUnique\+Id \&}]{query\+\_\+id,  }\item[{bool}]{is\+\_\+persistent,  }\item[{\mbox{\hyperlink{namespacedoris_1_1io_a12b7a12e387d2192f0feb8ce5f59c116}{File\+Blocks}} \&}]{result,  }\item[{std\+::lock\+\_\+guard$<$ std\+::mutex $>$ \&}]{cache\+\_\+lock }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

Move to the end of the queue. The iterator remains valid.函数调用图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/ddb/classdoris_1_1io_1_1_l_r_u_file_cache_a7e9e107d96582116fc575449a9cd2bda_cgraph}
\end{center}
\end{figure}
这是这个函数的调用关系图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=320pt]{d2/ddb/classdoris_1_1io_1_1_l_r_u_file_cache_a7e9e107d96582116fc575449a9cd2bda_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1io_1_1_l_r_u_file_cache_aa12d90e78295c706f726f3f38ba0937f}\label{classdoris_1_1io_1_1_l_r_u_file_cache_aa12d90e78295c706f726f3f38ba0937f}} 
\index{LRUFileCache@{LRUFileCache}!try\_reserve@{try\_reserve}}
\index{try\_reserve@{try\_reserve}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{try\_reserve()}{try\_reserve()}}
{\footnotesize\ttfamily bool try\+\_\+reserve (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structdoris_1_1io_1_1_i_file_cache_1_1_key}{Key}} \&}]{key,  }\item[{const TUnique\+Id \&}]{query\+\_\+id,  }\item[{bool}]{is\+\_\+persistent,  }\item[{size\+\_\+t}]{offset,  }\item[{size\+\_\+t}]{size,  }\item[{std\+::lock\+\_\+guard$<$ std\+::mutex $>$ \&}]{cache\+\_\+lock }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [private]}, {\ttfamily [virtual]}}

Select the cache from the LRU queue held by query for expulsion.

The cache corresponding to this record may be swapped out by other queries, so it has become invalid.

实现了 \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a9084413812a61833bd99dc21f94f94ec}{IFile\+Cache}}.

函数调用图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/ddb/classdoris_1_1io_1_1_l_r_u_file_cache_aa12d90e78295c706f726f3f38ba0937f_cgraph}
\end{center}
\end{figure}
这是这个函数的调用关系图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/ddb/classdoris_1_1io_1_1_l_r_u_file_cache_aa12d90e78295c706f726f3f38ba0937f_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1io_1_1_l_r_u_file_cache_a76b1555e78804c6b63cd0038ec6ad512}\label{classdoris_1_1io_1_1_l_r_u_file_cache_a76b1555e78804c6b63cd0038ec6ad512}} 
\index{LRUFileCache@{LRUFileCache}!try\_reserve\_for\_main\_list@{try\_reserve\_for\_main\_list}}
\index{try\_reserve\_for\_main\_list@{try\_reserve\_for\_main\_list}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{try\_reserve\_for\_main\_list()}{try\_reserve\_for\_main\_list()}}
{\footnotesize\ttfamily bool try\+\_\+reserve\+\_\+for\+\_\+main\+\_\+list (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structdoris_1_1io_1_1_i_file_cache_1_1_key}{Key}} \&}]{key,  }\item[{\mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a8c66fc6bb666006ac6243084864487b6}{Query\+File\+Cache\+Context\+Ptr}}}]{query\+\_\+context,  }\item[{bool}]{is\+\_\+persistent,  }\item[{size\+\_\+t}]{offset,  }\item[{size\+\_\+t}]{size,  }\item[{std\+::lock\+\_\+guard$<$ std\+::mutex $>$ \&}]{cache\+\_\+lock }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

It is guaranteed that cell is not removed from cache as long as pointer to corresponding file segment is hold by any other thread.

Cell will actually be removed only if we managed to reserve enough space.函数调用图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/ddb/classdoris_1_1io_1_1_l_r_u_file_cache_a76b1555e78804c6b63cd0038ec6ad512_cgraph}
\end{center}
\end{figure}
这是这个函数的调用关系图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/ddb/classdoris_1_1io_1_1_l_r_u_file_cache_a76b1555e78804c6b63cd0038ec6ad512_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1io_1_1_l_r_u_file_cache_a9842f06e7eca4524f3dfa4b09f1cbb9c}\label{classdoris_1_1io_1_1_l_r_u_file_cache_a9842f06e7eca4524f3dfa4b09f1cbb9c}} 
\index{LRUFileCache@{LRUFileCache}!remove@{remove}}
\index{remove@{remove}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{remove()}{remove()}}
{\footnotesize\ttfamily void remove (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structdoris_1_1io_1_1_i_file_cache_1_1_key}{Key}} \&}]{key,  }\item[{bool}]{is\+\_\+persistent,  }\item[{size\+\_\+t}]{offset,  }\item[{std\+::lock\+\_\+guard$<$ std\+::mutex $>$ \&}]{cache\+\_\+lock,  }\item[{std\+::lock\+\_\+guard$<$ std\+::mutex $>$ \&}]{segment\+\_\+lock }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [private]}, {\ttfamily [virtual]}}



实现了 \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a67d6cf0a4d5c2d331edfe8736fe50846}{IFile\+Cache}}.

函数调用图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/ddb/classdoris_1_1io_1_1_l_r_u_file_cache_a9842f06e7eca4524f3dfa4b09f1cbb9c_cgraph}
\end{center}
\end{figure}
这是这个函数的调用关系图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/ddb/classdoris_1_1io_1_1_l_r_u_file_cache_a9842f06e7eca4524f3dfa4b09f1cbb9c_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1io_1_1_l_r_u_file_cache_af09bfc1a2d83f1089bc31ec8e30048fa}\label{classdoris_1_1io_1_1_l_r_u_file_cache_af09bfc1a2d83f1089bc31ec8e30048fa}} 
\index{LRUFileCache@{LRUFileCache}!get\_available\_cache\_size@{get\_available\_cache\_size}}
\index{get\_available\_cache\_size@{get\_available\_cache\_size}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{get\_available\_cache\_size()}{get\_available\_cache\_size()}}
{\footnotesize\ttfamily size\+\_\+t get\+\_\+available\+\_\+cache\+\_\+size (\begin{DoxyParamCaption}\item[{bool}]{is\+\_\+persistent }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [private]}}

函数调用图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/ddb/classdoris_1_1io_1_1_l_r_u_file_cache_af09bfc1a2d83f1089bc31ec8e30048fa_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1io_1_1_l_r_u_file_cache_ae4193c23e933aff85769c000f25bd413}\label{classdoris_1_1io_1_1_l_r_u_file_cache_ae4193c23e933aff85769c000f25bd413}} 
\index{LRUFileCache@{LRUFileCache}!load\_cache\_info\_into\_memory@{load\_cache\_info\_into\_memory}}
\index{load\_cache\_info\_into\_memory@{load\_cache\_info\_into\_memory}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{load\_cache\_info\_into\_memory()}{load\_cache\_info\_into\_memory()}}
{\footnotesize\ttfamily void load\+\_\+cache\+\_\+info\+\_\+into\+\_\+memory (\begin{DoxyParamCaption}\item[{std\+::lock\+\_\+guard$<$ std\+::mutex $>$ \&}]{cache\+\_\+lock }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

version 1.\+0\+: cache\+\_\+base\+\_\+path / key / offset version 2.\+0\+: cache\+\_\+base\+\_\+path / key\+\_\+prefix / key / offset

Or just remove? Some unexpected file.

Shuffle cells to have random order in LRUQueue as at startup all cells have the same priority.函数调用图\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/ddb/classdoris_1_1io_1_1_l_r_u_file_cache_ae4193c23e933aff85769c000f25bd413_cgraph}
\end{center}
\end{figure}
这是这个函数的调用关系图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=276pt]{d2/ddb/classdoris_1_1io_1_1_l_r_u_file_cache_ae4193c23e933aff85769c000f25bd413_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1io_1_1_l_r_u_file_cache_ad7ef7b45af02921ef194ba26333e94d1}\label{classdoris_1_1io_1_1_l_r_u_file_cache_ad7ef7b45af02921ef194ba26333e94d1}} 
\index{LRUFileCache@{LRUFileCache}!write\_file\_cache\_version@{write\_file\_cache\_version}}
\index{write\_file\_cache\_version@{write\_file\_cache\_version}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{write\_file\_cache\_version()}{write\_file\_cache\_version()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classdoris_1_1_status}{Status}} write\+\_\+file\+\_\+cache\+\_\+version (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [private]}}

函数调用图\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/ddb/classdoris_1_1io_1_1_l_r_u_file_cache_ad7ef7b45af02921ef194ba26333e94d1_cgraph}
\end{center}
\end{figure}
这是这个函数的调用关系图\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/ddb/classdoris_1_1io_1_1_l_r_u_file_cache_ad7ef7b45af02921ef194ba26333e94d1_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1io_1_1_l_r_u_file_cache_a4abbb082452ab56024d0f9bb227b09de}\label{classdoris_1_1io_1_1_l_r_u_file_cache_a4abbb082452ab56024d0f9bb227b09de}} 
\index{LRUFileCache@{LRUFileCache}!read\_file\_cache\_version@{read\_file\_cache\_version}}
\index{read\_file\_cache\_version@{read\_file\_cache\_version}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{read\_file\_cache\_version()}{read\_file\_cache\_version()}}
{\footnotesize\ttfamily std\+::string read\+\_\+file\+\_\+cache\+\_\+version (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [private]}}

函数调用图\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=346pt]{d2/ddb/classdoris_1_1io_1_1_l_r_u_file_cache_a4abbb082452ab56024d0f9bb227b09de_cgraph}
\end{center}
\end{figure}
这是这个函数的调用关系图\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/ddb/classdoris_1_1io_1_1_l_r_u_file_cache_a4abbb082452ab56024d0f9bb227b09de_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1io_1_1_l_r_u_file_cache_a678600500e1d9a7ac56f07ff7c9882dc}\label{classdoris_1_1io_1_1_l_r_u_file_cache_a678600500e1d9a7ac56f07ff7c9882dc}} 
\index{LRUFileCache@{LRUFileCache}!split\_range\_into\_cells@{split\_range\_into\_cells}}
\index{split\_range\_into\_cells@{split\_range\_into\_cells}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{split\_range\_into\_cells()}{split\_range\_into\_cells()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacedoris_1_1io_a12b7a12e387d2192f0feb8ce5f59c116}{File\+Blocks}} split\+\_\+range\+\_\+into\+\_\+cells (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structdoris_1_1io_1_1_i_file_cache_1_1_key}{Key}} \&}]{key,  }\item[{const TUnique\+Id \&}]{query\+\_\+id,  }\item[{bool}]{is\+\_\+persistent,  }\item[{size\+\_\+t}]{offset,  }\item[{size\+\_\+t}]{size,  }\item[{\mbox{\hyperlink{classdoris_1_1io_1_1_file_block_a5d74787dedbc4e11c1ab15bf487e61f8}{File\+Block\+::\+State}}}]{state,  }\item[{std\+::lock\+\_\+guard$<$ std\+::mutex $>$ \&}]{cache\+\_\+lock }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

函数调用图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/ddb/classdoris_1_1io_1_1_l_r_u_file_cache_a678600500e1d9a7ac56f07ff7c9882dc_cgraph}
\end{center}
\end{figure}
这是这个函数的调用关系图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/ddb/classdoris_1_1io_1_1_l_r_u_file_cache_a678600500e1d9a7ac56f07ff7c9882dc_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1io_1_1_l_r_u_file_cache_ad4bd0a5783832f110b9c43288d4cec5b}\label{classdoris_1_1io_1_1_l_r_u_file_cache_ad4bd0a5783832f110b9c43288d4cec5b}} 
\index{LRUFileCache@{LRUFileCache}!dump\_structure\_unlocked@{dump\_structure\_unlocked}}
\index{dump\_structure\_unlocked@{dump\_structure\_unlocked}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{dump\_structure\_unlocked()}{dump\_structure\_unlocked()}}
{\footnotesize\ttfamily std\+::string dump\+\_\+structure\+\_\+unlocked (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structdoris_1_1io_1_1_i_file_cache_1_1_key}{Key}} \&}]{key,  }\item[{bool}]{is\+\_\+persistent,  }\item[{std\+::lock\+\_\+guard$<$ std\+::mutex $>$ \&}]{cache\+\_\+lock }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

函数调用图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/ddb/classdoris_1_1io_1_1_l_r_u_file_cache_ad4bd0a5783832f110b9c43288d4cec5b_cgraph}
\end{center}
\end{figure}
这是这个函数的调用关系图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/ddb/classdoris_1_1io_1_1_l_r_u_file_cache_ad4bd0a5783832f110b9c43288d4cec5b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1io_1_1_l_r_u_file_cache_afc9456e4757b4e8625c8c611859c71b9}\label{classdoris_1_1io_1_1_l_r_u_file_cache_afc9456e4757b4e8625c8c611859c71b9}} 
\index{LRUFileCache@{LRUFileCache}!fill\_holes\_with\_empty\_file\_segments@{fill\_holes\_with\_empty\_file\_segments}}
\index{fill\_holes\_with\_empty\_file\_segments@{fill\_holes\_with\_empty\_file\_segments}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{fill\_holes\_with\_empty\_file\_segments()}{fill\_holes\_with\_empty\_file\_segments()}}
{\footnotesize\ttfamily void fill\+\_\+holes\+\_\+with\+\_\+empty\+\_\+file\+\_\+segments (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespacedoris_1_1io_a12b7a12e387d2192f0feb8ce5f59c116}{File\+Blocks}} \&}]{file\+\_\+segments,  }\item[{const \mbox{\hyperlink{structdoris_1_1io_1_1_i_file_cache_1_1_key}{Key}} \&}]{key,  }\item[{const TUnique\+Id \&}]{query\+\_\+id,  }\item[{bool}]{is\+\_\+persistent,  }\item[{const \mbox{\hyperlink{structdoris_1_1io_1_1_file_block_1_1_range}{File\+Block\+::\+Range}} \&}]{range,  }\item[{std\+::lock\+\_\+guard$<$ std\+::mutex $>$ \&}]{cache\+\_\+lock }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

There are segments \mbox{[}segment1, ..., segmentN\mbox{]} (non-\/overlapping, non-\/empty, ascending-\/ordered) which (maybe partially) intersect with given range.

It can have holes\+: \mbox{[}\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\mbox{]} -- requested range \mbox{[}\+\_\+\+\_\+\+\_\+\+\_\+\mbox{]} \mbox{[}\+\_\+\mbox{]} \mbox{[}\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\mbox{]} -- intersecting cache \mbox{[}segment1, ..., segmentN\mbox{]}

For each such hole create a cell with file segment state EMPTY.

\mbox{[}\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+ -- requested range \mbox{[}\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+ $^\wedge$ segment1

\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\mbox{]} -- requested range \+\_\+\+\_\+\+\_\+\+\_\+\+\_\+\mbox{]} $^\wedge$ segmentN函数调用图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/ddb/classdoris_1_1io_1_1_l_r_u_file_cache_afc9456e4757b4e8625c8c611859c71b9_cgraph}
\end{center}
\end{figure}
这是这个函数的调用关系图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=288pt]{d2/ddb/classdoris_1_1io_1_1_l_r_u_file_cache_afc9456e4757b4e8625c8c611859c71b9_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1io_1_1_l_r_u_file_cache_af6e665ae416cd0bb806ccc36fd2b414b}\label{classdoris_1_1io_1_1_l_r_u_file_cache_af6e665ae416cd0bb806ccc36fd2b414b}} 
\index{LRUFileCache@{LRUFileCache}!get\_used\_cache\_size\_unlocked@{get\_used\_cache\_size\_unlocked}}
\index{get\_used\_cache\_size\_unlocked@{get\_used\_cache\_size\_unlocked}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{get\_used\_cache\_size\_unlocked()}{get\_used\_cache\_size\_unlocked()}}
{\footnotesize\ttfamily size\+\_\+t get\+\_\+used\+\_\+cache\+\_\+size\+\_\+unlocked (\begin{DoxyParamCaption}\item[{bool}]{is\+\_\+persistent,  }\item[{std\+::lock\+\_\+guard$<$ std\+::mutex $>$ \&}]{cache\+\_\+lock }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [private]}}

函数调用图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=342pt]{d2/ddb/classdoris_1_1io_1_1_l_r_u_file_cache_af6e665ae416cd0bb806ccc36fd2b414b_cgraph}
\end{center}
\end{figure}
这是这个函数的调用关系图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/ddb/classdoris_1_1io_1_1_l_r_u_file_cache_af6e665ae416cd0bb806ccc36fd2b414b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1io_1_1_l_r_u_file_cache_a0781f1ed534dad10e7af439ce08d6d09}\label{classdoris_1_1io_1_1_l_r_u_file_cache_a0781f1ed534dad10e7af439ce08d6d09}} 
\index{LRUFileCache@{LRUFileCache}!get\_available\_cache\_size\_unlocked@{get\_available\_cache\_size\_unlocked}}
\index{get\_available\_cache\_size\_unlocked@{get\_available\_cache\_size\_unlocked}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{get\_available\_cache\_size\_unlocked()}{get\_available\_cache\_size\_unlocked()}}
{\footnotesize\ttfamily size\+\_\+t get\+\_\+available\+\_\+cache\+\_\+size\+\_\+unlocked (\begin{DoxyParamCaption}\item[{bool}]{is\+\_\+persistent,  }\item[{std\+::lock\+\_\+guard$<$ std\+::mutex $>$ \&}]{cache\+\_\+lock }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [private]}}

函数调用图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/ddb/classdoris_1_1io_1_1_l_r_u_file_cache_a0781f1ed534dad10e7af439ce08d6d09_cgraph}
\end{center}
\end{figure}
这是这个函数的调用关系图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/ddb/classdoris_1_1io_1_1_l_r_u_file_cache_a0781f1ed534dad10e7af439ce08d6d09_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1io_1_1_l_r_u_file_cache_ac5c5b4161254a93f22dbeaf58a4eec17}\label{classdoris_1_1io_1_1_l_r_u_file_cache_ac5c5b4161254a93f22dbeaf58a4eec17}} 
\index{LRUFileCache@{LRUFileCache}!get\_file\_segments\_num\_unlocked@{get\_file\_segments\_num\_unlocked}}
\index{get\_file\_segments\_num\_unlocked@{get\_file\_segments\_num\_unlocked}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{get\_file\_segments\_num\_unlocked()}{get\_file\_segments\_num\_unlocked()}}
{\footnotesize\ttfamily size\+\_\+t get\+\_\+file\+\_\+segments\+\_\+num\+\_\+unlocked (\begin{DoxyParamCaption}\item[{bool}]{is\+\_\+persistent,  }\item[{std\+::lock\+\_\+guard$<$ std\+::mutex $>$ \&}]{cache\+\_\+lock }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [private]}}

函数调用图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/ddb/classdoris_1_1io_1_1_l_r_u_file_cache_ac5c5b4161254a93f22dbeaf58a4eec17_cgraph}
\end{center}
\end{figure}
这是这个函数的调用关系图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/ddb/classdoris_1_1io_1_1_l_r_u_file_cache_ac5c5b4161254a93f22dbeaf58a4eec17_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1io_1_1_l_r_u_file_cache_a7500355b22c1715b6d9ae0facdc05453}\label{classdoris_1_1io_1_1_l_r_u_file_cache_a7500355b22c1715b6d9ae0facdc05453}} 
\index{LRUFileCache@{LRUFileCache}!dump\_structure@{dump\_structure}}
\index{dump\_structure@{dump\_structure}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{dump\_structure()}{dump\_structure()}}
{\footnotesize\ttfamily std\+::string dump\+\_\+structure (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structdoris_1_1io_1_1_i_file_cache_1_1_key}{Key}} \&}]{key,  }\item[{bool}]{is\+\_\+persistent }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



For debug. 



实现了 \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_aa71ca3b482c454ff756a920373e49e60}{IFile\+Cache}}.

函数调用图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/ddb/classdoris_1_1io_1_1_l_r_u_file_cache_a7500355b22c1715b6d9ae0facdc05453_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1io_1_1_i_file_cache_a7223528283cd4e5872e0cc716bf9bd9d}\label{classdoris_1_1io_1_1_i_file_cache_a7223528283cd4e5872e0cc716bf9bd9d}} 
\index{LRUFileCache@{LRUFileCache}!capacity@{capacity}}
\index{capacity@{capacity}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{capacity()}{capacity()}}
{\footnotesize\ttfamily size\+\_\+t capacity (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [inherited]}}



\mbox{\hyperlink{classdoris_1_1_cache}{Cache}} capacity in bytes. 

\mbox{\Hypertarget{classdoris_1_1io_1_1_i_file_cache_af618e53b20e5e19b7b976dac4620a216}\label{classdoris_1_1io_1_1_i_file_cache_af618e53b20e5e19b7b976dac4620a216}} 
\index{LRUFileCache@{LRUFileCache}!hash@{hash}}
\index{hash@{hash}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{hash()}{hash()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structdoris_1_1io_1_1_i_file_cache_1_1_key}{IFile\+Cache\+::\+Key}} hash (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{path }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [inherited]}}

函数调用图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{df/dc4/classdoris_1_1io_1_1_i_file_cache_af618e53b20e5e19b7b976dac4620a216_cgraph}
\end{center}
\end{figure}
这是这个函数的调用关系图\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=324pt]{df/dc4/classdoris_1_1io_1_1_i_file_cache_af618e53b20e5e19b7b976dac4620a216_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1io_1_1_i_file_cache_a4d09a4047f95b0143001f69f59548d30}\label{classdoris_1_1io_1_1_i_file_cache_a4d09a4047f95b0143001f69f59548d30}} 
\index{LRUFileCache@{LRUFileCache}!get\_path\_in\_local\_cache@{get\_path\_in\_local\_cache}}
\index{get\_path\_in\_local\_cache@{get\_path\_in\_local\_cache}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{get\_path\_in\_local\_cache()}{get\_path\_in\_local\_cache()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily std\+::string get\+\_\+path\+\_\+in\+\_\+local\+\_\+cache (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structdoris_1_1io_1_1_i_file_cache_1_1_key}{Key}} \&}]{key,  }\item[{size\+\_\+t}]{offset,  }\item[{bool}]{is\+\_\+persistent }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inherited]}}

函数调用图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{df/dc4/classdoris_1_1io_1_1_i_file_cache_a4d09a4047f95b0143001f69f59548d30_cgraph}
\end{center}
\end{figure}
这是这个函数的调用关系图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{df/dc4/classdoris_1_1io_1_1_i_file_cache_a4d09a4047f95b0143001f69f59548d30_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1io_1_1_i_file_cache_a5bc9e70487e1ef3e5ba3b0e577a0fa20}\label{classdoris_1_1io_1_1_i_file_cache_a5bc9e70487e1ef3e5ba3b0e577a0fa20}} 
\index{LRUFileCache@{LRUFileCache}!get\_path\_in\_local\_cache@{get\_path\_in\_local\_cache}}
\index{get\_path\_in\_local\_cache@{get\_path\_in\_local\_cache}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{get\_path\_in\_local\_cache()}{get\_path\_in\_local\_cache()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily std\+::string get\+\_\+path\+\_\+in\+\_\+local\+\_\+cache (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structdoris_1_1io_1_1_i_file_cache_1_1_key}{Key}} \&}]{key }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inherited]}}

函数调用图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{df/dc4/classdoris_1_1io_1_1_i_file_cache_a5bc9e70487e1ef3e5ba3b0e577a0fa20_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1io_1_1_i_file_cache_a219908755454cd7c7ceb5ced4da1faf7}\label{classdoris_1_1io_1_1_i_file_cache_a219908755454cd7c7ceb5ced4da1faf7}} 
\index{LRUFileCache@{LRUFileCache}!get\_version\_path@{get\_version\_path}}
\index{get\_version\_path@{get\_version\_path}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{get\_version\_path()}{get\_version\_path()}}
{\footnotesize\ttfamily std\+::string get\+\_\+version\+\_\+path (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inherited]}}

这是这个函数的调用关系图\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{df/dc4/classdoris_1_1io_1_1_i_file_cache_a219908755454cd7c7ceb5ced4da1faf7_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1io_1_1_i_file_cache_a0c437bfbf13578710df28996a11c181d}\label{classdoris_1_1io_1_1_i_file_cache_a0c437bfbf13578710df28996a11c181d}} 
\index{LRUFileCache@{LRUFileCache}!get\_base\_path@{get\_base\_path}}
\index{get\_base\_path@{get\_base\_path}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{get\_base\_path()}{get\_base\_path()}}
{\footnotesize\ttfamily const std\+::string \& get\+\_\+base\+\_\+path (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [inherited]}}

\mbox{\Hypertarget{classdoris_1_1io_1_1_i_file_cache_a5b2a6670f77761ee0e166c8319ed74fe}\label{classdoris_1_1io_1_1_i_file_cache_a5b2a6670f77761ee0e166c8319ed74fe}} 
\index{LRUFileCache@{LRUFileCache}!get\_query\_context@{get\_query\_context}}
\index{get\_query\_context@{get\_query\_context}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{get\_query\_context()}{get\_query\_context()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a8c66fc6bb666006ac6243084864487b6}{IFile\+Cache\+::\+Query\+File\+Cache\+Context\+Ptr}} get\+\_\+query\+\_\+context (\begin{DoxyParamCaption}\item[{const TUnique\+Id \&}]{query\+\_\+id,  }\item[{std\+::lock\+\_\+guard$<$ std\+::mutex $>$ \&}]{cache\+\_\+lock }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}

这是这个函数的调用关系图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{df/dc4/classdoris_1_1io_1_1_i_file_cache_a5b2a6670f77761ee0e166c8319ed74fe_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1io_1_1_i_file_cache_a171ce34f33a2715f0697f2676892b2ae}\label{classdoris_1_1io_1_1_i_file_cache_a171ce34f33a2715f0697f2676892b2ae}} 
\index{LRUFileCache@{LRUFileCache}!remove\_query\_context@{remove\_query\_context}}
\index{remove\_query\_context@{remove\_query\_context}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{remove\_query\_context()}{remove\_query\_context()}}
{\footnotesize\ttfamily void remove\+\_\+query\+\_\+context (\begin{DoxyParamCaption}\item[{const TUnique\+Id \&}]{query\+\_\+id }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}

这是这个函数的调用关系图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{df/dc4/classdoris_1_1io_1_1_i_file_cache_a171ce34f33a2715f0697f2676892b2ae_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1io_1_1_i_file_cache_a227d0732b6b1e1ec43cbb6bddcd5e5dc}\label{classdoris_1_1io_1_1_i_file_cache_a227d0732b6b1e1ec43cbb6bddcd5e5dc}} 
\index{LRUFileCache@{LRUFileCache}!get\_or\_set\_query\_context@{get\_or\_set\_query\_context}}
\index{get\_or\_set\_query\_context@{get\_or\_set\_query\_context}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{get\_or\_set\_query\_context()}{get\_or\_set\_query\_context()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a8c66fc6bb666006ac6243084864487b6}{IFile\+Cache\+::\+Query\+File\+Cache\+Context\+Ptr}} get\+\_\+or\+\_\+set\+\_\+query\+\_\+context (\begin{DoxyParamCaption}\item[{const TUnique\+Id \&}]{query\+\_\+id,  }\item[{std\+::lock\+\_\+guard$<$ std\+::mutex $>$ \&}]{cache\+\_\+lock }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}

函数调用图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=342pt]{df/dc4/classdoris_1_1io_1_1_i_file_cache_a227d0732b6b1e1ec43cbb6bddcd5e5dc_cgraph}
\end{center}
\end{figure}
这是这个函数的调用关系图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{df/dc4/classdoris_1_1io_1_1_i_file_cache_a227d0732b6b1e1ec43cbb6bddcd5e5dc_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1io_1_1_i_file_cache_a3636e05272af94893026ac964ec401fd}\label{classdoris_1_1io_1_1_i_file_cache_a3636e05272af94893026ac964ec401fd}} 
\index{LRUFileCache@{LRUFileCache}!get\_query\_context\_holder@{get\_query\_context\_holder}}
\index{get\_query\_context\_holder@{get\_query\_context\_holder}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{get\_query\_context\_holder()}{get\_query\_context\_holder()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a3c7d80a775cb9b2160e61a945865f534}{IFile\+Cache\+::\+Query\+File\+Cache\+Context\+Holder\+Ptr}} get\+\_\+query\+\_\+context\+\_\+holder (\begin{DoxyParamCaption}\item[{const TUnique\+Id \&}]{query\+\_\+id }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inherited]}}

if enable\+\_\+filesystem\+\_\+query\+\_\+cache\+\_\+limit is true, we create context query for current query.函数调用图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{df/dc4/classdoris_1_1io_1_1_i_file_cache_a3636e05272af94893026ac964ec401fd_cgraph}
\end{center}
\end{figure}


\doxysubsection{类成员变量说明}
\mbox{\Hypertarget{classdoris_1_1io_1_1_l_r_u_file_cache_a31a366c9f070d46beffc14bcd67f2fdd}\label{classdoris_1_1io_1_1_l_r_u_file_cache_a31a366c9f070d46beffc14bcd67f2fdd}} 
\index{LRUFileCache@{LRUFileCache}!\_files@{\_files}}
\index{\_files@{\_files}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{\_files}{\_files}}
{\footnotesize\ttfamily \mbox{\hyperlink{classdoris_1_1io_1_1_l_r_u_file_cache_a3ad54d3b33fc242ffb81e0c4dfeb99eb}{Cached\+Files}} \+\_\+files\hspace{0.3cm}{\ttfamily [private]}}

\mbox{\Hypertarget{classdoris_1_1io_1_1_l_r_u_file_cache_a850e2ffd8de08325716b5f9a9e5dcb86}\label{classdoris_1_1io_1_1_l_r_u_file_cache_a850e2ffd8de08325716b5f9a9e5dcb86}} 
\index{LRUFileCache@{LRUFileCache}!\_queue@{\_queue}}
\index{\_queue@{\_queue}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{\_queue}{\_queue}}
{\footnotesize\ttfamily \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_1_1_l_r_u_queue}{LRUQueue}} \+\_\+queue\hspace{0.3cm}{\ttfamily [private]}}

\mbox{\Hypertarget{classdoris_1_1io_1_1_l_r_u_file_cache_a6601fe68ab2b631161709dcd4517d006}\label{classdoris_1_1io_1_1_l_r_u_file_cache_a6601fe68ab2b631161709dcd4517d006}} 
\index{LRUFileCache@{LRUFileCache}!\_persistent\_queue@{\_persistent\_queue}}
\index{\_persistent\_queue@{\_persistent\_queue}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{\_persistent\_queue}{\_persistent\_queue}}
{\footnotesize\ttfamily \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_1_1_l_r_u_queue}{LRUQueue}} \+\_\+persistent\+\_\+queue\hspace{0.3cm}{\ttfamily [private]}}

\mbox{\Hypertarget{classdoris_1_1io_1_1_i_file_cache_af0b4ec01d04c96b15a98f608349cea8e}\label{classdoris_1_1io_1_1_i_file_cache_af0b4ec01d04c96b15a98f608349cea8e}} 
\index{LRUFileCache@{LRUFileCache}!USE\_CACHE\_VERSION2@{USE\_CACHE\_VERSION2}}
\index{USE\_CACHE\_VERSION2@{USE\_CACHE\_VERSION2}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{USE\_CACHE\_VERSION2}{USE\_CACHE\_VERSION2}}
{\footnotesize\ttfamily constexpr bool USE\+\_\+\+CACHE\+\_\+\+VERSION2 = true\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [constexpr]}, {\ttfamily [inherited]}}

use version 2 when USE\+\_\+\+CACHE\+\_\+\+VERSION2 = true, while use version 1 if false version 1.\+0\+: cache\+\_\+base\+\_\+path / key / offset version 2.\+0\+: cache\+\_\+base\+\_\+path / key\+\_\+prefix / key / offset \mbox{\Hypertarget{classdoris_1_1io_1_1_i_file_cache_aa7a2ed45a456f47d8fe8151f7406caff}\label{classdoris_1_1io_1_1_i_file_cache_aa7a2ed45a456f47d8fe8151f7406caff}} 
\index{LRUFileCache@{LRUFileCache}!KEY\_PREFIX\_LENGTH@{KEY\_PREFIX\_LENGTH}}
\index{KEY\_PREFIX\_LENGTH@{KEY\_PREFIX\_LENGTH}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{KEY\_PREFIX\_LENGTH}{KEY\_PREFIX\_LENGTH}}
{\footnotesize\ttfamily constexpr int KEY\+\_\+\+PREFIX\+\_\+\+LENGTH = 3\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [constexpr]}, {\ttfamily [inherited]}}

\mbox{\Hypertarget{classdoris_1_1io_1_1_i_file_cache_a2ba6697a12d63637494dbeec00ff3a78}\label{classdoris_1_1io_1_1_i_file_cache_a2ba6697a12d63637494dbeec00ff3a78}} 
\index{LRUFileCache@{LRUFileCache}!\_cache\_base\_path@{\_cache\_base\_path}}
\index{\_cache\_base\_path@{\_cache\_base\_path}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{\_cache\_base\_path}{\_cache\_base\_path}}
{\footnotesize\ttfamily std\+::string \+\_\+cache\+\_\+base\+\_\+path\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}

\mbox{\Hypertarget{classdoris_1_1io_1_1_i_file_cache_ab0288896c161455b7451327a41d33e74}\label{classdoris_1_1io_1_1_i_file_cache_ab0288896c161455b7451327a41d33e74}} 
\index{LRUFileCache@{LRUFileCache}!\_max\_size@{\_max\_size}}
\index{\_max\_size@{\_max\_size}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{\_max\_size}{\_max\_size}}
{\footnotesize\ttfamily size\+\_\+t \+\_\+max\+\_\+size = 0\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}

\mbox{\Hypertarget{classdoris_1_1io_1_1_i_file_cache_a19cbdfacaa469abf31575087e0473a73}\label{classdoris_1_1io_1_1_i_file_cache_a19cbdfacaa469abf31575087e0473a73}} 
\index{LRUFileCache@{LRUFileCache}!\_max\_element\_size@{\_max\_element\_size}}
\index{\_max\_element\_size@{\_max\_element\_size}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{\_max\_element\_size}{\_max\_element\_size}}
{\footnotesize\ttfamily size\+\_\+t \+\_\+max\+\_\+element\+\_\+size = 0\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}

\mbox{\Hypertarget{classdoris_1_1io_1_1_i_file_cache_a79ca82467b815ca27bb285d6185c1fe8}\label{classdoris_1_1io_1_1_i_file_cache_a79ca82467b815ca27bb285d6185c1fe8}} 
\index{LRUFileCache@{LRUFileCache}!\_persistent\_max\_size@{\_persistent\_max\_size}}
\index{\_persistent\_max\_size@{\_persistent\_max\_size}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{\_persistent\_max\_size}{\_persistent\_max\_size}}
{\footnotesize\ttfamily size\+\_\+t \+\_\+persistent\+\_\+max\+\_\+size = 0\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}

\mbox{\Hypertarget{classdoris_1_1io_1_1_i_file_cache_a6f6f9a282d55df2917b54cf99d501785}\label{classdoris_1_1io_1_1_i_file_cache_a6f6f9a282d55df2917b54cf99d501785}} 
\index{LRUFileCache@{LRUFileCache}!\_persistent\_max\_element\_size@{\_persistent\_max\_element\_size}}
\index{\_persistent\_max\_element\_size@{\_persistent\_max\_element\_size}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{\_persistent\_max\_element\_size}{\_persistent\_max\_element\_size}}
{\footnotesize\ttfamily size\+\_\+t \+\_\+persistent\+\_\+max\+\_\+element\+\_\+size = 0\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}

\mbox{\Hypertarget{classdoris_1_1io_1_1_i_file_cache_afa297c207d83ea0b9ebf5cee4fbad83a}\label{classdoris_1_1io_1_1_i_file_cache_afa297c207d83ea0b9ebf5cee4fbad83a}} 
\index{LRUFileCache@{LRUFileCache}!\_max\_file\_segment\_size@{\_max\_file\_segment\_size}}
\index{\_max\_file\_segment\_size@{\_max\_file\_segment\_size}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{\_max\_file\_segment\_size}{\_max\_file\_segment\_size}}
{\footnotesize\ttfamily size\+\_\+t \+\_\+max\+\_\+file\+\_\+segment\+\_\+size = 0\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}

\mbox{\Hypertarget{classdoris_1_1io_1_1_i_file_cache_ad8ab93e3585b26c3ff70100f829e448b}\label{classdoris_1_1io_1_1_i_file_cache_ad8ab93e3585b26c3ff70100f829e448b}} 
\index{LRUFileCache@{LRUFileCache}!\_max\_query\_cache\_size@{\_max\_query\_cache\_size}}
\index{\_max\_query\_cache\_size@{\_max\_query\_cache\_size}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{\_max\_query\_cache\_size}{\_max\_query\_cache\_size}}
{\footnotesize\ttfamily size\+\_\+t \+\_\+max\+\_\+query\+\_\+cache\+\_\+size = 0\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}

\mbox{\Hypertarget{classdoris_1_1io_1_1_i_file_cache_aa47905df0a83061082cf11f932a918df}\label{classdoris_1_1io_1_1_i_file_cache_aa47905df0a83061082cf11f932a918df}} 
\index{LRUFileCache@{LRUFileCache}!\_is\_initialized@{\_is\_initialized}}
\index{\_is\_initialized@{\_is\_initialized}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{\_is\_initialized}{\_is\_initialized}}
{\footnotesize\ttfamily bool \+\_\+is\+\_\+initialized = false\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}

\mbox{\Hypertarget{classdoris_1_1io_1_1_i_file_cache_a3f0b4c278cb19f9c2b2dbdb065f51e14}\label{classdoris_1_1io_1_1_i_file_cache_a3f0b4c278cb19f9c2b2dbdb065f51e14}} 
\index{LRUFileCache@{LRUFileCache}!\_mutex@{\_mutex}}
\index{\_mutex@{\_mutex}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{\_mutex}{\_mutex}}
{\footnotesize\ttfamily std\+::mutex \+\_\+mutex\hspace{0.3cm}{\ttfamily [mutable]}, {\ttfamily [protected]}, {\ttfamily [inherited]}}

\mbox{\Hypertarget{classdoris_1_1io_1_1_i_file_cache_a243744aff6497bffe2dfde68e4b064bd}\label{classdoris_1_1io_1_1_i_file_cache_a243744aff6497bffe2dfde68e4b064bd}} 
\index{LRUFileCache@{LRUFileCache}!\_query\_map@{\_query\_map}}
\index{\_query\_map@{\_query\_map}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{\_query\_map}{\_query\_map}}
{\footnotesize\ttfamily \mbox{\hyperlink{classdoris_1_1io_1_1_i_file_cache_a18f35fffa11659535addfdd93902c7f4}{Query\+File\+Cache\+Context\+Map}} \+\_\+query\+\_\+map\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}

\mbox{\Hypertarget{classdoris_1_1io_1_1_i_file_cache_a8b3d22a40257298552eb609d18cb2219}\label{classdoris_1_1io_1_1_i_file_cache_a8b3d22a40257298552eb609d18cb2219}} 
\index{LRUFileCache@{LRUFileCache}!\_enable\_file\_cache\_query\_limit@{\_enable\_file\_cache\_query\_limit}}
\index{\_enable\_file\_cache\_query\_limit@{\_enable\_file\_cache\_query\_limit}!LRUFileCache@{LRUFileCache}}
\doxysubsubsection{\texorpdfstring{\_enable\_file\_cache\_query\_limit}{\_enable\_file\_cache\_query\_limit}}
{\footnotesize\ttfamily bool \+\_\+enable\+\_\+file\+\_\+cache\+\_\+query\+\_\+limit = config\+::enable\+\_\+file\+\_\+cache\+\_\+query\+\_\+limit\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



该类的文档由以下文件生成\+:\begin{DoxyCompactItemize}
\item 
/\+Users/dabowang/doris/be/src/io/cache/block/\mbox{\hyperlink{block__lru__file__cache_8h}{block\+\_\+lru\+\_\+file\+\_\+cache.\+h}}\item 
/\+Users/dabowang/doris/be/src/io/cache/block/\mbox{\hyperlink{block__lru__file__cache_8cpp}{block\+\_\+lru\+\_\+file\+\_\+cache.\+cpp}}\end{DoxyCompactItemize}
