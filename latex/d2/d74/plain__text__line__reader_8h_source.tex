\hypertarget{plain__text__line__reader_8h_source}{}\doxysection{plain\+\_\+text\+\_\+line\+\_\+reader.\+h}
\label{plain__text__line__reader_8h_source}\index{/Users/dabowang/be\_all/exec/plain\_text\_line\_reader.h@{/Users/dabowang/be\_all/exec/plain\_text\_line\_reader.h}}
\mbox{\hyperlink{plain__text__line__reader_8h}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Licensed\ to\ the\ Apache\ Software\ Foundation\ (ASF)\ under\ one}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ or\ more\ contributor\ license\ agreements.\ \ See\ the\ NOTICE\ file}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ distributed\ with\ this\ work\ for\ additional\ information}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ regarding\ copyright\ ownership.\ \ The\ ASF\ licenses\ this\ file}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ to\ you\ under\ the\ Apache\ License,\ Version\ 2.0\ (the}}
\DoxyCodeLine{00006\ \textcolor{comment}{//\ "{}License"{});\ you\ may\ not\ use\ this\ file\ except\ in\ compliance}}
\DoxyCodeLine{00007\ \textcolor{comment}{//\ with\ the\ License.\ \ You\ may\ obtain\ a\ copy\ of\ the\ License\ at}}
\DoxyCodeLine{00008\ \textcolor{comment}{//}}
\DoxyCodeLine{00009\ \textcolor{comment}{//\ \ \ http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{00010\ \textcolor{comment}{//}}
\DoxyCodeLine{00011\ \textcolor{comment}{//\ Unless\ required\ by\ applicable\ law\ or\ agreed\ to\ in\ writing,}}
\DoxyCodeLine{00012\ \textcolor{comment}{//\ software\ distributed\ under\ the\ License\ is\ distributed\ on\ an}}
\DoxyCodeLine{00013\ \textcolor{comment}{//\ "{}AS\ IS"{}\ BASIS,\ WITHOUT\ WARRANTIES\ OR\ CONDITIONS\ OF\ ANY}}
\DoxyCodeLine{00014\ \textcolor{comment}{//\ KIND,\ either\ express\ or\ implied.\ \ See\ the\ License\ for\ the}}
\DoxyCodeLine{00015\ \textcolor{comment}{//\ specific\ language\ governing\ permissions\ and\ limitations}}
\DoxyCodeLine{00016\ \textcolor{comment}{//\ under\ the\ License.}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{line__reader_8h}{exec/line\_reader.h}}"{}}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{runtime__profile_8h}{util/runtime\_profile.h}}"{}}}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacedoris}{doris}}\ \{}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00025\ \textcolor{keyword}{class\ }FileReader;}
\DoxyCodeLine{00026\ \textcolor{keyword}{class\ }Decompressor;}
\DoxyCodeLine{00027\ \textcolor{keyword}{class\ }Status;}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classdoris_1_1_plain_text_line_reader}{PlainTextLineReader}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classdoris_1_1_line_reader}{LineReader}}\ \{}
\DoxyCodeLine{00030\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00031\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_plain_text_line_reader}{PlainTextLineReader}}(\mbox{\hyperlink{classdoris_1_1_runtime_profile}{RuntimeProfile}}*\ profile,\ \mbox{\hyperlink{classdoris_1_1_file_reader}{FileReader}}*\ file\_reader,}
\DoxyCodeLine{00032\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_decompressor}{Decompressor}}*\ decompressor,\ \textcolor{keywordtype}{size\_t}\ length,}
\DoxyCodeLine{00033\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ line\_delimiter,\ \textcolor{keywordtype}{size\_t}\ line\_delimiter\_length);}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00035\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_plain_text_line_reader_afd013eb952fcb041e7bfac4b83f56b5f}{\string~PlainTextLineReader}}()\ \textcolor{keyword}{override};}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_plain_text_line_reader_a5f95ffed550ce0b7b4d3d7c53bf9ba76}{read\_line}}(\textcolor{keyword}{const}\ uint8\_t**\ ptr,\ \textcolor{keywordtype}{size\_t}*\ size,\ \textcolor{keywordtype}{bool}*\ eof)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1_plain_text_line_reader_a7008bca493d69ea65f12e0940f3a6886}{close}}()\ \textcolor{keyword}{override};}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00042\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1_plain_text_line_reader_ae870f50fe9de0dc4e72c1af3cfdd136f}{update\_eof}}();}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classdoris_1_1_plain_text_line_reader_ab8bf4e858fd6dc43d62ffc9c08732b74}{output\_buf\_read\_remaining}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdoris_1_1_plain_text_line_reader_a95903651a3daafb8be47476830f12e6f}{\_output\_buf\_limit}}\ -\/\ \mbox{\hyperlink{classdoris_1_1_plain_text_line_reader_a91d70c3b387c062a6a979347bf0e9c44}{\_output\_buf\_pos}};\ \}}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classdoris_1_1_plain_text_line_reader_aa490b8a86adc706ee8b27bb2f417f159}{input\_buf\_read\_remaining}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdoris_1_1_plain_text_line_reader_af273b300f4395fa17c6c3859a2b3314e}{\_input\_buf\_limit}}\ -\/\ \mbox{\hyperlink{classdoris_1_1_plain_text_line_reader_ad062e1de0195a6fa1930aced589f3c4b}{\_input\_buf\_pos}};\ \}}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1_plain_text_line_reader_ad9a5ec16d009cae2fc6d298db3bf8142}{done}}()\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdoris_1_1_plain_text_line_reader_a5d5a8f6094f26ce8c1a09ddf828db6fc}{\_file\_eof}}\ \&\&\ \mbox{\hyperlink{classdoris_1_1_plain_text_line_reader_ab8bf4e858fd6dc43d62ffc9c08732b74}{output\_buf\_read\_remaining}}()\ ==\ 0;\ \}}
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00050\ \ \ \ \ \textcolor{comment}{//\ find\ line\ delimiter\ from\ 'start'\ to\ 'start'\ +\ len,}}
\DoxyCodeLine{00051\ \ \ \ \ \textcolor{comment}{//\ return\ line\ delimiter\ pos\ if\ found,\ otherwise\ return\ nullptr.}}
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{comment}{//\ TODO:}}
\DoxyCodeLine{00053\ \ \ \ \ \textcolor{comment}{//\ \ save\ to\ positions\ of\ field\ separator}}
\DoxyCodeLine{00054\ \ \ \ \ uint8\_t*\ \mbox{\hyperlink{classdoris_1_1_plain_text_line_reader_afbec5c9e75118eea7f6ca492fd45becc}{update\_field\_pos\_and\_find\_line\_delimiter}}(\textcolor{keyword}{const}\ uint8\_t*\ start,\ \textcolor{keywordtype}{size\_t}\ len);}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00056\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1_plain_text_line_reader_ab20e52b22d75a65e22a7e7cc2f3b1c3b}{extend\_input\_buf}}();}
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1_plain_text_line_reader_ab4be3e7ee48b67016ff58c2674e42cf7}{extend\_output\_buf}}();}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00059\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00060\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_runtime_profile}{RuntimeProfile}}*\ \mbox{\hyperlink{classdoris_1_1_plain_text_line_reader_a2e859f47407c7a031f6c1e087775e510}{\_profile}};}
\DoxyCodeLine{00061\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_file_reader}{FileReader}}*\ \mbox{\hyperlink{classdoris_1_1_plain_text_line_reader_a1c36ceaecc7f19d42c7dc13fc95752d7}{\_file\_reader}};}
\DoxyCodeLine{00062\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_decompressor}{Decompressor}}*\ \mbox{\hyperlink{classdoris_1_1_plain_text_line_reader_a58beff1403a8761f785181e11106ea05}{\_decompressor}};}
\DoxyCodeLine{00063\ \ \ \ \ \textcolor{comment}{//\ the\ min\ length\ that\ should\ be\ read.}}
\DoxyCodeLine{00064\ \ \ \ \ \textcolor{comment}{//\ -\/1\ means\ endless(for\ stream\ load)}}
\DoxyCodeLine{00065\ \ \ \ \ \textcolor{comment}{//\ and\ only\ valid\ if\ the\ content\ is\ uncompressed}}
\DoxyCodeLine{00066\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classdoris_1_1_plain_text_line_reader_ad458623a8beefa72c9318fa1d49972ac}{\_min\_length}};}
\DoxyCodeLine{00067\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classdoris_1_1_plain_text_line_reader_ae130128954b795829f3c75b90a4b73be}{\_total\_read\_bytes}};}
\DoxyCodeLine{00068\ \ \ \ \ std::string\ \mbox{\hyperlink{classdoris_1_1_plain_text_line_reader_acada9f8a04db8554655059ec9adfd975}{\_line\_delimiter}};}
\DoxyCodeLine{00069\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classdoris_1_1_plain_text_line_reader_a0515fde348e7a1f3027fc2e066c30a38}{\_line\_delimiter\_length}};}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00071\ \ \ \ \ \textcolor{comment}{//\ save\ the\ data\ read\ from\ file\ reader}}
\DoxyCodeLine{00072\ \ \ \ \ uint8\_t*\ \mbox{\hyperlink{classdoris_1_1_plain_text_line_reader_aaa5d1885c6193e3ec6dd3773b99d72d5}{\_input\_buf}};}
\DoxyCodeLine{00073\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classdoris_1_1_plain_text_line_reader_a5a99501a0b355cfa4e7e01bee4498825}{\_input\_buf\_size}};}
\DoxyCodeLine{00074\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classdoris_1_1_plain_text_line_reader_ad062e1de0195a6fa1930aced589f3c4b}{\_input\_buf\_pos}};}
\DoxyCodeLine{00075\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classdoris_1_1_plain_text_line_reader_af273b300f4395fa17c6c3859a2b3314e}{\_input\_buf\_limit}};}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ \ \ \ \ \textcolor{comment}{//\ save\ the\ data\ decompressed\ from\ decompressor.}}
\DoxyCodeLine{00078\ \ \ \ \ uint8\_t*\ \mbox{\hyperlink{classdoris_1_1_plain_text_line_reader_af124090baf23e2f63ef26e7b8700390e}{\_output\_buf}};}
\DoxyCodeLine{00079\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classdoris_1_1_plain_text_line_reader_af4178d78c6c09c1dca66743d7b1dcfdf}{\_output\_buf\_size}};}
\DoxyCodeLine{00080\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classdoris_1_1_plain_text_line_reader_a91d70c3b387c062a6a979347bf0e9c44}{\_output\_buf\_pos}};}
\DoxyCodeLine{00081\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classdoris_1_1_plain_text_line_reader_a95903651a3daafb8be47476830f12e6f}{\_output\_buf\_limit}};}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00083\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1_plain_text_line_reader_a5d5a8f6094f26ce8c1a09ddf828db6fc}{\_file\_eof}};}
\DoxyCodeLine{00084\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1_plain_text_line_reader_ae5595017fd8e23981e3f562556998fc6}{\_eof}};}
\DoxyCodeLine{00085\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1_plain_text_line_reader_a05f886d6e84a0b603383a08ceb76e78d}{\_stream\_end}};}
\DoxyCodeLine{00086\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classdoris_1_1_plain_text_line_reader_aae4ebafb85f57833cdb11ce5fa0ff983}{\_more\_input\_bytes}};}
\DoxyCodeLine{00087\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classdoris_1_1_plain_text_line_reader_a795a0e0230da73613a9ec2a2f5cf9a3e}{\_more\_output\_bytes}};}
\DoxyCodeLine{00088\ }
\DoxyCodeLine{00089\ \ \ \ \ \textcolor{comment}{//\ Profile\ counters}}
\DoxyCodeLine{00090\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_runtime_profile_1_1_counter}{RuntimeProfile::Counter}}*\ \mbox{\hyperlink{classdoris_1_1_plain_text_line_reader_a34fb4311d101ecd39979774eeb63e5ec}{\_bytes\_read\_counter}};}
\DoxyCodeLine{00091\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_runtime_profile_1_1_counter}{RuntimeProfile::Counter}}*\ \mbox{\hyperlink{classdoris_1_1_plain_text_line_reader_a85c51feec28339bf062a62ef94784cb5}{\_read\_timer}};}
\DoxyCodeLine{00092\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_runtime_profile_1_1_counter}{RuntimeProfile::Counter}}*\ \mbox{\hyperlink{classdoris_1_1_plain_text_line_reader_ad9155fdfacda3a30de61599a41a235c5}{\_bytes\_decompress\_counter}};}
\DoxyCodeLine{00093\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_runtime_profile_1_1_counter}{RuntimeProfile::Counter}}*\ \mbox{\hyperlink{classdoris_1_1_plain_text_line_reader_a4fa7ec9d4aabb1535309b0073e4a7c2c}{\_decompress\_timer}};}
\DoxyCodeLine{00094\ \};}
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00096\ \}\ \textcolor{comment}{//\ namespace\ doris}}

\end{DoxyCode}
