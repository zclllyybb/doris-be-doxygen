\hypertarget{schema__change_8h_source}{}\doxysection{schema\+\_\+change.\+h}
\label{schema__change_8h_source}\index{/Users/dabowang/be\_all/olap/schema\_change.h@{/Users/dabowang/be\_all/olap/schema\_change.h}}
\mbox{\hyperlink{schema__change_8h}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Licensed\ to\ the\ Apache\ Software\ Foundation\ (ASF)\ under\ one}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ or\ more\ contributor\ license\ agreements.\ \ See\ the\ NOTICE\ file}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ distributed\ with\ this\ work\ for\ additional\ information}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ regarding\ copyright\ ownership.\ \ The\ ASF\ licenses\ this\ file}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ to\ you\ under\ the\ Apache\ License,\ Version\ 2.0\ (the}}
\DoxyCodeLine{00006\ \textcolor{comment}{//\ "{}License"{});\ you\ may\ not\ use\ this\ file\ except\ in\ compliance}}
\DoxyCodeLine{00007\ \textcolor{comment}{//\ with\ the\ License.\ \ You\ may\ obtain\ a\ copy\ of\ the\ License\ at}}
\DoxyCodeLine{00008\ \textcolor{comment}{//}}
\DoxyCodeLine{00009\ \textcolor{comment}{//\ \ \ http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{00010\ \textcolor{comment}{//}}
\DoxyCodeLine{00011\ \textcolor{comment}{//\ Unless\ required\ by\ applicable\ law\ or\ agreed\ to\ in\ writing,}}
\DoxyCodeLine{00012\ \textcolor{comment}{//\ software\ distributed\ under\ the\ License\ is\ distributed\ on\ an}}
\DoxyCodeLine{00013\ \textcolor{comment}{//\ "{}AS\ IS"{}\ BASIS,\ WITHOUT\ WARRANTIES\ OR\ CONDITIONS\ OF\ ANY}}
\DoxyCodeLine{00014\ \textcolor{comment}{//\ KIND,\ either\ express\ or\ implied.\ \ See\ the\ License\ for\ the}}
\DoxyCodeLine{00015\ \textcolor{comment}{//\ specific\ language\ governing\ permissions\ and\ limitations}}
\DoxyCodeLine{00016\ \textcolor{comment}{//\ under\ the\ License.}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{status_8h}{common/status.h}}"{}}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ "{}gen\_cpp/AgentService\_types.h"{}}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{column__mapping_8h}{olap/column\_mapping.h}}"{}}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{delete__handler_8h}{olap/delete\_handler.h}}"{}}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{rowset_8h}{olap/rowset/rowset.h}}"{}}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{rowset__writer_8h}{olap/rowset/rowset\_writer.h}}"{}}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{tablet_8h}{olap/tablet.h}}"{}}}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{column_8h}{vec/columns/column.h}}"{}}}
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{block_8h}{vec/core/block.h}}"{}}}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00030\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacedoris}{doris}}\ \{}
\DoxyCodeLine{00031\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classdoris_1_1_row_block_changer}{RowBlockChanger}}\ \{}
\DoxyCodeLine{00032\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00033\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_row_block_changer}{RowBlockChanger}}(\mbox{\hyperlink{namespacedoris_a9216ba4fd9b418b8808bfb91a407ea20}{TabletSchemaSPtr}}\ tablet\_schema,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdoris_1_1_delete_handler}{DeleteHandler}}*\ delete\_handler,}
\DoxyCodeLine{00034\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_descriptor_tbl}{DescriptorTbl}}\ desc\_tbl);}
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00036\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_row_block_changer_a12670a18ada0070984ad8984aa8e2b21}{\string~RowBlockChanger}}();}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ \ \ \ \ \mbox{\hyperlink{structdoris_1_1_column_mapping}{ColumnMapping}}*\ \mbox{\hyperlink{classdoris_1_1_row_block_changer_a544ffe0791fbe26c3c15438c8861723c}{get\_mutable\_column\_mapping}}(\textcolor{keywordtype}{size\_t}\ column\_index);}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00040\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_row_block_changer_a99943c3764aab4692656dd9dff62d26e}{change\_block}}(\mbox{\hyperlink{classdoris_1_1vectorized_1_1_block}{vectorized::Block}}*\ ref\_block,\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_block}{vectorized::Block}}*\ new\_block)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00043\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_row_block_changer_a51e680638fd8d01231a2b394924147b0}{\_check\_cast\_valid}}(\mbox{\hyperlink{namespacedoris_1_1vectorized_aa1d7b67012985a9197efd18f7dd48e51}{vectorized::ColumnPtr}}\ ref\_column,}
\DoxyCodeLine{00044\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedoris_1_1vectorized_aa1d7b67012985a9197efd18f7dd48e51}{vectorized::ColumnPtr}}\ new\_column)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{comment}{//\ @brief\ column-\/mapping\ specification\ of\ new\ schema}}
\DoxyCodeLine{00047\ \ \ \ \ \mbox{\hyperlink{namespacedoris_ac6a70f89e3ffebb1e772cd5becd6acf8}{SchemaMapping}}\ \mbox{\hyperlink{classdoris_1_1_row_block_changer_a3ce22e2d8b931e4c220e6e00012f33f2}{\_schema\_mapping}};}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00049\ \ \ \ \ \textcolor{comment}{//\ delete\ handler\ for\ filtering\ data\ which\ use\ specified\ in\ DELETE\_DATA}}
\DoxyCodeLine{00050\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdoris_1_1_delete_handler}{DeleteHandler}}*\ \mbox{\hyperlink{classdoris_1_1_row_block_changer_a5e3747e717897600f587d5e1db037c36}{\_delete\_handler}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00052\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_descriptor_tbl}{DescriptorTbl}}\ \mbox{\hyperlink{classdoris_1_1_row_block_changer_a76aac2dc7938c66a9ab1ab49547c104e}{\_desc\_tbl}};}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00054\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_row_block_changer_a81fae9b2c5e539eb8ee3dec755b8f1c7}{DISALLOW\_COPY\_AND\_ASSIGN}}(\mbox{\hyperlink{classdoris_1_1_row_block_changer}{RowBlockChanger}});}
\DoxyCodeLine{00055\ \};}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00057\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classdoris_1_1_schema_change}{SchemaChange}}\ \{}
\DoxyCodeLine{00058\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00059\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_schema_change_a35785f0793b749f203a3248d0b2365a3}{SchemaChange}}()\ :\ \mbox{\hyperlink{classdoris_1_1_schema_change_a435660ba2c88e4cc75c131a0465b959d}{\_filtered\_rows}}(0),\ \mbox{\hyperlink{classdoris_1_1_schema_change_a06b84d8f115f05c5d05aaa332fb6cf83}{\_merged\_rows}}(0)\ \{\}}
\DoxyCodeLine{00060\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{classdoris_1_1_schema_change_a7ab9489504ee3138e3563127bccb74ca}{\string~SchemaChange}}()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_schema_change_a78e3c3646a61f2617768b45127cce414}{process}}(\mbox{\hyperlink{namespacedoris_a4991717acc636b63fb85afa5cd3e02a1}{RowsetReaderSharedPtr}}\ rowset\_reader,\ \mbox{\hyperlink{classdoris_1_1_rowset_writer}{RowsetWriter}}*\ rowset\_writer,}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedoris_ad3e800b72ff04da97e09ccc723b2f8cf}{TabletSharedPtr}}\ new\_tablet,\ \mbox{\hyperlink{namespacedoris_ad3e800b72ff04da97e09ccc723b2f8cf}{TabletSharedPtr}}\ base\_tablet,}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedoris_a9216ba4fd9b418b8808bfb91a407ea20}{TabletSchemaSPtr}}\ base\_tablet\_schema)\ \{}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (rowset\_reader-\/>rowset()-\/>empty()\ ||\ rowset\_reader-\/>rowset()-\/>num\_rows()\ ==\ 0)\ \{}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{status_8h_a7f122d03731fbafe5f83de473538c567}{RETURN\_WITH\_WARN\_IF\_ERROR}}(}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rowset\_writer-\/>\mbox{\hyperlink{classdoris_1_1_rowset_writer_aa5a8afca4a0eff41fea00af55ebf3f8e}{flush}}(),\ Status::Error<ErrorCode::INVALID\_ARGUMENT>(),}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fmt::format(\textcolor{stringliteral}{"{}create\ empty\ version\ for\ schema\ change\ failed.\ version=\ \{\}-\/\{\}"{}},}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rowset\_writer-\/>\mbox{\hyperlink{classdoris_1_1_rowset_writer_ab3e8becb73a53e2f3c6de22c4bb9bbe7}{version}}().\mbox{\hyperlink{structdoris_1_1_version_a60646cb67795d4643f463d6678081989}{first}},\ rowset\_writer-\/>\mbox{\hyperlink{classdoris_1_1_rowset_writer_ab3e8becb73a53e2f3c6de22c4bb9bbe7}{version}}().\mbox{\hyperlink{structdoris_1_1_version_ad199717fb108e23c8a6e7d2c52c4aea8}{second}}));}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdoris_1_1_status_a6ec1a217f203269ab53d2290d602db24}{Status::OK}}();}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_schema_change_a435660ba2c88e4cc75c131a0465b959d}{\_filtered\_rows}}\ =\ 0;}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_schema_change_a06b84d8f115f05c5d05aaa332fb6cf83}{\_merged\_rows}}\ =\ 0;}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{status_8h_a85f7d0e774e15eb35b74f53264305e16}{RETURN\_IF\_ERROR}}(}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_schema_change_aea5b47411993669371db6080212b65c4}{\_inner\_process}}(rowset\_reader,\ rowset\_writer,\ new\_tablet,\ base\_tablet\_schema));}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_schema_change_a0fab415de155ba98c49651c9790c9696}{\_add\_filtered\_rows}}(rowset\_reader-\/>filtered\_rows());}
\DoxyCodeLine{00080\ }
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Check\ row\ num\ changes}}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (config::row\_nums\_check\ \&\&\ !\mbox{\hyperlink{classdoris_1_1_schema_change_a4807218cf5d0d48ac9c28a38acc121d3}{\_check\_row\_nums}}(rowset\_reader,\ *rowset\_writer))\ \{}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ Status::Error<ErrorCode::ALTER\_STATUS\_ERR>();}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00085\ }
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ LOG(INFO)\ <<\ \textcolor{stringliteral}{"{}all\ row\ nums.\ source\_rows="{}}\ <<\ rowset\_reader-\/>rowset()-\/>num\_rows()}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{},\ merged\_rows="{}}\ <<\ \mbox{\hyperlink{classdoris_1_1_schema_change_a535f347c1fe73c2166df6e29a30d8a70}{merged\_rows}}()\ <<\ \textcolor{stringliteral}{"{},\ filtered\_rows="{}}\ <<\ \mbox{\hyperlink{classdoris_1_1_schema_change_a116c9cd3bf664580b3591c1561907801}{filtered\_rows}}()}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{},\ new\_index\_rows="{}}\ <<\ rowset\_writer-\/>\mbox{\hyperlink{classdoris_1_1_rowset_writer_aa1e2558f988346fe1f3ff5cf91d1c80c}{num\_rows}}();}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdoris_1_1_status_a6ec1a217f203269ab53d2290d602db24}{Status::OK}}();}
\DoxyCodeLine{00090\ \ \ \ \ \}}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00092\ \ \ \ \ uint64\_t\ \mbox{\hyperlink{classdoris_1_1_schema_change_a116c9cd3bf664580b3591c1561907801}{filtered\_rows}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdoris_1_1_schema_change_a435660ba2c88e4cc75c131a0465b959d}{\_filtered\_rows}};\ \}}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ \ \ \ \ uint64\_t\ \mbox{\hyperlink{classdoris_1_1_schema_change_a535f347c1fe73c2166df6e29a30d8a70}{merged\_rows}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdoris_1_1_schema_change_a06b84d8f115f05c5d05aaa332fb6cf83}{\_merged\_rows}};\ \}}
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00096\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00097\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1_schema_change_a0fab415de155ba98c49651c9790c9696}{\_add\_filtered\_rows}}(uint64\_t\ \mbox{\hyperlink{classdoris_1_1_schema_change_a116c9cd3bf664580b3591c1561907801}{filtered\_rows}})\ \{\ \mbox{\hyperlink{classdoris_1_1_schema_change_a435660ba2c88e4cc75c131a0465b959d}{\_filtered\_rows}}\ +=\ \mbox{\hyperlink{classdoris_1_1_schema_change_a116c9cd3bf664580b3591c1561907801}{filtered\_rows}};\ \}}
\DoxyCodeLine{00098\ }
\DoxyCodeLine{00099\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1_schema_change_a88eadb24e7d7dd02572ec2d4a51cbe77}{\_add\_merged\_rows}}(uint64\_t\ \mbox{\hyperlink{classdoris_1_1_schema_change_a535f347c1fe73c2166df6e29a30d8a70}{merged\_rows}})\ \{\ \mbox{\hyperlink{classdoris_1_1_schema_change_a06b84d8f115f05c5d05aaa332fb6cf83}{\_merged\_rows}}\ +=\ \mbox{\hyperlink{classdoris_1_1_schema_change_a535f347c1fe73c2166df6e29a30d8a70}{merged\_rows}};\ \}}
\DoxyCodeLine{00100\ }
\DoxyCodeLine{00101\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_schema_change_aea5b47411993669371db6080212b65c4}{\_inner\_process}}(\mbox{\hyperlink{namespacedoris_a4991717acc636b63fb85afa5cd3e02a1}{RowsetReaderSharedPtr}}\ rowset\_reader,\ \mbox{\hyperlink{classdoris_1_1_rowset_writer}{RowsetWriter}}*\ rowset\_writer,}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedoris_ad3e800b72ff04da97e09ccc723b2f8cf}{TabletSharedPtr}}\ new\_tablet,\ \mbox{\hyperlink{namespacedoris_a9216ba4fd9b418b8808bfb91a407ea20}{TabletSchemaSPtr}}\ base\_tablet\_schema)\ \{}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ Status::NotSupported(\textcolor{stringliteral}{"{}inner\ process\ unsupported."{}});}
\DoxyCodeLine{00104\ \ \ \ \ \}}
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00106\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1_schema_change_a4807218cf5d0d48ac9c28a38acc121d3}{\_check\_row\_nums}}(\mbox{\hyperlink{namespacedoris_a4991717acc636b63fb85afa5cd3e02a1}{RowsetReaderSharedPtr}}\ reader,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdoris_1_1_rowset_writer}{RowsetWriter}}\&\ writer)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (reader-\/>rowset()-\/>num\_rows()\ !=\ writer.\mbox{\hyperlink{classdoris_1_1_rowset_writer_aa1e2558f988346fe1f3ff5cf91d1c80c}{num\_rows}}()\ +\ \mbox{\hyperlink{classdoris_1_1_schema_change_a06b84d8f115f05c5d05aaa332fb6cf83}{\_merged\_rows}}\ +\ \mbox{\hyperlink{classdoris_1_1_schema_change_a435660ba2c88e4cc75c131a0465b959d}{\_filtered\_rows}})\ \{}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ \ \ \ \ LOG(WARNING)\ <<\ \textcolor{stringliteral}{"{}fail\ to\ check\ row\ num!\ "{}}}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}source\_rows="{}}\ <<\ reader-\/>rowset()-\/>num\_rows()}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{},\ writer\ rows="{}}\ <<\ writer.\mbox{\hyperlink{classdoris_1_1_rowset_writer_aa1e2558f988346fe1f3ff5cf91d1c80c}{num\_rows}}()}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{},\ merged\_rows="{}}\ <<\ \mbox{\hyperlink{classdoris_1_1_schema_change_a535f347c1fe73c2166df6e29a30d8a70}{merged\_rows}}()}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{},\ filtered\_rows="{}}\ <<\ \mbox{\hyperlink{classdoris_1_1_schema_change_a116c9cd3bf664580b3591c1561907801}{filtered\_rows}}()}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{},\ new\_index\_rows="{}}\ <<\ writer.\mbox{\hyperlink{classdoris_1_1_rowset_writer_aa1e2558f988346fe1f3ff5cf91d1c80c}{num\_rows}}();}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00117\ \ \ \ \ \}}
\DoxyCodeLine{00118\ }
\DoxyCodeLine{00119\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00120\ \ \ \ \ uint64\_t\ \mbox{\hyperlink{classdoris_1_1_schema_change_a435660ba2c88e4cc75c131a0465b959d}{\_filtered\_rows}};}
\DoxyCodeLine{00121\ \ \ \ \ uint64\_t\ \mbox{\hyperlink{classdoris_1_1_schema_change_a06b84d8f115f05c5d05aaa332fb6cf83}{\_merged\_rows}};}
\DoxyCodeLine{00122\ \};}
\DoxyCodeLine{00123\ }
\DoxyCodeLine{00124\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classdoris_1_1_linked_schema_change}{LinkedSchemaChange}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classdoris_1_1_schema_change}{SchemaChange}}\ \{}
\DoxyCodeLine{00125\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00126\ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{classdoris_1_1_linked_schema_change_ae7675c3dbee32120f65523c20f3dbea4}{LinkedSchemaChange}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classdoris_1_1_row_block_changer}{RowBlockChanger}}\&\ row\_block\_changer)}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{classdoris_1_1_linked_schema_change_a5529cd1923a9d83446a66a931aa30bc5}{\_row\_block\_changer}}(row\_block\_changer)\ \{\}}
\DoxyCodeLine{00128\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_linked_schema_change_ab5c1993ece146ed330bb8123f633b799}{\string~LinkedSchemaChange}}()\ \textcolor{keyword}{override}\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00129\ }
\DoxyCodeLine{00130\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_linked_schema_change_a3da2dd115c5ed49f4a1d58419406f566}{process}}(\mbox{\hyperlink{namespacedoris_a4991717acc636b63fb85afa5cd3e02a1}{RowsetReaderSharedPtr}}\ rowset\_reader,\ \mbox{\hyperlink{classdoris_1_1_rowset_writer}{RowsetWriter}}*\ rowset\_writer,}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedoris_ad3e800b72ff04da97e09ccc723b2f8cf}{TabletSharedPtr}}\ new\_tablet,\ \mbox{\hyperlink{namespacedoris_ad3e800b72ff04da97e09ccc723b2f8cf}{TabletSharedPtr}}\ base\_tablet,}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedoris_a9216ba4fd9b418b8808bfb91a407ea20}{TabletSchemaSPtr}}\ base\_tablet\_schema)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00133\ }
\DoxyCodeLine{00134\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00135\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdoris_1_1_row_block_changer}{RowBlockChanger}}\&\ \mbox{\hyperlink{classdoris_1_1_linked_schema_change_a5529cd1923a9d83446a66a931aa30bc5}{\_row\_block\_changer}};}
\DoxyCodeLine{00136\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_linked_schema_change_a4d461d310943e9d036be5324d06735c0}{DISALLOW\_COPY\_AND\_ASSIGN}}(\mbox{\hyperlink{classdoris_1_1_linked_schema_change}{LinkedSchemaChange}});}
\DoxyCodeLine{00137\ \};}
\DoxyCodeLine{00138\ }
\DoxyCodeLine{00139\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classdoris_1_1_v_schema_change_directly}{VSchemaChangeDirectly}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classdoris_1_1_schema_change}{SchemaChange}}\ \{}
\DoxyCodeLine{00140\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00141\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_v_schema_change_directly_a97b4bf0f402cb791a3e92fa99ed88445}{VSchemaChangeDirectly}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classdoris_1_1_row_block_changer}{RowBlockChanger}}\&\ row\_block\_changer)\ :\ \mbox{\hyperlink{classdoris_1_1_v_schema_change_directly_a6692279ecf5e54f13d8932e4b0d7277e}{\_changer}}(row\_block\_changer)\ \{\}}
\DoxyCodeLine{00142\ }
\DoxyCodeLine{00143\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00144\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_v_schema_change_directly_a0d8656af3adfb25b565ff4c3e0fe9fc5}{\_inner\_process}}(\mbox{\hyperlink{namespacedoris_a4991717acc636b63fb85afa5cd3e02a1}{RowsetReaderSharedPtr}}\ rowset\_reader,\ \mbox{\hyperlink{classdoris_1_1_rowset_writer}{RowsetWriter}}*\ rowset\_writer,}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedoris_ad3e800b72ff04da97e09ccc723b2f8cf}{TabletSharedPtr}}\ new\_tablet,\ \mbox{\hyperlink{namespacedoris_a9216ba4fd9b418b8808bfb91a407ea20}{TabletSchemaSPtr}}\ base\_tablet\_schema)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00146\ }
\DoxyCodeLine{00147\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdoris_1_1_row_block_changer}{RowBlockChanger}}\&\ \mbox{\hyperlink{classdoris_1_1_v_schema_change_directly_a6692279ecf5e54f13d8932e4b0d7277e}{\_changer}};}
\DoxyCodeLine{00148\ \};}
\DoxyCodeLine{00149\ }
\DoxyCodeLine{00150\ \textcolor{comment}{//\ @breif\ schema\ change\ with\ sorting}}
\DoxyCodeLine{00151\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classdoris_1_1_v_schema_change_with_sorting}{VSchemaChangeWithSorting}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classdoris_1_1_schema_change}{SchemaChange}}\ \{}
\DoxyCodeLine{00152\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00153\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_v_schema_change_with_sorting}{VSchemaChangeWithSorting}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classdoris_1_1_row_block_changer}{RowBlockChanger}}\&\ row\_block\_changer,\ \textcolor{keywordtype}{size\_t}\ memory\_limitation);}
\DoxyCodeLine{00154\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_v_schema_change_with_sorting_a9485465bda49bff417c30013c312c62b}{\string~VSchemaChangeWithSorting}}()\ \textcolor{keyword}{override}\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00155\ }
\DoxyCodeLine{00156\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00157\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_v_schema_change_with_sorting_a0d8656af3adfb25b565ff4c3e0fe9fc5}{\_inner\_process}}(\mbox{\hyperlink{namespacedoris_a4991717acc636b63fb85afa5cd3e02a1}{RowsetReaderSharedPtr}}\ rowset\_reader,\ \mbox{\hyperlink{classdoris_1_1_rowset_writer}{RowsetWriter}}*\ rowset\_writer,}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedoris_ad3e800b72ff04da97e09ccc723b2f8cf}{TabletSharedPtr}}\ new\_tablet,\ \mbox{\hyperlink{namespacedoris_a9216ba4fd9b418b8808bfb91a407ea20}{TabletSchemaSPtr}}\ base\_tablet\_schema)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00159\ }
\DoxyCodeLine{00160\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_v_schema_change_with_sorting_a254a5e486aae18deda9378d8c6046ff9}{\_internal\_sorting}}(\textcolor{keyword}{const}\ std::vector<std::unique\_ptr<vectorized::Block>>\&\ blocks,}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structdoris_1_1_version}{Version}}\&\ temp\_delta\_versions,\ int64\_t\ oldest\_write\_timestamp,}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ int64\_t\ newest\_write\_timestamp,\ \mbox{\hyperlink{namespacedoris_ad3e800b72ff04da97e09ccc723b2f8cf}{TabletSharedPtr}}\ new\_tablet,}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ RowsetTypePB\ new\_rowset\_type,\ SegmentsOverlapPB\ segments\_overlap,}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedoris_a45a11d2c52e9b86e26ff0bb6d9c667d2}{RowsetSharedPtr}}*\ rowset);}
\DoxyCodeLine{00165\ }
\DoxyCodeLine{00166\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_v_schema_change_with_sorting_a572b14f05da72b0ad62ba76ab3cef526}{\_external\_sorting}}(std::vector<RowsetSharedPtr>\&\ src\_rowsets,\ \mbox{\hyperlink{classdoris_1_1_rowset_writer}{RowsetWriter}}*\ rowset\_writer,}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedoris_ad3e800b72ff04da97e09ccc723b2f8cf}{TabletSharedPtr}}\ new\_tablet);}
\DoxyCodeLine{00168\ }
\DoxyCodeLine{00169\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdoris_1_1_row_block_changer}{RowBlockChanger}}\&\ \mbox{\hyperlink{classdoris_1_1_v_schema_change_with_sorting_a6692279ecf5e54f13d8932e4b0d7277e}{\_changer}};}
\DoxyCodeLine{00170\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classdoris_1_1_v_schema_change_with_sorting_a58931b22871f368c6628c67c064e1814}{\_memory\_limitation}};}
\DoxyCodeLine{00171\ \ \ \ \ \mbox{\hyperlink{structdoris_1_1_version}{Version}}\ \mbox{\hyperlink{classdoris_1_1_v_schema_change_with_sorting_a6b651d17e3eca218ad4f42dcd79a77d5}{\_temp\_delta\_versions}};}
\DoxyCodeLine{00172\ \ \ \ \ std::unique\_ptr<MemTracker>\ \mbox{\hyperlink{classdoris_1_1_v_schema_change_with_sorting_a589c3f7fd9800e4fd09e03c9dd12d33f}{\_mem\_tracker}};}
\DoxyCodeLine{00173\ \};}
\DoxyCodeLine{00174\ }
\DoxyCodeLine{00175\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classdoris_1_1_schema_change_handler}{SchemaChangeHandler}}\ \{}
\DoxyCodeLine{00176\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00177\ \ \ \ \ \textcolor{comment}{//\ schema\ change\ v2,\ it\ will\ not\ set\ alter\ task\ in\ base\ tablet}}
\DoxyCodeLine{00178\ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_schema_change_handler_aa7f160dfe971788c9421c686a6988d9f}{process\_alter\_tablet\_v2}}(\textcolor{keyword}{const}\ TAlterTabletReqV2\&\ request);}
\DoxyCodeLine{00179\ }
\DoxyCodeLine{00180\ \ \ \ \ \textcolor{keyword}{static}\ std::unique\_ptr<SchemaChange>\ \mbox{\hyperlink{classdoris_1_1_schema_change_handler_aabac69293ce5085481024f77d0ceea19}{get\_sc\_procedure}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classdoris_1_1_row_block_changer}{RowBlockChanger}}\&\ rb\_changer,}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ sc\_sorting,\ \textcolor{keywordtype}{bool}\ sc\_directly)\ \{}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (sc\_sorting)\ \{}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::make\_unique<VSchemaChangeWithSorting>(}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rb\_changer,\ config::memory\_limitation\_per\_thread\_for\_schema\_change\_bytes);}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00186\ }
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (sc\_directly)\ \{}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::make\_unique<VSchemaChangeDirectly>(rb\_changer);}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00190\ }
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::make\_unique<LinkedSchemaChange>(rb\_changer);}
\DoxyCodeLine{00192\ \ \ \ \ \}}
\DoxyCodeLine{00193\ }
\DoxyCodeLine{00194\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1_schema_change_handler_aeab57dfc08a5dc6f39a4c73046fbe376}{tablet\_in\_converting}}(int64\_t\ tablet\_id);}
\DoxyCodeLine{00195\ }
\DoxyCodeLine{00196\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00197\ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_schema_change_handler_ac1589d821c47b67cda59adcdf8ec8373}{\_get\_versions\_to\_be\_changed}}(\mbox{\hyperlink{namespacedoris_ad3e800b72ff04da97e09ccc723b2f8cf}{TabletSharedPtr}}\ base\_tablet,}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<Version>*\ versions\_to\_be\_changed,}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedoris_a45a11d2c52e9b86e26ff0bb6d9c667d2}{RowsetSharedPtr}}*\ max\_rowset);}
\DoxyCodeLine{00200\ }
\DoxyCodeLine{00201\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structdoris_1_1_schema_change_handler_1_1_alter_materialized_view_param}{AlterMaterializedViewParam}}\ \{}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \ \ std::string\ \mbox{\hyperlink{structdoris_1_1_schema_change_handler_1_1_alter_materialized_view_param_a418a457a1123a2f29218bc0f252fe0fc}{column\_name}};}
\DoxyCodeLine{00203\ \ \ \ \ \ \ \ \ std::string\ \mbox{\hyperlink{structdoris_1_1_schema_change_handler_1_1_alter_materialized_view_param_afcb80bff340c0dfbe7c52e549e8b1ca3}{origin\_column\_name}};}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ std::string\ \mbox{\hyperlink{structdoris_1_1_schema_change_handler_1_1_alter_materialized_view_param_ae5757a8555e2811ef28594ac20cc3f83}{mv\_expr}};}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ std::shared\_ptr<TExpr>\ \mbox{\hyperlink{structdoris_1_1_schema_change_handler_1_1_alter_materialized_view_param_ad29fa28c6c07599122083a0f818acac9}{expr}};}
\DoxyCodeLine{00206\ \ \ \ \ \};}
\DoxyCodeLine{00207\ }
\DoxyCodeLine{00208\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structdoris_1_1_schema_change_handler_1_1_schema_change_params}{SchemaChangeParams}}\ \{}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \ \ AlterTabletType\ \mbox{\hyperlink{structdoris_1_1_schema_change_handler_1_1_schema_change_params_ab00b9c36a7c90b5dfc1129f6f3240cb4}{alter\_tablet\_type}};}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedoris_ad3e800b72ff04da97e09ccc723b2f8cf}{TabletSharedPtr}}\ \mbox{\hyperlink{structdoris_1_1_schema_change_handler_1_1_schema_change_params_a93fa663faf4c65fe6a165f60db5f95da}{base\_tablet}};}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedoris_ad3e800b72ff04da97e09ccc723b2f8cf}{TabletSharedPtr}}\ \mbox{\hyperlink{structdoris_1_1_schema_change_handler_1_1_schema_change_params_a0fdfd239dc1c8ff04adf08046383cb5c}{new\_tablet}};}
\DoxyCodeLine{00212\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedoris_a9216ba4fd9b418b8808bfb91a407ea20}{TabletSchemaSPtr}}\ \mbox{\hyperlink{structdoris_1_1_schema_change_handler_1_1_schema_change_params_a0c96588bc21d209c5b630554586b3f1e}{base\_tablet\_schema}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00213\ \ \ \ \ \ \ \ \ std::vector<RowsetReaderSharedPtr>\ \mbox{\hyperlink{structdoris_1_1_schema_change_handler_1_1_schema_change_params_ae7b666da41962d0caf0d0eca44948d38}{ref\_rowset\_readers}};}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_delete_handler}{DeleteHandler}}*\ \mbox{\hyperlink{structdoris_1_1_schema_change_handler_1_1_schema_change_params_ad0880837a6a439c3c8eb4f2d5d560a6d}{delete\_handler}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ std::unordered\_map<std::string,\ AlterMaterializedViewParam>\ \mbox{\hyperlink{structdoris_1_1_schema_change_handler_1_1_schema_change_params_a98f670d04bdcb1c402b3c58b50cb384b}{materialized\_params\_map}};}
\DoxyCodeLine{00216\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_descriptor_tbl}{DescriptorTbl}}*\ \mbox{\hyperlink{structdoris_1_1_schema_change_handler_1_1_schema_change_params_a04df63d24aa09eed9d11065c314630d9}{desc\_tbl}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_object_pool}{ObjectPool}}\ \mbox{\hyperlink{structdoris_1_1_schema_change_handler_1_1_schema_change_params_a3a5de7bd423fbc0afc4cf935c166ca6b}{pool}};}
\DoxyCodeLine{00218\ \ \ \ \ \};}
\DoxyCodeLine{00219\ }
\DoxyCodeLine{00220\ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_schema_change_handler_a70eb38465eb761d944f32619f780a563}{\_do\_process\_alter\_tablet\_v2}}(\textcolor{keyword}{const}\ TAlterTabletReqV2\&\ request);}
\DoxyCodeLine{00221\ }
\DoxyCodeLine{00222\ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_schema_change_handler_a9689b941d610d5024cf79821a4556d5d}{\_validate\_alter\_result}}(\mbox{\hyperlink{namespacedoris_ad3e800b72ff04da97e09ccc723b2f8cf}{TabletSharedPtr}}\ new\_tablet,}
\DoxyCodeLine{00223\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ TAlterTabletReqV2\&\ request);}
\DoxyCodeLine{00224\ }
\DoxyCodeLine{00225\ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_schema_change_handler_a4695eea517ee59a8ab9f7cf442c1ac24}{\_convert\_historical\_rowsets}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structdoris_1_1_schema_change_handler_1_1_schema_change_params}{SchemaChangeParams}}\&\ sc\_params);}
\DoxyCodeLine{00226\ }
\DoxyCodeLine{00227\ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_schema_change_handler_a158ac5f3db97560c7b015bf12f441693}{\_parse\_request}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structdoris_1_1_schema_change_handler_1_1_schema_change_params}{SchemaChangeParams}}\&\ sc\_params,\ \mbox{\hyperlink{classdoris_1_1_row_block_changer}{RowBlockChanger}}*\ rb\_changer,}
\DoxyCodeLine{00228\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}*\ sc\_sorting,\ \textcolor{keywordtype}{bool}*\ sc\_directly);}
\DoxyCodeLine{00229\ }
\DoxyCodeLine{00230\ \ \ \ \ \textcolor{comment}{//\ Initialization\ Settings\ for\ creating\ a\ default\ value}}
\DoxyCodeLine{00231\ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_schema_change_handler_a00c1ce1a96d782c6015a63dc129a9afc}{\_init\_column\_mapping}}(\mbox{\hyperlink{structdoris_1_1_column_mapping}{ColumnMapping}}*\ column\_mapping,}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdoris_1_1_tablet_column}{TabletColumn}}\&\ column\_schema,\ \textcolor{keyword}{const}\ std::string\&\ \mbox{\hyperlink{util_2types_8h_adae7202c63102b0934c3ac5be41b0dae}{value}});}
\DoxyCodeLine{00233\ }
\DoxyCodeLine{00234\ \ \ \ \ \textcolor{keyword}{static}\ std::shared\_mutex\ \mbox{\hyperlink{classdoris_1_1_schema_change_handler_a0829237c98eabf9ce37eeefa2226d65f}{\_mutex}};}
\DoxyCodeLine{00235\ \ \ \ \ \textcolor{keyword}{static}\ std::unordered\_set<int64\_t>\ \mbox{\hyperlink{classdoris_1_1_schema_change_handler_a8a0c7f254aac884273e0ca784caf4d22}{\_tablet\_ids\_in\_converting}};}
\DoxyCodeLine{00236\ \ \ \ \ \textcolor{keyword}{static}\ std::set<std::string>\ \mbox{\hyperlink{classdoris_1_1_schema_change_handler_abed4664d345e1c75816e318454c56304}{\_supported\_functions}};}
\DoxyCodeLine{00237\ \};}
\DoxyCodeLine{00238\ \}\ \textcolor{comment}{//\ namespace\ doris}}

\end{DoxyCode}
