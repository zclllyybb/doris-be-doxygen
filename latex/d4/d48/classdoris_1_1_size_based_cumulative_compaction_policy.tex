\hypertarget{classdoris_1_1_size_based_cumulative_compaction_policy}{}\doxysection{Size\+Based\+Cumulative\+Compaction\+Policy类 参考}
\label{classdoris_1_1_size_based_cumulative_compaction_policy}\index{SizeBasedCumulativeCompactionPolicy@{SizeBasedCumulativeCompactionPolicy}}


{\ttfamily \#include $<$cumulative\+\_\+compaction\+\_\+policy.\+h$>$}



类 Size\+Based\+Cumulative\+Compaction\+Policy 继承关系图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=246pt]{d9/d15/classdoris_1_1_size_based_cumulative_compaction_policy__inherit__graph}
\end{center}
\end{figure}


Size\+Based\+Cumulative\+Compaction\+Policy 的协作图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=246pt]{d8/d3e/classdoris_1_1_size_based_cumulative_compaction_policy__coll__graph}
\end{center}
\end{figure}
\doxysubsection*{Public 成员函数}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classdoris_1_1_size_based_cumulative_compaction_policy_a6f6c803a1211b4f6387029daef0e8bcd}{Size\+Based\+Cumulative\+Compaction\+Policy}} (int64\+\_\+t promotion\+\_\+size=config\+::compaction\+\_\+promotion\+\_\+size\+\_\+mbytes $\ast$1024 $\ast$1024, double promotion\+\_\+ratio=config\+::compaction\+\_\+promotion\+\_\+ratio, int64\+\_\+t promotion\+\_\+min\+\_\+size=config\+::compaction\+\_\+promotion\+\_\+min\+\_\+size\+\_\+mbytes $\ast$1024 $\ast$1024, int64\+\_\+t compaction\+\_\+min\+\_\+size=config\+::compaction\+\_\+min\+\_\+size\+\_\+mbytes $\ast$1024 $\ast$1024)
\item 
\mbox{\hyperlink{classdoris_1_1_size_based_cumulative_compaction_policy_ae2316d02f3da6baee8eb8e235931beec}{$\sim$\+Size\+Based\+Cumulative\+Compaction\+Policy}} ()
\begin{DoxyCompactList}\small\item\em Destructor function of \mbox{\hyperlink{classdoris_1_1_size_based_cumulative_compaction_policy}{Size\+Based\+Cumulative\+Compaction\+Policy}}. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classdoris_1_1_size_based_cumulative_compaction_policy_aa53788b20b707f9b68b93881c9a4a919}{calculate\+\_\+cumulative\+\_\+point}} (\mbox{\hyperlink{classdoris_1_1_tablet}{Tablet}} $\ast$tablet, const std\+::vector$<$ \mbox{\hyperlink{namespacedoris_a8e1aa733e7ffe7bd29887ebdf7c1303d}{Rowset\+Meta\+Shared\+Ptr}} $>$ \&all\+\_\+rowsets, int64\+\_\+t current\+\_\+cumulative\+\_\+point, int64\+\_\+t $\ast$cumulative\+\_\+point) override
\item 
int \mbox{\hyperlink{classdoris_1_1_size_based_cumulative_compaction_policy_a3220157fa77fd36edaea621cd1177956}{pick\+\_\+input\+\_\+rowsets}} (\mbox{\hyperlink{classdoris_1_1_tablet}{Tablet}} $\ast$tablet, const std\+::vector$<$ \mbox{\hyperlink{namespacedoris_a45a11d2c52e9b86e26ff0bb6d9c667d2}{Rowset\+Shared\+Ptr}} $>$ \&candidate\+\_\+rowsets, const int64\+\_\+t max\+\_\+compaction\+\_\+score, const int64\+\_\+t min\+\_\+compaction\+\_\+score, std\+::vector$<$ \mbox{\hyperlink{namespacedoris_a45a11d2c52e9b86e26ff0bb6d9c667d2}{Rowset\+Shared\+Ptr}} $>$ $\ast$input\+\_\+rowsets, \mbox{\hyperlink{structdoris_1_1_version}{Version}} $\ast$last\+\_\+delete\+\_\+version, size\+\_\+t $\ast$compaction\+\_\+score) override
\item 
void \mbox{\hyperlink{classdoris_1_1_size_based_cumulative_compaction_policy_a3523f47e95cab903b180e4fb310bd320}{update\+\_\+cumulative\+\_\+point}} (\mbox{\hyperlink{classdoris_1_1_tablet}{Tablet}} $\ast$tablet, const std\+::vector$<$ \mbox{\hyperlink{namespacedoris_a45a11d2c52e9b86e26ff0bb6d9c667d2}{Rowset\+Shared\+Ptr}} $>$ \&input\+\_\+rowsets, \mbox{\hyperlink{namespacedoris_a45a11d2c52e9b86e26ff0bb6d9c667d2}{Rowset\+Shared\+Ptr}} \+\_\+output\+\_\+rowset, \mbox{\hyperlink{structdoris_1_1_version}{Version}} \&last\+\_\+delete\+\_\+version) override
\item 
uint32\+\_\+t \mbox{\hyperlink{classdoris_1_1_size_based_cumulative_compaction_policy_ad5872f5d8ad6ff174d2335b6b0c387f7}{calc\+\_\+cumulative\+\_\+compaction\+\_\+score}} (\mbox{\hyperlink{classdoris_1_1_tablet}{Tablet}} $\ast$tablet) override
\item 
std\+::string \mbox{\hyperlink{classdoris_1_1_size_based_cumulative_compaction_policy_abf14a745a4908c83f69c87965fe8eb7e}{name}} () override
\begin{DoxyCompactList}\small\item\em Fetch cumulative policy name \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Private 成员函数}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{classdoris_1_1_size_based_cumulative_compaction_policy_a13f26d8beea5f4b9ad6f6e0b717c23f9}{\+\_\+calc\+\_\+promotion\+\_\+size}} (\mbox{\hyperlink{classdoris_1_1_tablet}{Tablet}} $\ast$tablet, \mbox{\hyperlink{namespacedoris_a8e1aa733e7ffe7bd29887ebdf7c1303d}{Rowset\+Meta\+Shared\+Ptr}} base\+\_\+rowset\+\_\+meta, int64\+\_\+t $\ast$promotion\+\_\+size)
\begin{DoxyCompactList}\small\item\em calculate promotion size using current base rowset meta size and promotion configs \end{DoxyCompactList}\item 
int64\+\_\+t \mbox{\hyperlink{classdoris_1_1_size_based_cumulative_compaction_policy_a4610bc7853aaa33fa9ab3439ec326e6e}{\+\_\+level\+\_\+size}} (const int64\+\_\+t size)
\item 
void \mbox{\hyperlink{classdoris_1_1_size_based_cumulative_compaction_policy_a57986a72871b3ea169aafa70a7fdb459}{\+\_\+refresh\+\_\+tablet\+\_\+promotion\+\_\+size}} (\mbox{\hyperlink{classdoris_1_1_tablet}{Tablet}} $\ast$tablet, int64\+\_\+t promotion\+\_\+size)
\begin{DoxyCompactList}\small\item\em when policy calculate cumulative\+\_\+compaction\+\_\+score, update promotion size at the same time \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Private 属性}
\begin{DoxyCompactItemize}
\item 
int64\+\_\+t \mbox{\hyperlink{classdoris_1_1_size_based_cumulative_compaction_policy_ab0aacd7b3f4b233215d59c92d24bb52b}{\+\_\+promotion\+\_\+size}}
\begin{DoxyCompactList}\small\item\em cumulative compaction promotion size, unit is byte. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classdoris_1_1_size_based_cumulative_compaction_policy_ad5d22fd7be985b18c3e1abbe3a502ad2}{\+\_\+promotion\+\_\+ratio}}
\begin{DoxyCompactList}\small\item\em cumulative compaction promotion ratio of base rowset total disk size. \end{DoxyCompactList}\item 
int64\+\_\+t \mbox{\hyperlink{classdoris_1_1_size_based_cumulative_compaction_policy_ac54e5ebc2e76be70b774e5b70585a7d5}{\+\_\+promotion\+\_\+min\+\_\+size}}
\begin{DoxyCompactList}\small\item\em cumulative compaction promotion min size, unit is byte. \end{DoxyCompactList}\item 
int64\+\_\+t \mbox{\hyperlink{classdoris_1_1_size_based_cumulative_compaction_policy_aaae2927346b7da3ba952be8d3a5aece7}{\+\_\+compaction\+\_\+min\+\_\+size}}
\begin{DoxyCompactList}\small\item\em lower bound size to do compaction compaction. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{详细描述}
Size\+Based cumulative compaction policy implementation. Size\+Based policy which derives \mbox{\hyperlink{classdoris_1_1_cumulative_compaction_policy}{Cumulative\+Compaction\+Policy}} is a optimized version of num based cumulative compaction policy. This policy also uses linear structure to compact rowsets. The cumulative rowsets can do compaction when they are in same level size. And when output rowset exceeds the promotion radio of base size or min promotion size, it will do base compaction. This policy is targeting the use cases requiring lower write amplification, trading off read amplification and space amplification. 

\doxysubsection{构造及析构函数说明}
\mbox{\Hypertarget{classdoris_1_1_size_based_cumulative_compaction_policy_a6f6c803a1211b4f6387029daef0e8bcd}\label{classdoris_1_1_size_based_cumulative_compaction_policy_a6f6c803a1211b4f6387029daef0e8bcd}} 
\index{SizeBasedCumulativeCompactionPolicy@{SizeBasedCumulativeCompactionPolicy}!SizeBasedCumulativeCompactionPolicy@{SizeBasedCumulativeCompactionPolicy}}
\index{SizeBasedCumulativeCompactionPolicy@{SizeBasedCumulativeCompactionPolicy}!SizeBasedCumulativeCompactionPolicy@{SizeBasedCumulativeCompactionPolicy}}
\doxysubsubsection{\texorpdfstring{SizeBasedCumulativeCompactionPolicy()}{SizeBasedCumulativeCompactionPolicy()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classdoris_1_1_size_based_cumulative_compaction_policy}{Size\+Based\+Cumulative\+Compaction\+Policy}} (\begin{DoxyParamCaption}\item[{int64\+\_\+t}]{promotion\+\_\+size = {\ttfamily config\+:\+:compaction\+\_\+promotion\+\_\+size\+\_\+mbytes~$\ast$~1024~$\ast$~1024},  }\item[{double}]{promotion\+\_\+ratio = {\ttfamily config\+:\+:compaction\+\_\+promotion\+\_\+ratio},  }\item[{int64\+\_\+t}]{promotion\+\_\+min\+\_\+size = {\ttfamily config\+:\+:compaction\+\_\+promotion\+\_\+min\+\_\+size\+\_\+mbytes~$\ast$~1024~$\ast$~1024},  }\item[{int64\+\_\+t}]{compaction\+\_\+min\+\_\+size = {\ttfamily config\+:\+:compaction\+\_\+min\+\_\+size\+\_\+mbytes~$\ast$~1024~$\ast$~1024} }\end{DoxyParamCaption})}

Constructor function of \mbox{\hyperlink{classdoris_1_1_size_based_cumulative_compaction_policy}{Size\+Based\+Cumulative\+Compaction\+Policy}}, it needs tablet pointer to access tablet method. param tablet, the shared pointer of tablet \mbox{\Hypertarget{classdoris_1_1_size_based_cumulative_compaction_policy_ae2316d02f3da6baee8eb8e235931beec}\label{classdoris_1_1_size_based_cumulative_compaction_policy_ae2316d02f3da6baee8eb8e235931beec}} 
\index{SizeBasedCumulativeCompactionPolicy@{SizeBasedCumulativeCompactionPolicy}!````~SizeBasedCumulativeCompactionPolicy@{$\sim$SizeBasedCumulativeCompactionPolicy}}
\index{````~SizeBasedCumulativeCompactionPolicy@{$\sim$SizeBasedCumulativeCompactionPolicy}!SizeBasedCumulativeCompactionPolicy@{SizeBasedCumulativeCompactionPolicy}}
\doxysubsubsection{\texorpdfstring{$\sim$SizeBasedCumulativeCompactionPolicy()}{~SizeBasedCumulativeCompactionPolicy()}}
{\footnotesize\ttfamily $\sim$\mbox{\hyperlink{classdoris_1_1_size_based_cumulative_compaction_policy}{Size\+Based\+Cumulative\+Compaction\+Policy}} (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Destructor function of \mbox{\hyperlink{classdoris_1_1_size_based_cumulative_compaction_policy}{Size\+Based\+Cumulative\+Compaction\+Policy}}. 



\doxysubsection{成员函数说明}
\mbox{\Hypertarget{classdoris_1_1_size_based_cumulative_compaction_policy_aa53788b20b707f9b68b93881c9a4a919}\label{classdoris_1_1_size_based_cumulative_compaction_policy_aa53788b20b707f9b68b93881c9a4a919}} 
\index{SizeBasedCumulativeCompactionPolicy@{SizeBasedCumulativeCompactionPolicy}!calculate\_cumulative\_point@{calculate\_cumulative\_point}}
\index{calculate\_cumulative\_point@{calculate\_cumulative\_point}!SizeBasedCumulativeCompactionPolicy@{SizeBasedCumulativeCompactionPolicy}}
\doxysubsubsection{\texorpdfstring{calculate\_cumulative\_point()}{calculate\_cumulative\_point()}}
{\footnotesize\ttfamily void calculate\+\_\+cumulative\+\_\+point (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classdoris_1_1_tablet}{Tablet}} $\ast$}]{tablet,  }\item[{const std\+::vector$<$ \mbox{\hyperlink{namespacedoris_a8e1aa733e7ffe7bd29887ebdf7c1303d}{Rowset\+Meta\+Shared\+Ptr}} $>$ \&}]{all\+\_\+rowsets,  }\item[{int64\+\_\+t}]{current\+\_\+cumulative\+\_\+point,  }\item[{int64\+\_\+t $\ast$}]{cumulative\+\_\+point }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

Size\+Based cumulative compaction policy implements calculate cumulative point function. When the first time the tablet does compact, this calculation is executed. Its main policy is to find first rowset which does not satisfied the promotion conditions. 

实现了 \mbox{\hyperlink{classdoris_1_1_cumulative_compaction_policy_adee345202204a9e65fb2340ca0d6db7f}{Cumulative\+Compaction\+Policy}}.

函数调用图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d4/d48/classdoris_1_1_size_based_cumulative_compaction_policy_aa53788b20b707f9b68b93881c9a4a919_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1_size_based_cumulative_compaction_policy_a3220157fa77fd36edaea621cd1177956}\label{classdoris_1_1_size_based_cumulative_compaction_policy_a3220157fa77fd36edaea621cd1177956}} 
\index{SizeBasedCumulativeCompactionPolicy@{SizeBasedCumulativeCompactionPolicy}!pick\_input\_rowsets@{pick\_input\_rowsets}}
\index{pick\_input\_rowsets@{pick\_input\_rowsets}!SizeBasedCumulativeCompactionPolicy@{SizeBasedCumulativeCompactionPolicy}}
\doxysubsubsection{\texorpdfstring{pick\_input\_rowsets()}{pick\_input\_rowsets()}}
{\footnotesize\ttfamily int pick\+\_\+input\+\_\+rowsets (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classdoris_1_1_tablet}{Tablet}} $\ast$}]{tablet,  }\item[{const std\+::vector$<$ \mbox{\hyperlink{namespacedoris_a45a11d2c52e9b86e26ff0bb6d9c667d2}{Rowset\+Shared\+Ptr}} $>$ \&}]{candidate\+\_\+rowsets,  }\item[{const int64\+\_\+t}]{max\+\_\+compaction\+\_\+score,  }\item[{const int64\+\_\+t}]{min\+\_\+compaction\+\_\+score,  }\item[{std\+::vector$<$ \mbox{\hyperlink{namespacedoris_a45a11d2c52e9b86e26ff0bb6d9c667d2}{Rowset\+Shared\+Ptr}} $>$ $\ast$}]{input\+\_\+rowsets,  }\item[{\mbox{\hyperlink{structdoris_1_1_version}{Version}} $\ast$}]{last\+\_\+delete\+\_\+version,  }\item[{size\+\_\+t $\ast$}]{compaction\+\_\+score }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

Size\+Based cumulative compaction policy implements pick input rowsets function. Its main policy is picking rowsets from candidate rowsets by comparing accumulative compaction\+\_\+score, max\+\_\+cumulative\+\_\+compaction\+\_\+num\+\_\+singleton\+\_\+deltas or checking whether there is delete version rowset, and choose those rowset in the same level to do cumulative compaction. 

实现了 \mbox{\hyperlink{classdoris_1_1_cumulative_compaction_policy_abe0974c008cdf58ba27952cdeff3f430}{Cumulative\+Compaction\+Policy}}.

函数调用图\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=340pt]{d4/d48/classdoris_1_1_size_based_cumulative_compaction_policy_a3220157fa77fd36edaea621cd1177956_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1_size_based_cumulative_compaction_policy_a3523f47e95cab903b180e4fb310bd320}\label{classdoris_1_1_size_based_cumulative_compaction_policy_a3523f47e95cab903b180e4fb310bd320}} 
\index{SizeBasedCumulativeCompactionPolicy@{SizeBasedCumulativeCompactionPolicy}!update\_cumulative\_point@{update\_cumulative\_point}}
\index{update\_cumulative\_point@{update\_cumulative\_point}!SizeBasedCumulativeCompactionPolicy@{SizeBasedCumulativeCompactionPolicy}}
\doxysubsubsection{\texorpdfstring{update\_cumulative\_point()}{update\_cumulative\_point()}}
{\footnotesize\ttfamily void update\+\_\+cumulative\+\_\+point (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classdoris_1_1_tablet}{Tablet}} $\ast$}]{tablet,  }\item[{const std\+::vector$<$ \mbox{\hyperlink{namespacedoris_a45a11d2c52e9b86e26ff0bb6d9c667d2}{Rowset\+Shared\+Ptr}} $>$ \&}]{input\+\_\+rowsets,  }\item[{\mbox{\hyperlink{namespacedoris_a45a11d2c52e9b86e26ff0bb6d9c667d2}{Rowset\+Shared\+Ptr}}}]{\+\_\+output\+\_\+rowset,  }\item[{\mbox{\hyperlink{structdoris_1_1_version}{Version}} \&}]{last\+\_\+delete\+\_\+version }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

Size\+Based cumulative compaction policy implements update cumulative point function. Its main policy is judging the output rowset size whether satisfied the promotion size. If it satisfied, this policy will update the cumulative point. 

实现了 \mbox{\hyperlink{classdoris_1_1_cumulative_compaction_policy_a4b34b6f469138cd6cb7209e5beae4ebb}{Cumulative\+Compaction\+Policy}}.

函数调用图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d4/d48/classdoris_1_1_size_based_cumulative_compaction_policy_a3523f47e95cab903b180e4fb310bd320_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1_size_based_cumulative_compaction_policy_ad5872f5d8ad6ff174d2335b6b0c387f7}\label{classdoris_1_1_size_based_cumulative_compaction_policy_ad5872f5d8ad6ff174d2335b6b0c387f7}} 
\index{SizeBasedCumulativeCompactionPolicy@{SizeBasedCumulativeCompactionPolicy}!calc\_cumulative\_compaction\_score@{calc\_cumulative\_compaction\_score}}
\index{calc\_cumulative\_compaction\_score@{calc\_cumulative\_compaction\_score}!SizeBasedCumulativeCompactionPolicy@{SizeBasedCumulativeCompactionPolicy}}
\doxysubsubsection{\texorpdfstring{calc\_cumulative\_compaction\_score()}{calc\_cumulative\_compaction\_score()}}
{\footnotesize\ttfamily uint32\+\_\+t calc\+\_\+cumulative\+\_\+compaction\+\_\+score (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classdoris_1_1_tablet}{Tablet}} $\ast$}]{tablet }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}

Num based cumulative compaction policy implements calc cumulative compaction score function. Its main policy is calculating the accumulative compaction score after current cumulative\+\_\+point in tablet. 

实现了 \mbox{\hyperlink{classdoris_1_1_cumulative_compaction_policy_a4d8b17498731ea3034346b42a8a4e890}{Cumulative\+Compaction\+Policy}}.

函数调用图\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d4/d48/classdoris_1_1_size_based_cumulative_compaction_policy_ad5872f5d8ad6ff174d2335b6b0c387f7_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1_size_based_cumulative_compaction_policy_abf14a745a4908c83f69c87965fe8eb7e}\label{classdoris_1_1_size_based_cumulative_compaction_policy_abf14a745a4908c83f69c87965fe8eb7e}} 
\index{SizeBasedCumulativeCompactionPolicy@{SizeBasedCumulativeCompactionPolicy}!name@{name}}
\index{name@{name}!SizeBasedCumulativeCompactionPolicy@{SizeBasedCumulativeCompactionPolicy}}
\doxysubsubsection{\texorpdfstring{name()}{name()}}
{\footnotesize\ttfamily std\+::string name (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Fetch cumulative policy name 



实现了 \mbox{\hyperlink{classdoris_1_1_cumulative_compaction_policy_a338331e32e424c27f3f50d6435b0c7da}{Cumulative\+Compaction\+Policy}}.

\mbox{\Hypertarget{classdoris_1_1_size_based_cumulative_compaction_policy_a13f26d8beea5f4b9ad6f6e0b717c23f9}\label{classdoris_1_1_size_based_cumulative_compaction_policy_a13f26d8beea5f4b9ad6f6e0b717c23f9}} 
\index{SizeBasedCumulativeCompactionPolicy@{SizeBasedCumulativeCompactionPolicy}!\_calc\_promotion\_size@{\_calc\_promotion\_size}}
\index{\_calc\_promotion\_size@{\_calc\_promotion\_size}!SizeBasedCumulativeCompactionPolicy@{SizeBasedCumulativeCompactionPolicy}}
\doxysubsubsection{\texorpdfstring{\_calc\_promotion\_size()}{\_calc\_promotion\_size()}}
{\footnotesize\ttfamily void \+\_\+calc\+\_\+promotion\+\_\+size (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classdoris_1_1_tablet}{Tablet}} $\ast$}]{tablet,  }\item[{\mbox{\hyperlink{namespacedoris_a8e1aa733e7ffe7bd29887ebdf7c1303d}{Rowset\+Meta\+Shared\+Ptr}}}]{base\+\_\+rowset\+\_\+meta,  }\item[{int64\+\_\+t $\ast$}]{promotion\+\_\+size }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



calculate promotion size using current base rowset meta size and promotion configs 

函数调用图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d4/d48/classdoris_1_1_size_based_cumulative_compaction_policy_a13f26d8beea5f4b9ad6f6e0b717c23f9_cgraph}
\end{center}
\end{figure}
这是这个函数的调用关系图\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d4/d48/classdoris_1_1_size_based_cumulative_compaction_policy_a13f26d8beea5f4b9ad6f6e0b717c23f9_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1_size_based_cumulative_compaction_policy_a4610bc7853aaa33fa9ab3439ec326e6e}\label{classdoris_1_1_size_based_cumulative_compaction_policy_a4610bc7853aaa33fa9ab3439ec326e6e}} 
\index{SizeBasedCumulativeCompactionPolicy@{SizeBasedCumulativeCompactionPolicy}!\_level\_size@{\_level\_size}}
\index{\_level\_size@{\_level\_size}!SizeBasedCumulativeCompactionPolicy@{SizeBasedCumulativeCompactionPolicy}}
\doxysubsubsection{\texorpdfstring{\_level\_size()}{\_level\_size()}}
{\footnotesize\ttfamily int64\+\_\+t \+\_\+level\+\_\+size (\begin{DoxyParamCaption}\item[{const int64\+\_\+t}]{size }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}

calculate the disk size belong to which level, the level is divide by power of 2 between compaction\+\_\+promotion\+\_\+size\+\_\+mbytes and 1KB 这是这个函数的调用关系图\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=324pt]{d4/d48/classdoris_1_1_size_based_cumulative_compaction_policy_a4610bc7853aaa33fa9ab3439ec326e6e_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1_size_based_cumulative_compaction_policy_a57986a72871b3ea169aafa70a7fdb459}\label{classdoris_1_1_size_based_cumulative_compaction_policy_a57986a72871b3ea169aafa70a7fdb459}} 
\index{SizeBasedCumulativeCompactionPolicy@{SizeBasedCumulativeCompactionPolicy}!\_refresh\_tablet\_promotion\_size@{\_refresh\_tablet\_promotion\_size}}
\index{\_refresh\_tablet\_promotion\_size@{\_refresh\_tablet\_promotion\_size}!SizeBasedCumulativeCompactionPolicy@{SizeBasedCumulativeCompactionPolicy}}
\doxysubsubsection{\texorpdfstring{\_refresh\_tablet\_promotion\_size()}{\_refresh\_tablet\_promotion\_size()}}
{\footnotesize\ttfamily void \+\_\+refresh\+\_\+tablet\+\_\+promotion\+\_\+size (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classdoris_1_1_tablet}{Tablet}} $\ast$}]{tablet,  }\item[{int64\+\_\+t}]{promotion\+\_\+size }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



when policy calculate cumulative\+\_\+compaction\+\_\+score, update promotion size at the same time 

函数调用图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d4/d48/classdoris_1_1_size_based_cumulative_compaction_policy_a57986a72871b3ea169aafa70a7fdb459_cgraph}
\end{center}
\end{figure}
这是这个函数的调用关系图\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d4/d48/classdoris_1_1_size_based_cumulative_compaction_policy_a57986a72871b3ea169aafa70a7fdb459_icgraph}
\end{center}
\end{figure}


\doxysubsection{类成员变量说明}
\mbox{\Hypertarget{classdoris_1_1_size_based_cumulative_compaction_policy_ab0aacd7b3f4b233215d59c92d24bb52b}\label{classdoris_1_1_size_based_cumulative_compaction_policy_ab0aacd7b3f4b233215d59c92d24bb52b}} 
\index{SizeBasedCumulativeCompactionPolicy@{SizeBasedCumulativeCompactionPolicy}!\_promotion\_size@{\_promotion\_size}}
\index{\_promotion\_size@{\_promotion\_size}!SizeBasedCumulativeCompactionPolicy@{SizeBasedCumulativeCompactionPolicy}}
\doxysubsubsection{\texorpdfstring{\_promotion\_size}{\_promotion\_size}}
{\footnotesize\ttfamily int64\+\_\+t \+\_\+promotion\+\_\+size\hspace{0.3cm}{\ttfamily [private]}}



cumulative compaction promotion size, unit is byte. 

\mbox{\Hypertarget{classdoris_1_1_size_based_cumulative_compaction_policy_ad5d22fd7be985b18c3e1abbe3a502ad2}\label{classdoris_1_1_size_based_cumulative_compaction_policy_ad5d22fd7be985b18c3e1abbe3a502ad2}} 
\index{SizeBasedCumulativeCompactionPolicy@{SizeBasedCumulativeCompactionPolicy}!\_promotion\_ratio@{\_promotion\_ratio}}
\index{\_promotion\_ratio@{\_promotion\_ratio}!SizeBasedCumulativeCompactionPolicy@{SizeBasedCumulativeCompactionPolicy}}
\doxysubsubsection{\texorpdfstring{\_promotion\_ratio}{\_promotion\_ratio}}
{\footnotesize\ttfamily double \+\_\+promotion\+\_\+ratio\hspace{0.3cm}{\ttfamily [private]}}



cumulative compaction promotion ratio of base rowset total disk size. 

\mbox{\Hypertarget{classdoris_1_1_size_based_cumulative_compaction_policy_ac54e5ebc2e76be70b774e5b70585a7d5}\label{classdoris_1_1_size_based_cumulative_compaction_policy_ac54e5ebc2e76be70b774e5b70585a7d5}} 
\index{SizeBasedCumulativeCompactionPolicy@{SizeBasedCumulativeCompactionPolicy}!\_promotion\_min\_size@{\_promotion\_min\_size}}
\index{\_promotion\_min\_size@{\_promotion\_min\_size}!SizeBasedCumulativeCompactionPolicy@{SizeBasedCumulativeCompactionPolicy}}
\doxysubsubsection{\texorpdfstring{\_promotion\_min\_size}{\_promotion\_min\_size}}
{\footnotesize\ttfamily int64\+\_\+t \+\_\+promotion\+\_\+min\+\_\+size\hspace{0.3cm}{\ttfamily [private]}}



cumulative compaction promotion min size, unit is byte. 

\mbox{\Hypertarget{classdoris_1_1_size_based_cumulative_compaction_policy_aaae2927346b7da3ba952be8d3a5aece7}\label{classdoris_1_1_size_based_cumulative_compaction_policy_aaae2927346b7da3ba952be8d3a5aece7}} 
\index{SizeBasedCumulativeCompactionPolicy@{SizeBasedCumulativeCompactionPolicy}!\_compaction\_min\_size@{\_compaction\_min\_size}}
\index{\_compaction\_min\_size@{\_compaction\_min\_size}!SizeBasedCumulativeCompactionPolicy@{SizeBasedCumulativeCompactionPolicy}}
\doxysubsubsection{\texorpdfstring{\_compaction\_min\_size}{\_compaction\_min\_size}}
{\footnotesize\ttfamily int64\+\_\+t \+\_\+compaction\+\_\+min\+\_\+size\hspace{0.3cm}{\ttfamily [private]}}



lower bound size to do compaction compaction. 



该类的文档由以下文件生成\+:\begin{DoxyCompactItemize}
\item 
/\+Users/dabowang/doris/be/src/olap/\mbox{\hyperlink{cumulative__compaction__policy_8h}{cumulative\+\_\+compaction\+\_\+policy.\+h}}\item 
/\+Users/dabowang/doris/be/src/olap/\mbox{\hyperlink{cumulative__compaction__policy_8cpp}{cumulative\+\_\+compaction\+\_\+policy.\+cpp}}\end{DoxyCompactItemize}
