\hypertarget{vscanner_8h_source}{}\doxysection{vscanner.\+h}
\label{vscanner_8h_source}\index{/Users/dabowang/doris/be/src/vec/exec/scan/vscanner.h@{/Users/dabowang/doris/be/src/vec/exec/scan/vscanner.h}}
\mbox{\hyperlink{vscanner_8h}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Licensed\ to\ the\ Apache\ Software\ Foundation\ (ASF)\ under\ one}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ or\ more\ contributor\ license\ agreements.\ \ See\ the\ NOTICE\ file}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ distributed\ with\ this\ work\ for\ additional\ information}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ regarding\ copyright\ ownership.\ \ The\ ASF\ licenses\ this\ file}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ to\ you\ under\ the\ Apache\ License,\ Version\ 2.0\ (the}}
\DoxyCodeLine{00006\ \textcolor{comment}{//\ "{}License"{});\ you\ may\ not\ use\ this\ file\ except\ in\ compliance}}
\DoxyCodeLine{00007\ \textcolor{comment}{//\ with\ the\ License.\ \ You\ may\ obtain\ a\ copy\ of\ the\ License\ at}}
\DoxyCodeLine{00008\ \textcolor{comment}{//}}
\DoxyCodeLine{00009\ \textcolor{comment}{//\ \ \ http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{00010\ \textcolor{comment}{//}}
\DoxyCodeLine{00011\ \textcolor{comment}{//\ Unless\ required\ by\ applicable\ law\ or\ agreed\ to\ in\ writing,}}
\DoxyCodeLine{00012\ \textcolor{comment}{//\ software\ distributed\ under\ the\ License\ is\ distributed\ on\ an}}
\DoxyCodeLine{00013\ \textcolor{comment}{//\ "{}AS\ IS"{}\ BASIS,\ WITHOUT\ WARRANTIES\ OR\ CONDITIONS\ OF\ ANY}}
\DoxyCodeLine{00014\ \textcolor{comment}{//\ KIND,\ either\ express\ or\ implied.\ \ See\ the\ License\ for\ the}}
\DoxyCodeLine{00015\ \textcolor{comment}{//\ specific\ language\ governing\ permissions\ and\ limitations}}
\DoxyCodeLine{00016\ \textcolor{comment}{//\ under\ the\ License.}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{status_8h}{common/status.h}}"{}}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{tablet_8h}{olap/tablet.h}}"{}}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{runtime__state_8h}{runtime/runtime\_state.h}}"{}}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{vexpr__context_8h}{vec/exprs/vexpr\_context.h}}"{}}}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00025\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacedoris_1_1vectorized}{doris::vectorized}}\ \{}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00027\ \textcolor{keyword}{class\ }Block;}
\DoxyCodeLine{00028\ \textcolor{keyword}{class\ }VScanNode;}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00030\ \textcolor{comment}{//\ Counter\ for\ load}}
\DoxyCodeLine{00031\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structdoris_1_1vectorized_1_1_scanner_counter}{ScannerCounter}}\ \{}
\DoxyCodeLine{00032\ \ \ \ \ \mbox{\hyperlink{structdoris_1_1vectorized_1_1_scanner_counter_a101beafbe1ef025eb954666664080587}{ScannerCounter}}()\ :\ \mbox{\hyperlink{structdoris_1_1vectorized_1_1_scanner_counter_a2dac864b720ca1d8783819f00167c30b}{num\_rows\_filtered}}(0),\ \mbox{\hyperlink{structdoris_1_1vectorized_1_1_scanner_counter_ae00f9b50e72b51963184cb54dbe01a1c}{num\_rows\_unselected}}(0)\ \{\}}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00034\ \ \ \ \ int64\_t\ \mbox{\hyperlink{structdoris_1_1vectorized_1_1_scanner_counter_a2dac864b720ca1d8783819f00167c30b}{num\_rows\_filtered}};\ \ \ \textcolor{comment}{//\ unqualified\ rows\ (unmatched\ the\ dest\ schema,\ or\ no\ partition)}}
\DoxyCodeLine{00035\ \ \ \ \ int64\_t\ \mbox{\hyperlink{structdoris_1_1vectorized_1_1_scanner_counter_ae00f9b50e72b51963184cb54dbe01a1c}{num\_rows\_unselected}};\ \textcolor{comment}{//\ rows\ filtered\ by\ predicates}}
\DoxyCodeLine{00036\ \};}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner}{VScanner}}\ \{}
\DoxyCodeLine{00039\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00040\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner}{VScanner}}(\mbox{\hyperlink{classdoris_1_1_runtime_state}{RuntimeState}}*\ state,\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scan_node}{VScanNode}}*\ parent,\ int64\_t\ limit,\ \mbox{\hyperlink{classdoris_1_1_runtime_profile}{RuntimeProfile}}*\ profile);}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a497e72ceeb8e333d1d8ace99c1be1434}{\string~VScanner}}()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a3af5355f1599fdfced70447f8d2304a7}{init}}()\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdoris_1_1_status_a6ec1a217f203269ab53d2290d602db24}{Status::OK}}();\ \}}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a65e65b909dc127b2442ecffc81376cb0}{open}}(\mbox{\hyperlink{classdoris_1_1_runtime_state}{RuntimeState}}*\ state)\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdoris_1_1_status_a6ec1a217f203269ab53d2290d602db24}{Status::OK}}();\ \}}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_ab5b6bf7e5ccdce88b1102a5d28fc9d4c}{get\_block}}(\mbox{\hyperlink{classdoris_1_1_runtime_state}{RuntimeState}}*\ state,\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_block}{Block}}*\ block,\ \textcolor{keywordtype}{bool}*\ eos);}
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00050\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a4cd0274c89d380200b7a409715948fc3}{close}}(\mbox{\hyperlink{classdoris_1_1_runtime_state}{RuntimeState}}*\ state);}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00052\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00053\ \ \ \ \ \textcolor{comment}{//\ Subclass\ should\ implement\ this\ to\ return\ data.}}
\DoxyCodeLine{00054\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a47bd44bd1136255880fb96b797abfcbe}{\_get\_block\_impl}}(\mbox{\hyperlink{classdoris_1_1_runtime_state}{RuntimeState}}*\ state,\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_block}{Block}}*\ block,\ \textcolor{keywordtype}{bool}*\ eof)\ =\ 0;}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00056\ \ \ \ \ \textcolor{comment}{//\ Update\ the\ counters\ before\ closing\ this\ scanner}}
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_afca0293718d99e7a8acbdb6eb6fb54a0}{\_update\_counters\_before\_close}}();}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00059\ \ \ \ \ \textcolor{comment}{//\ Filter\ the\ output\ block\ finally.}}
\DoxyCodeLine{00060\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_ab4a0fc4f8baa2f00eb07d29ca7ddf6b4}{\_filter\_output\_block}}(\mbox{\hyperlink{classdoris_1_1vectorized_1_1_block}{Block}}*\ block);}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ \ \ \ \ \textcolor{comment}{//\ Not\ virtual,\ all\ child\ will\ call\ this\ method\ explictly}}
\DoxyCodeLine{00063\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_aaf47805e980854a8e638615cb968169c}{prepare}}(\mbox{\hyperlink{classdoris_1_1_runtime_state}{RuntimeState}}*\ state,\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_expr_context}{VExprContext}}**\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a4f676cf49d71e332ba4eb0ef5165bc36}{vconjunct\_ctx\_ptr}});}
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00065\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00066\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scan_node}{VScanNode}}*\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_aaf3a58ca6411c0fb05c0733fc59203da}{get\_parent}}()\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a7ab2d932607871b1b47e15dc2e1c4f3c}{\_parent}};\ \}}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00068\ \ \ \ \ int64\_t\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a75094ca8e57ed97bb32647a4b2603e97}{get\_time\_cost\_ns}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a7edf004281e85f055b8ac92cfd0be479}{\_per\_scanner\_timer}};\ \}}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00070\ \ \ \ \ int64\_t\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a649381a5a31a94ae9d6a53ff68b35b4d}{get\_rows\_read}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a6ad0181a2c59286aff05d311b0065576}{\_num\_rows\_read}};\ \}}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00072\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_ab05eb89684c22f115becfd5c05753bd4}{is\_init}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a9542b3368055eb7fb0bf36fc2deea1f3}{\_is\_init}};\ \}}
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00074\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a9afa1f696cb60266cade8927467d405f}{try\_append\_late\_arrival\_runtime\_filter}}();}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00076\ \ \ \ \ \textcolor{comment}{//\ Call\ start\_wait\_worker\_timer()\ when\ submit\ the\ scanner\ to\ the\ thread\ pool.}}
\DoxyCodeLine{00077\ \ \ \ \ \textcolor{comment}{//\ And\ call\ update\_wait\_worker\_timer()\ when\ it\ is\ actually\ being\ executed.}}
\DoxyCodeLine{00078\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_ad2c1163c542f93aedb8c66e648786485}{start\_wait\_worker\_timer}}()\ \{}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a8ad6c871deec1b8bfe903647b4898a8d}{\_watch}}.\mbox{\hyperlink{classdoris_1_1_custom_stop_watch_aaf1b1c263c89ed4ea99db7a979daa30a}{reset}}();}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a8ad6c871deec1b8bfe903647b4898a8d}{\_watch}}.\mbox{\hyperlink{classdoris_1_1_custom_stop_watch_a60de64d75454385b23995437f1d72669}{start}}();}
\DoxyCodeLine{00081\ \ \ \ \ \}}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00083\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_ae68bbbd30aaa6e998a4a898ed3ed18f0}{start\_scan\_cpu\_timer}}()\ \{}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a60a213bcd52235bd182a4634a96c215f}{\_cpu\_watch}}.\mbox{\hyperlink{classdoris_1_1_custom_stop_watch_aaf1b1c263c89ed4ea99db7a979daa30a}{reset}}();}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a60a213bcd52235bd182a4634a96c215f}{\_cpu\_watch}}.\mbox{\hyperlink{classdoris_1_1_custom_stop_watch_a60de64d75454385b23995437f1d72669}{start}}();}
\DoxyCodeLine{00086\ \ \ \ \ \}}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00088\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a0fb37e98b42d14ddceabc301e31070d4}{update\_wait\_worker\_timer}}()\ \{\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a33435759d45eef5a6031999aa2dbd53c}{\_scanner\_wait\_worker\_timer}}\ +=\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a8ad6c871deec1b8bfe903647b4898a8d}{\_watch}}.\mbox{\hyperlink{classdoris_1_1_custom_stop_watch_adcda5684f125d03f01912ee2b400fd89}{elapsed\_time}}();\ \}}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00090\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_abfaba6326d32d8f438db6ecc3758e012}{update\_scan\_cpu\_timer}}()\ \{\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_ab4a8ce353a203cd32c1b021d230769c4}{\_scan\_cpu\_timer}}\ +=\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a60a213bcd52235bd182a4634a96c215f}{\_cpu\_watch}}.\mbox{\hyperlink{classdoris_1_1_custom_stop_watch_adcda5684f125d03f01912ee2b400fd89}{elapsed\_time}}();\ \}}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00092\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_runtime_state}{RuntimeState}}*\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a188e97a8900df82e0ca93f713d2d5c1f}{runtime\_state}}()\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a91f2150e84757ffe2be5129f52c9e85a}{\_state}};\ \}}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a2f57f54d8c03b615bb31eee091d8a88a}{is\_open}}()\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_acf96a9fb4906bccc6c68b1971022df4d}{\_is\_open}};\ \}}
\DoxyCodeLine{00095\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a93d69ed5b111d6d72b5d0bc88df13553}{set\_opened}}()\ \{\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_acf96a9fb4906bccc6c68b1971022df4d}{\_is\_open}}\ =\ \textcolor{keyword}{true};\ \}}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00097\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_af312ade69da225bb18f88f4dde26c068}{queue\_id}}()\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a91f2150e84757ffe2be5129f52c9e85a}{\_state}}-\/>\mbox{\hyperlink{classdoris_1_1_runtime_state_a7e0d0163a03ace13113f67bc696d5194}{exec\_env}}()-\/>\mbox{\hyperlink{classdoris_1_1_exec_env_a13c321fb82089457088794413e5c20c8}{store\_path\_to\_index}}(\textcolor{stringliteral}{"{}xxx"{}});\ \}}
\DoxyCodeLine{00098\ }
\DoxyCodeLine{00099\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{namespacedoris_a66bbeaaac0be5dcb3d9ec1df4311075c}{doris::TabletStorageType}}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a2b486b16459a067580241387639a2d8f}{get\_storage\_type}}()\ \{}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacedoris_a66bbeaaac0be5dcb3d9ec1df4311075ca5acaca56574a0e4e4881641a61fa8d0a}{doris::TabletStorageType::STORAGE\_TYPE\_REMOTE}};}
\DoxyCodeLine{00101\ \ \ \ \ \}}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00103\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_ac4f719418856e44d8b42e87636e47ada}{need\_to\_close}}()\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_afc42f091eb57c2f291c7db34d4f189bf}{\_need\_to\_close}};\ \}}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00105\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a0c4fd49e4a692c358d08b1c7108eb826}{mark\_to\_need\_to\_close}}()\ \{}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_afca0293718d99e7a8acbdb6eb6fb54a0}{\_update\_counters\_before\_close}}();}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_afc42f091eb57c2f291c7db34d4f189bf}{\_need\_to\_close}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00108\ \ \ \ \ \}}
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00110\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a7796488a8198792707e5cdcfafe7a0f6}{set\_status\_on\_failure}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\&\ st)\ \{\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a6cdf6e6db875a442f3ab6db542bd2bb5}{\_status}}\ =\ st;\ \}}
\DoxyCodeLine{00111\ }
\DoxyCodeLine{00112\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_expr_context}{VExprContext}}**\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a4f676cf49d71e332ba4eb0ef5165bc36}{vconjunct\_ctx\_ptr}}()\ \{\ \textcolor{keywordflow}{return}\ \&\mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a293538409e6ddc43ebb577134bb3d669}{\_vconjunct\_ctx}};\ \}}
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00114\ \ \ \ \ \textcolor{comment}{//\ return\ false\ if\ \_is\_counted\_down\ is\ already\ true,}}
\DoxyCodeLine{00115\ \ \ \ \ \textcolor{comment}{//\ otherwise,\ set\ \_is\_counted\_down\ to\ true\ and\ return\ true.}}
\DoxyCodeLine{00116\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_abaae52cdd5840313ea7bb8bc93460a31}{set\_counted\_down}}()\ \{}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a76b8263055190a80a0697e61416f1a69}{\_is\_counted\_down}})\ \{}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a76b8263055190a80a0697e61416f1a69}{\_is\_counted\_down}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00122\ \ \ \ \ \}}
\DoxyCodeLine{00123\ }
\DoxyCodeLine{00124\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00125\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a160c11c17eb5a9525b7de3a4c32a8bfe}{\_discard\_conjuncts}}()\ \{}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a293538409e6ddc43ebb577134bb3d669}{\_vconjunct\_ctx}})\ \{}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_abeba6991d2f0dbc737947008d126dafe}{\_stale\_vexpr\_ctxs}}.push\_back(\mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a293538409e6ddc43ebb577134bb3d669}{\_vconjunct\_ctx}});}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a293538409e6ddc43ebb577134bb3d669}{\_vconjunct\_ctx}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00130\ \ \ \ \ \}}
\DoxyCodeLine{00131\ }
\DoxyCodeLine{00132\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00133\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_runtime_state}{RuntimeState}}*\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a91f2150e84757ffe2be5129f52c9e85a}{\_state}};}
\DoxyCodeLine{00134\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scan_node}{VScanNode}}*\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a7ab2d932607871b1b47e15dc2e1c4f3c}{\_parent}};}
\DoxyCodeLine{00135\ \ \ \ \ \textcolor{comment}{//\ Set\ if\ scan\ node\ has\ sort\ limit\ info}}
\DoxyCodeLine{00136\ \ \ \ \ int64\_t\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_af78cf7ca4356248c3c3b0bbe0f12a653}{\_limit}}\ =\ -\/1;}
\DoxyCodeLine{00137\ }
\DoxyCodeLine{00138\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_runtime_profile}{RuntimeProfile}}*\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a2e859f47407c7a031f6c1e087775e510}{\_profile}};}
\DoxyCodeLine{00139\ }
\DoxyCodeLine{00140\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdoris_1_1_tuple_descriptor}{TupleDescriptor}}*\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a64c0d08290a05e24655ac487059a9240}{\_input\_tuple\_desc}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00141\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdoris_1_1_tuple_descriptor}{TupleDescriptor}}*\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a87f5435a52651132da1791ac0d25ef3e}{\_output\_tuple\_desc}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00142\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdoris_1_1_tuple_descriptor}{TupleDescriptor}}*\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_ad297a1e82b4b792b312bc4e32b9e7ddf}{\_real\_tuple\_desc}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00143\ }
\DoxyCodeLine{00144\ \ \ \ \ \textcolor{comment}{//\ If\ \_input\_tuple\_desc\ is\ set,\ the\ scanner\ will\ read\ data\ into}}
\DoxyCodeLine{00145\ \ \ \ \ \textcolor{comment}{//\ this\ \_input\_block\ first,\ then\ convert\ to\ the\ output\ block.}}
\DoxyCodeLine{00146\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_block}{Block}}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a149ab1daf60835a8de7b204f019e9bf3}{\_input\_block}};}
\DoxyCodeLine{00147\ }
\DoxyCodeLine{00148\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_acf96a9fb4906bccc6c68b1971022df4d}{\_is\_open}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00149\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a6a7c9f0db03d1ee8f7e0e2d5a1392c2e}{\_is\_closed}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00150\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_afc42f091eb57c2f291c7db34d4f189bf}{\_need\_to\_close}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00151\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a6cdf6e6db875a442f3ab6db542bd2bb5}{\_status}};}
\DoxyCodeLine{00152\ }
\DoxyCodeLine{00153\ \ \ \ \ \textcolor{comment}{//\ If\ \_applied\_rf\_num\ ==\ \_total\_rf\_num}}
\DoxyCodeLine{00154\ \ \ \ \ \textcolor{comment}{//\ means\ all\ runtime\ filters\ are\ arrived\ and\ applied.}}
\DoxyCodeLine{00155\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_ae8cce5c13e18a0da99284702a11100c1}{\_applied\_rf\_num}}\ =\ 0;}
\DoxyCodeLine{00156\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a747cbb98bc96a584ccd5568d1c3884bf}{\_total\_rf\_num}}\ =\ 0;}
\DoxyCodeLine{00157\ \ \ \ \ \textcolor{comment}{//\ Cloned\ from\ \_vconjunct\_ctx\ of\ scan\ node.}}
\DoxyCodeLine{00158\ \ \ \ \ \textcolor{comment}{//\ It\ includes\ predicate\ in\ SQL\ and\ runtime\ filters.}}
\DoxyCodeLine{00159\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_expr_context}{VExprContext}}*\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a293538409e6ddc43ebb577134bb3d669}{\_vconjunct\_ctx}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00160\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_expr_context}{VExprContext}}*\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a0dab3fbee604de875e0259c19b6bc3cf}{\_common\_vexpr\_ctxs\_pushdown}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00161\ \ \ \ \ \textcolor{comment}{//\ Late\ arriving\ runtime\ filters\ will\ update\ \_vconjunct\_ctx.}}
\DoxyCodeLine{00162\ \ \ \ \ \textcolor{comment}{//\ The\ old\ \_vconjunct\_ctx\ will\ be\ temporarily\ placed\ in\ \_stale\_vexpr\_ctxs}}
\DoxyCodeLine{00163\ \ \ \ \ \textcolor{comment}{//\ and\ will\ be\ destroyed\ at\ the\ end.}}
\DoxyCodeLine{00164\ \ \ \ \ std::vector<VExprContext*>\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_abeba6991d2f0dbc737947008d126dafe}{\_stale\_vexpr\_ctxs}};}
\DoxyCodeLine{00165\ }
\DoxyCodeLine{00166\ \ \ \ \ \textcolor{comment}{//\ num\ of\ rows\ read\ from\ scanner}}
\DoxyCodeLine{00167\ \ \ \ \ int64\_t\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a6ad0181a2c59286aff05d311b0065576}{\_num\_rows\_read}}\ =\ 0;}
\DoxyCodeLine{00168\ }
\DoxyCodeLine{00169\ \ \ \ \ \textcolor{comment}{//\ num\ of\ rows\ return\ from\ scanner,\ after\ filter\ block}}
\DoxyCodeLine{00170\ \ \ \ \ int64\_t\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_ae84acde7df3a65a948763b355187f2d7}{\_num\_rows\_return}}\ =\ 0;}
\DoxyCodeLine{00171\ }
\DoxyCodeLine{00172\ \ \ \ \ \textcolor{comment}{//\ Set\ true\ after\ counter\ is\ updated\ finally}}
\DoxyCodeLine{00173\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a8ce99ed0671666bbc99d1e0e4376aad1}{\_has\_updated\_counter}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00174\ }
\DoxyCodeLine{00175\ \ \ \ \ \textcolor{comment}{//\ watch\ to\ count\ the\ time\ wait\ for\ scanner\ thread}}
\DoxyCodeLine{00176\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_custom_stop_watch}{MonotonicStopWatch}}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a8ad6c871deec1b8bfe903647b4898a8d}{\_watch}};}
\DoxyCodeLine{00177\ \ \ \ \ \textcolor{comment}{//\ Do\ not\ use\ ScopedTimer.\ There\ is\ no\ guarantee\ that,\ the\ counter}}
\DoxyCodeLine{00178\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_custom_stop_watch}{ThreadCpuStopWatch}}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a60a213bcd52235bd182a4634a96c215f}{\_cpu\_watch}};}
\DoxyCodeLine{00179\ \ \ \ \ int64\_t\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a33435759d45eef5a6031999aa2dbd53c}{\_scanner\_wait\_worker\_timer}}\ =\ 0;}
\DoxyCodeLine{00180\ \ \ \ \ int64\_t\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_ab4a8ce353a203cd32c1b021d230769c4}{\_scan\_cpu\_timer}}\ =\ 0;}
\DoxyCodeLine{00181\ }
\DoxyCodeLine{00182\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_ab4968adf057e5365bd9a27e8c989d745}{\_is\_load}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00183\ \ \ \ \ \textcolor{comment}{//\ set\ to\ true\ after\ decrease\ the\ "{}\_num\_unfinished\_scanners"{}\ in\ scanner\ context}}
\DoxyCodeLine{00184\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a76b8263055190a80a0697e61416f1a69}{\_is\_counted\_down}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00185\ }
\DoxyCodeLine{00186\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a9542b3368055eb7fb0bf36fc2deea1f3}{\_is\_init}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00187\ }
\DoxyCodeLine{00188\ \ \ \ \ \mbox{\hyperlink{structdoris_1_1vectorized_1_1_scanner_counter}{ScannerCounter}}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_afd1770687a9f21abc64b167c2c0343aa}{\_counter}};}
\DoxyCodeLine{00189\ \ \ \ \ int64\_t\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_scanner_a7edf004281e85f055b8ac92cfd0be479}{\_per\_scanner\_timer}}\ =\ 0;}
\DoxyCodeLine{00190\ \};}
\DoxyCodeLine{00191\ }
\DoxyCodeLine{00192\ \}\ \textcolor{comment}{//\ namespace\ doris::vectorized}}

\end{DoxyCode}
