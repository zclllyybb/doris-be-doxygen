\hypertarget{result__node_8h_source}{}\doxysection{result\+\_\+node.\+h}
\label{result__node_8h_source}\index{/Users/dabowang/doris/be/src/runtime/cache/result\_node.h@{/Users/dabowang/doris/be/src/runtime/cache/result\_node.h}}
\mbox{\hyperlink{result__node_8h}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Licensed\ to\ the\ Apache\ Software\ Foundation\ (ASF)\ under\ one}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ or\ more\ contributor\ license\ agreements.\ \ See\ the\ NOTICE\ file}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ distributed\ with\ this\ work\ for\ additional\ information}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ regarding\ copyright\ ownership.\ \ The\ ASF\ licenses\ this\ file}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ to\ you\ under\ the\ Apache\ License,\ Version\ 2.0\ (the}}
\DoxyCodeLine{00006\ \textcolor{comment}{//\ "{}License"{});\ you\ may\ not\ use\ this\ file\ except\ in\ compliance}}
\DoxyCodeLine{00007\ \textcolor{comment}{//\ with\ the\ License.\ \ You\ may\ obtain\ a\ copy\ of\ the\ License\ at}}
\DoxyCodeLine{00008\ \textcolor{comment}{//}}
\DoxyCodeLine{00009\ \textcolor{comment}{//\ \ \ http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{00010\ \textcolor{comment}{//}}
\DoxyCodeLine{00011\ \textcolor{comment}{//\ Unless\ required\ by\ applicable\ law\ or\ agreed\ to\ in\ writing,}}
\DoxyCodeLine{00012\ \textcolor{comment}{//\ software\ distributed\ under\ the\ License\ is\ distributed\ on\ an}}
\DoxyCodeLine{00013\ \textcolor{comment}{//\ "{}AS\ IS"{}\ BASIS,\ WITHOUT\ WARRANTIES\ OR\ CONDITIONS\ OF\ ANY}}
\DoxyCodeLine{00014\ \textcolor{comment}{//\ KIND,\ either\ express\ or\ implied.\ \ See\ the\ License\ for\ the}}
\DoxyCodeLine{00015\ \textcolor{comment}{//\ specific\ language\ governing\ permissions\ and\ limitations}}
\DoxyCodeLine{00016\ \textcolor{comment}{//\ under\ the\ License.}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ <sys/time.h>}}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ <algorithm>}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ <cassert>}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ <cstdio>}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ <cstdlib>}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#include\ <exception>}}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#include\ <iostream>}}
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#include\ <list>}}
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\#include\ <map>}}
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\#include\ <string>}}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{common_2config_8h}{common/config.h}}"{}}}
\DoxyCodeLine{00033\ \textcolor{preprocessor}{\#include\ "{}gen\_cpp/internal\_service.pb.h"{}}}
\DoxyCodeLine{00034\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{olap__define_8h}{olap/olap\_define.h}}"{}}}
\DoxyCodeLine{00035\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{cache__utils_8h}{runtime/cache/cache\_utils.h}}"{}}}
\DoxyCodeLine{00036\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{uid__util_8h}{util/uid\_util.h}}"{}}}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacedoris}{doris}}\ \{}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00040\ \textcolor{keyword}{class\ }PCacheParam;}
\DoxyCodeLine{00041\ \textcolor{keyword}{class\ }PCacheValue;}
\DoxyCodeLine{00042\ \textcolor{keyword}{class\ }PCacheResponse;}
\DoxyCodeLine{00043\ \textcolor{keyword}{class\ }PFetchCacheRequest;}
\DoxyCodeLine{00044\ \textcolor{keyword}{class\ }PFetchCacheResult;}
\DoxyCodeLine{00045\ \textcolor{keyword}{class\ }PUpdateCacheRequest;}
\DoxyCodeLine{00046\ \textcolor{keyword}{class\ }PClearCacheRequest;}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00051\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classdoris_1_1_partition_row_batch}{PartitionRowBatch}}\ \{}
\DoxyCodeLine{00052\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00053\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_partition_row_batch_a6ef383569464c0f20fb991ccb8a7c724}{PartitionRowBatch}}(\mbox{\hyperlink{integral__types_8h_a7cde0074dfd288f2d70c0e035dacb28a}{int64}}\ partition\_key)}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{classdoris_1_1_partition_row_batch_ac29c9528601668a2f492a0339004d4a1}{\_partition\_key}}(partition\_key),\ \mbox{\hyperlink{classdoris_1_1_partition_row_batch_a7cc1108c12101a5321abe712d9209e45}{\_cache\_value}}(nullptr),\ \mbox{\hyperlink{classdoris_1_1_partition_row_batch_a58ea1b4b0614eaf64fdba64743d65d86}{\_data\_size}}(0)\ \{\}}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00056\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_partition_row_batch_a22d9adb522b9ed0875eddd45b52e0906}{\string~PartitionRowBatch}}()\ \{\}}
\DoxyCodeLine{00057\ }
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1_partition_row_batch_aafd7a1e149ac13a2b94a5885a7f18e84}{set\_row\_batch}}(\textcolor{keyword}{const}\ PCacheValue\&\ \mbox{\hyperlink{util_2types_8h_adae7202c63102b0934c3ac5be41b0dae}{value}});}
\DoxyCodeLine{00059\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1_partition_row_batch_a9146b35d69bf55fa5cb0c5a57a6a4d1b}{is\_hit\_cache}}(\textcolor{keyword}{const}\ PCacheParam\&\ param);}
\DoxyCodeLine{00060\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1_partition_row_batch_ac8bb3912a3ce86b15842e79d0b421204}{clear}}();}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ \ \ \ \ \mbox{\hyperlink{integral__types_8h_a7cde0074dfd288f2d70c0e035dacb28a}{int64}}\ \mbox{\hyperlink{classdoris_1_1_partition_row_batch_a23485dab8fdb9120b8634899c158fe55}{get\_partition\_key}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdoris_1_1_partition_row_batch_ac29c9528601668a2f492a0339004d4a1}{\_partition\_key}};\ \}}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00064\ \ \ \ \ PCacheValue*\ \mbox{\hyperlink{classdoris_1_1_partition_row_batch_a3160e33f3b7567f061df06778602edff}{get\_value}}()\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdoris_1_1_partition_row_batch_a7cc1108c12101a5321abe712d9209e45}{\_cache\_value}};\ \}}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00066\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classdoris_1_1_partition_row_batch_aaf160dde16f2bca6c31cc5dac131fcac}{get\_data\_size}}()\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdoris_1_1_partition_row_batch_a58ea1b4b0614eaf64fdba64743d65d86}{\_data\_size}};\ \}}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00068\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structdoris_1_1_cache_stat}{CacheStat}}*\ \mbox{\hyperlink{classdoris_1_1_partition_row_batch_af369b1f7d0b63d7d518ef2cfcad19c30}{get\_stat}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \&\mbox{\hyperlink{classdoris_1_1_partition_row_batch_a0b1bb4a41638c95b72ce9344de11e8e9}{\_cache\_stat}};\ \}}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00070\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00071\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1_partition_row_batch_a7463cdea779d845ad46915dc751b201c}{check\_match}}(\textcolor{keyword}{const}\ PCacheParam\&\ req\_param)\ \{}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (req\_param.partition\_key()\ !=\ \mbox{\hyperlink{classdoris_1_1_partition_row_batch_ac29c9528601668a2f492a0339004d4a1}{\_partition\_key}})\ \{}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (req\_param.last\_version()\ >\ \mbox{\hyperlink{classdoris_1_1_partition_row_batch_a7cc1108c12101a5321abe712d9209e45}{\_cache\_value}}-\/>param().last\_version())\ \{}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (req\_param.last\_version\_time()\ >\ \mbox{\hyperlink{classdoris_1_1_partition_row_batch_a7cc1108c12101a5321abe712d9209e45}{\_cache\_value}}-\/>param().last\_version\_time())\ \{}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00082\ \ \ \ \ \}}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00084\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1_partition_row_batch_a846b10740a952c116fdde182f3fa97d1}{check\_newer}}(\textcolor{keyword}{const}\ PCacheParam\&\ up\_param)\ \{}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \textcolor{comment}{//for\ init\ data\ of\ sql\ cache}}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (up\_param.last\_version()\ ==\ 0\ ||\ up\_param.last\_version\_time()\ ==\ 0)\ \{}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (up\_param.last\_version\_time()\ >\ \mbox{\hyperlink{classdoris_1_1_partition_row_batch_a7cc1108c12101a5321abe712d9209e45}{\_cache\_value}}-\/>param().last\_version\_time())\ \{}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (up\_param.last\_version()\ >\ \mbox{\hyperlink{classdoris_1_1_partition_row_batch_a7cc1108c12101a5321abe712d9209e45}{\_cache\_value}}-\/>param().last\_version())\ \{}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00096\ \ \ \ \ \}}
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00098\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00099\ \ \ \ \ \mbox{\hyperlink{integral__types_8h_a7cde0074dfd288f2d70c0e035dacb28a}{int64}}\ \mbox{\hyperlink{classdoris_1_1_partition_row_batch_ac29c9528601668a2f492a0339004d4a1}{\_partition\_key}};}
\DoxyCodeLine{00100\ \ \ \ \ PCacheValue*\ \mbox{\hyperlink{classdoris_1_1_partition_row_batch_a7cc1108c12101a5321abe712d9209e45}{\_cache\_value}};}
\DoxyCodeLine{00101\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classdoris_1_1_partition_row_batch_a58ea1b4b0614eaf64fdba64743d65d86}{\_data\_size}};}
\DoxyCodeLine{00102\ \ \ \ \ \mbox{\hyperlink{structdoris_1_1_cache_stat}{CacheStat}}\ \mbox{\hyperlink{classdoris_1_1_partition_row_batch_a0b1bb4a41638c95b72ce9344de11e8e9}{\_cache\_stat}};}
\DoxyCodeLine{00103\ \};}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00105\ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{integral__types_8h_a7cde0074dfd288f2d70c0e035dacb28a}{int64}}\ \mbox{\hyperlink{namespacedoris_a4df43878ad943af1538a257ee9102866}{PartitionKey}};}
\DoxyCodeLine{00106\ \textcolor{keyword}{typedef}\ std::list<PartitionRowBatch*>\ \mbox{\hyperlink{namespacedoris_a165b080f2f4c394ff0ffec9040aaeb14}{PartitionRowBatchList}};}
\DoxyCodeLine{00107\ \textcolor{keyword}{typedef}\ std::unordered\_map<PartitionKey,\ PartitionRowBatch*>\ \mbox{\hyperlink{namespacedoris_ac48d73ba5f636fb3022ad7268cb6aa10}{PartitionRowBatchMap}};}
\DoxyCodeLine{00108\ }
\DoxyCodeLine{00115\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classdoris_1_1_result_node}{ResultNode}}\ \{}
\DoxyCodeLine{00116\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00117\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_result_node_a3d15c0fd2f4e39e45b5764d6ccc51a64}{ResultNode}}()\ :\ \mbox{\hyperlink{classdoris_1_1_result_node_a819eff73b7e5dcc2e1345ff6c1907105}{\_sql\_key}}(0,\ 0),\ \mbox{\hyperlink{classdoris_1_1_result_node_a3d2c85f07d5c9a2cf9f363fb55734de8}{\_prev}}(nullptr),\ \mbox{\hyperlink{classdoris_1_1_result_node_a9ffe318b469f44fc4bfc48f4c258848e}{\_next}}(nullptr),\ \mbox{\hyperlink{classdoris_1_1_result_node_a58ea1b4b0614eaf64fdba64743d65d86}{\_data\_size}}(0)\ \{\}}
\DoxyCodeLine{00118\ }
\DoxyCodeLine{00119\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_result_node_ab767ed64307193bfebb579d89fcf1c61}{ResultNode}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structdoris_1_1_unique_id}{UniqueId}}\&\ sql\_key)}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{classdoris_1_1_result_node_a819eff73b7e5dcc2e1345ff6c1907105}{\_sql\_key}}(sql\_key),\ \mbox{\hyperlink{classdoris_1_1_result_node_a3d2c85f07d5c9a2cf9f363fb55734de8}{\_prev}}(nullptr),\ \mbox{\hyperlink{classdoris_1_1_result_node_a9ffe318b469f44fc4bfc48f4c258848e}{\_next}}(nullptr),\ \mbox{\hyperlink{classdoris_1_1_result_node_a58ea1b4b0614eaf64fdba64743d65d86}{\_data\_size}}(0)\ \{\}}
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00122\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{classdoris_1_1_result_node_aca245266c8b02f90e7dcfb995df33a99}{\string~ResultNode}}()\ \{\}}
\DoxyCodeLine{00123\ }
\DoxyCodeLine{00124\ \ \ \ \ PCacheStatus\ \mbox{\hyperlink{classdoris_1_1_result_node_af85d9e9b8f542dc2dc5066d65b30c8e2}{update\_partition}}(\textcolor{keyword}{const}\ PUpdateCacheRequest*\ request,\ \textcolor{keywordtype}{bool}\&\ is\_update\_firstkey);}
\DoxyCodeLine{00125\ \ \ \ \ PCacheStatus\ \mbox{\hyperlink{classdoris_1_1_result_node_a75babd8c18694a19bf5d809bf6e5ddf9}{fetch\_partition}}(\textcolor{keyword}{const}\ PFetchCacheRequest*\ request,}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedoris_a165b080f2f4c394ff0ffec9040aaeb14}{PartitionRowBatchList}}\&\ rowBatchList,\ \textcolor{keywordtype}{bool}\&\ is\_hit\_firstkey);}
\DoxyCodeLine{00127\ \ \ \ \ PCacheStatus\ \mbox{\hyperlink{classdoris_1_1_result_node_a86f7bf9153bb9d2937deaa517693bd97}{update\_sql\_cache}}(\textcolor{keyword}{const}\ PUpdateCacheRequest*\ request,\ \textcolor{keywordtype}{bool}\&\ is\_update\_firstkey);}
\DoxyCodeLine{00128\ \ \ \ \ PCacheStatus\ \mbox{\hyperlink{classdoris_1_1_result_node_a5395165e47230a831392a7ca24d69a83}{update\_partition\_cache}}(\textcolor{keyword}{const}\ PUpdateCacheRequest*\ request,}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\&\ is\_update\_firstkey);}
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00131\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classdoris_1_1_result_node_a9929a20a2cff6d3e8adc87eee0b26220}{prune\_first}}();}
\DoxyCodeLine{00132\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1_result_node_ac8bb3912a3ce86b15842e79d0b421204}{clear}}();}
\DoxyCodeLine{00133\ }
\DoxyCodeLine{00134\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_result_node}{ResultNode}}*\ \mbox{\hyperlink{classdoris_1_1_result_node_a7b31badbe2bef8a43d67316c7c2dc18a}{get\_prev}}()\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdoris_1_1_result_node_a3d2c85f07d5c9a2cf9f363fb55734de8}{\_prev}};\ \}}
\DoxyCodeLine{00135\ }
\DoxyCodeLine{00136\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1_result_node_a54d4bc6f4b46c44d0dfcac966251f22d}{set\_prev}}(\mbox{\hyperlink{classdoris_1_1_result_node}{ResultNode}}*\ prev)\ \{\ \mbox{\hyperlink{classdoris_1_1_result_node_a3d2c85f07d5c9a2cf9f363fb55734de8}{\_prev}}\ =\ prev;\ \}}
\DoxyCodeLine{00137\ }
\DoxyCodeLine{00138\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_result_node}{ResultNode}}*\ \mbox{\hyperlink{classdoris_1_1_result_node_ab405e2368c0a8824228335fa8867d6aa}{get\_next}}()\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdoris_1_1_result_node_a9ffe318b469f44fc4bfc48f4c258848e}{\_next}};\ \}}
\DoxyCodeLine{00139\ }
\DoxyCodeLine{00140\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1_result_node_aaf4935d2c63b4fac034a337ca8ceafe5}{set\_next}}(\mbox{\hyperlink{classdoris_1_1_result_node}{ResultNode}}*\ \mbox{\hyperlink{threadlocal_8cc_a6ce3ddf2a70a9a8f5f94ce52c188ec6c}{next}})\ \{\ \mbox{\hyperlink{classdoris_1_1_result_node_a9ffe318b469f44fc4bfc48f4c258848e}{\_next}}\ =\ \mbox{\hyperlink{threadlocal_8cc_a6ce3ddf2a70a9a8f5f94ce52c188ec6c}{next}};\ \}}
\DoxyCodeLine{00141\ }
\DoxyCodeLine{00142\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1_result_node_af02636b2a678e9245d65fafb459f84be}{append}}(\mbox{\hyperlink{classdoris_1_1_result_node}{ResultNode}}*\ tail);}
\DoxyCodeLine{00143\ }
\DoxyCodeLine{00144\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1_result_node_acefbc7d5aa5a6fad7b468b9a84b3db7d}{unlink}}();}
\DoxyCodeLine{00145\ }
\DoxyCodeLine{00146\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classdoris_1_1_result_node_a7874a9fb060342524c11394a0d77876e}{get\_partition\_count}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdoris_1_1_result_node_a137462c7a7197d9d97b4ebfdf7c93c5d}{\_partition\_list}}.size();\ \}}
\DoxyCodeLine{00147\ }
\DoxyCodeLine{00148\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classdoris_1_1_result_node_aba508f36133813e7844f14af0ae3175b}{get\_data\_size}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdoris_1_1_result_node_a58ea1b4b0614eaf64fdba64743d65d86}{\_data\_size}};\ \}}
\DoxyCodeLine{00149\ }
\DoxyCodeLine{00150\ \ \ \ \ \mbox{\hyperlink{structdoris_1_1_unique_id}{UniqueId}}\ \mbox{\hyperlink{classdoris_1_1_result_node_a99ef5bdf923599144a7ee51a53c84afc}{get\_sql\_key}}()\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdoris_1_1_result_node_a819eff73b7e5dcc2e1345ff6c1907105}{\_sql\_key}};\ \}}
\DoxyCodeLine{00151\ }
\DoxyCodeLine{00152\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1_result_node_aaa7ab09d72b220ca1ec9095142e744e9}{sql\_key\_null}}()\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdoris_1_1_result_node_a819eff73b7e5dcc2e1345ff6c1907105}{\_sql\_key}}.\mbox{\hyperlink{structdoris_1_1_unique_id_a94ebb4c22130c6225e4853bda2afdede}{hi}}\ ==\ 0\ \&\&\ \mbox{\hyperlink{classdoris_1_1_result_node_a819eff73b7e5dcc2e1345ff6c1907105}{\_sql\_key}}.\mbox{\hyperlink{structdoris_1_1_unique_id_a02d2e758b56a585c38f9b055ddc6038a}{lo}}\ ==\ 0;\ \}}
\DoxyCodeLine{00153\ }
\DoxyCodeLine{00154\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1_result_node_aa89a7c05d976d1fa523336507aa3463f}{set\_sql\_key}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structdoris_1_1_unique_id}{UniqueId}}\&\ sql\_key)\ \{\ \mbox{\hyperlink{classdoris_1_1_result_node_a819eff73b7e5dcc2e1345ff6c1907105}{\_sql\_key}}\ =\ sql\_key;\ \}}
\DoxyCodeLine{00155\ }
\DoxyCodeLine{00156\ \ \ \ \ \textcolor{keywordtype}{long}\ \mbox{\hyperlink{classdoris_1_1_result_node_a42ea2c28fb2f608f71026e55317ab995}{first\_partition\_last\_time}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classdoris_1_1_result_node_a137462c7a7197d9d97b4ebfdf7c93c5d}{\_partition\_list}}.size()\ ==\ 0)\ \{}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classdoris_1_1_partition_row_batch}{PartitionRowBatch}}*\ first\ =\ *(\mbox{\hyperlink{classdoris_1_1_result_node_a137462c7a7197d9d97b4ebfdf7c93c5d}{\_partition\_list}}.begin());}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ first-\/>\mbox{\hyperlink{classdoris_1_1_partition_row_batch_af369b1f7d0b63d7d518ef2cfcad19c30}{get\_stat}}()-\/>\mbox{\hyperlink{structdoris_1_1_cache_stat_a10678c9ad1226e2f1380daa10da3587d}{last\_read\_time}};}
\DoxyCodeLine{00162\ \ \ \ \ \}}
\DoxyCodeLine{00163\ }
\DoxyCodeLine{00164\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structdoris_1_1_cache_stat}{CacheStat}}*\ \mbox{\hyperlink{classdoris_1_1_result_node_aab7a0d4f07c3db0f9f3ff38b05004375}{get\_first\_stat}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classdoris_1_1_result_node_a137462c7a7197d9d97b4ebfdf7c93c5d}{\_partition\_list}}.size()\ ==\ 0)\ \{}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (*(\mbox{\hyperlink{classdoris_1_1_result_node_a137462c7a7197d9d97b4ebfdf7c93c5d}{\_partition\_list}}.begin()))-\/>get\_stat();}
\DoxyCodeLine{00169\ \ \ \ \ \}}
\DoxyCodeLine{00170\ }
\DoxyCodeLine{00171\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structdoris_1_1_cache_stat}{CacheStat}}*\ \mbox{\hyperlink{classdoris_1_1_result_node_a9e0f0c27283f4a14700948f855b98a6b}{get\_last\_stat}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classdoris_1_1_result_node_a137462c7a7197d9d97b4ebfdf7c93c5d}{\_partition\_list}}.size()\ ==\ 0)\ \{}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (*(\mbox{\hyperlink{classdoris_1_1_result_node_a137462c7a7197d9d97b4ebfdf7c93c5d}{\_partition\_list}}.end()-\/-\/))-\/>get\_stat();}
\DoxyCodeLine{00176\ \ \ \ \ \}}
\DoxyCodeLine{00177\ }
\DoxyCodeLine{00178\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00179\ \ \ \ \ \textcolor{keyword}{mutable}\ std::shared\_mutex\ \mbox{\hyperlink{classdoris_1_1_result_node_aad33609d1088307c73055a307f0bffbd}{\_node\_mtx}};}
\DoxyCodeLine{00180\ \ \ \ \ \mbox{\hyperlink{structdoris_1_1_unique_id}{UniqueId}}\ \mbox{\hyperlink{classdoris_1_1_result_node_a819eff73b7e5dcc2e1345ff6c1907105}{\_sql\_key}};}
\DoxyCodeLine{00181\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_result_node}{ResultNode}}*\ \mbox{\hyperlink{classdoris_1_1_result_node_a3d2c85f07d5c9a2cf9f363fb55734de8}{\_prev}};}
\DoxyCodeLine{00182\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_result_node}{ResultNode}}*\ \mbox{\hyperlink{classdoris_1_1_result_node_a9ffe318b469f44fc4bfc48f4c258848e}{\_next}};}
\DoxyCodeLine{00183\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classdoris_1_1_result_node_a58ea1b4b0614eaf64fdba64743d65d86}{\_data\_size}};}
\DoxyCodeLine{00184\ \ \ \ \ \mbox{\hyperlink{namespacedoris_a165b080f2f4c394ff0ffec9040aaeb14}{PartitionRowBatchList}}\ \mbox{\hyperlink{classdoris_1_1_result_node_a137462c7a7197d9d97b4ebfdf7c93c5d}{\_partition\_list}};}
\DoxyCodeLine{00185\ \ \ \ \ \mbox{\hyperlink{namespacedoris_ac48d73ba5f636fb3022ad7268cb6aa10}{PartitionRowBatchMap}}\ \mbox{\hyperlink{classdoris_1_1_result_node_a4818d60b593bca117c6b9ce6c776ae44}{\_partition\_map}};}
\DoxyCodeLine{00186\ \};}
\DoxyCodeLine{00187\ }
\DoxyCodeLine{00188\ \}\ \textcolor{comment}{//\ namespace\ doris}}

\end{DoxyCode}
