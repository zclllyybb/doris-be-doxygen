\hypertarget{zone__map__index_8h_source}{}\doxysection{zone\+\_\+map\+\_\+index.\+h}
\label{zone__map__index_8h_source}\index{/Users/dabowang/doris/be/src/olap/rowset/segment\_v2/zone\_map\_index.h@{/Users/dabowang/doris/be/src/olap/rowset/segment\_v2/zone\_map\_index.h}}
\mbox{\hyperlink{zone__map__index_8h}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Licensed\ to\ the\ Apache\ Software\ Foundation\ (ASF)\ under\ one}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ or\ more\ contributor\ license\ agreements.\ \ See\ the\ NOTICE\ file}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ distributed\ with\ this\ work\ for\ additional\ information}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ regarding\ copyright\ ownership.\ \ The\ ASF\ licenses\ this\ file}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ to\ you\ under\ the\ Apache\ License,\ Version\ 2.0\ (the}}
\DoxyCodeLine{00006\ \textcolor{comment}{//\ "{}License"{});\ you\ may\ not\ use\ this\ file\ except\ in\ compliance}}
\DoxyCodeLine{00007\ \textcolor{comment}{//\ with\ the\ License.\ \ You\ may\ obtain\ a\ copy\ of\ the\ License\ at}}
\DoxyCodeLine{00008\ \textcolor{comment}{//}}
\DoxyCodeLine{00009\ \textcolor{comment}{//\ \ \ http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{00010\ \textcolor{comment}{//}}
\DoxyCodeLine{00011\ \textcolor{comment}{//\ Unless\ required\ by\ applicable\ law\ or\ agreed\ to\ in\ writing,}}
\DoxyCodeLine{00012\ \textcolor{comment}{//\ software\ distributed\ under\ the\ License\ is\ distributed\ on\ an}}
\DoxyCodeLine{00013\ \textcolor{comment}{//\ "{}AS\ IS"{}\ BASIS,\ WITHOUT\ WARRANTIES\ OR\ CONDITIONS\ OF\ ANY}}
\DoxyCodeLine{00014\ \textcolor{comment}{//\ KIND,\ either\ express\ or\ implied.\ \ See\ the\ License\ for\ the}}
\DoxyCodeLine{00015\ \textcolor{comment}{//\ specific\ language\ governing\ permissions\ and\ limitations}}
\DoxyCodeLine{00016\ \textcolor{comment}{//\ under\ the\ License.}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ <memory>}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ <string>}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{status_8h}{common/status.h}}"{}}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ "{}gen\_cpp/segment\_v2.pb.h"{}}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{file__reader_8h}{io/fs/file\_reader.h}}"{}}}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{olap_2field_8h}{olap/field.h}}"{}}}
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{binary__plain__page_8h}{olap/rowset/segment\_v2/binary\_plain\_page.h}}"{}}}
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{slice_8h}{util/slice.h}}"{}}}
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{arena_8h}{vec/common/arena.h}}"{}}}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacedoris}{doris}}\ \{}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00034\ \textcolor{keyword}{namespace\ }io\ \{}
\DoxyCodeLine{00035\ \textcolor{keyword}{class\ }FileWriter;}
\DoxyCodeLine{00036\ \}\ \textcolor{comment}{//\ namespace\ io}}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ \textcolor{keyword}{namespace\ }segment\_v2\ \{}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00040\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structdoris_1_1segment__v2_1_1_zone_map}{ZoneMap}}\ \{}
\DoxyCodeLine{00041\ \ \ \ \ \textcolor{comment}{//\ min\ value\ of\ zone}}
\DoxyCodeLine{00042\ \ \ \ \ \textcolor{keywordtype}{char}*\ \mbox{\hyperlink{structdoris_1_1segment__v2_1_1_zone_map_a5ad1d86e261de7f9132c7380d4ab1141}{min\_value}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00043\ \ \ \ \ \textcolor{comment}{//\ max\ value\ of\ zone}}
\DoxyCodeLine{00044\ \ \ \ \ \textcolor{keywordtype}{char}*\ \mbox{\hyperlink{structdoris_1_1segment__v2_1_1_zone_map_ace98cd4268ab0da492fba2b077095a26}{max\_value}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{comment}{//\ if\ both\ has\_null\ and\ has\_not\_null\ is\ false,\ means\ no\ rows.}}
\DoxyCodeLine{00047\ \ \ \ \ \textcolor{comment}{//\ if\ has\_null\ is\ true\ and\ has\_not\_null\ is\ false,\ means\ all\ rows\ is\ null.}}
\DoxyCodeLine{00048\ \ \ \ \ \textcolor{comment}{//\ if\ has\_null\ is\ false\ and\ has\_not\_null\ is\ true,\ means\ all\ rows\ is\ not\ null.}}
\DoxyCodeLine{00049\ \ \ \ \ \textcolor{comment}{//\ if\ has\_null\ is\ true\ and\ has\_not\_null\ is\ true,\ means\ some\ rows\ is\ null\ and\ others\ are\ not.}}
\DoxyCodeLine{00050\ \ \ \ \ \textcolor{comment}{//\ has\_null\ means\ whether\ zone\ has\ null\ value}}
\DoxyCodeLine{00051\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structdoris_1_1segment__v2_1_1_zone_map_a78cf86ed4e3d2c55885e64604eb5cc9e}{has\_null}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{comment}{//\ has\_not\_null\ means\ whether\ zone\ has\ none-\/null\ value}}
\DoxyCodeLine{00053\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structdoris_1_1segment__v2_1_1_zone_map_ac1105826d0146ff89def74958aaa95e6}{has\_not\_null}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00055\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structdoris_1_1segment__v2_1_1_zone_map_a83639c24ec3bc32f7be71f807de041ab}{pass\_all}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structdoris_1_1segment__v2_1_1_zone_map_a52ac2bbc4ad094562c8d1417fa906257}{to\_proto}}(ZoneMapPB*\ dst,\ \mbox{\hyperlink{classdoris_1_1_field}{Field}}*\ field)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structdoris_1_1segment__v2_1_1_zone_map_a83639c24ec3bc32f7be71f807de041ab}{pass\_all}})\ \{}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \ \ \ \ dst-\/>set\_min(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \ \ \ \ dst-\/>set\_max(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \ \ \ \ dst-\/>set\_min(field-\/>\mbox{\hyperlink{classdoris_1_1_field_a87a7f6c010dac8d30c897d22b7597b8d}{to\_string}}(\mbox{\hyperlink{structdoris_1_1segment__v2_1_1_zone_map_a5ad1d86e261de7f9132c7380d4ab1141}{min\_value}}));}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \ \ \ \ dst-\/>set\_max(field-\/>\mbox{\hyperlink{classdoris_1_1_field_a87a7f6c010dac8d30c897d22b7597b8d}{to\_string}}(\mbox{\hyperlink{structdoris_1_1segment__v2_1_1_zone_map_ace98cd4268ab0da492fba2b077095a26}{max\_value}}));}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ dst-\/>set\_has\_null(\mbox{\hyperlink{structdoris_1_1segment__v2_1_1_zone_map_a78cf86ed4e3d2c55885e64604eb5cc9e}{has\_null}});}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ dst-\/>set\_has\_not\_null(\mbox{\hyperlink{structdoris_1_1segment__v2_1_1_zone_map_ac1105826d0146ff89def74958aaa95e6}{has\_not\_null}});}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ dst-\/>set\_pass\_all(\mbox{\hyperlink{structdoris_1_1segment__v2_1_1_zone_map_a83639c24ec3bc32f7be71f807de041ab}{pass\_all}});}
\DoxyCodeLine{00068\ \ \ \ \ \}}
\DoxyCodeLine{00069\ \};}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00071\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classdoris_1_1segment__v2_1_1_zone_map_index_writer}{ZoneMapIndexWriter}}\ \{}
\DoxyCodeLine{00072\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00073\ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1segment__v2_1_1_zone_map_index_writer_adc9dceec7a1628d3e83dc481672a5667}{create}}(\mbox{\hyperlink{classdoris_1_1_field}{Field}}*\ field,\ std::unique\_ptr<ZoneMapIndexWriter>\&\ res);}
\DoxyCodeLine{00074\ }
\DoxyCodeLine{00075\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1segment__v2_1_1_zone_map_index_writer_aa1a4c390323ce8989caf5c21f9cb5c9c}{ZoneMapIndexWriter}}()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{classdoris_1_1segment__v2_1_1_zone_map_index_writer_a3517dc1fd2bccbd3193d26f1cbce46e3}{\string~ZoneMapIndexWriter}}()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00078\ }
\DoxyCodeLine{00079\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1segment__v2_1_1_zone_map_index_writer_aed3d41752906ea61e5c466ca30dd57df}{add\_values}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ values,\ \textcolor{keywordtype}{size\_t}\ count)\ =\ 0;}
\DoxyCodeLine{00080\ }
\DoxyCodeLine{00081\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1segment__v2_1_1_zone_map_index_writer_aafa1f404117a808f3e32cee81ebabfcc}{add\_nulls}}(uint32\_t\ count)\ =\ 0;}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00083\ \ \ \ \ \textcolor{comment}{//\ mark\ the\ end\ of\ one\ data\ page\ so\ that\ we\ can\ finalize\ the\ corresponding\ zone\ map}}
\DoxyCodeLine{00084\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1segment__v2_1_1_zone_map_index_writer_aa5a8afca4a0eff41fea00af55ebf3f8e}{flush}}()\ =\ 0;}
\DoxyCodeLine{00085\ }
\DoxyCodeLine{00086\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1segment__v2_1_1_zone_map_index_writer_a0dacbc72fa9ab9c027ac38c82380f9d9}{finish}}(\mbox{\hyperlink{classdoris_1_1io_1_1_file_writer}{io::FileWriter}}*\ file\_writer,\ ColumnIndexMetaPB*\ index\_meta)\ =\ 0;}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00088\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1segment__v2_1_1_zone_map_index_writer_aa4b70f585899e28849122e1f47f6f91b}{moidfy\_index\_before\_flush}}(\mbox{\hyperlink{structdoris_1_1segment__v2_1_1_zone_map}{ZoneMap}}\&\ zone\_map)\ =\ 0;}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00090\ \ \ \ \ \textcolor{keyword}{virtual}\ uint64\_t\ \mbox{\hyperlink{classdoris_1_1segment__v2_1_1_zone_map_index_writer_ad6e91c334a35c6b6398de28ccbfaece2}{size}}()\ \textcolor{keyword}{const}\ =\ 0;}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00092\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1segment__v2_1_1_zone_map_index_writer_a17fb6e0216e942a4fc630076e639a4e1}{reset\_page\_zone\_map}}()\ =\ 0;}
\DoxyCodeLine{00093\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1segment__v2_1_1_zone_map_index_writer_a2ad0c31deb25203f58e88c0b51ace98e}{reset\_segment\_zone\_map}}()\ =\ 0;}
\DoxyCodeLine{00094\ \};}
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00096\ \textcolor{comment}{//\ Zone\ map\ index\ is\ represented\ by\ an\ IndexedColumn\ with\ ordinal\ index.}}
\DoxyCodeLine{00097\ \textcolor{comment}{//\ The\ IndexedColumn\ stores\ serialized\ ZoneMapPB\ for\ each\ data\ page.}}
\DoxyCodeLine{00098\ \textcolor{comment}{//\ It\ also\ create\ and\ store\ the\ segment-\/level\ zone\ map\ in\ the\ index\ meta\ so\ that}}
\DoxyCodeLine{00099\ \textcolor{comment}{//\ reader\ can\ prune\ an\ entire\ segment\ without\ reading\ pages.}}
\DoxyCodeLine{00100\ \textcolor{keyword}{template}\ <PrimitiveType\ Type>}
\DoxyCodeLine{00101\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classdoris_1_1segment__v2_1_1_typed_zone_map_index_writer}{TypedZoneMapIndexWriter}}\ final\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classdoris_1_1segment__v2_1_1_zone_map_index_writer}{ZoneMapIndexWriter}}\ \{}
\DoxyCodeLine{00102\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00103\ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{classdoris_1_1segment__v2_1_1_typed_zone_map_index_writer}{TypedZoneMapIndexWriter}}(\mbox{\hyperlink{classdoris_1_1_field}{Field}}*\ field);}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00105\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1segment__v2_1_1_typed_zone_map_index_writer_af6ce1aac7b43a8a74d00ebf507e03ac2}{add\_values}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ values,\ \textcolor{keywordtype}{size\_t}\ count)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00107\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1segment__v2_1_1_typed_zone_map_index_writer_a6cd3d582caee891a06cc9edf9cf93da4}{add\_nulls}}(uint32\_t\ count)\textcolor{keyword}{\ override\ }\{\ \mbox{\hyperlink{classdoris_1_1segment__v2_1_1_typed_zone_map_index_writer_a10f23d6548f6b4467464ec5d8015ec7b}{\_page\_zone\_map}}.\mbox{\hyperlink{structdoris_1_1segment__v2_1_1_zone_map_a78cf86ed4e3d2c55885e64604eb5cc9e}{has\_null}}\ =\ \textcolor{keyword}{true};\ \}}
\DoxyCodeLine{00108\ }
\DoxyCodeLine{00109\ \ \ \ \ \textcolor{comment}{//\ mark\ the\ end\ of\ one\ data\ page\ so\ that\ we\ can\ finalize\ the\ corresponding\ zone\ map}}
\DoxyCodeLine{00110\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1segment__v2_1_1_typed_zone_map_index_writer_ad79027858f888da67d94d9f46fb09db6}{flush}}()\ \textcolor{keyword}{override};}
\DoxyCodeLine{00111\ }
\DoxyCodeLine{00112\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1segment__v2_1_1_typed_zone_map_index_writer_a92ac14e4a5d25dfbfe4db047b040ec79}{finish}}(\mbox{\hyperlink{classdoris_1_1io_1_1_file_writer}{io::FileWriter}}*\ file\_writer,\ ColumnIndexMetaPB*\ index\_meta)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00114\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1segment__v2_1_1_typed_zone_map_index_writer_a96492f8d6d31a2de5a6fe0bf95282762}{moidfy\_index\_before\_flush}}(\mbox{\hyperlink{structdoris_1_1segment__v2_1_1_zone_map}{ZoneMap}}\&\ zone\_map)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00115\ }
\DoxyCodeLine{00116\ \ \ \ \ uint64\_t\ \mbox{\hyperlink{classdoris_1_1segment__v2_1_1_typed_zone_map_index_writer_a29c8248f6e0691cfce26b1ec9092b0b4}{size}}()\textcolor{keyword}{\ const\ override\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdoris_1_1segment__v2_1_1_typed_zone_map_index_writer_a0d61230eb66888b5d75a4eab276a581a}{\_estimated\_size}};\ \}}
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00118\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1segment__v2_1_1_typed_zone_map_index_writer_ab947400e5625981f7ccf748ac3fe6615}{reset\_page\_zone\_map}}()\ \textcolor{keyword}{override};}
\DoxyCodeLine{00119\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1segment__v2_1_1_typed_zone_map_index_writer_a9d6333c051875e3bd558a1744671c596}{reset\_segment\_zone\_map}}()\ \textcolor{keyword}{override};}
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00121\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00122\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1segment__v2_1_1_typed_zone_map_index_writer_adb60fec2f5bc2f8e281fee96f4cddebc}{\_reset\_zone\_map}}(\mbox{\hyperlink{structdoris_1_1segment__v2_1_1_zone_map}{ZoneMap}}*\ zone\_map)\ \{}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ we\ should\ allocate\ max\ varchar\ length\ and\ set\ to\ max\ for\ min\ value}}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1segment__v2_1_1_typed_zone_map_index_writer_a20ba3246a332b03620dfef7c8e3c9a3a}{\_field}}-\/>\mbox{\hyperlink{classdoris_1_1_field_a8a9c0e3468b66d8e671cc0fb3a66d98e}{set\_to\_zone\_map\_max}}(zone\_map-\/>\mbox{\hyperlink{structdoris_1_1segment__v2_1_1_zone_map_a5ad1d86e261de7f9132c7380d4ab1141}{min\_value}});}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1segment__v2_1_1_typed_zone_map_index_writer_a20ba3246a332b03620dfef7c8e3c9a3a}{\_field}}-\/>\mbox{\hyperlink{classdoris_1_1_field_a8f7408cdb7a150566fa8503adf3164d8}{set\_to\_zone\_map\_min}}(zone\_map-\/>\mbox{\hyperlink{structdoris_1_1segment__v2_1_1_zone_map_ace98cd4268ab0da492fba2b077095a26}{max\_value}});}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ zone\_map-\/>\mbox{\hyperlink{structdoris_1_1segment__v2_1_1_zone_map_a78cf86ed4e3d2c55885e64604eb5cc9e}{has\_null}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ zone\_map-\/>\mbox{\hyperlink{structdoris_1_1segment__v2_1_1_zone_map_ac1105826d0146ff89def74958aaa95e6}{has\_not\_null}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ zone\_map-\/>\mbox{\hyperlink{structdoris_1_1segment__v2_1_1_zone_map_a83639c24ec3bc32f7be71f807de041ab}{pass\_all}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00129\ \ \ \ \ \}}
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00131\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_field}{Field}}*\ \mbox{\hyperlink{classdoris_1_1segment__v2_1_1_typed_zone_map_index_writer_a20ba3246a332b03620dfef7c8e3c9a3a}{\_field}};}
\DoxyCodeLine{00132\ \ \ \ \ \textcolor{comment}{//\ memory\ will\ be\ managed\ by\ Arena}}
\DoxyCodeLine{00133\ \ \ \ \ \mbox{\hyperlink{structdoris_1_1segment__v2_1_1_zone_map}{ZoneMap}}\ \mbox{\hyperlink{classdoris_1_1segment__v2_1_1_typed_zone_map_index_writer_a10f23d6548f6b4467464ec5d8015ec7b}{\_page\_zone\_map}};}
\DoxyCodeLine{00134\ \ \ \ \ \mbox{\hyperlink{structdoris_1_1segment__v2_1_1_zone_map}{ZoneMap}}\ \mbox{\hyperlink{classdoris_1_1segment__v2_1_1_typed_zone_map_index_writer_ac15c4bba519bfba71575b31b4e8da4bd}{\_segment\_zone\_map}};}
\DoxyCodeLine{00135\ \ \ \ \ \textcolor{comment}{//\ TODO(zc):\ we\ should\ replace\ this\ arena\ later,\ we\ only\ allocate\ min/max}}
\DoxyCodeLine{00136\ \ \ \ \ \textcolor{comment}{//\ for\ field.\ But\ Arena\ allocate\ 4KB\ least,\ it\ will\ a\ waste\ for\ most\ cases.}}
\DoxyCodeLine{00137\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_arena}{vectorized::Arena}}\ \mbox{\hyperlink{classdoris_1_1segment__v2_1_1_typed_zone_map_index_writer_a5ce2827690b7bc49da6331de2172fe4d}{\_arena}};}
\DoxyCodeLine{00138\ }
\DoxyCodeLine{00139\ \ \ \ \ \textcolor{comment}{//\ serialized\ ZoneMapPB\ for\ each\ data\ page}}
\DoxyCodeLine{00140\ \ \ \ \ std::vector<std::string>\ \mbox{\hyperlink{classdoris_1_1segment__v2_1_1_typed_zone_map_index_writer_a084f9f813e913bbf0bc71e6be6235f9c}{\_values}};}
\DoxyCodeLine{00141\ \ \ \ \ uint64\_t\ \mbox{\hyperlink{classdoris_1_1segment__v2_1_1_typed_zone_map_index_writer_a0d61230eb66888b5d75a4eab276a581a}{\_estimated\_size}}\ =\ 0;}
\DoxyCodeLine{00142\ \};}
\DoxyCodeLine{00143\ }
\DoxyCodeLine{00144\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classdoris_1_1segment__v2_1_1_zone_map_index_reader}{ZoneMapIndexReader}}\ \{}
\DoxyCodeLine{00145\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00146\ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{classdoris_1_1segment__v2_1_1_zone_map_index_reader_af7a719db8550772ba850ca0b989efe9d}{ZoneMapIndexReader}}(\mbox{\hyperlink{namespacedoris_1_1io_a4fab59e5f39ac7c318b993fa0c5265ee}{io::FileReaderSPtr}}\ file\_reader,\ \textcolor{keyword}{const}\ ZoneMapIndexPB*\ index\_meta)}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{classdoris_1_1segment__v2_1_1_zone_map_index_reader_a0c94b8447f79ad7c6166e0b4e50c5cf8}{\_file\_reader}}(std::move(file\_reader)),\ \mbox{\hyperlink{classdoris_1_1segment__v2_1_1_zone_map_index_reader_a7acd8760e654c7fe1b9fb71793891215}{\_index\_meta}}(index\_meta)\ \{\}}
\DoxyCodeLine{00148\ }
\DoxyCodeLine{00149\ \ \ \ \ \textcolor{comment}{//\ load\ all\ page\ zone\ maps\ into\ memory}}
\DoxyCodeLine{00150\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1segment__v2_1_1_zone_map_index_reader_a3f9e9debec7dfe6a44dbc41b67565dfd}{load}}(\textcolor{keywordtype}{bool}\ use\_page\_cache,\ \textcolor{keywordtype}{bool}\ kept\_in\_memory);}
\DoxyCodeLine{00151\ }
\DoxyCodeLine{00152\ \ \ \ \ \textcolor{keyword}{const}\ std::vector<ZoneMapPB>\&\ \mbox{\hyperlink{classdoris_1_1segment__v2_1_1_zone_map_index_reader_ac3754bbf3d6212f1cb6ce60ba0ac3f38}{page\_zone\_maps}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdoris_1_1segment__v2_1_1_zone_map_index_reader_a1f5dd4e9c47d378cda6d0ff093e245f8}{\_page\_zone\_maps}};\ \}}
\DoxyCodeLine{00153\ }
\DoxyCodeLine{00154\ \ \ \ \ int32\_t\ \mbox{\hyperlink{classdoris_1_1segment__v2_1_1_zone_map_index_reader_a7c9cf2968de3319f98475bfefb9ce623}{num\_pages}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdoris_1_1segment__v2_1_1_zone_map_index_reader_a1f5dd4e9c47d378cda6d0ff093e245f8}{\_page\_zone\_maps}}.size();\ \}}
\DoxyCodeLine{00155\ }
\DoxyCodeLine{00156\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00157\ \ \ \ \ \mbox{\hyperlink{namespacedoris_1_1io_a4fab59e5f39ac7c318b993fa0c5265ee}{io::FileReaderSPtr}}\ \mbox{\hyperlink{classdoris_1_1segment__v2_1_1_zone_map_index_reader_a0c94b8447f79ad7c6166e0b4e50c5cf8}{\_file\_reader}};}
\DoxyCodeLine{00158\ \ \ \ \ \textcolor{keyword}{const}\ ZoneMapIndexPB*\ \mbox{\hyperlink{classdoris_1_1segment__v2_1_1_zone_map_index_reader_a7acd8760e654c7fe1b9fb71793891215}{\_index\_meta}};}
\DoxyCodeLine{00159\ }
\DoxyCodeLine{00160\ \ \ \ \ std::vector<ZoneMapPB>\ \mbox{\hyperlink{classdoris_1_1segment__v2_1_1_zone_map_index_reader_a1f5dd4e9c47d378cda6d0ff093e245f8}{\_page\_zone\_maps}};}
\DoxyCodeLine{00161\ \};}
\DoxyCodeLine{00162\ }
\DoxyCodeLine{00163\ \}\ \textcolor{comment}{//\ namespace\ segment\_v2}}
\DoxyCodeLine{00164\ \}\ \textcolor{comment}{//\ namespace\ doris}}

\end{DoxyCode}
