\hypertarget{coding_8h_source}{}\doxysection{coding.\+h}
\label{coding_8h_source}\index{/Users/dabowang/be\_all/util/coding.h@{/Users/dabowang/be\_all/util/coding.h}}
\mbox{\hyperlink{coding_8h}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ \ Copyright\ (c)\ 2011-\/present,\ Facebook,\ Inc.\ \ All\ rights\ reserved.}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ \ This\ source\ code\ is\ licensed\ under\ both\ the\ GPLv2\ (found\ in\ the}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ \ COPYING\ file\ in\ the\ root\ directory)\ and\ Apache\ 2.0\ License}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ \ (found\ in\ the\ LICENSE.Apache\ file\ in\ the\ root\ directory).}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ Copyright\ (c)\ 2011\ The\ LevelDB\ Authors.\ All\ rights\ reserved.}}
\DoxyCodeLine{00006\ \textcolor{comment}{//\ Use\ of\ this\ source\ code\ is\ governed\ by\ a\ BSD-\/style\ license\ that\ can\ be}}
\DoxyCodeLine{00007\ \textcolor{comment}{//\ found\ in\ the\ LICENSE\ file.\ See\ the\ AUTHORS\ file\ for\ names\ of\ contributors.}}
\DoxyCodeLine{00008\ }
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ <string>}}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{endian_8h}{gutil/endian.h}}"{}}}
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{olap_2olap__common_8h}{olap/olap\_common.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{slice_8h}{util/slice.h}}"{}}}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00017\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacedoris}{doris}}\ \{}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \textcolor{comment}{//\ TODO(zc):\ add\ encode\ big\ endian\ later\ when\ we\ need\ it}}
\DoxyCodeLine{00020\ \textcolor{comment}{//\ use\ big\ endian\ when\ we\ have\ order\ requirement.}}
\DoxyCodeLine{00021\ \textcolor{comment}{//\ little\ endian\ is\ more\ efficient\ when\ we\ use\ X86\ CPU,\ so}}
\DoxyCodeLine{00022\ \textcolor{comment}{//\ when\ we\ have\ no\ order\ needs,\ we\ prefer\ little\ endian\ encoding}}
\DoxyCodeLine{00023\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespacedoris_aa5e66abcac7dbe186a659f735712533f}{encode\_fixed8}}(uint8\_t*\ buf,\ uint8\_t\ val)\ \{}
\DoxyCodeLine{00024\ \ \ \ \ *buf\ =\ val;}
\DoxyCodeLine{00025\ \}}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00027\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespacedoris_a874b01ab366306e44e03993a4f60122c}{encode\_fixed16\_le}}(uint8\_t*\ buf,\ uint16\_t\ val)\ \{}
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#if\ \_\_BYTE\_ORDER\ ==\ \_\_LITTLE\_ENDIAN}}
\DoxyCodeLine{00029\ \ \ \ \ \mbox{\hyperlink{memcpy__aarch64_8cpp_a156c5821f16ed93be8c7d315303f7b2a}{memcpy}}(buf,\ \&val,\ \textcolor{keyword}{sizeof}(val));}
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00031\ \ \ \ \ uint16\_t\ res\ =\ \mbox{\hyperlink{port_8h_ad409605fabe125b1d222acb94a3f480f}{bswap\_16}}(val);}
\DoxyCodeLine{00032\ \ \ \ \ \mbox{\hyperlink{memcpy__aarch64_8cpp_a156c5821f16ed93be8c7d315303f7b2a}{memcpy}}(buf,\ \&res,\ \textcolor{keyword}{sizeof}(res));}
\DoxyCodeLine{00033\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00034\ \}}
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00036\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespacedoris_a343764117c996fb2e87e2eff6d19774c}{encode\_fixed32\_le}}(uint8\_t*\ buf,\ uint32\_t\ val)\ \{}
\DoxyCodeLine{00037\ \textcolor{preprocessor}{\#if\ \_\_BYTE\_ORDER\ ==\ \_\_LITTLE\_ENDIAN}}
\DoxyCodeLine{00038\ \ \ \ \ \mbox{\hyperlink{memcpy__aarch64_8cpp_a156c5821f16ed93be8c7d315303f7b2a}{memcpy}}(buf,\ \&val,\ \textcolor{keyword}{sizeof}(val));}
\DoxyCodeLine{00039\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00040\ \ \ \ \ uint32\_t\ res\ =\ \mbox{\hyperlink{port_8h_a5bcbf8b6ee067af4c2fd60ef3bdb39d2}{bswap\_32}}(val);}
\DoxyCodeLine{00041\ \ \ \ \ \mbox{\hyperlink{memcpy__aarch64_8cpp_a156c5821f16ed93be8c7d315303f7b2a}{memcpy}}(buf,\ \&res,\ \textcolor{keyword}{sizeof}(res));}
\DoxyCodeLine{00042\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00043\ \}}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespacedoris_ab931780a5307d87e117662e862408b6a}{encode\_fixed64\_le}}(uint8\_t*\ buf,\ uint64\_t\ val)\ \{}
\DoxyCodeLine{00046\ \textcolor{preprocessor}{\#if\ \_\_BYTE\_ORDER\ ==\ \_\_LITTLE\_ENDIAN}}
\DoxyCodeLine{00047\ \ \ \ \ \mbox{\hyperlink{memcpy__aarch64_8cpp_a156c5821f16ed93be8c7d315303f7b2a}{memcpy}}(buf,\ \&val,\ \textcolor{keyword}{sizeof}(val));}
\DoxyCodeLine{00048\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00049\ \ \ \ \ uint64\_t\ res\ =\ \mbox{\hyperlink{endian_8h_a86e0473276a5855fbe6317beef9089f7}{gbswap\_64}}(val);}
\DoxyCodeLine{00050\ \ \ \ \ \mbox{\hyperlink{memcpy__aarch64_8cpp_a156c5821f16ed93be8c7d315303f7b2a}{memcpy}}(buf,\ \&res,\ \textcolor{keyword}{sizeof}(res));}
\DoxyCodeLine{00051\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00052\ \}}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00054\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespacedoris_a6ace9755f7d477891e169683a7d9035c}{encode\_fixed128\_le}}(uint8\_t*\ buf,\ \mbox{\hyperlink{namespacedoris_aee92dadb31cc06d09b0932b066333595}{uint128\_t}}\ val)\ \{}
\DoxyCodeLine{00055\ \textcolor{preprocessor}{\#if\ \_\_BYTE\_ORDER\ ==\ \_\_LITTLE\_ENDIAN}}
\DoxyCodeLine{00056\ \ \ \ \ \mbox{\hyperlink{memcpy__aarch64_8cpp_a156c5821f16ed93be8c7d315303f7b2a}{memcpy}}(buf,\ \&val,\ \textcolor{keyword}{sizeof}(val));}
\DoxyCodeLine{00057\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00058\ \ \ \ \ \mbox{\hyperlink{namespacedoris_aee92dadb31cc06d09b0932b066333595}{uint128\_t}}\ res\ =\ \mbox{\hyperlink{endian_8h_ab418648a003823c5293d180e32e95455}{gbswap\_128}}(val);}
\DoxyCodeLine{00059\ \ \ \ \ \mbox{\hyperlink{memcpy__aarch64_8cpp_a156c5821f16ed93be8c7d315303f7b2a}{memcpy}}(buf,\ \&res,\ \textcolor{keyword}{sizeof}(res));}
\DoxyCodeLine{00060\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00061\ \}}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00063\ \textcolor{keyword}{inline}\ uint8\_t\ \mbox{\hyperlink{namespacedoris_a627e5fb4b7c95b6c0c072662a39ee7a7}{decode\_fixed8}}(\textcolor{keyword}{const}\ uint8\_t*\ buf)\ \{}
\DoxyCodeLine{00064\ \ \ \ \ \textcolor{keywordflow}{return}\ *buf;}
\DoxyCodeLine{00065\ \}}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00067\ \textcolor{keyword}{inline}\ uint16\_t\ \mbox{\hyperlink{namespacedoris_ab96faa07393a81d86bc78db791593a3d}{decode\_fixed16\_le}}(\textcolor{keyword}{const}\ uint8\_t*\ buf)\ \{}
\DoxyCodeLine{00068\ \ \ \ \ uint16\_t\ res;}
\DoxyCodeLine{00069\ \ \ \ \ \mbox{\hyperlink{memcpy__aarch64_8cpp_a156c5821f16ed93be8c7d315303f7b2a}{memcpy}}(\&res,\ buf,\ \textcolor{keyword}{sizeof}(res));}
\DoxyCodeLine{00070\ \textcolor{preprocessor}{\#if\ \_\_BYTE\_ORDER\ ==\ \_\_LITTLE\_ENDIAN}}
\DoxyCodeLine{00071\ \ \ \ \ \textcolor{keywordflow}{return}\ res;}
\DoxyCodeLine{00072\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00073\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{port_8h_ad409605fabe125b1d222acb94a3f480f}{bswap\_16}}(res);}
\DoxyCodeLine{00074\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00075\ \}}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ \textcolor{keyword}{inline}\ uint32\_t\ \mbox{\hyperlink{namespacedoris_a927ce65d9f547abdfc0ac9f473bee2ce}{decode\_fixed32\_le}}(\textcolor{keyword}{const}\ uint8\_t*\ buf)\ \{}
\DoxyCodeLine{00078\ \ \ \ \ uint32\_t\ res;}
\DoxyCodeLine{00079\ \ \ \ \ \mbox{\hyperlink{memcpy__aarch64_8cpp_a156c5821f16ed93be8c7d315303f7b2a}{memcpy}}(\&res,\ buf,\ \textcolor{keyword}{sizeof}(res));}
\DoxyCodeLine{00080\ \textcolor{preprocessor}{\#if\ \_\_BYTE\_ORDER\ ==\ \_\_LITTLE\_ENDIAN}}
\DoxyCodeLine{00081\ \ \ \ \ \textcolor{keywordflow}{return}\ res;}
\DoxyCodeLine{00082\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00083\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{port_8h_a5bcbf8b6ee067af4c2fd60ef3bdb39d2}{bswap\_32}}(res);}
\DoxyCodeLine{00084\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00085\ \}}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ \textcolor{keyword}{inline}\ uint64\_t\ \mbox{\hyperlink{namespacedoris_a6d56c5d0850f744b4c90f916cd48ad05}{decode\_fixed64\_le}}(\textcolor{keyword}{const}\ uint8\_t*\ buf)\ \{}
\DoxyCodeLine{00088\ \ \ \ \ uint64\_t\ res;}
\DoxyCodeLine{00089\ \ \ \ \ \mbox{\hyperlink{memcpy__aarch64_8cpp_a156c5821f16ed93be8c7d315303f7b2a}{memcpy}}(\&res,\ buf,\ \textcolor{keyword}{sizeof}(res));}
\DoxyCodeLine{00090\ \textcolor{preprocessor}{\#if\ \_\_BYTE\_ORDER\ ==\ \_\_LITTLE\_ENDIAN}}
\DoxyCodeLine{00091\ \ \ \ \ \textcolor{keywordflow}{return}\ res;}
\DoxyCodeLine{00092\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00093\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{endian_8h_a86e0473276a5855fbe6317beef9089f7}{gbswap\_64}}(res);}
\DoxyCodeLine{00094\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00095\ \}}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00097\ \textcolor{keyword}{inline}\ \mbox{\hyperlink{namespacedoris_aee92dadb31cc06d09b0932b066333595}{uint128\_t}}\ \mbox{\hyperlink{namespacedoris_a067fafeb8771dad890d0620f8e4a13e1}{decode\_fixed128\_le}}(\textcolor{keyword}{const}\ uint8\_t*\ buf)\ \{}
\DoxyCodeLine{00098\ \ \ \ \ \mbox{\hyperlink{namespacedoris_aee92dadb31cc06d09b0932b066333595}{uint128\_t}}\ res;}
\DoxyCodeLine{00099\ \ \ \ \ \mbox{\hyperlink{memcpy__aarch64_8cpp_a156c5821f16ed93be8c7d315303f7b2a}{memcpy}}(\&res,\ buf,\ \textcolor{keyword}{sizeof}(res));}
\DoxyCodeLine{00100\ \textcolor{preprocessor}{\#if\ \_\_BYTE\_ORDER\ ==\ \_\_LITTLE\_ENDIAN}}
\DoxyCodeLine{00101\ \ \ \ \ \textcolor{keywordflow}{return}\ res;}
\DoxyCodeLine{00102\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00103\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{endian_8h_ab418648a003823c5293d180e32e95455}{gbswap\_128}}(res);}
\DoxyCodeLine{00104\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00105\ \}}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00107\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00108\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespacedoris_ae4b159cd667e97f52562617ca1b83671}{put\_fixed32\_le}}(\mbox{\hyperlink{exp_8c_a0acb682b8260ab1c60b918599864e2e5}{T}}*\ dst,\ uint32\_t\ val)\ \{}
\DoxyCodeLine{00109\ \ \ \ \ uint8\_t\ buf[\textcolor{keyword}{sizeof}(val)];}
\DoxyCodeLine{00110\ \ \ \ \ \mbox{\hyperlink{namespacedoris_a343764117c996fb2e87e2eff6d19774c}{encode\_fixed32\_le}}(buf,\ val);}
\DoxyCodeLine{00111\ \ \ \ \ dst-\/>append((\textcolor{keywordtype}{char}*)buf,\ \textcolor{keyword}{sizeof}(buf));}
\DoxyCodeLine{00112\ \}}
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00114\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00115\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespacedoris_acf6decb9cdffdf421aba0ee16ebb2bb5}{put\_fixed64\_le}}(\mbox{\hyperlink{exp_8c_a0acb682b8260ab1c60b918599864e2e5}{T}}*\ dst,\ uint64\_t\ val)\ \{}
\DoxyCodeLine{00116\ \ \ \ \ uint8\_t\ buf[\textcolor{keyword}{sizeof}(val)];}
\DoxyCodeLine{00117\ \ \ \ \ \mbox{\hyperlink{namespacedoris_ab931780a5307d87e117662e862408b6a}{encode\_fixed64\_le}}(buf,\ val);}
\DoxyCodeLine{00118\ \ \ \ \ dst-\/>append((\textcolor{keywordtype}{char}*)buf,\ \textcolor{keyword}{sizeof}(buf));}
\DoxyCodeLine{00119\ \}}
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00121\ \textcolor{comment}{//\ Returns\ the\ length\ of\ the\ varint32\ or\ varint64\ encoding\ of\ "{}v"{}}}
\DoxyCodeLine{00122\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{namespacedoris_af66cdd969e0c468da0bb2966fed5a3e2}{varint\_length}}(uint64\_t\ v)\ \{}
\DoxyCodeLine{00123\ \ \ \ \ \textcolor{keywordtype}{int}\ len\ =\ 1;}
\DoxyCodeLine{00124\ \ \ \ \ \textcolor{keywordflow}{while}\ (v\ >=\ 128)\ \{}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ v\ >>=\ 7;}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ len++;}
\DoxyCodeLine{00127\ \ \ \ \ \}}
\DoxyCodeLine{00128\ \ \ \ \ \textcolor{keywordflow}{return}\ len;}
\DoxyCodeLine{00129\ \}}
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00131\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00132\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespacedoris_ae36585218654b93c81e6ae1f4277622f}{put\_fixed128\_le}}(\mbox{\hyperlink{exp_8c_a0acb682b8260ab1c60b918599864e2e5}{T}}*\ dst,\ \mbox{\hyperlink{namespacedoris_aee92dadb31cc06d09b0932b066333595}{uint128\_t}}\ val)\ \{}
\DoxyCodeLine{00133\ \ \ \ \ uint8\_t\ buf[\textcolor{keyword}{sizeof}(val)];}
\DoxyCodeLine{00134\ \ \ \ \ \mbox{\hyperlink{namespacedoris_a6ace9755f7d477891e169683a7d9035c}{encode\_fixed128\_le}}(buf,\ val);}
\DoxyCodeLine{00135\ \ \ \ \ dst-\/>append((\textcolor{keywordtype}{char}*)buf,\ \textcolor{keyword}{sizeof}(buf));}
\DoxyCodeLine{00136\ \}}
\DoxyCodeLine{00137\ }
\DoxyCodeLine{00138\ \textcolor{keyword}{extern}\ uint8\_t*\ \mbox{\hyperlink{namespacedoris_ad2a5df2ca0e715e830703d07239a483f}{encode\_varint32}}(uint8\_t*\ dst,\ uint32\_t\ \mbox{\hyperlink{util_2types_8h_adae7202c63102b0934c3ac5be41b0dae}{value}});}
\DoxyCodeLine{00139\ \textcolor{keyword}{extern}\ uint8\_t*\ \mbox{\hyperlink{namespacedoris_a847a7442908674bcfbfaa052e7198d63}{encode\_varint64}}(uint8\_t*\ dst,\ uint64\_t\ \mbox{\hyperlink{util_2types_8h_adae7202c63102b0934c3ac5be41b0dae}{value}});}
\DoxyCodeLine{00140\ }
\DoxyCodeLine{00141\ \textcolor{keyword}{inline}\ uint8\_t*\ \mbox{\hyperlink{namespacedoris_a847a7442908674bcfbfaa052e7198d63}{encode\_varint64}}(uint8\_t*\ dst,\ uint64\_t\ v)\ \{}
\DoxyCodeLine{00142\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{log_8c_a111da81ae5883147168bbb8366377b10}{B}}\ =\ 128;}
\DoxyCodeLine{00143\ \ \ \ \ \textcolor{keywordflow}{while}\ (v\ >=\ \mbox{\hyperlink{log_8c_a111da81ae5883147168bbb8366377b10}{B}})\ \{}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Fetch\ low\ seven\ bits\ from\ current\ v,\ and\ the\ eight\ bit\ is\ marked\ as\ compression\ mark.}}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ v\ |\ B\ is\ optimised\ from\ (v\ \&\ (B-\/1))\ |\ B,\ because\ result\ is\ assigned\ to\ uint8\_t\ and\ other\ bits}}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ is\ cleared\ by\ implicit\ conversion.}}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ *(dst++)\ =\ v\ |\ \mbox{\hyperlink{log_8c_a111da81ae5883147168bbb8366377b10}{B}};}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ v\ >>=\ 7;}
\DoxyCodeLine{00149\ \ \ \ \ \}}
\DoxyCodeLine{00150\ \ \ \ \ *(dst++)\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\textcolor{keyword}{>}(v);}
\DoxyCodeLine{00151\ \ \ \ \ \textcolor{keywordflow}{return}\ dst;}
\DoxyCodeLine{00152\ \}}
\DoxyCodeLine{00153\ }
\DoxyCodeLine{00154\ \textcolor{keyword}{extern}\ \textcolor{keyword}{const}\ uint8\_t*\ \mbox{\hyperlink{namespacedoris_a583a87b6775fb3ec04fb01c7a137b9cd}{decode\_varint32\_ptr\_fallback}}(\textcolor{keyword}{const}\ uint8\_t*\ p,\ \textcolor{keyword}{const}\ uint8\_t*\ limit,}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint32\_t*\ \mbox{\hyperlink{util_2types_8h_adae7202c63102b0934c3ac5be41b0dae}{value}});}
\DoxyCodeLine{00156\ }
\DoxyCodeLine{00157\ \textcolor{keyword}{inline}\ \textcolor{keyword}{const}\ uint8\_t*\ \mbox{\hyperlink{namespacedoris_ab3ee64bf1e8bef81f2cb0dc5f6419b6a}{decode\_varint32\_ptr}}(\textcolor{keyword}{const}\ uint8\_t*\ ptr,\ \textcolor{keyword}{const}\ uint8\_t*\ limit,}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint32\_t*\ \mbox{\hyperlink{util_2types_8h_adae7202c63102b0934c3ac5be41b0dae}{value}})\ \{}
\DoxyCodeLine{00159\ \ \ \ \ \textcolor{keywordflow}{if}\ (ptr\ <\ limit)\ \{}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ uint32\_t\ result\ =\ *ptr;}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((result\ \&\ 128)\ ==\ 0)\ \{}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \ \ \ \ *\mbox{\hyperlink{util_2types_8h_adae7202c63102b0934c3ac5be41b0dae}{value}}\ =\ result;}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ ptr\ +\ 1;}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00165\ \ \ \ \ \}}
\DoxyCodeLine{00166\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacedoris_a583a87b6775fb3ec04fb01c7a137b9cd}{decode\_varint32\_ptr\_fallback}}(ptr,\ limit,\ \mbox{\hyperlink{util_2types_8h_adae7202c63102b0934c3ac5be41b0dae}{value}});}
\DoxyCodeLine{00167\ \}}
\DoxyCodeLine{00168\ }
\DoxyCodeLine{00169\ \textcolor{keyword}{extern}\ \textcolor{keyword}{const}\ uint8\_t*\ \mbox{\hyperlink{namespacedoris_a85c4b95405e09ac831c9dbf59233f3aa}{decode\_varint64\_ptr}}(\textcolor{keyword}{const}\ uint8\_t*\ p,\ \textcolor{keyword}{const}\ uint8\_t*\ limit,\ uint64\_t*\ \mbox{\hyperlink{util_2types_8h_adae7202c63102b0934c3ac5be41b0dae}{value}});}
\DoxyCodeLine{00170\ }
\DoxyCodeLine{00171\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00172\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespacedoris_a784f98e58523fdf7662fee33ce53f0ae}{put\_varint32}}(\mbox{\hyperlink{exp_8c_a0acb682b8260ab1c60b918599864e2e5}{T}}*\ dst,\ uint32\_t\ v)\ \{}
\DoxyCodeLine{00173\ \ \ \ \ uint8\_t\ buf[16];}
\DoxyCodeLine{00174\ \ \ \ \ uint8\_t*\ ptr\ =\ \mbox{\hyperlink{namespacedoris_ad2a5df2ca0e715e830703d07239a483f}{encode\_varint32}}(buf,\ v);}
\DoxyCodeLine{00175\ \ \ \ \ dst-\/>append((\textcolor{keywordtype}{char}*)buf,\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{size\_t}\textcolor{keyword}{>}(ptr\ -\/\ buf));}
\DoxyCodeLine{00176\ \}}
\DoxyCodeLine{00177\ }
\DoxyCodeLine{00178\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00179\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespacedoris_aaad047e89902d9663f0a4a72cb73753d}{put\_varint64}}(\mbox{\hyperlink{exp_8c_a0acb682b8260ab1c60b918599864e2e5}{T}}*\ dst,\ uint64\_t\ v)\ \{}
\DoxyCodeLine{00180\ \ \ \ \ uint8\_t\ buf[16];}
\DoxyCodeLine{00181\ \ \ \ \ uint8\_t*\ ptr\ =\ \mbox{\hyperlink{namespacedoris_a847a7442908674bcfbfaa052e7198d63}{encode\_varint64}}(buf,\ v);}
\DoxyCodeLine{00182\ \ \ \ \ dst-\/>append((\textcolor{keywordtype}{char}*)buf,\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{size\_t}\textcolor{keyword}{>}(ptr\ -\/\ buf));}
\DoxyCodeLine{00183\ \}}
\DoxyCodeLine{00184\ }
\DoxyCodeLine{00185\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00186\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespacedoris_a768de1b88c8dac51e903c63b69fce0da}{put\_length\_prefixed\_slice}}(\mbox{\hyperlink{exp_8c_a0acb682b8260ab1c60b918599864e2e5}{T}}*\ dst,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structdoris_1_1_slice}{Slice}}\&\ \mbox{\hyperlink{util_2types_8h_adae7202c63102b0934c3ac5be41b0dae}{value}})\ \{}
\DoxyCodeLine{00187\ \ \ \ \ \mbox{\hyperlink{namespacedoris_a784f98e58523fdf7662fee33ce53f0ae}{put\_varint32}}(dst,\ \mbox{\hyperlink{util_2types_8h_adae7202c63102b0934c3ac5be41b0dae}{value}}.get\_size());}
\DoxyCodeLine{00188\ \ \ \ \ dst-\/>append(\mbox{\hyperlink{util_2types_8h_adae7202c63102b0934c3ac5be41b0dae}{value}}.get\_data(),\ \mbox{\hyperlink{util_2types_8h_adae7202c63102b0934c3ac5be41b0dae}{value}}.get\_size());}
\DoxyCodeLine{00189\ \}}
\DoxyCodeLine{00190\ }
\DoxyCodeLine{00191\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00192\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespacedoris_a7b0fcc82c6efe2ead27af06b869176d2}{put\_varint64\_varint32}}(\mbox{\hyperlink{exp_8c_a0acb682b8260ab1c60b918599864e2e5}{T}}*\ dst,\ uint64\_t\ \mbox{\hyperlink{lgamma_8c_aa093742515502bf4db0682901e124460}{v1}},\ uint32\_t\ \mbox{\hyperlink{lgamma_8c_abcf7b2a7a4c5fe85992ae2378315224e}{v2}})\ \{}
\DoxyCodeLine{00193\ \ \ \ \ uint8\_t\ buf[16];}
\DoxyCodeLine{00194\ \ \ \ \ uint8\_t*\ ptr\ =\ \mbox{\hyperlink{namespacedoris_a847a7442908674bcfbfaa052e7198d63}{encode\_varint64}}(buf,\ \mbox{\hyperlink{lgamma_8c_aa093742515502bf4db0682901e124460}{v1}});}
\DoxyCodeLine{00195\ \ \ \ \ ptr\ =\ \mbox{\hyperlink{namespacedoris_ad2a5df2ca0e715e830703d07239a483f}{encode\_varint32}}(ptr,\ \mbox{\hyperlink{lgamma_8c_abcf7b2a7a4c5fe85992ae2378315224e}{v2}});}
\DoxyCodeLine{00196\ \ \ \ \ dst-\/>append((\textcolor{keywordtype}{char}*)buf,\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{size\_t}\textcolor{keyword}{>}(ptr\ -\/\ buf));}
\DoxyCodeLine{00197\ \}}
\DoxyCodeLine{00198\ }
\DoxyCodeLine{00199\ \textcolor{comment}{//\ parse\ a\ varint32\ from\ the\ start\ of\ `input`\ into\ `val`.}}
\DoxyCodeLine{00200\ \textcolor{comment}{//\ on\ success,\ return\ true\ and\ advance\ `input`\ past\ the\ parsed\ value.}}
\DoxyCodeLine{00201\ \textcolor{comment}{//\ on\ failure,\ return\ false\ and\ `input`\ is\ not\ modified.}}
\DoxyCodeLine{00202\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacedoris_a43b1e2df482174ecfab859e306686cff}{get\_varint32}}(\mbox{\hyperlink{structdoris_1_1_slice}{Slice}}*\ input,\ uint32\_t*\ val)\ \{}
\DoxyCodeLine{00203\ \ \ \ \ \textcolor{keyword}{const}\ uint8\_t*\ p\ =\ (\textcolor{keyword}{const}\ uint8\_t*)input-\/>\mbox{\hyperlink{structdoris_1_1_slice_a91a70b77df95bd8b0830b49a094c2acb}{data}};}
\DoxyCodeLine{00204\ \ \ \ \ \textcolor{keyword}{const}\ uint8\_t*\ limit\ =\ p\ +\ input-\/>\mbox{\hyperlink{structdoris_1_1_slice_a854352f53b148adc24983a58a1866d66}{size}};}
\DoxyCodeLine{00205\ \ \ \ \ \textcolor{keyword}{const}\ uint8\_t*\ q\ =\ \mbox{\hyperlink{namespacedoris_ab3ee64bf1e8bef81f2cb0dc5f6419b6a}{decode\_varint32\_ptr}}(p,\ limit,\ val);}
\DoxyCodeLine{00206\ \ \ \ \ \textcolor{keywordflow}{if}\ (q\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00208\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \ \ *input\ =\ \mbox{\hyperlink{structdoris_1_1_slice}{Slice}}(q,\ limit\ -\/\ q);}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00211\ \ \ \ \ \}}
\DoxyCodeLine{00212\ \}}
\DoxyCodeLine{00213\ }
\DoxyCodeLine{00214\ \textcolor{comment}{//\ parse\ a\ varint64\ from\ the\ start\ of\ `input`\ into\ `val`.}}
\DoxyCodeLine{00215\ \textcolor{comment}{//\ on\ success,\ return\ true\ and\ advance\ `input`\ past\ the\ parsed\ value.}}
\DoxyCodeLine{00216\ \textcolor{comment}{//\ on\ failure,\ return\ false\ and\ `input`\ is\ not\ modified.}}
\DoxyCodeLine{00217\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacedoris_ae1c6b691df3a1ace662e685211a54a68}{get\_varint64}}(\mbox{\hyperlink{structdoris_1_1_slice}{Slice}}*\ input,\ uint64\_t*\ val)\ \{}
\DoxyCodeLine{00218\ \ \ \ \ \textcolor{keyword}{const}\ uint8\_t*\ p\ =\ (\textcolor{keyword}{const}\ uint8\_t*)input-\/>\mbox{\hyperlink{structdoris_1_1_slice_a91a70b77df95bd8b0830b49a094c2acb}{data}};}
\DoxyCodeLine{00219\ \ \ \ \ \textcolor{keyword}{const}\ uint8\_t*\ limit\ =\ p\ +\ input-\/>\mbox{\hyperlink{structdoris_1_1_slice_a854352f53b148adc24983a58a1866d66}{size}};}
\DoxyCodeLine{00220\ \ \ \ \ \textcolor{keyword}{const}\ uint8\_t*\ q\ =\ \mbox{\hyperlink{namespacedoris_a85c4b95405e09ac831c9dbf59233f3aa}{decode\_varint64\_ptr}}(p,\ limit,\ val);}
\DoxyCodeLine{00221\ \ \ \ \ \textcolor{keywordflow}{if}\ (q\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00223\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00224\ \ \ \ \ \ \ \ \ *input\ =\ \mbox{\hyperlink{structdoris_1_1_slice}{Slice}}(q,\ limit\ -\/\ q);}
\DoxyCodeLine{00225\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00226\ \ \ \ \ \}}
\DoxyCodeLine{00227\ \}}
\DoxyCodeLine{00228\ }
\DoxyCodeLine{00229\ \textcolor{comment}{//\ parse\ a\ length-\/prefixed-\/slice\ from\ the\ start\ of\ `input`\ into\ `val`.}}
\DoxyCodeLine{00230\ \textcolor{comment}{//\ on\ success,\ return\ true\ and\ advance\ `input`\ past\ the\ parsed\ value.}}
\DoxyCodeLine{00231\ \textcolor{comment}{//\ on\ failure,\ return\ false\ and\ `input`\ may\ or\ may\ not\ be\ modified.}}
\DoxyCodeLine{00232\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacedoris_a415d6962e55ca1212ee54d355233c161}{get\_length\_prefixed\_slice}}(\mbox{\hyperlink{structdoris_1_1_slice}{Slice}}*\ input,\ \mbox{\hyperlink{structdoris_1_1_slice}{Slice}}*\ val)\ \{}
\DoxyCodeLine{00233\ \ \ \ \ uint32\_t\ len;}
\DoxyCodeLine{00234\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacedoris_a43b1e2df482174ecfab859e306686cff}{get\_varint32}}(input,\ \&len)\ \&\&\ input-\/>\mbox{\hyperlink{structdoris_1_1_slice_adeac1643dd75193bb87fe54485a32600}{get\_size}}()\ >=\ len)\ \{}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ *val\ =\ \mbox{\hyperlink{structdoris_1_1_slice}{Slice}}(input-\/>\mbox{\hyperlink{structdoris_1_1_slice_a30578fc3dd9ac76530995b2ddd902a84}{get\_data}}(),\ len);}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ input-\/>\mbox{\hyperlink{structdoris_1_1_slice_ad51651afef0ae59bf122b1cd9df2facb}{remove\_prefix}}(len);}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00238\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00240\ \ \ \ \ \}}
\DoxyCodeLine{00241\ \}}
\DoxyCodeLine{00242\ }
\DoxyCodeLine{00243\ \}\ \textcolor{comment}{//\ namespace\ doris}}

\end{DoxyCode}
