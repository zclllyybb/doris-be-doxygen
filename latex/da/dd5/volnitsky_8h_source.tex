\hypertarget{volnitsky_8h_source}{}\doxysection{volnitsky.\+h}
\label{volnitsky_8h_source}\index{/Users/dabowang/doris/be/src/vec/common/volnitsky.h@{/Users/dabowang/doris/be/src/vec/common/volnitsky.h}}
\mbox{\hyperlink{volnitsky_8h}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Licensed\ to\ the\ Apache\ Software\ Foundation\ (ASF)\ under\ one}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ or\ more\ contributor\ license\ agreements.\ \ See\ the\ NOTICE\ file}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ distributed\ with\ this\ work\ for\ additional\ information}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ regarding\ copyright\ ownership.\ \ The\ ASF\ licenses\ this\ file}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ to\ you\ under\ the\ Apache\ License,\ Version\ 2.0\ (the}}
\DoxyCodeLine{00006\ \textcolor{comment}{//\ "{}License"{});\ you\ may\ not\ use\ this\ file\ except\ in\ compliance}}
\DoxyCodeLine{00007\ \textcolor{comment}{//\ with\ the\ License.\ \ You\ may\ obtain\ a\ copy\ of\ the\ License\ at}}
\DoxyCodeLine{00008\ \textcolor{comment}{//}}
\DoxyCodeLine{00009\ \textcolor{comment}{//\ \ \ http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{00010\ \textcolor{comment}{//}}
\DoxyCodeLine{00011\ \textcolor{comment}{//\ Unless\ required\ by\ applicable\ law\ or\ agreed\ to\ in\ writing,}}
\DoxyCodeLine{00012\ \textcolor{comment}{//\ software\ distributed\ under\ the\ License\ is\ distributed\ on\ an}}
\DoxyCodeLine{00013\ \textcolor{comment}{//\ "{}AS\ IS"{}\ BASIS,\ WITHOUT\ WARRANTIES\ OR\ CONDITIONS\ OF\ ANY}}
\DoxyCodeLine{00014\ \textcolor{comment}{//\ KIND,\ either\ express\ or\ implied.\ \ See\ the\ License\ for\ the}}
\DoxyCodeLine{00015\ \textcolor{comment}{//\ specific\ language\ governing\ permissions\ and\ limitations}}
\DoxyCodeLine{00016\ \textcolor{comment}{//\ under\ the\ License.}}
\DoxyCodeLine{00017\ \textcolor{comment}{//\ This\ file\ is\ copied\ from}}
\DoxyCodeLine{00018\ \textcolor{comment}{//\ https://github.com/ClickHouse/ClickHouse/blob/master/src/Common/Volnitsky.h}}
\DoxyCodeLine{00019\ \textcolor{comment}{//\ and\ modified\ by\ Doris}}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ <stdint.h>}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ <string.h>}}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#include\ <algorithm>}}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#include\ <limits>}}
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{string__searcher_8h}{vec/common/string\_searcher.h}}"{}}}
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{unaligned_8h}{vec/common/unaligned.h}}"{}}}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00055\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacedoris}{doris}}\ \{}
\DoxyCodeLine{00056\ \textcolor{keyword}{using\ }\mbox{\hyperlink{namespacedoris_ac82f32fb6f16dbdc32cb4076004e63c4}{UInt8}}\ =\ uint8\_t;}
\DoxyCodeLine{00057\ \textcolor{keyword}{using\ }\mbox{\hyperlink{namespacedoris_afab11e51a98da69a0956ae5110641c8d}{UInt16}}\ =\ uint16\_t;}
\DoxyCodeLine{00058\ \textcolor{keyword}{using\ }\mbox{\hyperlink{namespacedoris_a81586a76c764e2556f67139907fa5440}{UInt64}}\ =\ uint64\_t;}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00060\ \textcolor{keyword}{namespace\ }VolnitskyTraits\ \{}
\DoxyCodeLine{00061\ \textcolor{keyword}{using\ }\mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_af1be2513bce0c752816a174c0489f992}{Offset}}\ =}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedoris_ac82f32fb6f16dbdc32cb4076004e63c4}{UInt8}};\ }
\DoxyCodeLine{00063\ \textcolor{keyword}{using\ }\mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a0e10dd61221b5f79e364efd561255075}{Id}}\ =}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedoris_ac82f32fb6f16dbdc32cb4076004e63c4}{UInt8}};\ }
\DoxyCodeLine{00065\ \textcolor{keyword}{using\ }\mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a2c8aec128b5de8c15e4b5912dd60b720}{Ngram}}\ =\ \mbox{\hyperlink{namespacedoris_afab11e51a98da69a0956ae5110641c8d}{UInt16}};\ }
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00070\ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a07e9f6ae0b6164b06f0a0a1921a0c33b}{hash\_size}}\ =\ 64\ *\ 1024;}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00073\ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_aeb1b8d5bebcbd3e45a27702b212c86b2}{min\_haystack\_size\_for\_algorithm}}\ =\ 20000;}
\DoxyCodeLine{00074\ }
\DoxyCodeLine{00075\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a9f90a0860a33a7c7d19cc72f3a60d340}{isFallbackNeedle}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ needle\_size,\ \textcolor{keywordtype}{size\_t}\ haystack\_size\_hint\ =\ 0)\ \{}
\DoxyCodeLine{00076\ \ \ \ \ \textcolor{keywordflow}{return}\ needle\_size\ <\ 2\ *\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a2c8aec128b5de8c15e4b5912dd60b720}{Ngram}})\ ||\ needle\_size\ >=\ std::numeric\_limits<Offset>::max()\ ||}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \ \ \ (haystack\_size\_hint\ \&\&\ haystack\_size\_hint\ <\ \mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_aeb1b8d5bebcbd3e45a27702b212c86b2}{min\_haystack\_size\_for\_algorithm}});}
\DoxyCodeLine{00078\ \}}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00080\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a2c8aec128b5de8c15e4b5912dd60b720}{Ngram}}\ \mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_abbf447cbcd1f6cacd8c33d697caac46c}{toNGram}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespacedoris_ac82f32fb6f16dbdc32cb4076004e63c4}{UInt8}}*\ \textcolor{keyword}{const}\ pos)\ \{}
\DoxyCodeLine{00081\ \ \ \ \ \textcolor{keywordflow}{return}\ unaligned\_load<Ngram>(pos);}
\DoxyCodeLine{00082\ \}}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00084\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Callback>}
\DoxyCodeLine{00085\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_adb01f18338cce640e57351037a541bf4}{putNGramASCIICaseInsensitive}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespacedoris_ac82f32fb6f16dbdc32cb4076004e63c4}{UInt8}}*\ pos,\ \textcolor{keywordtype}{int}\ offset,\ Callback\&\&\ putNGramBase)\ \{}
\DoxyCodeLine{00086\ \ \ \ \ \textcolor{keyword}{struct\ }Chars\ \{}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedoris_ac82f32fb6f16dbdc32cb4076004e63c4}{UInt8}}\ c0;}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedoris_ac82f32fb6f16dbdc32cb4076004e63c4}{UInt8}}\ c1;}
\DoxyCodeLine{00089\ \ \ \ \ \};}
\DoxyCodeLine{00090\ }
\DoxyCodeLine{00091\ \ \ \ \ \textcolor{keyword}{union\ }\{}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a2c8aec128b5de8c15e4b5912dd60b720}{Ngram}}\ n;}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ Chars\ chars;}
\DoxyCodeLine{00094\ \ \ \ \ \};}
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00096\ \ \ \ \ n\ =\ \mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_abbf447cbcd1f6cacd8c33d697caac46c}{toNGram}}(pos);}
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00098\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ c0\_al\ =\ isAlphaASCII(chars.c0);}
\DoxyCodeLine{00099\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ c1\_al\ =\ isAlphaASCII(chars.c1);}
\DoxyCodeLine{00100\ }
\DoxyCodeLine{00101\ \ \ \ \ \textcolor{keywordflow}{if}\ (c0\_al\ \&\&\ c1\_al)\ \{}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ putNGramBase(n,\ offset);}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ chars.c0\ =\ alternateCaseIfAlphaASCII(chars.c0);}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \ \ putNGramBase(n,\ offset);}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ chars.c1\ =\ alternateCaseIfAlphaASCII(chars.c1);}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ putNGramBase(n,\ offset);}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ chars.c0\ =\ alternateCaseIfAlphaASCII(chars.c0);}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ putNGramBase(n,\ offset);}
\DoxyCodeLine{00110\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (c0\_al)\ \{}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ putNGramBase(n,\ offset);}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ chars.c0\ =\ alternateCaseIfAlphaASCII(chars.c0);}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ putNGramBase(n,\ offset);}
\DoxyCodeLine{00115\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (c1\_al)\ \{}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ putNGramBase(n,\ offset);}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ chars.c1\ =\ alternateCaseIfAlphaASCII(chars.c1);}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ putNGramBase(n,\ offset);}
\DoxyCodeLine{00120\ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ putNGramBase(n,\ offset);}
\DoxyCodeLine{00123\ }
\DoxyCodeLine{00124\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00125\ \}}
\DoxyCodeLine{00126\ }
\DoxyCodeLine{00127\ \textcolor{keyword}{template}\ <\textcolor{keywordtype}{bool}\ CaseSensitive,\ \textcolor{keywordtype}{bool}\ ASCII,\ \textcolor{keyword}{typename}\ Callback>}
\DoxyCodeLine{00128\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_afab7071c5a7868a3d3112291c6c39197}{putNGram}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespacedoris_ac82f32fb6f16dbdc32cb4076004e63c4}{UInt8}}*\ pos,\ \textcolor{keywordtype}{int}\ offset,\ [[maybe\_unused]]\ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespacedoris_ac82f32fb6f16dbdc32cb4076004e63c4}{UInt8}}*\ begin,\ \textcolor{keywordtype}{size\_t}\ size,}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Callback\&\&\ putNGramBase)\ \{}
\DoxyCodeLine{00130\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (CaseSensitive)\ \{}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ putNGramBase(\mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_abbf447cbcd1f6cacd8c33d697caac46c}{toNGram}}(pos),\ offset);}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00133\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (ASCII)\ \{}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_adb01f18338cce640e57351037a541bf4}{putNGramASCIICaseInsensitive}}(pos,\ offset,\ std::forward<Callback>(putNGramBase));}
\DoxyCodeLine{00135\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ return\ putNGramUTF8CaseInsensitive(pos,\ offset,\ begin,\ size,\ std::forward<Callback>(putNGramBase));}}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00138\ \ \ \ \ \}}
\DoxyCodeLine{00139\ \}}
\DoxyCodeLine{00140\ \}\ \textcolor{comment}{//\ namespace\ VolnitskyTraits}}
\DoxyCodeLine{00141\ }
\DoxyCodeLine{00143\ \textcolor{keyword}{template}\ <\textcolor{keywordtype}{bool}\ CaseSensitive,\ \textcolor{keywordtype}{bool}\ ASCII,\ \textcolor{keyword}{typename}\ FallbackSearcher>}
\DoxyCodeLine{00144\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classdoris_1_1_volnitsky_base}{VolnitskyBase}}\ \{}
\DoxyCodeLine{00145\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00146\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespacedoris_ac82f32fb6f16dbdc32cb4076004e63c4}{UInt8}}*\ \mbox{\hyperlink{classdoris_1_1_volnitsky_base_a066c5ae8dfcf4e56bd1d07b3f7ebe023}{needle}};}
\DoxyCodeLine{00147\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classdoris_1_1_volnitsky_base_ac0d173c16e65473deb24d426137c4595}{needle\_size}};}
\DoxyCodeLine{00148\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespacedoris_ac82f32fb6f16dbdc32cb4076004e63c4}{UInt8}}*\ \mbox{\hyperlink{classdoris_1_1_volnitsky_base_a63aaa7b1f63b42b26631b4ca301f6577}{needle\_end}}\ =\ \mbox{\hyperlink{classdoris_1_1_volnitsky_base_a066c5ae8dfcf4e56bd1d07b3f7ebe023}{needle}}\ +\ \mbox{\hyperlink{classdoris_1_1_volnitsky_base_ac0d173c16e65473deb24d426137c4595}{needle\_size}};}
\DoxyCodeLine{00150\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classdoris_1_1_volnitsky_base_aa4d697c762fb380a0b8af7043dea701b}{step}}\ =\ \mbox{\hyperlink{classdoris_1_1_volnitsky_base_ac0d173c16e65473deb24d426137c4595}{needle\_size}}\ -\/\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a2c8aec128b5de8c15e4b5912dd60b720}{VolnitskyTraits::Ngram}})\ +\ 1;}
\DoxyCodeLine{00151\ }
\DoxyCodeLine{00154\ \ \ \ \ std::unique\_ptr<VolnitskyTraits::Offset[]>\ \mbox{\hyperlink{classdoris_1_1_volnitsky_base_a2b3a83e65c25aee60ac88804dd1c491d}{hash}};\ }
\DoxyCodeLine{00155\ }
\DoxyCodeLine{00156\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1_volnitsky_base_a912a01c1a45a1b5ac103bcd7fab6cd45}{fallback}};\ }
\DoxyCodeLine{00157\ }
\DoxyCodeLine{00158\ \ \ \ \ FallbackSearcher\ \mbox{\hyperlink{classdoris_1_1_volnitsky_base_a97b2a710d147aa252a4e11d7975de7c6}{fallback\_searcher}};}
\DoxyCodeLine{00159\ }
\DoxyCodeLine{00160\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00161\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{classdoris_1_1_volnitsky_base_a0e273c3b143eb117aa256c31867a4016}{Searcher}}\ =\ FallbackSearcher;}
\DoxyCodeLine{00162\ }
\DoxyCodeLine{00167\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_volnitsky_base_a43580485c049028abb0cb2af5e8faed1}{VolnitskyBase}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \textcolor{keyword}{const}\ needle\_,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ needle\_size\_,}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ haystack\_size\_hint\ =\ 0)}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{classdoris_1_1_volnitsky_base_a066c5ae8dfcf4e56bd1d07b3f7ebe023}{needle}}\ \{reinterpret\_cast<const\ \mbox{\hyperlink{namespacedoris_ac82f32fb6f16dbdc32cb4076004e63c4}{UInt8}}*>(needle\_)\},}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_volnitsky_base_ac0d173c16e65473deb24d426137c4595}{needle\_size}}\ \{needle\_size\_\},}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_volnitsky_base_a912a01c1a45a1b5ac103bcd7fab6cd45}{fallback}}\ \{VolnitskyTraits::isFallbackNeedle(\mbox{\hyperlink{classdoris_1_1_volnitsky_base_ac0d173c16e65473deb24d426137c4595}{needle\_size}},\ haystack\_size\_hint)\},}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_volnitsky_base_a97b2a710d147aa252a4e11d7975de7c6}{fallback\_searcher}}\ \{needle\_,\ \mbox{\hyperlink{classdoris_1_1_volnitsky_base_ac0d173c16e65473deb24d426137c4595}{needle\_size}}\}\ \{}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classdoris_1_1_volnitsky_base_a912a01c1a45a1b5ac103bcd7fab6cd45}{fallback}}\ ||\ \mbox{\hyperlink{classdoris_1_1_volnitsky_base_a97b2a710d147aa252a4e11d7975de7c6}{fallback\_searcher}}.force\_fallback)\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00174\ }
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_volnitsky_base_a2b3a83e65c25aee60ac88804dd1c491d}{hash}}\ =\ std::unique\_ptr<VolnitskyTraits::Offset[]>(}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{new}\ \mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_af1be2513bce0c752816a174c0489f992}{VolnitskyTraits::Offset}}[\mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a07e9f6ae0b6164b06f0a0a1921a0c33b}{VolnitskyTraits::hash\_size}}]\ \{\});}
\DoxyCodeLine{00177\ }
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ callback\ =\ [\textcolor{keyword}{this}](\textcolor{keyword}{const}\ \mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a2c8aec128b5de8c15e4b5912dd60b720}{VolnitskyTraits::Ngram}}\ ngram,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ offset)\ \{}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ this-\/>\mbox{\hyperlink{classdoris_1_1_volnitsky_base_a5dd8a6e52d1152338d58c930b5d9f851}{putNGramBase}}(ngram,\ offset);}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ i\ =\ \textcolor{keyword}{static\_cast<}ssize\_t\textcolor{keyword}{>}(\mbox{\hyperlink{classdoris_1_1_volnitsky_base_ac0d173c16e65473deb24d426137c4595}{needle\_size}}\ -\/\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a2c8aec128b5de8c15e4b5912dd60b720}{VolnitskyTraits::Ngram}}));\ i\ >=\ 0;}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/-\/i)\ \{}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ ok\ =\ VolnitskyTraits::putNGram<CaseSensitive,\ ASCII>(\mbox{\hyperlink{classdoris_1_1_volnitsky_base_a066c5ae8dfcf4e56bd1d07b3f7ebe023}{needle}}\ +\ i,\ i\ +\ 1,\ \mbox{\hyperlink{classdoris_1_1_volnitsky_base_a066c5ae8dfcf4e56bd1d07b3f7ebe023}{needle}},}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_volnitsky_base_ac0d173c16e65473deb24d426137c4595}{needle\_size}},\ callback);}
\DoxyCodeLine{00187\ }
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!ok)\ \{}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_volnitsky_base_a97b2a710d147aa252a4e11d7975de7c6}{fallback\_searcher}}.force\_fallback\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_volnitsky_base_a2b3a83e65c25aee60ac88804dd1c491d}{hash}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00196\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00198\ \ \ \ \ \}}
\DoxyCodeLine{00199\ }
\DoxyCodeLine{00201\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespacedoris_ac82f32fb6f16dbdc32cb4076004e63c4}{UInt8}}*\ \mbox{\hyperlink{classdoris_1_1_volnitsky_base_a0e2c3c5d3d54d5a865b2c426968814ec}{search}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespacedoris_ac82f32fb6f16dbdc32cb4076004e63c4}{UInt8}}*\ \textcolor{keyword}{const}\ haystack,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ haystack\_size)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classdoris_1_1_volnitsky_base_ac0d173c16e65473deb24d426137c4595}{needle\_size}}\ ==\ 0)\ \textcolor{keywordflow}{return}\ haystack;}
\DoxyCodeLine{00203\ }
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}*\ haystack\_end\ =\ haystack\ +\ haystack\_size;}
\DoxyCodeLine{00205\ }
\DoxyCodeLine{00206\ \textcolor{preprocessor}{\#ifdef\ \_\_SSE4\_1\_\_}}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdoris_1_1_volnitsky_base_a97b2a710d147aa252a4e11d7975de7c6}{fallback\_searcher}}.search(haystack,\ haystack\_end);}
\DoxyCodeLine{00208\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00209\ }
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classdoris_1_1_volnitsky_base_a912a01c1a45a1b5ac103bcd7fab6cd45}{fallback}}\ ||\ haystack\_size\ <=\ \mbox{\hyperlink{classdoris_1_1_volnitsky_base_ac0d173c16e65473deb24d426137c4595}{needle\_size}}\ ||\ \mbox{\hyperlink{classdoris_1_1_volnitsky_base_a97b2a710d147aa252a4e11d7975de7c6}{fallback\_searcher}}.force\_fallback)}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdoris_1_1_volnitsky_base_a97b2a710d147aa252a4e11d7975de7c6}{fallback\_searcher}}.search(haystack,\ haystack\_end);}
\DoxyCodeLine{00212\ }
\DoxyCodeLine{00214\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}*\ pos\ =\ haystack\ +\ \mbox{\hyperlink{classdoris_1_1_volnitsky_base_ac0d173c16e65473deb24d426137c4595}{needle\_size}}\ -\/\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a2c8aec128b5de8c15e4b5912dd60b720}{VolnitskyTraits::Ngram}});}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ pos\ <=\ haystack\_end\ -\/\ \mbox{\hyperlink{classdoris_1_1_volnitsky_base_ac0d173c16e65473deb24d426137c4595}{needle\_size}};\ pos\ +=\ \mbox{\hyperlink{classdoris_1_1_volnitsky_base_aa4d697c762fb380a0b8af7043dea701b}{step}})\ \{}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ cell\_num\ =\ \mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_abbf447cbcd1f6cacd8c33d697caac46c}{VolnitskyTraits::toNGram}}(pos)\ \%\ \mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a07e9f6ae0b6164b06f0a0a1921a0c33b}{VolnitskyTraits::hash\_size}};}
\DoxyCodeLine{00218\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_volnitsky_base_a2b3a83e65c25aee60ac88804dd1c491d}{hash}}[cell\_num];\ cell\_num\ =\ (cell\_num\ +\ 1)\ \%\ \mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a07e9f6ae0b6164b06f0a0a1921a0c33b}{VolnitskyTraits::hash\_size}})\ \{}
\DoxyCodeLine{00220\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}*\ res\ =\ pos\ -\/\ (\mbox{\hyperlink{classdoris_1_1_volnitsky_base_a2b3a83e65c25aee60ac88804dd1c491d}{hash}}[cell\_num]\ -\/\ 1);}
\DoxyCodeLine{00221\ }
\DoxyCodeLine{00223\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classdoris_1_1_volnitsky_base_a97b2a710d147aa252a4e11d7975de7c6}{fallback\_searcher}}.compare(haystack,\ haystack\_end,\ res))\ \textcolor{keywordflow}{return}\ res;}
\DoxyCodeLine{00224\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00225\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00226\ }
\DoxyCodeLine{00227\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdoris_1_1_volnitsky_base_a97b2a710d147aa252a4e11d7975de7c6}{fallback\_searcher}}.search(pos\ -\/\ \mbox{\hyperlink{classdoris_1_1_volnitsky_base_aa4d697c762fb380a0b8af7043dea701b}{step}}\ +\ 1,\ haystack\_end);}
\DoxyCodeLine{00228\ \ \ \ \ \}}
\DoxyCodeLine{00229\ }
\DoxyCodeLine{00230\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \mbox{\hyperlink{classdoris_1_1_volnitsky_base_ac4b57462fe195293df2213bbfbee517d}{search}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ haystack,\ \textcolor{keywordtype}{size\_t}\ haystack\_size)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\textcolor{keywordtype}{char}*\textcolor{keyword}{>}(}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_volnitsky_base_a0e2c3c5d3d54d5a865b2c426968814ec}{search}}(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\mbox{\hyperlink{namespacedoris_ac82f32fb6f16dbdc32cb4076004e63c4}{UInt8}}*\textcolor{keyword}{>}(haystack),\ haystack\_size));}
\DoxyCodeLine{00233\ \ \ \ \ \}}
\DoxyCodeLine{00234\ }
\DoxyCodeLine{00235\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00236\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1_volnitsky_base_a5dd8a6e52d1152338d58c930b5d9f851}{putNGramBase}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a2c8aec128b5de8c15e4b5912dd60b720}{VolnitskyTraits::Ngram}}\ ngram,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ offset)\ \{}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ cell\_num\ =\ ngram\ \%\ \mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a07e9f6ae0b6164b06f0a0a1921a0c33b}{VolnitskyTraits::hash\_size}};}
\DoxyCodeLine{00239\ }
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (\mbox{\hyperlink{classdoris_1_1_volnitsky_base_a2b3a83e65c25aee60ac88804dd1c491d}{hash}}[cell\_num])}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \ \ \ \ cell\_num\ =}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (cell\_num\ +\ 1)\ \%\ \mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a07e9f6ae0b6164b06f0a0a1921a0c33b}{VolnitskyTraits::hash\_size}};\ }
\DoxyCodeLine{00243\ }
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_volnitsky_base_a2b3a83e65c25aee60ac88804dd1c491d}{hash}}[cell\_num]\ =\ offset;}
\DoxyCodeLine{00245\ \ \ \ \ \}}
\DoxyCodeLine{00246\ \};}
\DoxyCodeLine{00247\ }
\DoxyCodeLine{00248\ \textcolor{keyword}{template}\ <\textcolor{keywordtype}{bool}\ CaseSensitive,\ \textcolor{keywordtype}{bool}\ ASCII,\ \textcolor{keyword}{typename}\ FallbackSearcher>}
\DoxyCodeLine{00249\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base}{MultiVolnitskyBase}}\ \{}
\DoxyCodeLine{00250\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00252\ \ \ \ \ \textcolor{keyword}{const}\ std::vector<StringRef>\&\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_a91aac91dda761ccb6d059e1b1fa673d6}{needles}};}
\DoxyCodeLine{00253\ }
\DoxyCodeLine{00255\ \ \ \ \ std::vector<size\_t>\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_a5f3f4f103526fb6a034cf5dfdf921068}{fallback\_needles}};}
\DoxyCodeLine{00256\ \ \ \ \ std::vector<FallbackSearcher>\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_a9b151e18e4d9d53858968824b7445123}{fallback\_searchers}};}
\DoxyCodeLine{00257\ }
\DoxyCodeLine{00259\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structdoris_1_1_multi_volnitsky_base_1_1_offset_id}{OffsetId}}\ \{}
\DoxyCodeLine{00260\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a0e10dd61221b5f79e364efd561255075}{VolnitskyTraits::Id}}\ \mbox{\hyperlink{structdoris_1_1_multi_volnitsky_base_1_1_offset_id_aca701e3f8c74fdf2714e7dc91d47d817}{id}};}
\DoxyCodeLine{00261\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_af1be2513bce0c752816a174c0489f992}{VolnitskyTraits::Offset}}\ \mbox{\hyperlink{structdoris_1_1_multi_volnitsky_base_1_1_offset_id_aa2fc87b74ec8cf5fd5c6015d2407b6f0}{off}};}
\DoxyCodeLine{00262\ \ \ \ \ \};}
\DoxyCodeLine{00263\ }
\DoxyCodeLine{00264\ \ \ \ \ std::unique\_ptr<OffsetId[]>\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_aab352b3b05f948c6d43cb6251b4b838a}{hash}};}
\DoxyCodeLine{00265\ }
\DoxyCodeLine{00267\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_aa4d697c762fb380a0b8af7043dea701b}{step}};}
\DoxyCodeLine{00268\ }
\DoxyCodeLine{00270\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_ad7d9920db63a5651a0acacfce21afa92}{last}};}
\DoxyCodeLine{00271\ }
\DoxyCodeLine{00273\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_a8692210f178acac89e3c665826eb3522}{small\_limit}}\ =\ \mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a07e9f6ae0b6164b06f0a0a1921a0c33b}{VolnitskyTraits::hash\_size}}\ /\ 8;}
\DoxyCodeLine{00274\ }
\DoxyCodeLine{00275\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00276\ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_a37fd1dabdbbfc4db1aa14c67a8227751}{MultiVolnitskyBase}}(\textcolor{keyword}{const}\ std::vector<StringRef>\&\ needles\_)}
\DoxyCodeLine{00277\ \ \ \ \ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_a91aac91dda761ccb6d059e1b1fa673d6}{needles}}\ \{needles\_\},\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_aa4d697c762fb380a0b8af7043dea701b}{step}}\ \{0\},\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_ad7d9920db63a5651a0acacfce21afa92}{last}}\ \{0\}\ \{}
\DoxyCodeLine{00278\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_a9b151e18e4d9d53858968824b7445123}{fallback\_searchers}}.reserve(\mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_a91aac91dda761ccb6d059e1b1fa673d6}{needles}}.size());}
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_aab352b3b05f948c6d43cb6251b4b838a}{hash}}\ =\ std::unique\_ptr<OffsetId[]>(}
\DoxyCodeLine{00280\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{new}\ \mbox{\hyperlink{structdoris_1_1_multi_volnitsky_base_1_1_offset_id}{OffsetId}}[VolnitskyTraits::}
\DoxyCodeLine{00281\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hash\_size]);\ }
\DoxyCodeLine{00282\ \ \ \ \ \}}
\DoxyCodeLine{00283\ }
\DoxyCodeLine{00297\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_aa4c500b373764fc3de7355e5846c2ee6}{hasMoreToSearch}}()\ \{}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_ad7d9920db63a5651a0acacfce21afa92}{last}}\ ==\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_a91aac91dda761ccb6d059e1b1fa673d6}{needles}}.size())\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00299\ }
\DoxyCodeLine{00300\ \ \ \ \ \ \ \ \ memset(\mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_aab352b3b05f948c6d43cb6251b4b838a}{hash}}.get(),\ 0,\ \mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a07e9f6ae0b6164b06f0a0a1921a0c33b}{VolnitskyTraits::hash\_size}}\ *\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structdoris_1_1_multi_volnitsky_base_1_1_offset_id}{OffsetId}}));}
\DoxyCodeLine{00301\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_a5f3f4f103526fb6a034cf5dfdf921068}{fallback\_needles}}.clear();}
\DoxyCodeLine{00302\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_aa4d697c762fb380a0b8af7043dea701b}{step}}\ =\ std::numeric\_limits<size\_t>::max();}
\DoxyCodeLine{00303\ }
\DoxyCodeLine{00304\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ buf\ =\ 0;}
\DoxyCodeLine{00305\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ size\ =\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_a91aac91dda761ccb6d059e1b1fa673d6}{needles}}.size();}
\DoxyCodeLine{00306\ }
\DoxyCodeLine{00307\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_ad7d9920db63a5651a0acacfce21afa92}{last}}\ <\ size;\ ++\mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_ad7d9920db63a5651a0acacfce21afa92}{last}})\ \{}
\DoxyCodeLine{00308\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ cur\_needle\_data\ =\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_a91aac91dda761ccb6d059e1b1fa673d6}{needles}}[\mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_ad7d9920db63a5651a0acacfce21afa92}{last}}].data;}
\DoxyCodeLine{00309\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ cur\_needle\_size\ =\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_a91aac91dda761ccb6d059e1b1fa673d6}{needles}}[\mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_ad7d9920db63a5651a0acacfce21afa92}{last}}].size;}
\DoxyCodeLine{00310\ }
\DoxyCodeLine{00312\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a9f90a0860a33a7c7d19cc72f3a60d340}{VolnitskyTraits::isFallbackNeedle}}(cur\_needle\_size))\ \{}
\DoxyCodeLine{00313\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_a5f3f4f103526fb6a034cf5dfdf921068}{fallback\_needles}}.push\_back(\mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_ad7d9920db63a5651a0acacfce21afa92}{last}});}
\DoxyCodeLine{00314\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ callback\ =\ [\textcolor{keyword}{this}](\textcolor{keyword}{const}\ \mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a2c8aec128b5de8c15e4b5912dd60b720}{VolnitskyTraits::Ngram}}\ ngram,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ offset)\ \{}
\DoxyCodeLine{00317\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ this-\/>\mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_a918d3e84748558efbf27f0a8018d90d3}{putNGramBase}}(ngram,\ offset,\ this-\/>last);}
\DoxyCodeLine{00318\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{00319\ }
\DoxyCodeLine{00320\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ buf\ +=\ cur\_needle\_size\ -\/\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a2c8aec128b5de8c15e4b5912dd60b720}{VolnitskyTraits::Ngram}})\ +\ 1;}
\DoxyCodeLine{00321\ }
\DoxyCodeLine{00323\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (buf\ >\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_a8692210f178acac89e3c665826eb3522}{small\_limit}})\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00324\ }
\DoxyCodeLine{00325\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_aa4d697c762fb380a0b8af7043dea701b}{step}}\ =\ std::min(\mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_aa4d697c762fb380a0b8af7043dea701b}{step}},\ cur\_needle\_size\ -\/\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a2c8aec128b5de8c15e4b5912dd60b720}{VolnitskyTraits::Ngram}})\ +\ 1);}
\DoxyCodeLine{00326\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ i\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(cur\_needle\_size\ -\/\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a2c8aec128b5de8c15e4b5912dd60b720}{VolnitskyTraits::Ngram}}));}
\DoxyCodeLine{00327\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ i\ >=\ 0;\ -\/-\/i)\ \{}
\DoxyCodeLine{00328\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ VolnitskyTraits::putNGram<CaseSensitive,\ ASCII>(}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\mbox{\hyperlink{namespacedoris_ac82f32fb6f16dbdc32cb4076004e63c4}{UInt8}}*\textcolor{keyword}{>}(cur\_needle\_data)\ +\ i,\ i\ +\ 1,}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\mbox{\hyperlink{namespacedoris_ac82f32fb6f16dbdc32cb4076004e63c4}{UInt8}}*\textcolor{keyword}{>}(cur\_needle\_data),\ cur\_needle\_size,}
\DoxyCodeLine{00331\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ callback);}
\DoxyCodeLine{00332\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00333\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00334\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_a9b151e18e4d9d53858968824b7445123}{fallback\_searchers}}.emplace\_back(cur\_needle\_data,\ cur\_needle\_size);}
\DoxyCodeLine{00335\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00337\ \ \ \ \ \}}
\DoxyCodeLine{00338\ }
\DoxyCodeLine{00339\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_abc8127cbada38e86fbfdbbe6207c7d7d}{searchOne}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespacedoris_ac82f32fb6f16dbdc32cb4076004e63c4}{UInt8}}*\ haystack,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespacedoris_ac82f32fb6f16dbdc32cb4076004e63c4}{UInt8}}*\ haystack\_end)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00340\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ fallback\_size\ =\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_a5f3f4f103526fb6a034cf5dfdf921068}{fallback\_needles}}.size();}
\DoxyCodeLine{00341\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ fallback\_size;\ ++i)}
\DoxyCodeLine{00342\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_a9b151e18e4d9d53858968824b7445123}{fallback\_searchers}}[\mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_a5f3f4f103526fb6a034cf5dfdf921068}{fallback\_needles}}[i]].search(haystack,\ haystack\_end)\ !=}
\DoxyCodeLine{00343\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ haystack\_end)}
\DoxyCodeLine{00344\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00345\ }
\DoxyCodeLine{00347\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_aa4d697c762fb380a0b8af7043dea701b}{step}}\ !=\ std::numeric\_limits<size\_t>::max())\ \{}
\DoxyCodeLine{00348\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}*\ pos\ =\ haystack\ +\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_aa4d697c762fb380a0b8af7043dea701b}{step}}\ -\/\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a2c8aec128b5de8c15e4b5912dd60b720}{VolnitskyTraits::Ngram}});}
\DoxyCodeLine{00349\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ pos\ <=\ haystack\_end\ -\/\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a2c8aec128b5de8c15e4b5912dd60b720}{VolnitskyTraits::Ngram}});\ pos\ +=\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_aa4d697c762fb380a0b8af7043dea701b}{step}})\ \{}
\DoxyCodeLine{00350\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ cell\_num\ =\ \mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_abbf447cbcd1f6cacd8c33d697caac46c}{VolnitskyTraits::toNGram}}(pos)\ \%\ \mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a07e9f6ae0b6164b06f0a0a1921a0c33b}{VolnitskyTraits::hash\_size}};}
\DoxyCodeLine{00351\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_aab352b3b05f948c6d43cb6251b4b838a}{hash}}[cell\_num].off;\ cell\_num\ =\ (cell\_num\ +\ 1)\ \%\ \mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a07e9f6ae0b6164b06f0a0a1921a0c33b}{VolnitskyTraits::hash\_size}})\ \{}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pos\ >=\ haystack\ +\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_aab352b3b05f948c6d43cb6251b4b838a}{hash}}[cell\_num].off\ -\/\ 1)\ \{}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ res\ =\ pos\ -\/\ (\mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_aab352b3b05f948c6d43cb6251b4b838a}{hash}}[cell\_num].off\ -\/\ 1);}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ ind\ =\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_aab352b3b05f948c6d43cb6251b4b838a}{hash}}[cell\_num].id;}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (res\ +\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_a91aac91dda761ccb6d059e1b1fa673d6}{needles}}[ind].size\ <=\ haystack\_end\ \&\&}
\DoxyCodeLine{00356\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_a9b151e18e4d9d53858968824b7445123}{fallback\_searchers}}[ind].compare(haystack,\ haystack\_end,\ res))}
\DoxyCodeLine{00357\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00358\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00360\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00362\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00363\ \ \ \ \ \}}
\DoxyCodeLine{00364\ }
\DoxyCodeLine{00365\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_a3d0dfe809200dbcde5e2ae58f6b834c1}{searchOneFirstIndex}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespacedoris_ac82f32fb6f16dbdc32cb4076004e63c4}{UInt8}}*\ haystack,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespacedoris_ac82f32fb6f16dbdc32cb4076004e63c4}{UInt8}}*\ haystack\_end)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00366\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ fallback\_size\ =\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_a5f3f4f103526fb6a034cf5dfdf921068}{fallback\_needles}}.size();}
\DoxyCodeLine{00367\ }
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ answer\ =\ std::numeric\_limits<size\_t>::max();}
\DoxyCodeLine{00369\ }
\DoxyCodeLine{00370\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ fallback\_size;\ ++i)}
\DoxyCodeLine{00371\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_a9b151e18e4d9d53858968824b7445123}{fallback\_searchers}}[\mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_a5f3f4f103526fb6a034cf5dfdf921068}{fallback\_needles}}[i]].search(haystack,\ haystack\_end)\ !=}
\DoxyCodeLine{00372\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ haystack\_end)}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ answer\ =\ std::min(answer,\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_a5f3f4f103526fb6a034cf5dfdf921068}{fallback\_needles}}[i]);}
\DoxyCodeLine{00374\ }
\DoxyCodeLine{00376\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_aa4d697c762fb380a0b8af7043dea701b}{step}}\ !=\ std::numeric\_limits<size\_t>::max())\ \{}
\DoxyCodeLine{00377\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}*\ pos\ =\ haystack\ +\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_aa4d697c762fb380a0b8af7043dea701b}{step}}\ -\/\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a2c8aec128b5de8c15e4b5912dd60b720}{VolnitskyTraits::Ngram}});}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ pos\ <=\ haystack\_end\ -\/\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a2c8aec128b5de8c15e4b5912dd60b720}{VolnitskyTraits::Ngram}});\ pos\ +=\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_aa4d697c762fb380a0b8af7043dea701b}{step}})\ \{}
\DoxyCodeLine{00379\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ cell\_num\ =\ \mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_abbf447cbcd1f6cacd8c33d697caac46c}{VolnitskyTraits::toNGram}}(pos)\ \%\ \mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a07e9f6ae0b6164b06f0a0a1921a0c33b}{VolnitskyTraits::hash\_size}};}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_aab352b3b05f948c6d43cb6251b4b838a}{hash}}[cell\_num].off;\ cell\_num\ =\ (cell\_num\ +\ 1)\ \%\ \mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a07e9f6ae0b6164b06f0a0a1921a0c33b}{VolnitskyTraits::hash\_size}})\ \{}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pos\ >=\ haystack\ +\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_aab352b3b05f948c6d43cb6251b4b838a}{hash}}[cell\_num].off\ -\/\ 1)\ \{}
\DoxyCodeLine{00382\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ res\ =\ pos\ -\/\ (\mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_aab352b3b05f948c6d43cb6251b4b838a}{hash}}[cell\_num].off\ -\/\ 1);}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ ind\ =\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_aab352b3b05f948c6d43cb6251b4b838a}{hash}}[cell\_num].id;}
\DoxyCodeLine{00384\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (res\ +\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_a91aac91dda761ccb6d059e1b1fa673d6}{needles}}[ind].size\ <=\ haystack\_end\ \&\&}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_a9b151e18e4d9d53858968824b7445123}{fallback\_searchers}}[ind].compare(haystack,\ haystack\_end,\ res))}
\DoxyCodeLine{00386\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ answer\ =\ std::min(answer,\ ind);}
\DoxyCodeLine{00387\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00388\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00389\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00390\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00391\ }
\DoxyCodeLine{00392\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00393\ \textcolor{comment}{\ \ \ \ \ \ \ \ *\ if\ nothing\ was\ found,\ answer\ +\ 1\ will\ be\ equal\ to\ zero\ and\ we\ can}}
\DoxyCodeLine{00394\ \textcolor{comment}{\ \ \ \ \ \ \ \ *\ assign\ it\ into\ the\ result\ because\ we\ need\ to\ return\ the\ position\ starting\ with\ one}}
\DoxyCodeLine{00395\ \textcolor{comment}{\ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00396\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ answer\ +\ 1;}
\DoxyCodeLine{00397\ \ \ \ \ \}}
\DoxyCodeLine{00398\ }
\DoxyCodeLine{00399\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ CountCharsCallback>}
\DoxyCodeLine{00400\ \ \ \ \ \textcolor{keyword}{inline}\ \mbox{\hyperlink{namespacedoris_a81586a76c764e2556f67139907fa5440}{UInt64}}\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_a35f0322fdbb56f2a2b1abb78a45b5745}{searchOneFirstPosition}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespacedoris_ac82f32fb6f16dbdc32cb4076004e63c4}{UInt8}}*\ haystack,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespacedoris_ac82f32fb6f16dbdc32cb4076004e63c4}{UInt8}}*\ haystack\_end,}
\DoxyCodeLine{00401\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ CountCharsCallback\&\ count\_chars)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00402\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ fallback\_size\ =\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_a5f3f4f103526fb6a034cf5dfdf921068}{fallback\_needles}}.size();}
\DoxyCodeLine{00403\ }
\DoxyCodeLine{00404\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacedoris_a81586a76c764e2556f67139907fa5440}{UInt64}}\ answer\ =\ std::numeric\_limits<UInt64>::max();}
\DoxyCodeLine{00405\ }
\DoxyCodeLine{00406\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ fallback\_size;\ ++i)}
\DoxyCodeLine{00407\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keyword}{auto}\ pos\ =\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_a9b151e18e4d9d53858968824b7445123}{fallback\_searchers}}[\mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_a5f3f4f103526fb6a034cf5dfdf921068}{fallback\_needles}}[i]].search(haystack,\ haystack\_end);}
\DoxyCodeLine{00408\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pos\ !=\ haystack\_end)}
\DoxyCodeLine{00409\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ answer\ =\ std::min<UInt64>(answer,\ pos\ -\/\ haystack);}
\DoxyCodeLine{00410\ }
\DoxyCodeLine{00412\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_aa4d697c762fb380a0b8af7043dea701b}{step}}\ !=\ std::numeric\_limits<size\_t>::max())\ \{}
\DoxyCodeLine{00413\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}*\ pos\ =\ haystack\ +\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_aa4d697c762fb380a0b8af7043dea701b}{step}}\ -\/\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a2c8aec128b5de8c15e4b5912dd60b720}{VolnitskyTraits::Ngram}});}
\DoxyCodeLine{00414\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ pos\ <=\ haystack\_end\ -\/\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a2c8aec128b5de8c15e4b5912dd60b720}{VolnitskyTraits::Ngram}});\ pos\ +=\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_aa4d697c762fb380a0b8af7043dea701b}{step}})\ \{}
\DoxyCodeLine{00415\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ cell\_num\ =\ \mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_abbf447cbcd1f6cacd8c33d697caac46c}{VolnitskyTraits::toNGram}}(pos)\ \%\ \mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a07e9f6ae0b6164b06f0a0a1921a0c33b}{VolnitskyTraits::hash\_size}};}
\DoxyCodeLine{00416\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_aab352b3b05f948c6d43cb6251b4b838a}{hash}}[cell\_num].off;\ cell\_num\ =\ (cell\_num\ +\ 1)\ \%\ \mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a07e9f6ae0b6164b06f0a0a1921a0c33b}{VolnitskyTraits::hash\_size}})\ \{}
\DoxyCodeLine{00417\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pos\ >=\ haystack\ +\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_aab352b3b05f948c6d43cb6251b4b838a}{hash}}[cell\_num].off\ -\/\ 1)\ \{}
\DoxyCodeLine{00418\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ res\ =\ pos\ -\/\ (\mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_aab352b3b05f948c6d43cb6251b4b838a}{hash}}[cell\_num].off\ -\/\ 1);}
\DoxyCodeLine{00419\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ ind\ =\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_aab352b3b05f948c6d43cb6251b4b838a}{hash}}[cell\_num].id;}
\DoxyCodeLine{00420\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (res\ +\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_a91aac91dda761ccb6d059e1b1fa673d6}{needles}}[ind].size\ <=\ haystack\_end\ \&\&}
\DoxyCodeLine{00421\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_a9b151e18e4d9d53858968824b7445123}{fallback\_searchers}}[ind].compare(haystack,\ haystack\_end,\ res))}
\DoxyCodeLine{00422\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ answer\ =\ std::min<UInt64>(answer,\ res\ -\/\ haystack);}
\DoxyCodeLine{00423\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00424\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00425\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00426\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00427\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (answer\ ==\ std::numeric\_limits<UInt64>::max())\ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00428\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ count\_chars(haystack,\ haystack\ +\ answer);}
\DoxyCodeLine{00429\ \ \ \ \ \}}
\DoxyCodeLine{00430\ }
\DoxyCodeLine{00431\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ CountCharsCallback,\ \textcolor{keyword}{typename}\ AnsType>}
\DoxyCodeLine{00432\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_a72689ab71afc068e7dd9b87379bdec27}{searchOneAll}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespacedoris_ac82f32fb6f16dbdc32cb4076004e63c4}{UInt8}}*\ haystack,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespacedoris_ac82f32fb6f16dbdc32cb4076004e63c4}{UInt8}}*\ haystack\_end,\ AnsType*\ answer,}
\DoxyCodeLine{00433\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ CountCharsCallback\&\ count\_chars)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00434\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ fallback\_size\ =\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_a5f3f4f103526fb6a034cf5dfdf921068}{fallback\_needles}}.size();}
\DoxyCodeLine{00435\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ fallback\_size;\ ++i)\ \{}
\DoxyCodeLine{00436\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespacedoris_ac82f32fb6f16dbdc32cb4076004e63c4}{UInt8}}*\ ptr\ =}
\DoxyCodeLine{00437\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_a9b151e18e4d9d53858968824b7445123}{fallback\_searchers}}[\mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_a5f3f4f103526fb6a034cf5dfdf921068}{fallback\_needles}}[i]].search(haystack,\ haystack\_end);}
\DoxyCodeLine{00438\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ptr\ !=\ haystack\_end)\ answer[\mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_a5f3f4f103526fb6a034cf5dfdf921068}{fallback\_needles}}[i]]\ =\ count\_chars(haystack,\ ptr);}
\DoxyCodeLine{00439\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00440\ }
\DoxyCodeLine{00442\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_aa4d697c762fb380a0b8af7043dea701b}{step}}\ !=\ std::numeric\_limits<size\_t>::max())\ \{}
\DoxyCodeLine{00443\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}*\ pos\ =\ haystack\ +\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_aa4d697c762fb380a0b8af7043dea701b}{step}}\ -\/\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a2c8aec128b5de8c15e4b5912dd60b720}{VolnitskyTraits::Ngram}});}
\DoxyCodeLine{00444\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ pos\ <=\ haystack\_end\ -\/\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a2c8aec128b5de8c15e4b5912dd60b720}{VolnitskyTraits::Ngram}});\ pos\ +=\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_aa4d697c762fb380a0b8af7043dea701b}{step}})\ \{}
\DoxyCodeLine{00445\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ cell\_num\ =\ \mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_abbf447cbcd1f6cacd8c33d697caac46c}{VolnitskyTraits::toNGram}}(pos)\ \%\ \mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a07e9f6ae0b6164b06f0a0a1921a0c33b}{VolnitskyTraits::hash\_size}};}
\DoxyCodeLine{00446\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_aab352b3b05f948c6d43cb6251b4b838a}{hash}}[cell\_num].off;\ cell\_num\ =\ (cell\_num\ +\ 1)\ \%\ \mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a07e9f6ae0b6164b06f0a0a1921a0c33b}{VolnitskyTraits::hash\_size}})\ \{}
\DoxyCodeLine{00447\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pos\ >=\ haystack\ +\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_aab352b3b05f948c6d43cb6251b4b838a}{hash}}[cell\_num].off\ -\/\ 1)\ \{}
\DoxyCodeLine{00448\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}*\ res\ =\ pos\ -\/\ (\mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_aab352b3b05f948c6d43cb6251b4b838a}{hash}}[cell\_num].off\ -\/\ 1);}
\DoxyCodeLine{00449\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ ind\ =\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_aab352b3b05f948c6d43cb6251b4b838a}{hash}}[cell\_num].id;}
\DoxyCodeLine{00450\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (answer[ind]\ ==\ 0\ \&\&\ res\ +\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_a91aac91dda761ccb6d059e1b1fa673d6}{needles}}[ind].size\ <=\ haystack\_end\ \&\&}
\DoxyCodeLine{00451\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_a9b151e18e4d9d53858968824b7445123}{fallback\_searchers}}[ind].compare(haystack,\ haystack\_end,\ res))}
\DoxyCodeLine{00452\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ answer[ind]\ =\ count\_chars(haystack,\ res);}
\DoxyCodeLine{00453\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00454\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00455\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00456\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00457\ \ \ \ \ \}}
\DoxyCodeLine{00458\ }
\DoxyCodeLine{00459\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_a918d3e84748558efbf27f0a8018d90d3}{putNGramBase}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a2c8aec128b5de8c15e4b5912dd60b720}{VolnitskyTraits::Ngram}}\ ngram,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ offset,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ num)\ \{}
\DoxyCodeLine{00460\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ cell\_num\ =\ ngram\ \%\ \mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a07e9f6ae0b6164b06f0a0a1921a0c33b}{VolnitskyTraits::hash\_size}};}
\DoxyCodeLine{00461\ }
\DoxyCodeLine{00462\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (\mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_aab352b3b05f948c6d43cb6251b4b838a}{hash}}[cell\_num].off)\ cell\_num\ =\ (cell\_num\ +\ 1)\ \%\ \mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a07e9f6ae0b6164b06f0a0a1921a0c33b}{VolnitskyTraits::hash\_size}};}
\DoxyCodeLine{00463\ }
\DoxyCodeLine{00464\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base_aab352b3b05f948c6d43cb6251b4b838a}{hash}}[cell\_num]\ =\ \{\textcolor{keyword}{static\_cast<}\mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_a0e10dd61221b5f79e364efd561255075}{VolnitskyTraits::Id}}\textcolor{keyword}{>}(num),}
\DoxyCodeLine{00465\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{namespacedoris_1_1_volnitsky_traits_af1be2513bce0c752816a174c0489f992}{VolnitskyTraits::Offset}}\textcolor{keyword}{>}(offset)\};}
\DoxyCodeLine{00466\ \ \ \ \ \}}
\DoxyCodeLine{00467\ \};}
\DoxyCodeLine{00468\ }
\DoxyCodeLine{00469\ \textcolor{keyword}{using\ }\mbox{\hyperlink{classdoris_1_1_volnitsky_base}{Volnitsky}}\ =\ \mbox{\hyperlink{classdoris_1_1_volnitsky_base}{VolnitskyBase<true,\ true,\ ASCIICaseSensitiveStringSearcher>}};}
\DoxyCodeLine{00470\ \textcolor{keyword}{using\ }\mbox{\hyperlink{classdoris_1_1_volnitsky_base}{VolnitskyUTF8}}\ =}
\DoxyCodeLine{00471\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_volnitsky_base}{VolnitskyBase<true,\ false,\ ASCIICaseSensitiveStringSearcher>}};\ }
\DoxyCodeLine{00472\ }
\DoxyCodeLine{00473\ \textcolor{keyword}{using\ }\mbox{\hyperlink{classdoris_1_1_volnitsky_base}{VolnitskyCaseSensitiveToken}}\ =\ \mbox{\hyperlink{classdoris_1_1_volnitsky_base}{VolnitskyBase<true,\ true,\ ASCIICaseSensitiveTokenSearcher>}};}
\DoxyCodeLine{00474\ }
\DoxyCodeLine{00475\ \textcolor{keyword}{using\ }\mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base}{MultiVolnitsky}}\ =\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base}{MultiVolnitskyBase<true,\ true,\ ASCIICaseSensitiveStringSearcher>}};}
\DoxyCodeLine{00476\ \textcolor{keyword}{using\ }\mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base}{MultiVolnitskyUTF8}}\ =\ \mbox{\hyperlink{classdoris_1_1_multi_volnitsky_base}{MultiVolnitskyBase<true,\ false,\ ASCIICaseSensitiveStringSearcher>}};}
\DoxyCodeLine{00477\ }
\DoxyCodeLine{00478\ \}\ \textcolor{comment}{//\ namespace\ doris}}

\end{DoxyCode}
