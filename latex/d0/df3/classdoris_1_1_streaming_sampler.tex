\hypertarget{classdoris_1_1_streaming_sampler}{}\doxysection{Streaming\+Sampler\texorpdfstring{$<$}{<} T, MAX\+\_\+\+SAMPLES \texorpdfstring{$>$}{>} 模板类 参考}
\label{classdoris_1_1_streaming_sampler}\index{StreamingSampler$<$ T, MAX\_SAMPLES $>$@{StreamingSampler$<$ T, MAX\_SAMPLES $>$}}


{\ttfamily \#include $<$streaming\+\_\+sampler.\+h$>$}



Streaming\+Sampler\texorpdfstring{$<$}{<} T, MAX\+\_\+\+SAMPLES \texorpdfstring{$>$}{>} 的协作图\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=193pt]{d6/deb/classdoris_1_1_streaming_sampler__coll__graph}
\end{center}
\end{figure}
\doxysubsection*{Public 成员函数}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classdoris_1_1_streaming_sampler_a2665a7cfc7dc8293c92438ea5342478d}{Streaming\+Sampler}} (int initial\+\_\+period=500)
\item 
\mbox{\hyperlink{classdoris_1_1_streaming_sampler_ae44100b9bb5d20014642f0905bef8441}{Streaming\+Sampler}} (int period, const std\+::vector$<$ \mbox{\hyperlink{exp_8c_a0acb682b8260ab1c60b918599864e2e5}{T}} $>$ \&initial\+\_\+samples)
\begin{DoxyCompactList}\small\item\em Initialize the sampler with values. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classdoris_1_1_streaming_sampler_a6303956523adff8252683c9068a6cbbe}{Add\+Sample}} (\mbox{\hyperlink{exp_8c_a0acb682b8260ab1c60b918599864e2e5}{T}} sample, int ms)
\item 
const \mbox{\hyperlink{exp_8c_a0acb682b8260ab1c60b918599864e2e5}{T}} $\ast$ \mbox{\hyperlink{classdoris_1_1_streaming_sampler_a6bee31e5df9a6735c48e5d3ad5afd3ab}{Get\+Samples}} (int $\ast$num\+\_\+samples, int $\ast$period, \mbox{\hyperlink{classdoris_1_1_spin_lock}{Spin\+Lock}} $\ast$$\ast$lock=nullptr) const
\item 
void \mbox{\hyperlink{classdoris_1_1_streaming_sampler_a939b31c2cc2a7e4e88f682ca5b2ec41f}{Set\+Samples}} (int period, const std\+::vector$<$ \mbox{\hyperlink{exp_8c_a0acb682b8260ab1c60b918599864e2e5}{T}} $>$ \&samples)
\begin{DoxyCompactList}\small\item\em Set the underlying data to period/samples \end{DoxyCompactList}\item 
std\+::string \mbox{\hyperlink{classdoris_1_1_streaming_sampler_ad117fada1b62a935c0227a256740b3ff}{Debug\+String}} (const std\+::string \&prefix=\char`\"{}\char`\"{}) const
\end{DoxyCompactItemize}
\doxysubsection*{Private 属性}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classdoris_1_1_spin_lock}{Spin\+Lock}} \mbox{\hyperlink{classdoris_1_1_streaming_sampler_a2ddca6daea747fedb927f1005a93f5d6}{lock\+\_\+}}
\item 
\mbox{\hyperlink{exp_8c_a0acb682b8260ab1c60b918599864e2e5}{T}} \mbox{\hyperlink{classdoris_1_1_streaming_sampler_ad1caba015afd1aab7667c271004e6e64}{samples\+\_\+}} \mbox{[}MAX\+\_\+\+SAMPLES\mbox{]}
\item 
int \mbox{\hyperlink{classdoris_1_1_streaming_sampler_a8b04398b4b8f06fc8aacfaeb88935b91}{samples\+\_\+collected\+\_\+}}
\begin{DoxyCompactList}\small\item\em Number of samples collected \texorpdfstring{$<$}{<}= MAX\+\_\+\+SAMPLES. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classdoris_1_1_streaming_sampler_a8309a7efb1db1afb3c8de5c240df517e}{period\+\_\+}}
\begin{DoxyCompactList}\small\item\em Storage period in ms. \end{DoxyCompactList}\item 
\mbox{\hyperlink{exp_8c_a0acb682b8260ab1c60b918599864e2e5}{T}} \mbox{\hyperlink{classdoris_1_1_streaming_sampler_a4bd4a73c348ec4309f79e7bc2406447d}{current\+\_\+sample\+\_\+sum\+\_\+}}
\begin{DoxyCompactList}\small\item\em The sum of input samples that makes up the next stored sample. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classdoris_1_1_streaming_sampler_a42a2fefa3d290e44a499f3d25321cd65}{current\+\_\+sample\+\_\+count\+\_\+}}
\begin{DoxyCompactList}\small\item\em The number of input samples that contribute to current\+\_\+sample\+\_\+sum\+\_\+. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classdoris_1_1_streaming_sampler_a7f0ca8e5f8c007f4192ecb6c28792227}{current\+\_\+sample\+\_\+total\+\_\+time\+\_\+}}
\begin{DoxyCompactList}\small\item\em The total time that current\+\_\+sample\+\_\+sum\+\_\+ represents \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{详细描述}
\subsubsection*{template$<$typename \mbox{\hyperlink{exp_8c_a0acb682b8260ab1c60b918599864e2e5}{T}}, int MAX\+\_\+\+SAMPLES$>$\newline
class doris\+::\+Streaming\+Sampler$<$ T, MAX\+\_\+\+SAMPLES $>$}
A fixed-\/size sampler to collect samples over time. Add\+Sample should be called periodically with the sampled value. Samples are added at the max resolution possible. When the sample buffer is full, the current samples are collapsed and the collection period is doubled. The input period and the streaming sampler period do not need to match, the streaming sampler will average values. T is the type of the sample and must be a native numerical type (e.\+g. int or float). 

\doxysubsection{构造及析构函数说明}
\mbox{\Hypertarget{classdoris_1_1_streaming_sampler_a2665a7cfc7dc8293c92438ea5342478d}\label{classdoris_1_1_streaming_sampler_a2665a7cfc7dc8293c92438ea5342478d}} 
\index{StreamingSampler$<$ T, MAX\_SAMPLES $>$@{StreamingSampler$<$ T, MAX\_SAMPLES $>$}!StreamingSampler@{StreamingSampler}}
\index{StreamingSampler@{StreamingSampler}!StreamingSampler$<$ T, MAX\_SAMPLES $>$@{StreamingSampler$<$ T, MAX\_SAMPLES $>$}}
\doxysubsubsection{\texorpdfstring{StreamingSampler()}{StreamingSampler()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily \mbox{\hyperlink{classdoris_1_1_streaming_sampler}{Streaming\+Sampler}} (\begin{DoxyParamCaption}\item[{int}]{initial\+\_\+period = {\ttfamily 500} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

\mbox{\Hypertarget{classdoris_1_1_streaming_sampler_ae44100b9bb5d20014642f0905bef8441}\label{classdoris_1_1_streaming_sampler_ae44100b9bb5d20014642f0905bef8441}} 
\index{StreamingSampler$<$ T, MAX\_SAMPLES $>$@{StreamingSampler$<$ T, MAX\_SAMPLES $>$}!StreamingSampler@{StreamingSampler}}
\index{StreamingSampler@{StreamingSampler}!StreamingSampler$<$ T, MAX\_SAMPLES $>$@{StreamingSampler$<$ T, MAX\_SAMPLES $>$}}
\doxysubsubsection{\texorpdfstring{StreamingSampler()}{StreamingSampler()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily \mbox{\hyperlink{classdoris_1_1_streaming_sampler}{Streaming\+Sampler}} (\begin{DoxyParamCaption}\item[{int}]{period,  }\item[{const std\+::vector$<$ \mbox{\hyperlink{exp_8c_a0acb682b8260ab1c60b918599864e2e5}{T}} $>$ \&}]{initial\+\_\+samples }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Initialize the sampler with values. 

函数调用图\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d0/df3/classdoris_1_1_streaming_sampler_ae44100b9bb5d20014642f0905bef8441_cgraph}
\end{center}
\end{figure}


\doxysubsection{成员函数说明}
\mbox{\Hypertarget{classdoris_1_1_streaming_sampler_a6303956523adff8252683c9068a6cbbe}\label{classdoris_1_1_streaming_sampler_a6303956523adff8252683c9068a6cbbe}} 
\index{StreamingSampler$<$ T, MAX\_SAMPLES $>$@{StreamingSampler$<$ T, MAX\_SAMPLES $>$}!AddSample@{AddSample}}
\index{AddSample@{AddSample}!StreamingSampler$<$ T, MAX\_SAMPLES $>$@{StreamingSampler$<$ T, MAX\_SAMPLES $>$}}
\doxysubsubsection{\texorpdfstring{AddSample()}{AddSample()}}
{\footnotesize\ttfamily void Add\+Sample (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{exp_8c_a0acb682b8260ab1c60b918599864e2e5}{T}}}]{sample,  }\item[{int}]{ms }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Add a sample to the sampler. \textquotesingle{}ms\textquotesingle{} is the time elapsed since the last time this was called. The input value is accumulated into current\+\_\+$\ast$. If the total time elapsed in current\+\_\+sample\+\_\+total\+\_\+time\+\_\+ is higher than the storage period, the value is stored. \textquotesingle{}sample\textquotesingle{} should be interpreted as a representative sample from (now -\/ ms, now\mbox{]}. TODO\+: we can make this more complex by taking a weighted average of samples accumulated in a period. collapse the samples in half by averaging them and doubling the storage period\mbox{\Hypertarget{classdoris_1_1_streaming_sampler_a6bee31e5df9a6735c48e5d3ad5afd3ab}\label{classdoris_1_1_streaming_sampler_a6bee31e5df9a6735c48e5d3ad5afd3ab}} 
\index{StreamingSampler$<$ T, MAX\_SAMPLES $>$@{StreamingSampler$<$ T, MAX\_SAMPLES $>$}!GetSamples@{GetSamples}}
\index{GetSamples@{GetSamples}!StreamingSampler$<$ T, MAX\_SAMPLES $>$@{StreamingSampler$<$ T, MAX\_SAMPLES $>$}}
\doxysubsubsection{\texorpdfstring{GetSamples()}{GetSamples()}}
{\footnotesize\ttfamily const \mbox{\hyperlink{exp_8c_a0acb682b8260ab1c60b918599864e2e5}{T}} $\ast$ Get\+Samples (\begin{DoxyParamCaption}\item[{int $\ast$}]{num\+\_\+samples,  }\item[{int $\ast$}]{period,  }\item[{\mbox{\hyperlink{classdoris_1_1_spin_lock}{Spin\+Lock}} $\ast$$\ast$}]{lock = {\ttfamily nullptr} }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}

Get the samples collected. Returns the number of samples and the period they were collected at. If lock is non-\/null, the lock will be taken before returning. The caller must unlock it. 函数调用图\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d0/df3/classdoris_1_1_streaming_sampler_a6bee31e5df9a6735c48e5d3ad5afd3ab_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1_streaming_sampler_a939b31c2cc2a7e4e88f682ca5b2ec41f}\label{classdoris_1_1_streaming_sampler_a939b31c2cc2a7e4e88f682ca5b2ec41f}} 
\index{StreamingSampler$<$ T, MAX\_SAMPLES $>$@{StreamingSampler$<$ T, MAX\_SAMPLES $>$}!SetSamples@{SetSamples}}
\index{SetSamples@{SetSamples}!StreamingSampler$<$ T, MAX\_SAMPLES $>$@{StreamingSampler$<$ T, MAX\_SAMPLES $>$}}
\doxysubsubsection{\texorpdfstring{SetSamples()}{SetSamples()}}
{\footnotesize\ttfamily void Set\+Samples (\begin{DoxyParamCaption}\item[{int}]{period,  }\item[{const std\+::vector$<$ \mbox{\hyperlink{exp_8c_a0acb682b8260ab1c60b918599864e2e5}{T}} $>$ \&}]{samples }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Set the underlying data to period/samples 

函数调用图\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d0/df3/classdoris_1_1_streaming_sampler_a939b31c2cc2a7e4e88f682ca5b2ec41f_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1_streaming_sampler_ad117fada1b62a935c0227a256740b3ff}\label{classdoris_1_1_streaming_sampler_ad117fada1b62a935c0227a256740b3ff}} 
\index{StreamingSampler$<$ T, MAX\_SAMPLES $>$@{StreamingSampler$<$ T, MAX\_SAMPLES $>$}!DebugString@{DebugString}}
\index{DebugString@{DebugString}!StreamingSampler$<$ T, MAX\_SAMPLES $>$@{StreamingSampler$<$ T, MAX\_SAMPLES $>$}}
\doxysubsubsection{\texorpdfstring{DebugString()}{DebugString()}}
{\footnotesize\ttfamily std\+::string Debug\+String (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{prefix = {\ttfamily \char`\"{}\char`\"{}} }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



\doxysubsection{类成员变量说明}
\mbox{\Hypertarget{classdoris_1_1_streaming_sampler_a2ddca6daea747fedb927f1005a93f5d6}\label{classdoris_1_1_streaming_sampler_a2ddca6daea747fedb927f1005a93f5d6}} 
\index{StreamingSampler$<$ T, MAX\_SAMPLES $>$@{StreamingSampler$<$ T, MAX\_SAMPLES $>$}!lock\_@{lock\_}}
\index{lock\_@{lock\_}!StreamingSampler$<$ T, MAX\_SAMPLES $>$@{StreamingSampler$<$ T, MAX\_SAMPLES $>$}}
\doxysubsubsection{\texorpdfstring{lock\_}{lock\_}}
{\footnotesize\ttfamily \mbox{\hyperlink{classdoris_1_1_spin_lock}{Spin\+Lock}} lock\+\_\+\hspace{0.3cm}{\ttfamily [mutable]}, {\ttfamily [private]}}

\mbox{\Hypertarget{classdoris_1_1_streaming_sampler_ad1caba015afd1aab7667c271004e6e64}\label{classdoris_1_1_streaming_sampler_ad1caba015afd1aab7667c271004e6e64}} 
\index{StreamingSampler$<$ T, MAX\_SAMPLES $>$@{StreamingSampler$<$ T, MAX\_SAMPLES $>$}!samples\_@{samples\_}}
\index{samples\_@{samples\_}!StreamingSampler$<$ T, MAX\_SAMPLES $>$@{StreamingSampler$<$ T, MAX\_SAMPLES $>$}}
\doxysubsubsection{\texorpdfstring{samples\_}{samples\_}}
{\footnotesize\ttfamily \mbox{\hyperlink{exp_8c_a0acb682b8260ab1c60b918599864e2e5}{T}} samples\+\_\+\mbox{[}MAX\+\_\+\+SAMPLES\mbox{]}\hspace{0.3cm}{\ttfamily [private]}}

Aggregated samples collected. Note\+: this is not all the input samples from \mbox{\hyperlink{classdoris_1_1_streaming_sampler_a6303956523adff8252683c9068a6cbbe}{Add\+Sample()}}, as logically, those samples get resampled and aggregated. \mbox{\Hypertarget{classdoris_1_1_streaming_sampler_a8b04398b4b8f06fc8aacfaeb88935b91}\label{classdoris_1_1_streaming_sampler_a8b04398b4b8f06fc8aacfaeb88935b91}} 
\index{StreamingSampler$<$ T, MAX\_SAMPLES $>$@{StreamingSampler$<$ T, MAX\_SAMPLES $>$}!samples\_collected\_@{samples\_collected\_}}
\index{samples\_collected\_@{samples\_collected\_}!StreamingSampler$<$ T, MAX\_SAMPLES $>$@{StreamingSampler$<$ T, MAX\_SAMPLES $>$}}
\doxysubsubsection{\texorpdfstring{samples\_collected\_}{samples\_collected\_}}
{\footnotesize\ttfamily int samples\+\_\+collected\+\_\+\hspace{0.3cm}{\ttfamily [private]}}



Number of samples collected \texorpdfstring{$<$}{<}= MAX\+\_\+\+SAMPLES. 

\mbox{\Hypertarget{classdoris_1_1_streaming_sampler_a8309a7efb1db1afb3c8de5c240df517e}\label{classdoris_1_1_streaming_sampler_a8309a7efb1db1afb3c8de5c240df517e}} 
\index{StreamingSampler$<$ T, MAX\_SAMPLES $>$@{StreamingSampler$<$ T, MAX\_SAMPLES $>$}!period\_@{period\_}}
\index{period\_@{period\_}!StreamingSampler$<$ T, MAX\_SAMPLES $>$@{StreamingSampler$<$ T, MAX\_SAMPLES $>$}}
\doxysubsubsection{\texorpdfstring{period\_}{period\_}}
{\footnotesize\ttfamily int period\+\_\+\hspace{0.3cm}{\ttfamily [private]}}



Storage period in ms. 

\mbox{\Hypertarget{classdoris_1_1_streaming_sampler_a4bd4a73c348ec4309f79e7bc2406447d}\label{classdoris_1_1_streaming_sampler_a4bd4a73c348ec4309f79e7bc2406447d}} 
\index{StreamingSampler$<$ T, MAX\_SAMPLES $>$@{StreamingSampler$<$ T, MAX\_SAMPLES $>$}!current\_sample\_sum\_@{current\_sample\_sum\_}}
\index{current\_sample\_sum\_@{current\_sample\_sum\_}!StreamingSampler$<$ T, MAX\_SAMPLES $>$@{StreamingSampler$<$ T, MAX\_SAMPLES $>$}}
\doxysubsubsection{\texorpdfstring{current\_sample\_sum\_}{current\_sample\_sum\_}}
{\footnotesize\ttfamily \mbox{\hyperlink{exp_8c_a0acb682b8260ab1c60b918599864e2e5}{T}} current\+\_\+sample\+\_\+sum\+\_\+\hspace{0.3cm}{\ttfamily [private]}}



The sum of input samples that makes up the next stored sample. 

\mbox{\Hypertarget{classdoris_1_1_streaming_sampler_a42a2fefa3d290e44a499f3d25321cd65}\label{classdoris_1_1_streaming_sampler_a42a2fefa3d290e44a499f3d25321cd65}} 
\index{StreamingSampler$<$ T, MAX\_SAMPLES $>$@{StreamingSampler$<$ T, MAX\_SAMPLES $>$}!current\_sample\_count\_@{current\_sample\_count\_}}
\index{current\_sample\_count\_@{current\_sample\_count\_}!StreamingSampler$<$ T, MAX\_SAMPLES $>$@{StreamingSampler$<$ T, MAX\_SAMPLES $>$}}
\doxysubsubsection{\texorpdfstring{current\_sample\_count\_}{current\_sample\_count\_}}
{\footnotesize\ttfamily int current\+\_\+sample\+\_\+count\+\_\+\hspace{0.3cm}{\ttfamily [private]}}



The number of input samples that contribute to current\+\_\+sample\+\_\+sum\+\_\+. 

\mbox{\Hypertarget{classdoris_1_1_streaming_sampler_a7f0ca8e5f8c007f4192ecb6c28792227}\label{classdoris_1_1_streaming_sampler_a7f0ca8e5f8c007f4192ecb6c28792227}} 
\index{StreamingSampler$<$ T, MAX\_SAMPLES $>$@{StreamingSampler$<$ T, MAX\_SAMPLES $>$}!current\_sample\_total\_time\_@{current\_sample\_total\_time\_}}
\index{current\_sample\_total\_time\_@{current\_sample\_total\_time\_}!StreamingSampler$<$ T, MAX\_SAMPLES $>$@{StreamingSampler$<$ T, MAX\_SAMPLES $>$}}
\doxysubsubsection{\texorpdfstring{current\_sample\_total\_time\_}{current\_sample\_total\_time\_}}
{\footnotesize\ttfamily int current\+\_\+sample\+\_\+total\+\_\+time\+\_\+\hspace{0.3cm}{\ttfamily [private]}}



The total time that current\+\_\+sample\+\_\+sum\+\_\+ represents 



该类的文档由以下文件生成\+:\begin{DoxyCompactItemize}
\item 
/\+Users/dabowang/be\+\_\+all/util/\mbox{\hyperlink{streaming__sampler_8h}{streaming\+\_\+sampler.\+h}}\end{DoxyCompactItemize}
