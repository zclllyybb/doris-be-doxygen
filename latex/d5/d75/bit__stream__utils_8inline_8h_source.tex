\hypertarget{bit__stream__utils_8inline_8h_source}{}\doxysection{bit\+\_\+stream\+\_\+utils.\+inline.\+h}
\label{bit__stream__utils_8inline_8h_source}\index{/Users/dabowang/be\_all/util/bit\_stream\_utils.inline.h@{/Users/dabowang/be\_all/util/bit\_stream\_utils.inline.h}}
\mbox{\hyperlink{bit__stream__utils_8inline_8h}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Licensed\ to\ the\ Apache\ Software\ Foundation\ (ASF)\ under\ one}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ or\ more\ contributor\ license\ agreements.\ \ See\ the\ NOTICE\ file}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ distributed\ with\ this\ work\ for\ additional\ information}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ regarding\ copyright\ ownership.\ \ The\ ASF\ licenses\ this\ file}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ to\ you\ under\ the\ Apache\ License,\ Version\ 2.0\ (the}}
\DoxyCodeLine{00006\ \textcolor{comment}{//\ "{}License"{});\ you\ may\ not\ use\ this\ file\ except\ in\ compliance}}
\DoxyCodeLine{00007\ \textcolor{comment}{//\ with\ the\ License.\ \ You\ may\ obtain\ a\ copy\ of\ the\ License\ at}}
\DoxyCodeLine{00008\ \textcolor{comment}{//}}
\DoxyCodeLine{00009\ \textcolor{comment}{//\ \ \ http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{00010\ \textcolor{comment}{//}}
\DoxyCodeLine{00011\ \textcolor{comment}{//\ Unless\ required\ by\ applicable\ law\ or\ agreed\ to\ in\ writing,}}
\DoxyCodeLine{00012\ \textcolor{comment}{//\ software\ distributed\ under\ the\ License\ is\ distributed\ on\ an}}
\DoxyCodeLine{00013\ \textcolor{comment}{//\ "{}AS\ IS"{}\ BASIS,\ WITHOUT\ WARRANTIES\ OR\ CONDITIONS\ OF\ ANY}}
\DoxyCodeLine{00014\ \textcolor{comment}{//\ KIND,\ either\ express\ or\ implied.\ \ See\ the\ License\ for\ the}}
\DoxyCodeLine{00015\ \textcolor{comment}{//\ specific\ language\ governing\ permissions\ and\ limitations}}
\DoxyCodeLine{00016\ \textcolor{comment}{//\ under\ the\ License.}}
\DoxyCodeLine{00017\ \textcolor{comment}{//\ This\ file\ is\ copied\ from}}
\DoxyCodeLine{00018\ \textcolor{comment}{//\ https://github.com/apache/impala/blob/branch-\/2.9.0/be/src/util/bit-\/stream-\/utils.inline.h}}
\DoxyCodeLine{00019\ \textcolor{comment}{//\ and\ modified\ by\ Doris}}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ <algorithm>}}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ "{}glog/logging.h"{}}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{alignment_8h}{util/alignment.h}}"{}}}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bit__packing_8inline_8h}{util/bit\_packing.inline.h}}"{}}}
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bit__stream__utils_8h}{util/bit\_stream\_utils.h}}"{}}}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00030\ \textcolor{keyword}{using\ }\mbox{\hyperlink{classdoris_1_1_bit_util}{doris::BitUtil}};}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacedoris}{doris}}\ \{}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00034\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1_bit_writer_a6693eab19a6504d732c31ef7af639cf8}{BitWriter::PutValue}}(uint64\_t\ v,\ \textcolor{keywordtype}{int}\ num\_bits)\ \{}
\DoxyCodeLine{00035\ \ \ \ \ DCHECK\_LE(num\_bits,\ 64);}
\DoxyCodeLine{00036\ \ \ \ \ \textcolor{comment}{//\ Truncate\ the\ higher-\/order\ bits.\ This\ is\ necessary\ to}}
\DoxyCodeLine{00037\ \ \ \ \ \textcolor{comment}{//\ support\ signed\ values.}}
\DoxyCodeLine{00038\ \ \ \ \ v\ \&=\ \string~0ULL\ >>\ (64\ -\/\ num\_bits);}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00040\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_bit_writer_adc033a5e038feb634fe7436abc5a087c}{buffered\_values\_}}\ |=\ v\ <<\ \mbox{\hyperlink{classdoris_1_1_bit_writer_ab52dc5034c0e004b8993280d95a33b64}{bit\_offset\_}};}
\DoxyCodeLine{00041\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_bit_writer_ab52dc5034c0e004b8993280d95a33b64}{bit\_offset\_}}\ +=\ num\_bits;}
\DoxyCodeLine{00042\ }
\DoxyCodeLine{00043\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{port_8h_aff70f3c8f03aae06b9011058a8da0cf0}{PREDICT\_FALSE}}(\mbox{\hyperlink{classdoris_1_1_bit_writer_ab52dc5034c0e004b8993280d95a33b64}{bit\_offset\_}}\ >=\ 64))\ \{}
\DoxyCodeLine{00044\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Flush\ buffered\_values\_\ and\ write\ out\ bits\ of\ v\ that\ did\ not\ fit}}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_bit_writer_a387ae995b4a7d9150e1630ec6d5f1c49}{buffer\_}}-\/>\mbox{\hyperlink{classdoris_1_1faststring_a799325ba7258a10f37ca3a9fa13de6b3}{reserve}}(\mbox{\hyperlink{alignment_8h_afb00b1a27b40fde5065d26e5aa367808}{ALIGN\_UP}}(\mbox{\hyperlink{classdoris_1_1_bit_writer_a6c8e3fb5e081561f38ca43460d136a2f}{byte\_offset\_}}\ +\ 8,\ 8));}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_bit_writer_a387ae995b4a7d9150e1630ec6d5f1c49}{buffer\_}}-\/>\mbox{\hyperlink{classdoris_1_1faststring_a69e9ab39dd42de8dcf2a78520a33c99b}{resize}}(\mbox{\hyperlink{classdoris_1_1_bit_writer_a6c8e3fb5e081561f38ca43460d136a2f}{byte\_offset\_}}\ +\ 8);}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ DCHECK\_LE(\mbox{\hyperlink{classdoris_1_1_bit_writer_a6c8e3fb5e081561f38ca43460d136a2f}{byte\_offset\_}}\ +\ 8,\ \mbox{\hyperlink{classdoris_1_1_bit_writer_a387ae995b4a7d9150e1630ec6d5f1c49}{buffer\_}}-\/>\mbox{\hyperlink{classdoris_1_1faststring_a7223528283cd4e5872e0cc716bf9bd9d}{capacity}}());}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{memcpy__aarch64_8cpp_a156c5821f16ed93be8c7d315303f7b2a}{memcpy}}(\mbox{\hyperlink{classdoris_1_1_bit_writer_a387ae995b4a7d9150e1630ec6d5f1c49}{buffer\_}}-\/>\mbox{\hyperlink{classdoris_1_1faststring_a215eaf2835bd078eb7cf0da711115346}{data}}()\ +\ \mbox{\hyperlink{classdoris_1_1_bit_writer_a6c8e3fb5e081561f38ca43460d136a2f}{byte\_offset\_}},\ \&\mbox{\hyperlink{classdoris_1_1_bit_writer_adc033a5e038feb634fe7436abc5a087c}{buffered\_values\_}},\ 8);}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_bit_writer_adc033a5e038feb634fe7436abc5a087c}{buffered\_values\_}}\ =\ 0;}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_bit_writer_a6c8e3fb5e081561f38ca43460d136a2f}{byte\_offset\_}}\ +=\ 8;}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_bit_writer_ab52dc5034c0e004b8993280d95a33b64}{bit\_offset\_}}\ -\/=\ 64;}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_bit_writer_adc033a5e038feb634fe7436abc5a087c}{buffered\_values\_}}\ =\ \mbox{\hyperlink{classdoris_1_1_bit_util_ac0180d011aaaf395664c34dfe9042477}{BitUtil::ShiftRightZeroOnOverflow}}(v,\ (num\_bits\ -\/\ \mbox{\hyperlink{classdoris_1_1_bit_writer_ab52dc5034c0e004b8993280d95a33b64}{bit\_offset\_}}));}
\DoxyCodeLine{00053\ \ \ \ \ \}}
\DoxyCodeLine{00054\ \ \ \ \ DCHECK\_LT(\mbox{\hyperlink{classdoris_1_1_bit_writer_ab52dc5034c0e004b8993280d95a33b64}{bit\_offset\_}},\ 64);}
\DoxyCodeLine{00055\ \}}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00057\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1_bit_writer_a051cd25893f7b8c8722cdb8d184a65c6}{BitWriter::Flush}}(\textcolor{keywordtype}{bool}\ align)\ \{}
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{keywordtype}{int}\ num\_bytes\ =\ \mbox{\hyperlink{classdoris_1_1_bit_util_ab9002e6aac9b818996faf615f08e426a}{BitUtil::Ceil}}(\mbox{\hyperlink{classdoris_1_1_bit_writer_ab52dc5034c0e004b8993280d95a33b64}{bit\_offset\_}},\ 8);}
\DoxyCodeLine{00059\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_bit_writer_a387ae995b4a7d9150e1630ec6d5f1c49}{buffer\_}}-\/>\mbox{\hyperlink{classdoris_1_1faststring_a799325ba7258a10f37ca3a9fa13de6b3}{reserve}}(\mbox{\hyperlink{alignment_8h_afb00b1a27b40fde5065d26e5aa367808}{ALIGN\_UP}}(\mbox{\hyperlink{classdoris_1_1_bit_writer_a6c8e3fb5e081561f38ca43460d136a2f}{byte\_offset\_}}\ +\ num\_bytes,\ 8));}
\DoxyCodeLine{00060\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_bit_writer_a387ae995b4a7d9150e1630ec6d5f1c49}{buffer\_}}-\/>\mbox{\hyperlink{classdoris_1_1faststring_a69e9ab39dd42de8dcf2a78520a33c99b}{resize}}(\mbox{\hyperlink{classdoris_1_1_bit_writer_a6c8e3fb5e081561f38ca43460d136a2f}{byte\_offset\_}}\ +\ num\_bytes);}
\DoxyCodeLine{00061\ \ \ \ \ DCHECK\_LE(\mbox{\hyperlink{classdoris_1_1_bit_writer_a6c8e3fb5e081561f38ca43460d136a2f}{byte\_offset\_}}\ +\ num\_bytes,\ \mbox{\hyperlink{classdoris_1_1_bit_writer_a387ae995b4a7d9150e1630ec6d5f1c49}{buffer\_}}-\/>\mbox{\hyperlink{classdoris_1_1faststring_a7223528283cd4e5872e0cc716bf9bd9d}{capacity}}());}
\DoxyCodeLine{00062\ \ \ \ \ \mbox{\hyperlink{memcpy__aarch64_8cpp_a156c5821f16ed93be8c7d315303f7b2a}{memcpy}}(\mbox{\hyperlink{classdoris_1_1_bit_writer_a387ae995b4a7d9150e1630ec6d5f1c49}{buffer\_}}-\/>\mbox{\hyperlink{classdoris_1_1faststring_a215eaf2835bd078eb7cf0da711115346}{data}}()\ +\ \mbox{\hyperlink{classdoris_1_1_bit_writer_a6c8e3fb5e081561f38ca43460d136a2f}{byte\_offset\_}},\ \&\mbox{\hyperlink{classdoris_1_1_bit_writer_adc033a5e038feb634fe7436abc5a087c}{buffered\_values\_}},\ num\_bytes);}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00064\ \ \ \ \ \textcolor{keywordflow}{if}\ (align)\ \{}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_bit_writer_adc033a5e038feb634fe7436abc5a087c}{buffered\_values\_}}\ =\ 0;}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_bit_writer_a6c8e3fb5e081561f38ca43460d136a2f}{byte\_offset\_}}\ +=\ num\_bytes;}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_bit_writer_ab52dc5034c0e004b8993280d95a33b64}{bit\_offset\_}}\ =\ 0;}
\DoxyCodeLine{00068\ \ \ \ \ \}}
\DoxyCodeLine{00069\ \}}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00071\ \textcolor{keyword}{inline}\ uint8\_t*\ \mbox{\hyperlink{classdoris_1_1_bit_writer_afe6d2ee2837c730dfdf0bc22603c0542}{BitWriter::GetNextBytePtr}}(\textcolor{keywordtype}{int}\ num\_bytes)\ \{}
\DoxyCodeLine{00072\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_bit_writer_a051cd25893f7b8c8722cdb8d184a65c6}{Flush}}(\textcolor{comment}{/*\ align\ */}\ \textcolor{keyword}{true});}
\DoxyCodeLine{00073\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_bit_writer_a387ae995b4a7d9150e1630ec6d5f1c49}{buffer\_}}-\/>\mbox{\hyperlink{classdoris_1_1faststring_a799325ba7258a10f37ca3a9fa13de6b3}{reserve}}(\mbox{\hyperlink{alignment_8h_afb00b1a27b40fde5065d26e5aa367808}{ALIGN\_UP}}(\mbox{\hyperlink{classdoris_1_1_bit_writer_a6c8e3fb5e081561f38ca43460d136a2f}{byte\_offset\_}}\ +\ num\_bytes,\ 8));}
\DoxyCodeLine{00074\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_bit_writer_a387ae995b4a7d9150e1630ec6d5f1c49}{buffer\_}}-\/>\mbox{\hyperlink{classdoris_1_1faststring_a69e9ab39dd42de8dcf2a78520a33c99b}{resize}}(\mbox{\hyperlink{classdoris_1_1_bit_writer_a6c8e3fb5e081561f38ca43460d136a2f}{byte\_offset\_}}\ +\ num\_bytes);}
\DoxyCodeLine{00075\ \ \ \ \ uint8\_t*\ ptr\ =\ \mbox{\hyperlink{classdoris_1_1_bit_writer_a387ae995b4a7d9150e1630ec6d5f1c49}{buffer\_}}-\/>\mbox{\hyperlink{classdoris_1_1faststring_a215eaf2835bd078eb7cf0da711115346}{data}}()\ +\ \mbox{\hyperlink{classdoris_1_1_bit_writer_a6c8e3fb5e081561f38ca43460d136a2f}{byte\_offset\_}};}
\DoxyCodeLine{00076\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_bit_writer_a6c8e3fb5e081561f38ca43460d136a2f}{byte\_offset\_}}\ +=\ num\_bytes;}
\DoxyCodeLine{00077\ \ \ \ \ DCHECK\_LE(\mbox{\hyperlink{classdoris_1_1_bit_writer_a6c8e3fb5e081561f38ca43460d136a2f}{byte\_offset\_}},\ \mbox{\hyperlink{classdoris_1_1_bit_writer_a387ae995b4a7d9150e1630ec6d5f1c49}{buffer\_}}-\/>\mbox{\hyperlink{classdoris_1_1faststring_a7223528283cd4e5872e0cc716bf9bd9d}{capacity}}());}
\DoxyCodeLine{00078\ \ \ \ \ \textcolor{keywordflow}{return}\ ptr;}
\DoxyCodeLine{00079\ \}}
\DoxyCodeLine{00080\ }
\DoxyCodeLine{00081\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00082\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1_bit_writer_a7123bf7d8934fe03d6115a490140e3b0}{BitWriter::PutAligned}}(\mbox{\hyperlink{exp_8c_a0acb682b8260ab1c60b918599864e2e5}{T}}\ val,\ \textcolor{keywordtype}{int}\ num\_bytes)\ \{}
\DoxyCodeLine{00083\ \ \ \ \ DCHECK\_LE(num\_bytes,\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{exp_8c_a0acb682b8260ab1c60b918599864e2e5}{T}}));}
\DoxyCodeLine{00084\ \ \ \ \ uint8\_t*\ ptr\ =\ \mbox{\hyperlink{classdoris_1_1_bit_writer_afe6d2ee2837c730dfdf0bc22603c0542}{GetNextBytePtr}}(num\_bytes);}
\DoxyCodeLine{00085\ \ \ \ \ \mbox{\hyperlink{memcpy__aarch64_8cpp_a156c5821f16ed93be8c7d315303f7b2a}{memcpy}}(ptr,\ \&val,\ num\_bytes);}
\DoxyCodeLine{00086\ \}}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00088\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1_bit_writer_a24d31d895216450c01488ec8b0ee8548}{BitWriter::PutVlqInt}}(int32\_t\ v)\ \{}
\DoxyCodeLine{00089\ \ \ \ \ \textcolor{keywordflow}{while}\ ((v\ \&\ 0xFFFFFF80)\ !=\ 0L)\ \{}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ PutAligned<uint8\_t>((v\ \&\ 0x7F)\ |\ 0x80,\ 1);}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ v\ >>=\ 7;}
\DoxyCodeLine{00092\ \ \ \ \ \}}
\DoxyCodeLine{00093\ \ \ \ \ PutAligned<uint8\_t>(v\ \&\ 0x7F,\ 1);}
\DoxyCodeLine{00094\ \}}
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00096\ \textcolor{keyword}{inline}\ \mbox{\hyperlink{classdoris_1_1_bit_reader_ac0726f5aac68a2b4539003b7892f6ad9}{BitReader::BitReader}}(\textcolor{keyword}{const}\ uint8\_t*\ buffer,\ \textcolor{keywordtype}{int}\ buffer\_len)}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{signal__handler_8h_a37525d5cfe40669bc9ca14b3234c70d2}{buffer\_}}(buffer),}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \ \ max\_bytes\_(buffer\_len),}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ \ \ buffered\_values\_(0),}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ \ \ byte\_offset\_(0),}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \ \ bit\_offset\_(0)\ \{}
\DoxyCodeLine{00102\ \ \ \ \ \textcolor{keywordtype}{int}\ num\_bytes\ =\ std::min(8,\ \mbox{\hyperlink{classdoris_1_1_bit_reader_a163ead0e7ab6eeff4bdd55ac51bd054b}{max\_bytes\_}});}
\DoxyCodeLine{00103\ \ \ \ \ \mbox{\hyperlink{memcpy__aarch64_8cpp_a156c5821f16ed93be8c7d315303f7b2a}{memcpy}}(\&\mbox{\hyperlink{classdoris_1_1_bit_reader_adc033a5e038feb634fe7436abc5a087c}{buffered\_values\_}},\ \mbox{\hyperlink{classdoris_1_1_bit_reader_a83fa585f5b2aa9ac3601d380761d38af}{buffer\_}}\ +\ \mbox{\hyperlink{classdoris_1_1_bit_reader_a6c8e3fb5e081561f38ca43460d136a2f}{byte\_offset\_}},\ num\_bytes);}
\DoxyCodeLine{00104\ \}}
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00106\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1_bit_reader_a9349aa34beda34a165dc019b52ab78eb}{BitReader::BufferValues}}()\ \{}
\DoxyCodeLine{00107\ \ \ \ \ \textcolor{keywordtype}{int}\ bytes\_remaining\ =\ \mbox{\hyperlink{classdoris_1_1_bit_reader_a163ead0e7ab6eeff4bdd55ac51bd054b}{max\_bytes\_}}\ -\/\ \mbox{\hyperlink{classdoris_1_1_bit_reader_a6c8e3fb5e081561f38ca43460d136a2f}{byte\_offset\_}};}
\DoxyCodeLine{00108\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{port_8h_a9e276e58cb5539281d80bf7676bd73a7}{PREDICT\_TRUE}}(bytes\_remaining\ >=\ 8))\ \{}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{memcpy__aarch64_8cpp_a156c5821f16ed93be8c7d315303f7b2a}{memcpy}}(\&\mbox{\hyperlink{classdoris_1_1_bit_reader_adc033a5e038feb634fe7436abc5a087c}{buffered\_values\_}},\ \mbox{\hyperlink{classdoris_1_1_bit_reader_a83fa585f5b2aa9ac3601d380761d38af}{buffer\_}}\ +\ \mbox{\hyperlink{classdoris_1_1_bit_reader_a6c8e3fb5e081561f38ca43460d136a2f}{byte\_offset\_}},\ 8);}
\DoxyCodeLine{00110\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{memcpy__aarch64_8cpp_a156c5821f16ed93be8c7d315303f7b2a}{memcpy}}(\&\mbox{\hyperlink{classdoris_1_1_bit_reader_adc033a5e038feb634fe7436abc5a087c}{buffered\_values\_}},\ \mbox{\hyperlink{classdoris_1_1_bit_reader_a83fa585f5b2aa9ac3601d380761d38af}{buffer\_}}\ +\ \mbox{\hyperlink{classdoris_1_1_bit_reader_a6c8e3fb5e081561f38ca43460d136a2f}{byte\_offset\_}},\ bytes\_remaining);}
\DoxyCodeLine{00112\ \ \ \ \ \}}
\DoxyCodeLine{00113\ \}}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00115\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00116\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1_bit_reader_af4fe3f02c5d5296029b792a6c18884c4}{BitReader::GetValue}}(\textcolor{keywordtype}{int}\ num\_bits,\ \mbox{\hyperlink{exp_8c_a0acb682b8260ab1c60b918599864e2e5}{T}}*\ v)\ \{}
\DoxyCodeLine{00117\ \ \ \ \ DCHECK\_LE(num\_bits,\ 64);}
\DoxyCodeLine{00118\ \ \ \ \ DCHECK\_LE(num\_bits,\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{exp_8c_a0acb682b8260ab1c60b918599864e2e5}{T}})\ *\ 8);}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00120\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{port_8h_aff70f3c8f03aae06b9011058a8da0cf0}{PREDICT\_FALSE}}(\mbox{\hyperlink{classdoris_1_1_bit_reader_a6c8e3fb5e081561f38ca43460d136a2f}{byte\_offset\_}}\ *\ 8\ +\ \mbox{\hyperlink{classdoris_1_1_bit_reader_ab52dc5034c0e004b8993280d95a33b64}{bit\_offset\_}}\ +\ num\_bits\ >\ \mbox{\hyperlink{classdoris_1_1_bit_reader_a163ead0e7ab6eeff4bdd55ac51bd054b}{max\_bytes\_}}\ *\ 8))\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00122\ \ \ \ \ *v\ =\ \mbox{\hyperlink{classdoris_1_1_bit_util_adccafd5a2a94fd5a030285793813aa72}{BitUtil::TrailingBits}}(\mbox{\hyperlink{classdoris_1_1_bit_reader_adc033a5e038feb634fe7436abc5a087c}{buffered\_values\_}},\ \mbox{\hyperlink{classdoris_1_1_bit_reader_ab52dc5034c0e004b8993280d95a33b64}{bit\_offset\_}}\ +\ num\_bits)\ >>\ \mbox{\hyperlink{classdoris_1_1_bit_reader_ab52dc5034c0e004b8993280d95a33b64}{bit\_offset\_}};}
\DoxyCodeLine{00123\ }
\DoxyCodeLine{00124\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_bit_reader_ab52dc5034c0e004b8993280d95a33b64}{bit\_offset\_}}\ +=\ num\_bits;}
\DoxyCodeLine{00125\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classdoris_1_1_bit_reader_ab52dc5034c0e004b8993280d95a33b64}{bit\_offset\_}}\ >=\ 64)\ \{}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_bit_reader_a6c8e3fb5e081561f38ca43460d136a2f}{byte\_offset\_}}\ +=\ 8;}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_bit_reader_ab52dc5034c0e004b8993280d95a33b64}{bit\_offset\_}}\ -\/=\ 64;}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_bit_reader_a9349aa34beda34a165dc019b52ab78eb}{BufferValues}}();}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Read\ bits\ of\ v\ that\ crossed\ into\ new\ buffered\_values\_}}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ *v\ |=\ \mbox{\hyperlink{classdoris_1_1_bit_util_ae6e329cef5e95e23d76bd987d04d0ff6}{BitUtil::ShiftLeftZeroOnOverflow}}(\mbox{\hyperlink{classdoris_1_1_bit_util_adccafd5a2a94fd5a030285793813aa72}{BitUtil::TrailingBits}}(\mbox{\hyperlink{classdoris_1_1_bit_reader_adc033a5e038feb634fe7436abc5a087c}{buffered\_values\_}},\ \mbox{\hyperlink{classdoris_1_1_bit_reader_ab52dc5034c0e004b8993280d95a33b64}{bit\_offset\_}}),}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (num\_bits\ -\/\ \mbox{\hyperlink{classdoris_1_1_bit_reader_ab52dc5034c0e004b8993280d95a33b64}{bit\_offset\_}}));}
\DoxyCodeLine{00132\ \ \ \ \ \}}
\DoxyCodeLine{00133\ \ \ \ \ DCHECK\_LE(\mbox{\hyperlink{classdoris_1_1_bit_reader_ab52dc5034c0e004b8993280d95a33b64}{bit\_offset\_}},\ 64);}
\DoxyCodeLine{00134\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00135\ \}}
\DoxyCodeLine{00136\ }
\DoxyCodeLine{00137\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1_bit_reader_aaa16bfb4016424fa24a0c302df7b4b88}{BitReader::Rewind}}(\textcolor{keywordtype}{int}\ num\_bits)\ \{}
\DoxyCodeLine{00138\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_bit_reader_ab52dc5034c0e004b8993280d95a33b64}{bit\_offset\_}}\ -\/=\ num\_bits;}
\DoxyCodeLine{00139\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classdoris_1_1_bit_reader_ab52dc5034c0e004b8993280d95a33b64}{bit\_offset\_}}\ >=\ 0)\ \{}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00141\ \ \ \ \ \}}
\DoxyCodeLine{00142\ \ \ \ \ \textcolor{keywordflow}{while}\ (\mbox{\hyperlink{classdoris_1_1_bit_reader_ab52dc5034c0e004b8993280d95a33b64}{bit\_offset\_}}\ <\ 0)\ \{}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ seek\_back\ =\ std::min(\mbox{\hyperlink{classdoris_1_1_bit_reader_a6c8e3fb5e081561f38ca43460d136a2f}{byte\_offset\_}},\ 8);}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_bit_reader_a6c8e3fb5e081561f38ca43460d136a2f}{byte\_offset\_}}\ -\/=\ seek\_back;}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_bit_reader_ab52dc5034c0e004b8993280d95a33b64}{bit\_offset\_}}\ +=\ seek\_back\ *\ 8;}
\DoxyCodeLine{00146\ \ \ \ \ \}}
\DoxyCodeLine{00147\ \ \ \ \ \textcolor{comment}{//\ This\ should\ only\ be\ executed\ *if*\ rewinding\ by\ 'num\_bits'}}
\DoxyCodeLine{00148\ \ \ \ \ \textcolor{comment}{//\ make\ the\ existing\ buffered\_values\_\ invalid}}
\DoxyCodeLine{00149\ \ \ \ \ DCHECK\_GE(\mbox{\hyperlink{classdoris_1_1_bit_reader_a6c8e3fb5e081561f38ca43460d136a2f}{byte\_offset\_}},\ 0);\ \textcolor{comment}{//\ Check\ for\ underflow}}
\DoxyCodeLine{00150\ \ \ \ \ \mbox{\hyperlink{memcpy__aarch64_8cpp_a156c5821f16ed93be8c7d315303f7b2a}{memcpy}}(\&\mbox{\hyperlink{classdoris_1_1_bit_reader_adc033a5e038feb634fe7436abc5a087c}{buffered\_values\_}},\ \mbox{\hyperlink{classdoris_1_1_bit_reader_a83fa585f5b2aa9ac3601d380761d38af}{buffer\_}}\ +\ \mbox{\hyperlink{classdoris_1_1_bit_reader_a6c8e3fb5e081561f38ca43460d136a2f}{byte\_offset\_}},\ 8);}
\DoxyCodeLine{00151\ \}}
\DoxyCodeLine{00152\ }
\DoxyCodeLine{00153\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1_bit_reader_a971b901a518e54154e3418224a577f78}{BitReader::SeekToBit}}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ stream\_position)\ \{}
\DoxyCodeLine{00154\ \ \ \ \ DCHECK\_LE(stream\_position,\ \mbox{\hyperlink{classdoris_1_1_bit_reader_a163ead0e7ab6eeff4bdd55ac51bd054b}{max\_bytes\_}}\ *\ 8);}
\DoxyCodeLine{00155\ }
\DoxyCodeLine{00156\ \ \ \ \ \textcolor{keywordtype}{int}\ delta\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(stream\_position)\ -\/\ \mbox{\hyperlink{classdoris_1_1_bit_reader_a186c71f841d085110172059bcb58006b}{position}}();}
\DoxyCodeLine{00157\ \ \ \ \ \textcolor{keywordflow}{if}\ (delta\ ==\ 0)\ \{}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00159\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (delta\ <\ 0)\ \{}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_bit_reader_aaa16bfb4016424fa24a0c302df7b4b88}{Rewind}}(\mbox{\hyperlink{classdoris_1_1_bit_reader_a186c71f841d085110172059bcb58006b}{position}}()\ -\/\ stream\_position);}
\DoxyCodeLine{00161\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_bit_reader_ab52dc5034c0e004b8993280d95a33b64}{bit\_offset\_}}\ +=\ delta;}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (\mbox{\hyperlink{classdoris_1_1_bit_reader_ab52dc5034c0e004b8993280d95a33b64}{bit\_offset\_}}\ >=\ 64)\ \{}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_bit_reader_a6c8e3fb5e081561f38ca43460d136a2f}{byte\_offset\_}}\ +=\ 8;}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_bit_reader_ab52dc5034c0e004b8993280d95a33b64}{bit\_offset\_}}\ -\/=\ 64;}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classdoris_1_1_bit_reader_ab52dc5034c0e004b8993280d95a33b64}{bit\_offset\_}}\ <\ 64)\ \{}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ This\ should\ only\ be\ executed\ if\ seeking\ to}}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ 'stream\_position'\ makes\ the\ existing\ buffered\_values\_}}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ invalid.}}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_bit_reader_a9349aa34beda34a165dc019b52ab78eb}{BufferValues}}();}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00173\ \ \ \ \ \}}
\DoxyCodeLine{00174\ \}}
\DoxyCodeLine{00175\ }
\DoxyCodeLine{00176\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00177\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1_bit_reader_aeb4acca07e7a6965211244f1186dddfc}{BitReader::GetAligned}}(\textcolor{keywordtype}{int}\ num\_bytes,\ \mbox{\hyperlink{exp_8c_a0acb682b8260ab1c60b918599864e2e5}{T}}*\ v)\ \{}
\DoxyCodeLine{00178\ \ \ \ \ DCHECK\_LE(num\_bytes,\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{exp_8c_a0acb682b8260ab1c60b918599864e2e5}{T}}));}
\DoxyCodeLine{00179\ \ \ \ \ \textcolor{keywordtype}{int}\ bytes\_read\ =\ \mbox{\hyperlink{classdoris_1_1_bit_util_ab9002e6aac9b818996faf615f08e426a}{BitUtil::Ceil}}(\mbox{\hyperlink{classdoris_1_1_bit_reader_ab52dc5034c0e004b8993280d95a33b64}{bit\_offset\_}},\ 8);}
\DoxyCodeLine{00180\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{port_8h_aff70f3c8f03aae06b9011058a8da0cf0}{PREDICT\_FALSE}}(\mbox{\hyperlink{classdoris_1_1_bit_reader_a6c8e3fb5e081561f38ca43460d136a2f}{byte\_offset\_}}\ +\ bytes\_read\ +\ num\_bytes\ >\ \mbox{\hyperlink{classdoris_1_1_bit_reader_a163ead0e7ab6eeff4bdd55ac51bd054b}{max\_bytes\_}}))\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00181\ }
\DoxyCodeLine{00182\ \ \ \ \ \textcolor{comment}{//\ Advance\ byte\_offset\ to\ next\ unread\ byte\ and\ read\ num\_bytes}}
\DoxyCodeLine{00183\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_bit_reader_a6c8e3fb5e081561f38ca43460d136a2f}{byte\_offset\_}}\ +=\ bytes\_read;}
\DoxyCodeLine{00184\ \ \ \ \ \mbox{\hyperlink{memcpy__aarch64_8cpp_a156c5821f16ed93be8c7d315303f7b2a}{memcpy}}(v,\ \mbox{\hyperlink{classdoris_1_1_bit_reader_a83fa585f5b2aa9ac3601d380761d38af}{buffer\_}}\ +\ \mbox{\hyperlink{classdoris_1_1_bit_reader_a6c8e3fb5e081561f38ca43460d136a2f}{byte\_offset\_}},\ num\_bytes);}
\DoxyCodeLine{00185\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_bit_reader_a6c8e3fb5e081561f38ca43460d136a2f}{byte\_offset\_}}\ +=\ num\_bytes;}
\DoxyCodeLine{00186\ }
\DoxyCodeLine{00187\ \ \ \ \ \textcolor{comment}{//\ Reset\ buffered\_values\_}}
\DoxyCodeLine{00188\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_bit_reader_ab52dc5034c0e004b8993280d95a33b64}{bit\_offset\_}}\ =\ 0;}
\DoxyCodeLine{00189\ \ \ \ \ \textcolor{keywordtype}{int}\ bytes\_remaining\ =\ \mbox{\hyperlink{classdoris_1_1_bit_reader_a163ead0e7ab6eeff4bdd55ac51bd054b}{max\_bytes\_}}\ -\/\ \mbox{\hyperlink{classdoris_1_1_bit_reader_a6c8e3fb5e081561f38ca43460d136a2f}{byte\_offset\_}};}
\DoxyCodeLine{00190\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{port_8h_a9e276e58cb5539281d80bf7676bd73a7}{PREDICT\_TRUE}}(bytes\_remaining\ >=\ 8))\ \{}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{memcpy__aarch64_8cpp_a156c5821f16ed93be8c7d315303f7b2a}{memcpy}}(\&\mbox{\hyperlink{classdoris_1_1_bit_reader_adc033a5e038feb634fe7436abc5a087c}{buffered\_values\_}},\ \mbox{\hyperlink{classdoris_1_1_bit_reader_a83fa585f5b2aa9ac3601d380761d38af}{buffer\_}}\ +\ \mbox{\hyperlink{classdoris_1_1_bit_reader_a6c8e3fb5e081561f38ca43460d136a2f}{byte\_offset\_}},\ 8);}
\DoxyCodeLine{00192\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{memcpy__aarch64_8cpp_a156c5821f16ed93be8c7d315303f7b2a}{memcpy}}(\&\mbox{\hyperlink{classdoris_1_1_bit_reader_adc033a5e038feb634fe7436abc5a087c}{buffered\_values\_}},\ \mbox{\hyperlink{classdoris_1_1_bit_reader_a83fa585f5b2aa9ac3601d380761d38af}{buffer\_}}\ +\ \mbox{\hyperlink{classdoris_1_1_bit_reader_a6c8e3fb5e081561f38ca43460d136a2f}{byte\_offset\_}},\ bytes\_remaining);}
\DoxyCodeLine{00194\ \ \ \ \ \}}
\DoxyCodeLine{00195\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00196\ \}}
\DoxyCodeLine{00197\ }
\DoxyCodeLine{00198\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1_bit_reader_a9419aedb59788b03211af501713554a7}{BitReader::GetVlqInt}}(int32\_t*\ v)\ \{}
\DoxyCodeLine{00199\ \ \ \ \ *v\ =\ 0;}
\DoxyCodeLine{00200\ \ \ \ \ \textcolor{keywordtype}{int}\ shift\ =\ 0;}
\DoxyCodeLine{00201\ \ \ \ \ \textcolor{keywordtype}{int}\ num\_bytes\ =\ 0;}
\DoxyCodeLine{00202\ \ \ \ \ uint8\_t\ \textcolor{keywordtype}{byte}\ =\ 0;}
\DoxyCodeLine{00203\ \ \ \ \ \textcolor{keywordflow}{do}\ \{}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!GetAligned<uint8\_t>(1,\ \&\textcolor{keywordtype}{byte}))\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ *v\ |=\ (\textcolor{keywordtype}{byte}\ \&\ 0x7F)\ <<\ shift;}
\DoxyCodeLine{00206\ \ \ \ \ \ \ \ \ shift\ +=\ 7;}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \ \ DCHECK\_LE(++num\_bytes,\ \mbox{\hyperlink{classdoris_1_1_bit_reader_aa51d64b66ddebd02f6b94f05a67f9476}{MAX\_VLQ\_BYTE\_LEN}});}
\DoxyCodeLine{00208\ \ \ \ \ \}\ \textcolor{keywordflow}{while}\ ((\textcolor{keywordtype}{byte}\ \&\ 0x80)\ !=\ 0);}
\DoxyCodeLine{00209\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00210\ \}}
\DoxyCodeLine{00211\ }
\DoxyCodeLine{00212\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00213\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classdoris_1_1_batched_bit_reader_acff74898c3a45f097ab227f49e131f4a}{BatchedBitReader::UnpackBatch}}(\textcolor{keywordtype}{int}\ bit\_width,\ \textcolor{keywordtype}{int}\ num\_values,\ \mbox{\hyperlink{exp_8c_a0acb682b8260ab1c60b918599864e2e5}{T}}*\ v)\ \{}
\DoxyCodeLine{00214\ \ \ \ \ DCHECK(\mbox{\hyperlink{classdoris_1_1_batched_bit_reader_a6b50ac6283692a4144cb59a3d7e9d63f}{buffer\_pos\_}}\ !=\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00215\ \ \ \ \ DCHECK\_GE(bit\_width,\ 0);}
\DoxyCodeLine{00216\ \ \ \ \ DCHECK\_LE(bit\_width,\ \mbox{\hyperlink{classdoris_1_1_batched_bit_reader_a122f34e44299ecba43fd54a57994935b}{MAX\_BITWIDTH}});}
\DoxyCodeLine{00217\ \ \ \ \ DCHECK\_LE(bit\_width,\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{exp_8c_a0acb682b8260ab1c60b918599864e2e5}{T}})\ *\ 8);}
\DoxyCodeLine{00218\ \ \ \ \ DCHECK\_GE(num\_values,\ 0);}
\DoxyCodeLine{00219\ }
\DoxyCodeLine{00220\ \ \ \ \ int64\_t\ num\_read;}
\DoxyCodeLine{00221\ \ \ \ \ std::tie(\mbox{\hyperlink{classdoris_1_1_batched_bit_reader_a6b50ac6283692a4144cb59a3d7e9d63f}{buffer\_pos\_}},\ num\_read)\ =}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_bit_packing_ad30022686967de61ed2b27c93961c2bb}{BitPacking::UnpackValues}}(bit\_width,\ \mbox{\hyperlink{classdoris_1_1_batched_bit_reader_a6b50ac6283692a4144cb59a3d7e9d63f}{buffer\_pos\_}},\ \mbox{\hyperlink{classdoris_1_1_batched_bit_reader_a7edd581ca3bdf5df0619edc68eb3c8f9}{bytes\_left}}(),\ num\_values,\ v);}
\DoxyCodeLine{00223\ \ \ \ \ DCHECK\_LE(\mbox{\hyperlink{classdoris_1_1_batched_bit_reader_a6b50ac6283692a4144cb59a3d7e9d63f}{buffer\_pos\_}},\ \mbox{\hyperlink{classdoris_1_1_batched_bit_reader_ae27374c9b898a83d8f2a48b054736a74}{buffer\_end\_}});}
\DoxyCodeLine{00224\ \ \ \ \ DCHECK\_LE(num\_read,\ num\_values);}
\DoxyCodeLine{00225\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(num\_read);}
\DoxyCodeLine{00226\ \}}
\DoxyCodeLine{00227\ }
\DoxyCodeLine{00228\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1_batched_bit_reader_a9866c67457c964149cdc86ae8b47bd15}{BatchedBitReader::SkipBatch}}(\textcolor{keywordtype}{int}\ bit\_width,\ \textcolor{keywordtype}{int}\ num\_values\_to\_skip)\ \{}
\DoxyCodeLine{00229\ \ \ \ \ DCHECK(\mbox{\hyperlink{classdoris_1_1_batched_bit_reader_a6b50ac6283692a4144cb59a3d7e9d63f}{buffer\_pos\_}}\ !=\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00230\ \ \ \ \ DCHECK\_GT(bit\_width,\ 0);}
\DoxyCodeLine{00231\ \ \ \ \ DCHECK\_LE(bit\_width,\ \mbox{\hyperlink{classdoris_1_1_batched_bit_reader_a122f34e44299ecba43fd54a57994935b}{MAX\_BITWIDTH}});}
\DoxyCodeLine{00232\ \ \ \ \ DCHECK\_GT(num\_values\_to\_skip,\ 0);}
\DoxyCodeLine{00233\ }
\DoxyCodeLine{00234\ \ \ \ \ \textcolor{keywordtype}{int}\ skip\_bytes\ =\ \mbox{\hyperlink{classdoris_1_1_bit_util_a07749bfe93fca0901e6dd0fed3857f3f}{BitUtil::RoundUpNumBytes}}(bit\_width\ *\ num\_values\_to\_skip);}
\DoxyCodeLine{00235\ \ \ \ \ \textcolor{keywordflow}{if}\ (skip\_bytes\ >\ \mbox{\hyperlink{classdoris_1_1_batched_bit_reader_ae27374c9b898a83d8f2a48b054736a74}{buffer\_end\_}}\ -\/\ \mbox{\hyperlink{classdoris_1_1_batched_bit_reader_a6b50ac6283692a4144cb59a3d7e9d63f}{buffer\_pos\_}})\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00236\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_batched_bit_reader_a6b50ac6283692a4144cb59a3d7e9d63f}{buffer\_pos\_}}\ +=\ skip\_bytes;}
\DoxyCodeLine{00237\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00238\ \}}
\DoxyCodeLine{00239\ }
\DoxyCodeLine{00240\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00241\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classdoris_1_1_batched_bit_reader_a4ac729fbee9fed1817808d55622fdd4a}{BatchedBitReader::UnpackAndDecodeBatch}}(\textcolor{keywordtype}{int}\ bit\_width,\ \mbox{\hyperlink{exp_8c_a0acb682b8260ab1c60b918599864e2e5}{T}}*\ dict,\ int64\_t\ dict\_len,}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ num\_values,\ \mbox{\hyperlink{exp_8c_a0acb682b8260ab1c60b918599864e2e5}{T}}*\ v,\ int64\_t\ stride)\ \{}
\DoxyCodeLine{00243\ \ \ \ \ DCHECK(\mbox{\hyperlink{classdoris_1_1_batched_bit_reader_a6b50ac6283692a4144cb59a3d7e9d63f}{buffer\_pos\_}}\ !=\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00244\ \ \ \ \ DCHECK\_GE(bit\_width,\ 0);}
\DoxyCodeLine{00245\ \ \ \ \ DCHECK\_LE(bit\_width,\ \mbox{\hyperlink{classdoris_1_1_batched_bit_reader_a122f34e44299ecba43fd54a57994935b}{MAX\_BITWIDTH}});}
\DoxyCodeLine{00246\ \ \ \ \ DCHECK\_GE(num\_values,\ 0);}
\DoxyCodeLine{00247\ }
\DoxyCodeLine{00248\ \ \ \ \ \textcolor{keyword}{const}\ uint8\_t*\ new\_buffer\_pos;}
\DoxyCodeLine{00249\ \ \ \ \ int64\_t\ num\_read;}
\DoxyCodeLine{00250\ \ \ \ \ \textcolor{keywordtype}{bool}\ decode\_error\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00251\ \ \ \ \ std::tie(new\_buffer\_pos,\ num\_read)\ =}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_bit_packing_a5c48753076d98b58714c616925a24d51}{BitPacking::UnpackAndDecodeValues}}(bit\_width,\ \mbox{\hyperlink{classdoris_1_1_batched_bit_reader_a6b50ac6283692a4144cb59a3d7e9d63f}{buffer\_pos\_}},\ \mbox{\hyperlink{classdoris_1_1_batched_bit_reader_a7edd581ca3bdf5df0619edc68eb3c8f9}{bytes\_left}}(),\ dict,\ dict\_len,}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ num\_values,\ v,\ stride,\ \&decode\_error);}
\DoxyCodeLine{00254\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{compiler__util_8h_a9acc330d508b9a3b775cfdf7ce405e7d}{UNLIKELY}}(decode\_error))\ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00255\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_batched_bit_reader_a6b50ac6283692a4144cb59a3d7e9d63f}{buffer\_pos\_}}\ =\ new\_buffer\_pos;}
\DoxyCodeLine{00256\ \ \ \ \ DCHECK\_LE(\mbox{\hyperlink{classdoris_1_1_batched_bit_reader_a6b50ac6283692a4144cb59a3d7e9d63f}{buffer\_pos\_}},\ \mbox{\hyperlink{classdoris_1_1_batched_bit_reader_ae27374c9b898a83d8f2a48b054736a74}{buffer\_end\_}});}
\DoxyCodeLine{00257\ \ \ \ \ DCHECK\_LE(num\_read,\ num\_values);}
\DoxyCodeLine{00258\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(num\_read);}
\DoxyCodeLine{00259\ \}}
\DoxyCodeLine{00260\ }
\DoxyCodeLine{00261\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00262\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1_batched_bit_reader_a26289b3e357fd2130867cc1466f58cb6}{BatchedBitReader::GetBytes}}(\textcolor{keywordtype}{int}\ num\_bytes,\ \mbox{\hyperlink{exp_8c_a0acb682b8260ab1c60b918599864e2e5}{T}}*\ v)\ \{}
\DoxyCodeLine{00263\ \ \ \ \ DCHECK(\mbox{\hyperlink{classdoris_1_1_batched_bit_reader_a6b50ac6283692a4144cb59a3d7e9d63f}{buffer\_pos\_}}\ !=\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00264\ \ \ \ \ DCHECK\_GE(num\_bytes,\ 0);}
\DoxyCodeLine{00265\ \ \ \ \ DCHECK\_LE(num\_bytes,\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{exp_8c_a0acb682b8260ab1c60b918599864e2e5}{T}}));}
\DoxyCodeLine{00266\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{compiler__util_8h_a9acc330d508b9a3b775cfdf7ce405e7d}{UNLIKELY}}(\mbox{\hyperlink{classdoris_1_1_batched_bit_reader_a6b50ac6283692a4144cb59a3d7e9d63f}{buffer\_pos\_}}\ +\ num\_bytes\ >\ \mbox{\hyperlink{classdoris_1_1_batched_bit_reader_ae27374c9b898a83d8f2a48b054736a74}{buffer\_end\_}}))\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00267\ \ \ \ \ *v\ =\ 0;\ \textcolor{comment}{//\ Ensure\ unset\ bytes\ are\ initialized\ to\ zero.}}
\DoxyCodeLine{00268\ \ \ \ \ \mbox{\hyperlink{memcpy__aarch64_8cpp_a156c5821f16ed93be8c7d315303f7b2a}{memcpy}}(v,\ \mbox{\hyperlink{classdoris_1_1_batched_bit_reader_a6b50ac6283692a4144cb59a3d7e9d63f}{buffer\_pos\_}},\ num\_bytes);}
\DoxyCodeLine{00269\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_batched_bit_reader_a6b50ac6283692a4144cb59a3d7e9d63f}{buffer\_pos\_}}\ +=\ num\_bytes;}
\DoxyCodeLine{00270\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00271\ \}}
\DoxyCodeLine{00272\ }
\DoxyCodeLine{00273\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ UINT\_T>}
\DoxyCodeLine{00274\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1_batched_bit_reader_afff8698fa0cd066a9da25c05c17156e4}{BatchedBitReader::GetUleb128}}(UINT\_T*\ v)\ \{}
\DoxyCodeLine{00275\ \ \ \ \ \textcolor{keyword}{static\_assert}(std::is\_integral<UINT\_T>::value,\ \textcolor{stringliteral}{"{}Integral\ type\ required."{}});}
\DoxyCodeLine{00276\ \ \ \ \ \textcolor{keyword}{static\_assert}(std::is\_unsigned<UINT\_T>::value,\ \textcolor{stringliteral}{"{}Unsigned\ type\ required."{}});}
\DoxyCodeLine{00277\ \ \ \ \ \textcolor{keyword}{static\_assert}(!std::is\_same<UINT\_T,\ bool>::value,\ \textcolor{stringliteral}{"{}Bools\ are\ not\ supported."{}});}
\DoxyCodeLine{00278\ }
\DoxyCodeLine{00279\ \ \ \ \ *v\ =\ 0;}
\DoxyCodeLine{00280\ \ \ \ \ \textcolor{keywordtype}{int}\ shift\ =\ 0;}
\DoxyCodeLine{00281\ \ \ \ \ uint8\_t\ \textcolor{keywordtype}{byte}\ =\ 0;}
\DoxyCodeLine{00282\ \ \ \ \ \textcolor{keywordflow}{do}\ \{}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{compiler__util_8h_a9acc330d508b9a3b775cfdf7ce405e7d}{UNLIKELY}}(shift\ >=\ max\_vlq\_byte\_len<UINT\_T>()\ *\ 7))\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classdoris_1_1_batched_bit_reader_a26289b3e357fd2130867cc1466f58cb6}{GetBytes}}(1,\ \&\textcolor{keywordtype}{byte}))\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00285\ }
\DoxyCodeLine{00289\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ UINT\_T\ byte\_as\_UINT\_T\ =\ byte;}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ *v\ |=\ (byte\_as\_UINT\_T\ \&\ 0x7Fu)\ <<\ shift;}
\DoxyCodeLine{00291\ \ \ \ \ \ \ \ \ shift\ +=\ 7;}
\DoxyCodeLine{00292\ \ \ \ \ \}\ \textcolor{keywordflow}{while}\ ((\textcolor{keywordtype}{byte}\ \&\ 0x80u)\ !=\ 0);}
\DoxyCodeLine{00293\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00294\ \}}
\DoxyCodeLine{00295\ }
\DoxyCodeLine{00296\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ INT\_T>}
\DoxyCodeLine{00297\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1_batched_bit_reader_abd52d577b05484e298062c13852b3a1a}{BatchedBitReader::GetZigZagInteger}}(INT\_T*\ v)\ \{}
\DoxyCodeLine{00298\ \ \ \ \ \textcolor{keyword}{static\_assert}(std::is\_integral<INT\_T>::value,\ \textcolor{stringliteral}{"{}Integral\ type\ required."{}});}
\DoxyCodeLine{00299\ \ \ \ \ \textcolor{keyword}{static\_assert}(std::is\_signed<INT\_T>::value,\ \textcolor{stringliteral}{"{}Signed\ type\ required."{}});}
\DoxyCodeLine{00300\ }
\DoxyCodeLine{00301\ \ \ \ \ \textcolor{keyword}{using\ }UINT\_T\ =\ std::make\_unsigned\_t<INT\_T>;}
\DoxyCodeLine{00302\ }
\DoxyCodeLine{00303\ \ \ \ \ UINT\_T\ v\_unsigned;}
\DoxyCodeLine{00304\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{compiler__util_8h_a9acc330d508b9a3b775cfdf7ce405e7d}{UNLIKELY}}(!GetUleb128<UINT\_T>(\&v\_unsigned)))\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00305\ }
\DoxyCodeLine{00307\ \ \ \ \ *v\ =\ (v\_unsigned\ >>\ 1)\ \string^\ -\/(v\_unsigned\ \&\ 1u);}
\DoxyCodeLine{00308\ }
\DoxyCodeLine{00309\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00310\ \}}
\DoxyCodeLine{00311\ }
\DoxyCodeLine{00312\ \}\ \textcolor{comment}{//\ namespace\ doris}}

\end{DoxyCode}
