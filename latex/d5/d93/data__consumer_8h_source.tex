\hypertarget{data__consumer_8h_source}{}\doxysection{data\+\_\+consumer.\+h}
\label{data__consumer_8h_source}\index{/Users/dabowang/be\_all/runtime/routine\_load/data\_consumer.h@{/Users/dabowang/be\_all/runtime/routine\_load/data\_consumer.h}}
\mbox{\hyperlink{data__consumer_8h}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Licensed\ to\ the\ Apache\ Software\ Foundation\ (ASF)\ under\ one}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ or\ more\ contributor\ license\ agreements.\ \ See\ the\ NOTICE\ file}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ distributed\ with\ this\ work\ for\ additional\ information}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ regarding\ copyright\ ownership.\ \ The\ ASF\ licenses\ this\ file}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ to\ you\ under\ the\ Apache\ License,\ Version\ 2.0\ (the}}
\DoxyCodeLine{00006\ \textcolor{comment}{//\ "{}License"{});\ you\ may\ not\ use\ this\ file\ except\ in\ compliance}}
\DoxyCodeLine{00007\ \textcolor{comment}{//\ with\ the\ License.\ \ You\ may\ obtain\ a\ copy\ of\ the\ License\ at}}
\DoxyCodeLine{00008\ \textcolor{comment}{//}}
\DoxyCodeLine{00009\ \textcolor{comment}{//\ \ \ http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{00010\ \textcolor{comment}{//}}
\DoxyCodeLine{00011\ \textcolor{comment}{//\ Unless\ required\ by\ applicable\ law\ or\ agreed\ to\ in\ writing,}}
\DoxyCodeLine{00012\ \textcolor{comment}{//\ software\ distributed\ under\ the\ License\ is\ distributed\ on\ an}}
\DoxyCodeLine{00013\ \textcolor{comment}{//\ "{}AS\ IS"{}\ BASIS,\ WITHOUT\ WARRANTIES\ OR\ CONDITIONS\ OF\ ANY}}
\DoxyCodeLine{00014\ \textcolor{comment}{//\ KIND,\ either\ express\ or\ implied.\ \ See\ the\ License\ for\ the}}
\DoxyCodeLine{00015\ \textcolor{comment}{//\ specific\ language\ governing\ permissions\ and\ limitations}}
\DoxyCodeLine{00016\ \textcolor{comment}{//\ under\ the\ License.}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ <ctime>}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ <mutex>}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ <unordered\_map>}}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ "{}librdkafka/rdkafkacpp.h"{}}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{stream__load__context_8h}{runtime/stream\_load/stream\_load\_context.h}}"{}}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{blocking__queue_8hpp}{util/blocking\_queue.hpp}}"{}}}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{uid__util_8h}{util/uid\_util.h}}"{}}}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacedoris}{doris}}\ \{}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00031\ \textcolor{keyword}{class\ }KafkaConsumerPipe;}
\DoxyCodeLine{00032\ \textcolor{keyword}{class\ }Status;}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00034\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classdoris_1_1_data_consumer}{DataConsumer}}\ \{}
\DoxyCodeLine{00035\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00036\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_data_consumer_a1743da3293861b5bc2e69c5bcd02bfbb}{DataConsumer}}(\mbox{\hyperlink{classdoris_1_1_stream_load_context}{StreamLoadContext}}*\ ctx)}
\DoxyCodeLine{00037\ \ \ \ \ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{classdoris_1_1_data_consumer_ad34ec572f24bd89a3084f17e31236ccb}{\_id}}(\mbox{\hyperlink{structdoris_1_1_unique_id}{UniqueId}}::gen\_uid()),}
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_data_consumer_aed16d6083252ed95d670cd3d3754bbc6}{\_grp\_id}}(\mbox{\hyperlink{structdoris_1_1_unique_id}{UniqueId}}::gen\_uid()),}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_data_consumer_af99ec47d3f59ab1cb3e946f17018c5e3}{\_has\_grp}}(false),}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_data_consumer_a40756214f69d1c40ad70b64ae9fdc08d}{\_init}}(false),}
\DoxyCodeLine{00041\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_data_consumer_a543de0eba68317b586707e9e9ca035dd}{\_cancelled}}(false),}
\DoxyCodeLine{00042\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_data_consumer_a58e23a7dfc599c38cd3ad8ca58641948}{\_last\_visit\_time}}(0)\ \{\}}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{classdoris_1_1_data_consumer_ad208ba8b3d3978e62ddb49edf4f84e5e}{\string~DataConsumer}}()\ \{\}}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{comment}{//\ init\ the\ consumer\ with\ the\ given\ parameters}}
\DoxyCodeLine{00047\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_data_consumer_a773c54c25f8c2afc22cd53408ea5cfb0}{init}}(\mbox{\hyperlink{classdoris_1_1_stream_load_context}{StreamLoadContext}}*\ ctx)\ =\ 0;}
\DoxyCodeLine{00048\ \ \ \ \ \textcolor{comment}{//\ start\ consuming}}
\DoxyCodeLine{00049\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_data_consumer_a60bbcdf7a8846db2a0da2bf2f21575de}{consume}}(\mbox{\hyperlink{classdoris_1_1_stream_load_context}{StreamLoadContext}}*\ ctx)\ =\ 0;}
\DoxyCodeLine{00050\ \ \ \ \ \textcolor{comment}{//\ cancel\ the\ consuming\ process.}}
\DoxyCodeLine{00051\ \ \ \ \ \textcolor{comment}{//\ if\ the\ consumer\ is\ not\ initialized,\ or\ the\ consuming}}
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{comment}{//\ process\ is\ already\ finished,\ call\ cancel()\ will}}
\DoxyCodeLine{00053\ \ \ \ \ \textcolor{comment}{//\ return\ ERROR}}
\DoxyCodeLine{00054\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_data_consumer_a41310b63e8ee828e62917338cec502bc}{cancel}}(\mbox{\hyperlink{classdoris_1_1_stream_load_context}{StreamLoadContext}}*\ ctx)\ =\ 0;}
\DoxyCodeLine{00055\ \ \ \ \ \textcolor{comment}{//\ reset\ the\ data\ consumer\ before\ being\ reused}}
\DoxyCodeLine{00056\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_data_consumer_a8324bff8d0b3cb35ace5c38aa8004b8c}{reset}}()\ =\ 0;}
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{comment}{//\ return\ true\ the\ if\ the\ consumer\ match\ the\ need}}
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1_data_consumer_a4587ddd3dc2defb01790a6ced15c1ed6}{match}}(\mbox{\hyperlink{classdoris_1_1_stream_load_context}{StreamLoadContext}}*\ ctx)\ =\ 0;}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00060\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structdoris_1_1_unique_id}{UniqueId}}\&\ \mbox{\hyperlink{classdoris_1_1_data_consumer_a531718420164f8fa43505da2f4ec2a07}{id}}()\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdoris_1_1_data_consumer_ad34ec572f24bd89a3084f17e31236ccb}{\_id}};\ \}}
\DoxyCodeLine{00061\ \ \ \ \ time\_t\ \mbox{\hyperlink{classdoris_1_1_data_consumer_a0b4b098445495e1935d5b5b5bd9ea9a7}{last\_visit\_time}}()\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdoris_1_1_data_consumer_a58e23a7dfc599c38cd3ad8ca58641948}{\_last\_visit\_time}};\ \}}
\DoxyCodeLine{00062\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1_data_consumer_a04ea80d6035d1937e4b2d07e6e19eb0f}{set\_grp}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structdoris_1_1_unique_id}{UniqueId}}\&\ grp\_id)\ \{}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_data_consumer_aed16d6083252ed95d670cd3d3754bbc6}{\_grp\_id}}\ =\ grp\_id;}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_data_consumer_af99ec47d3f59ab1cb3e946f17018c5e3}{\_has\_grp}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00065\ \ \ \ \ \}}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00067\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00068\ \ \ \ \ \mbox{\hyperlink{structdoris_1_1_unique_id}{UniqueId}}\ \mbox{\hyperlink{classdoris_1_1_data_consumer_ad34ec572f24bd89a3084f17e31236ccb}{\_id}};}
\DoxyCodeLine{00069\ \ \ \ \ \mbox{\hyperlink{structdoris_1_1_unique_id}{UniqueId}}\ \mbox{\hyperlink{classdoris_1_1_data_consumer_aed16d6083252ed95d670cd3d3754bbc6}{\_grp\_id}};}
\DoxyCodeLine{00070\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1_data_consumer_af99ec47d3f59ab1cb3e946f17018c5e3}{\_has\_grp}};}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00072\ \ \ \ \ \textcolor{comment}{//\ lock\ to\ protect\ the\ following\ bools}}
\DoxyCodeLine{00073\ \ \ \ \ std::mutex\ \mbox{\hyperlink{classdoris_1_1_data_consumer_a888111eeda289ae698cf8e8b92ab9d30}{\_lock}};}
\DoxyCodeLine{00074\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1_data_consumer_a40756214f69d1c40ad70b64ae9fdc08d}{\_init}};}
\DoxyCodeLine{00075\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1_data_consumer_a543de0eba68317b586707e9e9ca035dd}{\_cancelled}};}
\DoxyCodeLine{00076\ \ \ \ \ time\_t\ \mbox{\hyperlink{classdoris_1_1_data_consumer_a58e23a7dfc599c38cd3ad8ca58641948}{\_last\_visit\_time}};}
\DoxyCodeLine{00077\ \};}
\DoxyCodeLine{00078\ }
\DoxyCodeLine{00079\ \textcolor{keyword}{class\ }PIntegerPair;}
\DoxyCodeLine{00080\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classdoris_1_1_kafka_event_cb}{KafkaEventCb}}\ :\ \textcolor{keyword}{public}\ RdKafka::EventCb\ \{}
\DoxyCodeLine{00081\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00082\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classdoris_1_1_kafka_event_cb_a3d41019cee6e86a5486b1c67ba9eb05e}{event\_cb}}(RdKafka::Event\&\ event)\ \{}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (event.type())\ \{}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ RdKafka::Event::EVENT\_ERROR:}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \ \ \ \ LOG(INFO)\ <<\ \textcolor{stringliteral}{"{}kafka\ error:\ "{}}\ <<\ RdKafka::err2str(event.err())}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{},\ event:\ "{}}\ <<\ \textcolor{keyword}{event}.str();}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ RdKafka::Event::EVENT\_STATS:}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \ \ \ \ LOG(INFO)\ <<\ \textcolor{stringliteral}{"{}kafka\ stats:\ "{}}\ <<\ \textcolor{keyword}{event}.str();}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ RdKafka::Event::EVENT\_LOG:}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ \ \ \ \ LOG(INFO)\ <<\ \textcolor{stringliteral}{"{}kafka\ log-\/"{}}\ <<\ \textcolor{keyword}{event}.severity()\ <<\ \textcolor{stringliteral}{"{}-\/"{}}\ <<\ \textcolor{keyword}{event}.fac().c\_str()}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{},\ event:\ "{}}\ <<\ \textcolor{keyword}{event}.str();}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ RdKafka::Event::EVENT\_THROTTLE:}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \ \ \ \ LOG(INFO)\ <<\ \textcolor{stringliteral}{"{}kafka\ throttled:\ "{}}\ <<\ \textcolor{keyword}{event}.throttle\_time()\ <<\ \textcolor{stringliteral}{"{}ms\ by\ "{}}}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{keyword}{event}.broker\_name()\ <<\ \textcolor{stringliteral}{"{}\ id\ "{}}\ <<\ (int)event.broker\_id();}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \ \ \ \ LOG(INFO)\ <<\ \textcolor{stringliteral}{"{}kafka\ event:\ "{}}\ <<\ \textcolor{keyword}{event}.type()}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{},\ err:\ "{}}\ <<\ RdKafka::err2str(event.err())\ <<\ \textcolor{stringliteral}{"{},\ event:\ "{}}\ <<\ \textcolor{keyword}{event}.str();}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00107\ \ \ \ \ \}}
\DoxyCodeLine{00108\ \};}
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00110\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classdoris_1_1_kafka_data_consumer}{KafkaDataConsumer}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classdoris_1_1_data_consumer}{DataConsumer}}\ \{}
\DoxyCodeLine{00111\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00112\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_kafka_data_consumer_aa832e5d4750822e2625aba10fdcd62de}{KafkaDataConsumer}}(\mbox{\hyperlink{classdoris_1_1_stream_load_context}{StreamLoadContext}}*\ ctx)}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{classdoris_1_1_data_consumer}{DataConsumer}}(ctx),}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_kafka_data_consumer_a064cf72af50aa54505a90705476ff4d0}{\_brokers}}(ctx-\/>kafka\_info-\/>brokers),}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_kafka_data_consumer_a20434f80befd341bcf9662155c88cd88}{\_topic}}(ctx-\/>kafka\_info-\/>topic)\ \{\}}
\DoxyCodeLine{00116\ }
\DoxyCodeLine{00117\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{classdoris_1_1_kafka_data_consumer_a109a08880f59e669ccb15072cb2ed7df}{\string~KafkaDataConsumer}}()\ \{}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{logging_8h_a18eaecaf99d52cb40ba1da6343fa8449}{VLOG\_NOTICE}}\ <<\ \textcolor{stringliteral}{"{}deconstruct\ consumer"{}};}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classdoris_1_1_kafka_data_consumer_ac9430e1b9cd722eaf2c595e49036a37d}{\_k\_consumer}})\ \{}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_kafka_data_consumer_ac9430e1b9cd722eaf2c595e49036a37d}{\_k\_consumer}}-\/>close();}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ \mbox{\hyperlink{classdoris_1_1_kafka_data_consumer_ac9430e1b9cd722eaf2c595e49036a37d}{\_k\_consumer}};}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_kafka_data_consumer_ac9430e1b9cd722eaf2c595e49036a37d}{\_k\_consumer}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00124\ \ \ \ \ \}}
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00126\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_kafka_data_consumer_aa3ae6d34db20e87bb64243a6af7c72bf}{init}}(\mbox{\hyperlink{classdoris_1_1_stream_load_context}{StreamLoadContext}}*\ ctx)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00127\ \ \ \ \ \textcolor{comment}{//\ TODO(cmy):\ currently\ do\ not\ implement\ single\ consumer\ start\ method,\ using\ group\_consume}}
\DoxyCodeLine{00128\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_kafka_data_consumer_a3dcbeecd4d0022b92137f20ea4d616af}{consume}}(\mbox{\hyperlink{classdoris_1_1_stream_load_context}{StreamLoadContext}}*\ ctx)\textcolor{keyword}{\ override\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdoris_1_1_status_a6ec1a217f203269ab53d2290d602db24}{Status::OK}}();\ \}}
\DoxyCodeLine{00129\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_kafka_data_consumer_ac63ffa33be506c2ac0e6b8e0b288f91b}{cancel}}(\mbox{\hyperlink{classdoris_1_1_stream_load_context}{StreamLoadContext}}*\ ctx)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00130\ \ \ \ \ \textcolor{comment}{//\ reassign\ partition\ topics}}
\DoxyCodeLine{00131\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_kafka_data_consumer_a8e53579e9a5fc66c1761a4c1446b4c7d}{reset}}()\ \textcolor{keyword}{override};}
\DoxyCodeLine{00132\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structmatch}{match}}(\mbox{\hyperlink{classdoris_1_1_stream_load_context}{StreamLoadContext}}*\ ctx)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00133\ \ \ \ \ \textcolor{comment}{//\ commit\ kafka\ offset}}
\DoxyCodeLine{00134\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_kafka_data_consumer_ac12955d549b4a0a4221ddfa8f9ed6be1}{commit}}(std::vector<RdKafka::TopicPartition*>\&\ offset);}
\DoxyCodeLine{00135\ }
\DoxyCodeLine{00136\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_kafka_data_consumer_a47a324e5c2f173c89d4f3ed8cf000398}{assign\_topic\_partitions}}(\textcolor{keyword}{const}\ std::map<int32\_t,\ int64\_t>\&\ begin\_partition\_offset,}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ topic,\ \mbox{\hyperlink{classdoris_1_1_stream_load_context}{StreamLoadContext}}*\ ctx);}
\DoxyCodeLine{00138\ }
\DoxyCodeLine{00139\ \ \ \ \ \textcolor{comment}{//\ start\ the\ consumer\ and\ put\ msgs\ to\ queue}}
\DoxyCodeLine{00140\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_kafka_data_consumer_a12488176a83e762115c0a66d98974c19}{group\_consume}}(\mbox{\hyperlink{classdoris_1_1_blocking_queue}{BlockingQueue<RdKafka::Message*>}}*\ queue,\ int64\_t\ max\_running\_time\_ms);}
\DoxyCodeLine{00141\ }
\DoxyCodeLine{00142\ \ \ \ \ \textcolor{comment}{//\ get\ the\ partitions\ ids\ of\ the\ topic}}
\DoxyCodeLine{00143\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_kafka_data_consumer_ab5e27f7c5516491010a8a27a069fb6df}{get\_partition\_meta}}(std::vector<int32\_t>*\ partition\_ids);}
\DoxyCodeLine{00144\ \ \ \ \ \textcolor{comment}{//\ get\ offsets\ for\ times}}
\DoxyCodeLine{00145\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_kafka_data_consumer_ae502e897e9544c5f0bc2e9103547049d}{get\_offsets\_for\_times}}(\textcolor{keyword}{const}\ std::vector<PIntegerPair>\&\ times,}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<PIntegerPair>*\ offsets);}
\DoxyCodeLine{00147\ \ \ \ \ \textcolor{comment}{//\ get\ latest\ offsets\ for\ partitions}}
\DoxyCodeLine{00148\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_kafka_data_consumer_ac4c5fec32726a9ea9ece749472ca3cd6}{get\_latest\_offsets\_for\_partitions}}(\textcolor{keyword}{const}\ std::vector<int32\_t>\&\ partition\_ids,}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<PIntegerPair>*\ offsets);}
\DoxyCodeLine{00150\ }
\DoxyCodeLine{00151\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00152\ \ \ \ \ std::string\ \mbox{\hyperlink{classdoris_1_1_kafka_data_consumer_a064cf72af50aa54505a90705476ff4d0}{\_brokers}};}
\DoxyCodeLine{00153\ \ \ \ \ std::string\ \mbox{\hyperlink{classdoris_1_1_kafka_data_consumer_a20434f80befd341bcf9662155c88cd88}{\_topic}};}
\DoxyCodeLine{00154\ \ \ \ \ std::unordered\_map<std::string,\ std::string>\ \mbox{\hyperlink{classdoris_1_1_kafka_data_consumer_a5e025606f5498b90b3a6bb8068ee3f22}{\_custom\_properties}};}
\DoxyCodeLine{00155\ }
\DoxyCodeLine{00156\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_kafka_event_cb}{KafkaEventCb}}\ \mbox{\hyperlink{classdoris_1_1_kafka_data_consumer_a2dbbc4f4fc8207e8684d9bc9eaf20676}{\_k\_event\_cb}};}
\DoxyCodeLine{00157\ \ \ \ \ RdKafka::KafkaConsumer*\ \mbox{\hyperlink{classdoris_1_1_kafka_data_consumer_ac9430e1b9cd722eaf2c595e49036a37d}{\_k\_consumer}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00158\ \};}
\DoxyCodeLine{00159\ }
\DoxyCodeLine{00160\ \}\ \textcolor{comment}{//\ end\ namespace\ doris}}

\end{DoxyCode}
