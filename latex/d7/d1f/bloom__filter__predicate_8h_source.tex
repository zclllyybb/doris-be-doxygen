\hypertarget{bloom__filter__predicate_8h_source}{}\doxysection{bloom\+\_\+filter\+\_\+predicate.\+h}
\label{bloom__filter__predicate_8h_source}\index{/Users/dabowang/doris/be/src/olap/bloom\_filter\_predicate.h@{/Users/dabowang/doris/be/src/olap/bloom\_filter\_predicate.h}}
\mbox{\hyperlink{bloom__filter__predicate_8h}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Licensed\ to\ the\ Apache\ Software\ Foundation\ (ASF)\ under\ one}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ or\ more\ contributor\ license\ agreements.\ \ See\ the\ NOTICE\ file}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ distributed\ with\ this\ work\ for\ additional\ information}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ regarding\ copyright\ ownership.\ \ The\ ASF\ licenses\ this\ file}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ to\ you\ under\ the\ Apache\ License,\ Version\ 2.0\ (the}}
\DoxyCodeLine{00006\ \textcolor{comment}{//\ "{}License"{});\ you\ may\ not\ use\ this\ file\ except\ in\ compliance}}
\DoxyCodeLine{00007\ \textcolor{comment}{//\ with\ the\ License.\ \ You\ may\ obtain\ a\ copy\ of\ the\ License\ at}}
\DoxyCodeLine{00008\ \textcolor{comment}{//}}
\DoxyCodeLine{00009\ \textcolor{comment}{//\ \ \ http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{00010\ \textcolor{comment}{//}}
\DoxyCodeLine{00011\ \textcolor{comment}{//\ Unless\ required\ by\ applicable\ law\ or\ agreed\ to\ in\ writing,}}
\DoxyCodeLine{00012\ \textcolor{comment}{//\ software\ distributed\ under\ the\ License\ is\ distributed\ on\ an}}
\DoxyCodeLine{00013\ \textcolor{comment}{//\ "{}AS\ IS"{}\ BASIS,\ WITHOUT\ WARRANTIES\ OR\ CONDITIONS\ OF\ ANY}}
\DoxyCodeLine{00014\ \textcolor{comment}{//\ KIND,\ either\ express\ or\ implied.\ \ See\ the\ License\ for\ the}}
\DoxyCodeLine{00015\ \textcolor{comment}{//\ specific\ language\ governing\ permissions\ and\ limitations}}
\DoxyCodeLine{00016\ \textcolor{comment}{//\ under\ the\ License.}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bloom__filter__func_8h}{exprs/bloom\_filter\_func.h}}"{}}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{runtime__filter_8h}{exprs/runtime\_filter.h}}"{}}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{column__predicate_8h}{olap/column\_predicate.h}}"{}}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{primitive__type_8h}{runtime/primitive\_type.h}}"{}}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{column__dictionary_8h}{vec/columns/column\_dictionary.h}}"{}}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{column__nullable_8h}{vec/columns/column\_nullable.h}}"{}}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{column__vector_8h}{vec/columns/column\_vector.h}}"{}}}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{predicate__column_8h}{vec/columns/predicate\_column.h}}"{}}}
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{vruntimefilter__wrapper_8h}{vec/exprs/vruntimefilter\_wrapper.h}}"{}}}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00030\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacedoris}{doris}}\ \{}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ \textcolor{comment}{//\ only\ use\ in\ runtime\ filter\ and\ segment\ v2}}
\DoxyCodeLine{00033\ \textcolor{keyword}{template}\ <PrimitiveType\ T>}
\DoxyCodeLine{00034\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classdoris_1_1_bloom_filter_column_predicate}{BloomFilterColumnPredicate}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classdoris_1_1_column_predicate}{ColumnPredicate}}\ \{}
\DoxyCodeLine{00035\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00036\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{classdoris_1_1_bloom_filter_func}{SpecificFilter}}\ =\ \mbox{\hyperlink{classdoris_1_1_bloom_filter_func}{BloomFilterFunc<T>}};}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_bloom_filter_column_predicate_a554a18ea7b4fff15b2b5d98f6a002f7a}{BloomFilterColumnPredicate}}(uint32\_t\ \mbox{\hyperlink{classdoris_1_1_column_predicate_a1dc741e0ee4ae02d671b288213c01fc3}{column\_id}},}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::shared\_ptr<BloomFilterFuncBase>\&\ filter,}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ be\_exec\_version)}
\DoxyCodeLine{00041\ \ \ \ \ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{classdoris_1_1_column_predicate}{ColumnPredicate}}(\mbox{\hyperlink{classdoris_1_1_column_predicate_a1dc741e0ee4ae02d671b288213c01fc3}{column\_id}}),}
\DoxyCodeLine{00042\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_bloom_filter_column_predicate_aea5532e066d6cc1b6a78af8d60fcc9f9}{\_filter}}(filter),}
\DoxyCodeLine{00043\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_bloom_filter_column_predicate_a04560f50b224bc72384b259dd09c90a6}{\_specific\_filter}}(static\_cast<\mbox{\hyperlink{classdoris_1_1_bloom_filter_func}{SpecificFilter}}*>(\mbox{\hyperlink{classdoris_1_1_bloom_filter_column_predicate_aea5532e066d6cc1b6a78af8d60fcc9f9}{\_filter}}.get())),}
\DoxyCodeLine{00044\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_bloom_filter_column_predicate_a8abe22f475f1e66b0afd342e41439e28}{\_be\_exec\_version}}(be\_exec\_version)\ \{\}}
\DoxyCodeLine{00045\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_bloom_filter_column_predicate_a328669f88aac7136a049870698a34d5d}{\string~BloomFilterColumnPredicate}}()\ \textcolor{keyword}{override}\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ \ \ \ \ \mbox{\hyperlink{namespacedoris_a74200fe7b3fc40cf1385f05359608667}{PredicateType}}\ \mbox{\hyperlink{classdoris_1_1_bloom_filter_column_predicate_a352c565b57bc1155b4d9b43436dec0ca}{type}}()\textcolor{keyword}{\ const\ override\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacedoris_a74200fe7b3fc40cf1385f05359608667a7b8d2f92148f52cad46e331936922e80}{PredicateType::BF}};\ \}}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00049\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_bloom_filter_column_predicate_aa588c0426328cfb98920f255248991a4}{evaluate}}(\mbox{\hyperlink{classdoris_1_1segment__v2_1_1_bitmap_index_iterator}{BitmapIndexIterator}}*\ iterators,\ uint32\_t\ num\_rows,}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ roaring::Roaring*\ roaring)\textcolor{keyword}{\ const\ override\ }\{}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classdoris_1_1_status_a6ec1a217f203269ab53d2290d602db24}{Status::OK}}();}
\DoxyCodeLine{00052\ \ \ \ \ \}}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00054\ \ \ \ \ uint16\_t\ \mbox{\hyperlink{classdoris_1_1_bloom_filter_column_predicate_aa588c0426328cfb98920f255248991a4}{evaluate}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_i_column}{vectorized::IColumn}}\&\ column,\ uint16\_t*\ sel,}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint16\_t\ size)\ \textcolor{keyword}{const\ override};}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00057\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keywordtype}{bool}\ is\_nullable>}
\DoxyCodeLine{00059\ \ \ \ \ uint16\_t\ \mbox{\hyperlink{classdoris_1_1_bloom_filter_column_predicate_af484c97f4f78807e9bbfb814fd734a4c}{evaluate}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_i_column}{vectorized::IColumn}}\&\ column,\ \textcolor{keyword}{const}\ uint8\_t*\ null\_map,\ uint16\_t*\ sel,}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint16\_t\ size)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (is\_nullable)\ \{}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \ \ \ \ DCHECK(null\_map);}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ uint16\_t\ new\_size\ =\ 0;}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (column.\mbox{\hyperlink{classdoris_1_1vectorized_1_1_i_column_a38df4218ad9893243f04885c99b8da73}{is\_column\_dictionary}}())\ \{}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}*\ dict\_col\ =\ \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\mbox{\hyperlink{classdoris_1_1vectorized_1_1_column_dictionary}{vectorized::ColumnDictI32}}*\textcolor{keyword}{>}(\&column);}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (uint16\_t\ i\ =\ 0;\ i\ <\ size;\ i++)\ \{}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint16\_t\ \mbox{\hyperlink{rowset__tree_8cpp_ae40354a1051342eb5a9db005715dcfa9}{idx}}\ =\ sel[i];}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sel[new\_size]\ =\ \mbox{\hyperlink{rowset__tree_8cpp_ae40354a1051342eb5a9db005715dcfa9}{idx}};}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (is\_nullable)\ \{}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ new\_size\ +=\ !null\_map[\mbox{\hyperlink{rowset__tree_8cpp_ae40354a1051342eb5a9db005715dcfa9}{idx}}]\ \&\&}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_bloom_filter_column_predicate_a04560f50b224bc72384b259dd09c90a6}{\_specific\_filter}}-\/>\mbox{\hyperlink{classdoris_1_1_bloom_filter_func_a0e819d6f52b66ffb1274f0bab7c6544a}{find\_uint32\_t}}(dict\_col-\/>get\_hash\_value(\mbox{\hyperlink{rowset__tree_8cpp_ae40354a1051342eb5a9db005715dcfa9}{idx}}));}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ new\_size\ +=\ \mbox{\hyperlink{classdoris_1_1_bloom_filter_column_predicate_a04560f50b224bc72384b259dd09c90a6}{\_specific\_filter}}-\/>\mbox{\hyperlink{classdoris_1_1_bloom_filter_func_a0e819d6f52b66ffb1274f0bab7c6544a}{find\_uint32\_t}}(dict\_col-\/>get\_hash\_value(\mbox{\hyperlink{rowset__tree_8cpp_ae40354a1051342eb5a9db005715dcfa9}{idx}}));}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classdoris_1_1_i_runtime_filter_a3ff8b558df59486722a933be4364d0b1}{IRuntimeFilter::enable\_use\_batch}}(\mbox{\hyperlink{classdoris_1_1_bloom_filter_column_predicate_a8abe22f475f1e66b0afd342e41439e28}{\_be\_exec\_version}},\ \mbox{\hyperlink{exp_8c_a0acb682b8260ab1c60b918599864e2e5}{T}}))\ \{}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ \mbox{\hyperlink{uint24_8h_aa99be7b8b4274b2256b394ea7bf80762}{data}}\ =}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{reinterpret\_cast<}}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const\ }\mbox{\hyperlink{classdoris_1_1vectorized_1_1_predicate_column_type}{vectorized::PredicateColumnType<PredicateEvaluateType<T>}}\textcolor{keyword}{>}*>(}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&column)}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/>\mbox{\hyperlink{uint24_8h_a2548205c24a5abb8e9a504a1f8cf5862}{get\_data}}();}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \ \ \ \ new\_size\ =\ \mbox{\hyperlink{classdoris_1_1_bloom_filter_column_predicate_a04560f50b224bc72384b259dd09c90a6}{\_specific\_filter}}-\/>\mbox{\hyperlink{classdoris_1_1_bloom_filter_func_a0862344f13a92398f64915d794d9acea}{find\_fixed\_len\_olap\_engine}}((\textcolor{keywordtype}{char}*)\mbox{\hyperlink{uint24_8h_aa99be7b8b4274b2256b394ea7bf80762}{data}}.data(),\ null\_map,}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sel,\ size,\ \mbox{\hyperlink{uint24_8h_aa99be7b8b4274b2256b394ea7bf80762}{data}}.size()\ !=\ size);}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structdoris_1_1uint24__t}{uint24\_t}}\ tmp\_uint24\_value;}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ get\_cell\_value\ =\ [\&tmp\_uint24\_value](\textcolor{keyword}{auto}\&\ \mbox{\hyperlink{uint24_8h_aa99be7b8b4274b2256b394ea7bf80762}{data}})\ \{}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (std::is\_same\_v<std::decay\_t<\textcolor{keyword}{decltype}(\mbox{\hyperlink{uint24_8h_aa99be7b8b4274b2256b394ea7bf80762}{data}})>,\ uint32\_t>\ \&\&}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{exp_8c_a0acb682b8260ab1c60b918599864e2e5}{T}}\ ==\ \mbox{\hyperlink{namespacedoris_a240c1924416689e5700ff0d9f30539d9abee4b8bf9a35792598bc9f3e286341e9}{PrimitiveType::TYPE\_DATE}})\ \{}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{memcpy__aarch64_8cpp_a156c5821f16ed93be8c7d315303f7b2a}{memcpy}}((\textcolor{keywordtype}{char}*)(\&tmp\_uint24\_value),\ (\textcolor{keywordtype}{char}*)(\&\mbox{\hyperlink{uint24_8h_aa99be7b8b4274b2256b394ea7bf80762}{data}}),\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structdoris_1_1uint24__t}{uint24\_t}}));}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*)\&tmp\_uint24\_value;}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*)\&\mbox{\hyperlink{uint24_8h_aa99be7b8b4274b2256b394ea7bf80762}{data}};}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\&\ pred\_col\ =}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{reinterpret\_cast<}}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const\ }\mbox{\hyperlink{classdoris_1_1vectorized_1_1_predicate_column_type}{vectorized::PredicateColumnType<PredicateEvaluateType<T>}}\textcolor{keyword}{>}*>(}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&column)}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/>\mbox{\hyperlink{uint24_8h_a2548205c24a5abb8e9a504a1f8cf5862}{get\_data}}();}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ pred\_col\_data\ =\ pred\_col.data();}
\DoxyCodeLine{00105\ \textcolor{preprocessor}{\#define\ EVALUATE\_WITH\_NULL\_IMPL(IDX)\ \(\backslash\)}}
\DoxyCodeLine{00106\ \textcolor{preprocessor}{\ \ \ \ !null\_map[IDX]\ \&\&\ \_specific\_filter-\/>find\_olap\_engine(get\_cell\_value(pred\_col\_data[IDX]))}}
\DoxyCodeLine{00107\ \textcolor{preprocessor}{\#define\ EVALUATE\_WITHOUT\_NULL\_IMPL(IDX)\ \(\backslash\)}}
\DoxyCodeLine{00108\ \textcolor{preprocessor}{\ \ \ \ \_specific\_filter-\/>find\_olap\_engine(get\_cell\_value(pred\_col\_data[IDX]))}}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{column__predicate_8h_a03d869b0a7cb5b03c7393309aa9a1cb9}{EVALUATE\_BY\_SELECTOR}}(\mbox{\hyperlink{bloom__filter__predicate_8h_a2cf28f7750cf255ac868e614c381bbce}{EVALUATE\_WITH\_NULL\_IMPL}},\ \mbox{\hyperlink{bloom__filter__predicate_8h_ad8737275595d4267585ad8f642d25b3e}{EVALUATE\_WITHOUT\_NULL\_IMPL}})}
\DoxyCodeLine{00110\ \textcolor{preprocessor}{\#undef\ EVALUATE\_WITH\_NULL\_IMPL}}
\DoxyCodeLine{00111\ \textcolor{preprocessor}{\#undef\ EVALUATE\_WITHOUT\_NULL\_IMPL}}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ new\_size;}
\DoxyCodeLine{00114\ \ \ \ \ \}}
\DoxyCodeLine{00115\ }
\DoxyCodeLine{00116\ \ \ \ \ std::string\ \mbox{\hyperlink{classdoris_1_1_bloom_filter_column_predicate_ab675b0be49cab2cb7b4b431ec91ef000}{\_debug\_string}}()\textcolor{keyword}{\ const\ override\ }\{}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ std::string\ info\ =\ \textcolor{stringliteral}{"{}BloomFilterColumnPredicate("{}}\ +\ \mbox{\hyperlink{namespacedoris_a66421d0e4ffabe98bf2e77cdaeabdee0}{type\_to\_string}}(\mbox{\hyperlink{exp_8c_a0acb682b8260ab1c60b918599864e2e5}{T}})\ +\ \textcolor{stringliteral}{"{})"{}};}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ info;}
\DoxyCodeLine{00119\ \ \ \ \ \}}
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00121\ \ \ \ \ std::shared\_ptr<BloomFilterFuncBase>\ \mbox{\hyperlink{classdoris_1_1_bloom_filter_column_predicate_aea5532e066d6cc1b6a78af8d60fcc9f9}{\_filter}};}
\DoxyCodeLine{00122\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_bloom_filter_func}{SpecificFilter}}*\ \mbox{\hyperlink{classdoris_1_1_bloom_filter_column_predicate_a04560f50b224bc72384b259dd09c90a6}{\_specific\_filter}};\ \textcolor{comment}{//\ owned\ by\ \_filter}}
\DoxyCodeLine{00123\ \ \ \ \ \textcolor{keyword}{mutable}\ uint64\_t\ \mbox{\hyperlink{classdoris_1_1_bloom_filter_column_predicate_a17154f4d01c330fb3db3ef162e1dfebb}{\_evaluated\_rows}}\ =\ 1;}
\DoxyCodeLine{00124\ \ \ \ \ \textcolor{keyword}{mutable}\ uint64\_t\ \mbox{\hyperlink{classdoris_1_1_bloom_filter_column_predicate_a482995031187894b8d807865450e13f7}{\_passed\_rows}}\ =\ 0;}
\DoxyCodeLine{00125\ \ \ \ \ \textcolor{keyword}{mutable}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1_bloom_filter_column_predicate_aadb7ae410cf7c405577f01ef85149c4b}{\_always\_true}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00126\ \ \ \ \ \textcolor{keyword}{mutable}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1_bloom_filter_column_predicate_a2679fff0e76f9a41cdb04fb90f16e732}{\_has\_calculate\_filter}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00127\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classdoris_1_1_bloom_filter_column_predicate_a8abe22f475f1e66b0afd342e41439e28}{\_be\_exec\_version}};}
\DoxyCodeLine{00128\ \};}
\DoxyCodeLine{00129\ }
\DoxyCodeLine{00130\ \textcolor{keyword}{template}\ <PrimitiveType\ T>}
\DoxyCodeLine{00131\ uint16\_t\ \mbox{\hyperlink{classdoris_1_1_bloom_filter_column_predicate_aa588c0426328cfb98920f255248991a4}{BloomFilterColumnPredicate<T>::evaluate}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_i_column}{vectorized::IColumn}}\&\ column,\ uint16\_t*\ sel,}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint16\_t\ size)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00133\ \ \ \ \ uint16\_t\ new\_size\ =\ 0;}
\DoxyCodeLine{00134\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_always\_true)\ \{}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ size;}
\DoxyCodeLine{00136\ \ \ \ \ \}}
\DoxyCodeLine{00137\ \ \ \ \ \textcolor{keywordflow}{if}\ (column.\mbox{\hyperlink{classdoris_1_1vectorized_1_1_i_column_adf7bb7bb5661fd4437db8a5c333444b2}{is\_nullable}}())\ \{}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}*\ nullable\_col\ =\ \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const\ }\mbox{\hyperlink{classdoris_1_1vectorized_1_1_column_nullable}{vectorized::ColumnNullable}}*\textcolor{keyword}{>}(\&column);}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\&\ null\_map\_data\ =\ nullable\_col-\/>\mbox{\hyperlink{classdoris_1_1vectorized_1_1_column_nullable_ae0e77dedb4ba70d2b17b3eecf148ffe2}{get\_null\_map\_column}}().\mbox{\hyperlink{classdoris_1_1vectorized_1_1_column_vector_a3206c08675c03058605f3a6e5a452b5c}{get\_data}}();}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ new\_size\ =}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ evaluate<true>(nullable\_col-\/>get\_nested\_column(),\ null\_map\_data.data(),\ sel,\ size);}
\DoxyCodeLine{00142\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ new\_size\ =\ evaluate<false>(column,\ \textcolor{keyword}{nullptr},\ sel,\ size);}
\DoxyCodeLine{00144\ \ \ \ \ \}}
\DoxyCodeLine{00145\ \ \ \ \ \textcolor{comment}{//\ If\ the\ pass\ rate\ is\ very\ high,\ for\ example\ >\ 50\%,\ then\ the\ bloomfilter\ is\ useless.}}
\DoxyCodeLine{00146\ \ \ \ \ \textcolor{comment}{//\ Some\ bloomfilter\ is\ useless,\ for\ example\ ssb\ 4.3,\ it\ consumes\ a\ lot\ of\ cpu\ but\ it\ is}}
\DoxyCodeLine{00147\ \ \ \ \ \textcolor{comment}{//\ useless.}}
\DoxyCodeLine{00148\ \ \ \ \ \_evaluated\_rows\ +=\ size;}
\DoxyCodeLine{00149\ \ \ \ \ \_passed\_rows\ +=\ new\_size;}
\DoxyCodeLine{00150\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1vectorized_1_1_v_runtime_filter_wrapper_a3d3ada90192309c47a552fb1c5c8203a}{vectorized::VRuntimeFilterWrapper::calculate\_filter}}(}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \ \ \ \ \_evaluated\_rows\ -\/\ \_passed\_rows,\ \_evaluated\_rows,\ \_has\_calculate\_filter,\ \_always\_true);}
\DoxyCodeLine{00152\ \ \ \ \ \textcolor{keywordflow}{return}\ new\_size;}
\DoxyCodeLine{00153\ \}}
\DoxyCodeLine{00154\ }
\DoxyCodeLine{00155\ \}\ \textcolor{comment}{//namespace\ doris}}

\end{DoxyCode}
