\hypertarget{block__file__cache__profile_8h_source}{}\doxysection{block\+\_\+file\+\_\+cache\+\_\+profile.\+h}
\label{block__file__cache__profile_8h_source}\index{/Users/dabowang/be\_all/io/cache/block/block\_file\_cache\_profile.h@{/Users/dabowang/be\_all/io/cache/block/block\_file\_cache\_profile.h}}
\mbox{\hyperlink{block__file__cache__profile_8h}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Licensed\ to\ the\ Apache\ Software\ Foundation\ (ASF)\ under\ one}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ or\ more\ contributor\ license\ agreements.\ \ See\ the\ NOTICE\ file}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ distributed\ with\ this\ work\ for\ additional\ information}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ regarding\ copyright\ ownership.\ \ The\ ASF\ licenses\ this\ file}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ to\ you\ under\ the\ Apache\ License,\ Version\ 2.0\ (the}}
\DoxyCodeLine{00006\ \textcolor{comment}{//\ "{}License"{});\ you\ may\ not\ use\ this\ file\ except\ in\ compliance}}
\DoxyCodeLine{00007\ \textcolor{comment}{//\ with\ the\ License.\ \ You\ may\ obtain\ a\ copy\ of\ the\ License\ at}}
\DoxyCodeLine{00008\ \textcolor{comment}{//}}
\DoxyCodeLine{00009\ \textcolor{comment}{//\ \ \ http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{00010\ \textcolor{comment}{//}}
\DoxyCodeLine{00011\ \textcolor{comment}{//\ Unless\ required\ by\ applicable\ law\ or\ agreed\ to\ in\ writing,}}
\DoxyCodeLine{00012\ \textcolor{comment}{//\ software\ distributed\ under\ the\ License\ is\ distributed\ on\ an}}
\DoxyCodeLine{00013\ \textcolor{comment}{//\ "{}AS\ IS"{}\ BASIS,\ WITHOUT\ WARRANTIES\ OR\ CONDITIONS\ OF\ ANY}}
\DoxyCodeLine{00014\ \textcolor{comment}{//\ KIND,\ either\ express\ or\ implied.\ \ See\ the\ License\ for\ the}}
\DoxyCodeLine{00015\ \textcolor{comment}{//\ specific\ language\ governing\ permissions\ and\ limitations}}
\DoxyCodeLine{00016\ \textcolor{comment}{//\ under\ the\ License.}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ <atomic>}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ <cstdint>}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ <cstdlib>}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ <functional>}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ <memory>}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ <mutex>}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#include\ <string>}}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#include\ <unordered\_map>}}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{olap_2olap__common_8h}{olap/olap\_common.h}}"{}}}
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{doris__metrics_8h}{util/doris\_metrics.h}}"{}}}
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{metrics_8h}{util/metrics.h}}"{}}}
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{runtime__profile_8h}{util/runtime\_profile.h}}"{}}}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00034\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacedoris}{doris}}\ \{}
\DoxyCodeLine{00035\ \textcolor{keyword}{namespace\ }io\ \{}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structdoris_1_1io_1_1_atomic_statistics}{AtomicStatistics}}\ \{}
\DoxyCodeLine{00038\ \ \ \ \ std::atomic<int64\_t>\ \mbox{\hyperlink{structdoris_1_1io_1_1_atomic_statistics_a158cb767e295ca91f286356997755d46}{num\_io\_total}}\ =\ 0;}
\DoxyCodeLine{00039\ \ \ \ \ std::atomic<int64\_t>\ \mbox{\hyperlink{structdoris_1_1io_1_1_atomic_statistics_aaa32847fb5973efd466591e677dd03b6}{num\_io\_hit\_cache}}\ =\ 0;}
\DoxyCodeLine{00040\ \ \ \ \ std::atomic<int64\_t>\ \mbox{\hyperlink{structdoris_1_1io_1_1_atomic_statistics_a2a6315b43b913311703b6bb895bd2f56}{num\_io\_bytes\_read\_total}}\ =\ 0;}
\DoxyCodeLine{00041\ \ \ \ \ std::atomic<int64\_t>\ \mbox{\hyperlink{structdoris_1_1io_1_1_atomic_statistics_a45decb9b96ab6a6c8117d93a20a259c3}{num\_io\_bytes\_read\_from\_file\_cache}}\ =\ 0;}
\DoxyCodeLine{00042\ \ \ \ \ std::atomic<int64\_t>\ \mbox{\hyperlink{structdoris_1_1io_1_1_atomic_statistics_a03b9280abb6b491d5e7dae3b2fb76165}{num\_io\_bytes\_read\_from\_write\_cache}}\ =\ 0;}
\DoxyCodeLine{00043\ \ \ \ \ std::atomic<int64\_t>\ \mbox{\hyperlink{structdoris_1_1io_1_1_atomic_statistics_aecfdd82f959c2831f90a38739267bba8}{num\_io\_written\_in\_file\_cache}}\ =\ 0;}
\DoxyCodeLine{00044\ \ \ \ \ std::atomic<int64\_t>\ \mbox{\hyperlink{structdoris_1_1io_1_1_atomic_statistics_aa26e985c8049eae7e8a6317af49d7826}{num\_io\_bytes\_written\_in\_file\_cache}}\ =\ 0;}
\DoxyCodeLine{00045\ \};}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile}{FileCacheProfile}};}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00049\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_metric}{FileCacheMetric}}\ \{}
\DoxyCodeLine{00050\ \ \ \ \ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_metric_af6125fb7ddc539a0d94582e60bd31057}{FileCacheMetric}}(int64\_t\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_metric_ac83498c1cf0b272365fe0703883cd735}{table\_id}},\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile}{FileCacheProfile}}*\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_metric_a36202eb411d7988a21cb5a2e48fcbc90}{profile}})}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_metric_a36202eb411d7988a21cb5a2e48fcbc90}{profile}}(\mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_metric_a36202eb411d7988a21cb5a2e48fcbc90}{profile}}),\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_metric_ac83498c1cf0b272365fe0703883cd735}{table\_id}}(\mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_metric_ac83498c1cf0b272365fe0703883cd735}{table\_id}})\ \{\}}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00053\ \ \ \ \ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_metric_a0a20fac5feeb5669aeeb25e7d104dbb3}{FileCacheMetric}}(int64\_t\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_metric_ac83498c1cf0b272365fe0703883cd735}{table\_id}},\ int64\_t\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_metric_a3c43652ca8ec1d18bff18ad314afe000}{partition\_id}},\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile}{FileCacheProfile}}*\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_metric_a36202eb411d7988a21cb5a2e48fcbc90}{profile}})}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_metric_a36202eb411d7988a21cb5a2e48fcbc90}{profile}}(\mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_metric_a36202eb411d7988a21cb5a2e48fcbc90}{profile}}),\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_metric_ac83498c1cf0b272365fe0703883cd735}{table\_id}}(\mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_metric_ac83498c1cf0b272365fe0703883cd735}{table\_id}}),\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_metric_a3c43652ca8ec1d18bff18ad314afe000}{partition\_id}}(\mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_metric_a3c43652ca8ec1d18bff18ad314afe000}{partition\_id}})\ \{\}}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00056\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_metric_a1c1a66ad2fb83b446a0ca0f77e7619f9}{register\_entity}}();}
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_metric_a57c04255ec0d261ab251b4e5874b6c43}{deregister\_entity}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_doris_metrics_a4d0ce88513091aec833045b4eddeee8b}{DorisMetrics::instance}}()-\/>\mbox{\hyperlink{classdoris_1_1_doris_metrics_ac35419b87a3fe0126cb635fb8fe889ae}{metric\_registry}}()-\/>\mbox{\hyperlink{classdoris_1_1_metric_registry_aea814151e21597b5a31316959adb11d7}{deregister\_entity}}(\mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_metric_ac22a878ebf1568dcd8a3f9d356f76e17}{entity}});}
\DoxyCodeLine{00059\ \ \ \ \ \}}
\DoxyCodeLine{00060\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_metric_a683137e77683974d307639a58033118a}{update\_table\_metrics}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00061\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_metric_af7cea6f09c5e209d775104b6dc7bb22c}{update\_partition\_metrics}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00063\ \ \ \ \ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_metric}{FileCacheMetric}}\&\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_metric_af499b6f216088141c729c8afbf77113c}{operator=}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_metric}{FileCacheMetric}}\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{00064\ \ \ \ \ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_metric_a9d070bf8f9f51c0d6c5c74b535c621e6}{FileCacheMetric}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_metric}{FileCacheMetric}}\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{00065\ \ \ \ \ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile}{FileCacheProfile}}*\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_metric_a36202eb411d7988a21cb5a2e48fcbc90}{profile}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00066\ \ \ \ \ int64\_t\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_metric_ac83498c1cf0b272365fe0703883cd735}{table\_id}}\ =\ -\/1;}
\DoxyCodeLine{00067\ \ \ \ \ int64\_t\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_metric_a3c43652ca8ec1d18bff18ad314afe000}{partition\_id}}\ =\ -\/1;}
\DoxyCodeLine{00068\ \ \ \ \ std::shared\_ptr<MetricEntity>\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_metric_ac22a878ebf1568dcd8a3f9d356f76e17}{entity}};}
\DoxyCodeLine{00069\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_atomic_counter}{IntAtomicCounter}}*\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_metric_a05c9ae4613672f1802251d4916c3c406}{file\_cache\_num\_io\_total}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00070\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_atomic_counter}{IntAtomicCounter}}*\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_metric_a5983533d919545d883fb75a65ab6c448}{file\_cache\_num\_io\_hit\_cache}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00071\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_atomic_counter}{IntAtomicCounter}}*\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_metric_ac0db1d3e5e68b147cc3944b134732d44}{file\_cache\_num\_io\_bytes\_read\_total}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00072\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_atomic_counter}{IntAtomicCounter}}*\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_metric_aa155ad299fb62c8eab07ff04b4112259}{file\_cache\_num\_io\_bytes\_read\_from\_file\_cache}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00073\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_atomic_counter}{IntAtomicCounter}}*\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_metric_a682b616c85cb2726289b2c20d7a04624}{file\_cache\_num\_io\_bytes\_read\_from\_write\_cache}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00074\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_atomic_counter}{IntAtomicCounter}}*\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_metric_a08cc0a9b7e01b254ded1e47737489eb8}{file\_cache\_num\_io\_written\_in\_file\_cache}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00075\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_atomic_counter}{IntAtomicCounter}}*\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_metric_a9a0be5b9f2ea05f053d8f7c68f59f3f3}{file\_cache\_num\_io\_bytes\_written\_in\_file\_cache}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00076\ \};}
\DoxyCodeLine{00077\ }
\DoxyCodeLine{00078\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile}{FileCacheProfile}}\ \{}
\DoxyCodeLine{00079\ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile}{FileCacheProfile}}\&\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_a16755d4be72b3d6af470c9d7b5a57ce0}{instance}}()\ \{}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile}{FileCacheProfile}}\ s\_profile;}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ s\_profile;}
\DoxyCodeLine{00082\ \ \ \ \ \}}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00084\ \ \ \ \ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_aaf12ca6e08fcf46c4fac3e63917b0fbd}{FileCacheProfile}}()\ \{}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structdoris_1_1_olap_reader_statistics}{OlapReaderStatistics}}\ stats;}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_a37c5bbea44f58706c62f280a7817b4c3}{update}}(0,\ 0,\ \&stats);}
\DoxyCodeLine{00087\ \ \ \ \ \}}
\DoxyCodeLine{00088\ }
\DoxyCodeLine{00089\ \ \ \ \ \textcolor{comment}{//\ avoid\ performance\ impact,\ use\ https\ to\ control}}
\DoxyCodeLine{00090\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keyword}{static}\ std::atomic<bool>\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_a1b602fbd903cfaf029aa8b93f8b57741}{s\_enable\_profile}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00092\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_a5f78fb10eb829cca7405b6ca95db06ac}{set\_enable\_profile}}(\textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacedoris_aa22c8aa4a1f9eb102cc140540239702e}{flag}})\ \{}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ if\ enable\_profile\ =\ false\ originally,\ set\ true,\ it\ will\ clear\ the\ count}}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_a1b602fbd903cfaf029aa8b93f8b57741}{s\_enable\_profile}}\ \&\&\ \mbox{\hyperlink{namespacedoris_aa22c8aa4a1f9eb102cc140540239702e}{flag}})\ \{}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ \ \ \ \ std::lock\_guard\ lock(\mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_a16755d4be72b3d6af470c9d7b5a57ce0}{instance}}().\mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_a8bd24c60307804494c1d8e35976758f6}{\_mtx}});}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_a16755d4be72b3d6af470c9d7b5a57ce0}{instance}}().\mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_adcf490b63216b74929a60575358709c8}{\_profile}}.clear();}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_a1b602fbd903cfaf029aa8b93f8b57741}{s\_enable\_profile}}.store(\mbox{\hyperlink{namespacedoris_aa22c8aa4a1f9eb102cc140540239702e}{flag}},\ std::memory\_order\_release);}
\DoxyCodeLine{00099\ \ \ \ \ \}}
\DoxyCodeLine{00100\ }
\DoxyCodeLine{00101\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_a37c5bbea44f58706c62f280a7817b4c3}{update}}(int64\_t\ table\_id,\ int64\_t\ partition\_id,\ \mbox{\hyperlink{structdoris_1_1_olap_reader_statistics}{OlapReaderStatistics}}*\ stats);}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00103\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_aa933f13d46c4d4008905bdd5582f1af1}{deregister\_metric}}(int64\_t\ table\_id,\ int64\_t\ partition\_id);}
\DoxyCodeLine{00104\ \ \ \ \ std::mutex\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_a8bd24c60307804494c1d8e35976758f6}{\_mtx}};}
\DoxyCodeLine{00105\ \ \ \ \ \textcolor{comment}{//\ use\ shared\_ptr\ for\ concurrent}}
\DoxyCodeLine{00106\ \ \ \ \ std::unordered\_map<int64\_t,\ std::unordered\_map<int64\_t,\ std::shared\_ptr<AtomicStatistics>>>}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_adcf490b63216b74929a60575358709c8}{\_profile}};}
\DoxyCodeLine{00108\ \ \ \ \ std::unordered\_map<int64\_t,\ std::shared\_ptr<FileCacheMetric>>\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_a28475ec8dd994fbf87c9f2208b4adb21}{\_table\_metrics}};}
\DoxyCodeLine{00109\ \ \ \ \ std::unordered\_map<int64\_t,\ std::unordered\_map<int64\_t,\ std::shared\_ptr<FileCacheMetric>>>}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_a90f4efe48846dc1052b0f3bf1e7abf91}{\_partition\_metrics}};}
\DoxyCodeLine{00111\ \ \ \ \ \mbox{\hyperlink{structdoris_1_1_file_cache_statistics}{FileCacheStatistics}}\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_a9e70f7acac2e425e5e712381ec6ace33}{report}}(int64\_t\ table\_id);}
\DoxyCodeLine{00112\ \ \ \ \ \mbox{\hyperlink{structdoris_1_1_file_cache_statistics}{FileCacheStatistics}}\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_a9e70f7acac2e425e5e712381ec6ace33}{report}}(int64\_t\ table\_id,\ int64\_t\ partition\_id);}
\DoxyCodeLine{00113\ \};}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00115\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_reporter}{FileCacheProfileReporter}}\ \{}
\DoxyCodeLine{00116\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_runtime_profile_1_1_counter}{RuntimeProfile::Counter}}*\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_reporter_ab2aaf20bf7af14ed0fb4553f742ca5dc}{num\_io\_total}};}
\DoxyCodeLine{00117\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_runtime_profile_1_1_counter}{RuntimeProfile::Counter}}*\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_reporter_ab8d175ed5b8823d9ad44ff92317286b0}{num\_io\_hit\_cache}};}
\DoxyCodeLine{00118\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_runtime_profile_1_1_counter}{RuntimeProfile::Counter}}*\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_reporter_a743fe8fe27acd02f0bf52a06067ac5a6}{num\_io\_bytes\_read\_total}};}
\DoxyCodeLine{00119\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_runtime_profile_1_1_counter}{RuntimeProfile::Counter}}*\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_reporter_a0bcf12ea4e7d6ec905d32314a471751b}{num\_io\_bytes\_read\_from\_file\_cache}};}
\DoxyCodeLine{00120\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_runtime_profile_1_1_counter}{RuntimeProfile::Counter}}*\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_reporter_a64bf8e909f00fdf8450b4eecfb203518}{num\_io\_bytes\_read\_from\_write\_cache}};}
\DoxyCodeLine{00121\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_runtime_profile_1_1_counter}{RuntimeProfile::Counter}}*\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_reporter_aeae32c2ad8f20e77373031d2fb8d0f9c}{num\_io\_written\_in\_file\_cache}};}
\DoxyCodeLine{00122\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_runtime_profile_1_1_counter}{RuntimeProfile::Counter}}*\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_reporter_a7118cedb5c0b296f3a932957ee299d7e}{num\_io\_bytes\_written\_in\_file\_cache}};}
\DoxyCodeLine{00123\ \ \ \ \ \mbox{\hyperlink{classdoris_1_1_runtime_profile_1_1_counter}{RuntimeProfile::Counter}}*\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_reporter_ab8724e8c45d18159d1d37bac6041220d}{num\_io\_bytes\_skip\_cache}};}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00125\ \ \ \ \ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_reporter_aa63ca50f0c45a6749476b0a7b2591f36}{FileCacheProfileReporter}}(\mbox{\hyperlink{classdoris_1_1_runtime_profile}{RuntimeProfile}}*\ profile)\ \{}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ cache\_profile\ =\ \textcolor{stringliteral}{"{}FileCache"{}};}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{runtime__profile_8h_a8841ca205b2a05d608e82d443bad3a77}{ADD\_TIMER}}(profile,\ cache\_profile);}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_reporter_ab2aaf20bf7af14ed0fb4553f742ca5dc}{num\_io\_total}}\ =\ \mbox{\hyperlink{runtime__profile_8h_a1493ed307aec5af9d605b0fd5d23051d}{ADD\_CHILD\_COUNTER}}(profile,\ \textcolor{stringliteral}{"{}IOTotalNum"{}},\ TUnit::UNIT,\ cache\_profile);}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_reporter_ab8d175ed5b8823d9ad44ff92317286b0}{num\_io\_hit\_cache}}\ =\ \mbox{\hyperlink{runtime__profile_8h_a1493ed307aec5af9d605b0fd5d23051d}{ADD\_CHILD\_COUNTER}}(profile,\ \textcolor{stringliteral}{"{}IOHitCacheNum"{}},\ TUnit::UNIT,\ cache\_profile);}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_reporter_a743fe8fe27acd02f0bf52a06067ac5a6}{num\_io\_bytes\_read\_total}}\ =}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{runtime__profile_8h_a1493ed307aec5af9d605b0fd5d23051d}{ADD\_CHILD\_COUNTER}}(profile,\ \textcolor{stringliteral}{"{}ReadTotalBytes"{}},\ TUnit::BYTES,\ cache\_profile);}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_reporter_a0bcf12ea4e7d6ec905d32314a471751b}{num\_io\_bytes\_read\_from\_file\_cache}}\ =}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{runtime__profile_8h_a1493ed307aec5af9d605b0fd5d23051d}{ADD\_CHILD\_COUNTER}}(profile,\ \textcolor{stringliteral}{"{}ReadFromFileCacheBytes"{}},\ TUnit::BYTES,\ cache\_profile);}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_reporter_a64bf8e909f00fdf8450b4eecfb203518}{num\_io\_bytes\_read\_from\_write\_cache}}\ =}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{runtime__profile_8h_a1493ed307aec5af9d605b0fd5d23051d}{ADD\_CHILD\_COUNTER}}(profile,\ \textcolor{stringliteral}{"{}ReadFromWriteCacheBytes"{}},\ TUnit::BYTES,\ cache\_profile);}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_reporter_aeae32c2ad8f20e77373031d2fb8d0f9c}{num\_io\_written\_in\_file\_cache}}\ =}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{runtime__profile_8h_a1493ed307aec5af9d605b0fd5d23051d}{ADD\_CHILD\_COUNTER}}(profile,\ \textcolor{stringliteral}{"{}WriteInFileCacheNum"{}},\ TUnit::UNIT,\ cache\_profile);}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_reporter_a7118cedb5c0b296f3a932957ee299d7e}{num\_io\_bytes\_written\_in\_file\_cache}}\ =}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{runtime__profile_8h_a1493ed307aec5af9d605b0fd5d23051d}{ADD\_CHILD\_COUNTER}}(profile,\ \textcolor{stringliteral}{"{}WriteInFileCacheBytes"{}},\ TUnit::BYTES,\ cache\_profile);}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_reporter_ab8724e8c45d18159d1d37bac6041220d}{num\_io\_bytes\_skip\_cache}}\ =}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{runtime__profile_8h_a1493ed307aec5af9d605b0fd5d23051d}{ADD\_CHILD\_COUNTER}}(profile,\ \textcolor{stringliteral}{"{}SkipCacheBytes"{}},\ TUnit::BYTES,\ cache\_profile);}
\DoxyCodeLine{00142\ \ \ \ \ \}}
\DoxyCodeLine{00143\ }
\DoxyCodeLine{00144\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_reporter_aab3b6f53e6e4779e096b71dd38128af0}{update}}(\mbox{\hyperlink{structdoris_1_1_file_cache_statistics}{FileCacheStatistics}}*\ statistics)\ \{}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{runtime__profile_8h_a3c0413085db33b5cfe29ea149ed3cf0c}{COUNTER\_UPDATE}}(\mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_reporter_ab2aaf20bf7af14ed0fb4553f742ca5dc}{num\_io\_total}},\ statistics-\/>\mbox{\hyperlink{structdoris_1_1_file_cache_statistics_a240709aa79ba3c8ffce3a1c813db16c1}{num\_io\_total}});}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{runtime__profile_8h_a3c0413085db33b5cfe29ea149ed3cf0c}{COUNTER\_UPDATE}}(\mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_reporter_ab8d175ed5b8823d9ad44ff92317286b0}{num\_io\_hit\_cache}},\ statistics-\/>\mbox{\hyperlink{structdoris_1_1_file_cache_statistics_a9886b468a9daf26b1721c1e12352eb0d}{num\_io\_hit\_cache}});}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{runtime__profile_8h_a3c0413085db33b5cfe29ea149ed3cf0c}{COUNTER\_UPDATE}}(\mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_reporter_a743fe8fe27acd02f0bf52a06067ac5a6}{num\_io\_bytes\_read\_total}},\ statistics-\/>\mbox{\hyperlink{structdoris_1_1_file_cache_statistics_a78c85a6d84f98478bba6091c44c1acd0}{num\_io\_bytes\_read\_total}});}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{runtime__profile_8h_a3c0413085db33b5cfe29ea149ed3cf0c}{COUNTER\_UPDATE}}(\mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_reporter_a0bcf12ea4e7d6ec905d32314a471751b}{num\_io\_bytes\_read\_from\_file\_cache}},}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ statistics-\/>\mbox{\hyperlink{structdoris_1_1_file_cache_statistics_ae299e0b33f5fe0c7f54ca86f537feb26}{num\_io\_bytes\_read\_from\_file\_cache}});}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{runtime__profile_8h_a3c0413085db33b5cfe29ea149ed3cf0c}{COUNTER\_UPDATE}}(\mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_reporter_a64bf8e909f00fdf8450b4eecfb203518}{num\_io\_bytes\_read\_from\_write\_cache}},}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ statistics-\/>\mbox{\hyperlink{structdoris_1_1_file_cache_statistics_a5c74fb8cf474446630c31edc446fa891}{num\_io\_bytes\_read\_from\_write\_cache}});}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{runtime__profile_8h_a3c0413085db33b5cfe29ea149ed3cf0c}{COUNTER\_UPDATE}}(\mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_reporter_aeae32c2ad8f20e77373031d2fb8d0f9c}{num\_io\_written\_in\_file\_cache}},\ statistics-\/>\mbox{\hyperlink{structdoris_1_1_file_cache_statistics_a2c4c76f28b50d705b93b22d684f4f839}{num\_io\_written\_in\_file\_cache}});}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{runtime__profile_8h_a3c0413085db33b5cfe29ea149ed3cf0c}{COUNTER\_UPDATE}}(\mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_reporter_a7118cedb5c0b296f3a932957ee299d7e}{num\_io\_bytes\_written\_in\_file\_cache}},}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ statistics-\/>\mbox{\hyperlink{structdoris_1_1_file_cache_statistics_addbd18c0675f08d0de1517b1b36e28f6}{num\_io\_bytes\_written\_in\_file\_cache}});}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{runtime__profile_8h_a3c0413085db33b5cfe29ea149ed3cf0c}{COUNTER\_UPDATE}}(\mbox{\hyperlink{structdoris_1_1io_1_1_file_cache_profile_reporter_ab8724e8c45d18159d1d37bac6041220d}{num\_io\_bytes\_skip\_cache}},\ statistics-\/>\mbox{\hyperlink{structdoris_1_1_file_cache_statistics_a949249ba793e4ca07dd731d7d5f4c884}{num\_io\_bytes\_skip\_cache}});}
\DoxyCodeLine{00156\ \ \ \ \ \}}
\DoxyCodeLine{00157\ \};}
\DoxyCodeLine{00158\ }
\DoxyCodeLine{00159\ \}\ \textcolor{comment}{//\ namespace\ io}}
\DoxyCodeLine{00160\ \}\ \textcolor{comment}{//\ namespace\ doris}}

\end{DoxyCode}
