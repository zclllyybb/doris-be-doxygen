\hypertarget{file__utils_8h_source}{}\doxysection{file\+\_\+utils.\+h}
\label{file__utils_8h_source}\index{/Users/dabowang/be\_all/util/file\_utils.h@{/Users/dabowang/be\_all/util/file\_utils.h}}
\mbox{\hyperlink{file__utils_8h}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Licensed\ to\ the\ Apache\ Software\ Foundation\ (ASF)\ under\ one}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ or\ more\ contributor\ license\ agreements.\ \ See\ the\ NOTICE\ file}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ distributed\ with\ this\ work\ for\ additional\ information}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ regarding\ copyright\ ownership.\ \ The\ ASF\ licenses\ this\ file}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ to\ you\ under\ the\ Apache\ License,\ Version\ 2.0\ (the}}
\DoxyCodeLine{00006\ \textcolor{comment}{//\ "{}License"{});\ you\ may\ not\ use\ this\ file\ except\ in\ compliance}}
\DoxyCodeLine{00007\ \textcolor{comment}{//\ with\ the\ License.\ \ You\ may\ obtain\ a\ copy\ of\ the\ License\ at}}
\DoxyCodeLine{00008\ \textcolor{comment}{//}}
\DoxyCodeLine{00009\ \textcolor{comment}{//\ \ \ http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{00010\ \textcolor{comment}{//}}
\DoxyCodeLine{00011\ \textcolor{comment}{//\ Unless\ required\ by\ applicable\ law\ or\ agreed\ to\ in\ writing,}}
\DoxyCodeLine{00012\ \textcolor{comment}{//\ software\ distributed\ under\ the\ License\ is\ distributed\ on\ an}}
\DoxyCodeLine{00013\ \textcolor{comment}{//\ "{}AS\ IS"{}\ BASIS,\ WITHOUT\ WARRANTIES\ OR\ CONDITIONS\ OF\ ANY}}
\DoxyCodeLine{00014\ \textcolor{comment}{//\ KIND,\ either\ express\ or\ implied.\ \ See\ the\ License\ for\ the}}
\DoxyCodeLine{00015\ \textcolor{comment}{//\ specific\ language\ governing\ permissions\ and\ limitations}}
\DoxyCodeLine{00016\ \textcolor{comment}{//\ under\ the\ License.}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ <functional>}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ <string>}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{status_8h}{common/status.h}}"{}}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ "{}gen\_cpp/Types\_types.h"{}}}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00027\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacedoris}{doris}}\ \{}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \textcolor{keyword}{class\ }Env;}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00031\ \textcolor{comment}{//\ Return\ true\ if\ file\ is\ '.'\ or\ '..'}}
\DoxyCodeLine{00032\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespacedoris_abc8627a7384ed54c8960b15bed3aab0d}{is\_dot\_or\_dotdot}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \mbox{\hyperlink{namespacedoris_a8ccf841cb59e451791bcb2e1ac4f1edc}{name}})\ \{}
\DoxyCodeLine{00033\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacedoris_a8ccf841cb59e451791bcb2e1ac4f1edc}{name}}[0]\ ==\ \textcolor{charliteral}{'.'}\ \&\&\ (\mbox{\hyperlink{namespacedoris_a8ccf841cb59e451791bcb2e1ac4f1edc}{name}}[1]\ ==\ \textcolor{charliteral}{'\(\backslash\)0'}\ ||\ (\mbox{\hyperlink{namespacedoris_a8ccf841cb59e451791bcb2e1ac4f1edc}{name}}[1]\ ==\ \textcolor{charliteral}{'.'}\ \&\&\ \mbox{\hyperlink{namespacedoris_a8ccf841cb59e451791bcb2e1ac4f1edc}{name}}[2]\ ==\ \textcolor{charliteral}{'\(\backslash\)0'}));}
\DoxyCodeLine{00034\ \}}
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00036\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classdoris_1_1_file_utils}{FileUtils}}\ \{}
\DoxyCodeLine{00037\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00038\ \ \ \ \ \textcolor{comment}{//\ Create\ directory\ of\ dir\_path\ with\ default\ Env,}}
\DoxyCodeLine{00039\ \ \ \ \ \textcolor{comment}{//\ This\ function\ will\ create\ directory\ recursively,}}
\DoxyCodeLine{00040\ \ \ \ \ \textcolor{comment}{//\ if\ dir's\ parent\ directory\ doesn't\ exist}}
\DoxyCodeLine{00041\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00042\ \ \ \ \ \textcolor{comment}{//\ RETURNS:}}
\DoxyCodeLine{00043\ \ \ \ \ \textcolor{comment}{//\ \ Status::OK()\ \ \ \ \ \ if\ create\ directory\ success\ or\ directory\ already\ exists}}
\DoxyCodeLine{00044\ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_file_utils_a1d486c6d55867ab427baba4cc599441e}{create\_dir}}(\textcolor{keyword}{const}\ std::string\&\ dir\_path);}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{comment}{//\ Create\ directory\ of\ dir\_path,}}
\DoxyCodeLine{00047\ \ \ \ \ \textcolor{comment}{//\ This\ function\ will\ create\ directory\ recursively,}}
\DoxyCodeLine{00048\ \ \ \ \ \textcolor{comment}{//\ if\ dir's\ parent\ directory\ doesn't\ exist}}
\DoxyCodeLine{00049\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00050\ \ \ \ \ \textcolor{comment}{//\ RETURNS:}}
\DoxyCodeLine{00051\ \ \ \ \ \textcolor{comment}{//\ \ Status::OK()\ \ \ \ \ \ if\ create\ directory\ success\ or\ directory\ already\ exists}}
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_file_utils_a1d486c6d55867ab427baba4cc599441e}{create\_dir}}(\textcolor{keyword}{const}\ std::string\&\ dir\_path,\ \mbox{\hyperlink{classdoris_1_1_env}{Env}}*\ env);}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00054\ \ \ \ \ \textcolor{comment}{//\ Delete\ file\ recursively.}}
\DoxyCodeLine{00055\ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_file_utils_a96f3b07449087df8c32a773ebfde81a3}{remove\_all}}(\textcolor{keyword}{const}\ std::string\&\ dir\_path);}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_file_utils_a2cd113b0c7c62267a98fae344720e041}{remove}}(\textcolor{keyword}{const}\ std::string\&\ path);}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00059\ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_file_utils_a307b9672de12dda9086ac4adcddce39d}{remove\_paths}}(\textcolor{keyword}{const}\ std::vector<std::string>\&\ paths);}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00061\ \ \ \ \ \textcolor{comment}{//\ List\ all\ files\ in\ the\ specified\ directory\ without\ '.'\ and\ '..'.}}
\DoxyCodeLine{00062\ \ \ \ \ \textcolor{comment}{//\ If\ you\ want\ retrieve\ all\ files,\ you\ can\ use\ Env::iterate\_dir.}}
\DoxyCodeLine{00063\ \ \ \ \ \textcolor{comment}{//\ All\ valid\ files\ will\ be\ stored\ in\ given\ *files.}}
\DoxyCodeLine{00064\ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_file_utils_a4a57842b40ec54c78a9bf4b79c0c1798}{list\_files}}(\mbox{\hyperlink{classdoris_1_1_env}{Env}}*\ env,\ \textcolor{keyword}{const}\ std::string\&\ dir,\ std::vector<std::string>*\ files);}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00066\ \ \ \ \ \textcolor{comment}{//\ List\ all\ dirs\ and\ files\ in\ the\ specified\ directory}}
\DoxyCodeLine{00067\ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_file_utils_aa9245362d1d8fee546cc4bc07033a94e}{list\_dirs\_files}}(\textcolor{keyword}{const}\ std::string\&\ path,\ std::set<std::string>*\ dirs,}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::set<std::string>*\ files,\ \mbox{\hyperlink{classdoris_1_1_env}{Env}}*\ env);}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00070\ \ \ \ \ \textcolor{comment}{//\ Get\ the\ number\ of\ children\ belong\ to\ the\ specified\ directory,\ this}}
\DoxyCodeLine{00071\ \ \ \ \ \textcolor{comment}{//\ function\ also\ exclude\ '.'\ and\ '..'.}}
\DoxyCodeLine{00072\ \ \ \ \ \textcolor{comment}{//\ Return\ OK\ with\ *count\ is\ set\ to\ the\ count,\ if\ execute\ successful.}}
\DoxyCodeLine{00073\ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_file_utils_a279e6272bbefbd8d8d0e7e9d27aa5095}{get\_children\_count}}(\mbox{\hyperlink{classdoris_1_1_env}{Env}}*\ env,\ \textcolor{keyword}{const}\ std::string\&\ dir,\ int64\_t*\ count);}
\DoxyCodeLine{00074\ }
\DoxyCodeLine{00075\ \ \ \ \ \textcolor{comment}{//\ Check\ the\ file\_path\ is\ not\ exist\ with\ default\ env,\ or\ is\ not\ a\ dir,\ return\ false.}}
\DoxyCodeLine{00076\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1_file_utils_a3880284c9972026059d22f84b6f476ae}{is\_dir}}(\textcolor{keyword}{const}\ std::string\&\ file\_path,\ \mbox{\hyperlink{classdoris_1_1_env}{Env}}*\ env);}
\DoxyCodeLine{00077\ }
\DoxyCodeLine{00078\ \ \ \ \ \textcolor{comment}{//\ If\ the\ file\_path\ is\ not\ exist,\ or\ is\ not\ a\ dir,\ return\ false.}}
\DoxyCodeLine{00079\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1_file_utils_a3880284c9972026059d22f84b6f476ae}{is\_dir}}(\textcolor{keyword}{const}\ std::string\&\ file\_path);}
\DoxyCodeLine{00080\ }
\DoxyCodeLine{00081\ \ \ \ \ \textcolor{comment}{//\ Get\ file\ path\ from\ fd}}
\DoxyCodeLine{00082\ \ \ \ \ \textcolor{comment}{//\ Return}}
\DoxyCodeLine{00083\ \ \ \ \ \textcolor{comment}{//\ \ file\ path\ of\ this\ fd\ referenced}}
\DoxyCodeLine{00084\ \ \ \ \ \textcolor{comment}{//\ \ "{}"{}\ if\ this\ fd\ is\ invalid}}
\DoxyCodeLine{00085\ \ \ \ \ \textcolor{keyword}{static}\ std::string\ \mbox{\hyperlink{classdoris_1_1_file_utils_a8bcd50ec0c78c29c4afe3dc3b85b8a9c}{path\_of\_fd}}(\textcolor{keywordtype}{int}\ fd);}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ \ \ \ \ \textcolor{comment}{//\ split\ paths\ in\ configure\ file\ to\ path}}
\DoxyCodeLine{00088\ \ \ \ \ \textcolor{comment}{//\ for\ example}}
\DoxyCodeLine{00089\ \ \ \ \ \textcolor{comment}{//\ "{}/home/disk1/;/home/disk2"{}}}
\DoxyCodeLine{00090\ \ \ \ \ \textcolor{comment}{//\ will\ split\ to\ ['/home/disk1',\ '/home/disk2']}}
\DoxyCodeLine{00091\ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_file_utils_a3cc5c3241aba57570dd3a56fb944c355}{split\_paths}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ path,\ std::vector<std::string>*\ path\_vec);}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00093\ \ \ \ \ \textcolor{comment}{//\ copy\ the\ file\ from\ src\ path\ to\ dest\ path,\ it\ will\ overwrite\ the\ existing\ files}}
\DoxyCodeLine{00094\ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_file_utils_a2dcde5f7de67494f02d7212e50807e72}{copy\_file}}(\textcolor{keyword}{const}\ std::string\&\ src\_path,\ \textcolor{keyword}{const}\ std::string\&\ dest\_path);}
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00096\ \ \ \ \ \textcolor{comment}{//\ calc\ md5sum\ of\ a\ local\ file}}
\DoxyCodeLine{00097\ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_file_utils_a965fd0c3c3bc18923ed24d037740d092}{md5sum}}(\textcolor{keyword}{const}\ std::string\&\ file,\ std::string*\ \mbox{\hyperlink{classdoris_1_1_file_utils_a965fd0c3c3bc18923ed24d037740d092}{md5sum}});}
\DoxyCodeLine{00098\ }
\DoxyCodeLine{00099\ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_file_utils_a62c6935760674111a5ecec19e041fcdf}{mtime}}(\textcolor{keyword}{const}\ std::string\&\ file,\ time\_t*\ m\_time);}
\DoxyCodeLine{00100\ }
\DoxyCodeLine{00101\ \ \ \ \ \textcolor{comment}{//\ check\ path(file\ or\ directory)\ exist\ with\ default\ env}}
\DoxyCodeLine{00102\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdoris_1_1_file_utils_a1cc140ec680ae7f7e362e96d1062eb57}{check\_exist}}(\textcolor{keyword}{const}\ std::string\&\ path);}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00104\ \ \ \ \ \textcolor{comment}{//\ Canonicalize\ 'path'\ by\ applying\ the\ following\ conversions:}}
\DoxyCodeLine{00105\ \ \ \ \ \textcolor{comment}{//\ -\/\ Converts\ a\ relative\ path\ into\ an\ absolute\ one\ using\ the\ cwd.}}
\DoxyCodeLine{00106\ \ \ \ \ \textcolor{comment}{//\ -\/\ Converts\ '.'\ and\ '..'\ references.}}
\DoxyCodeLine{00107\ \ \ \ \ \textcolor{comment}{//\ -\/\ Resolves\ all\ symbolic\ links.}}
\DoxyCodeLine{00108\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00109\ \ \ \ \ \textcolor{comment}{//\ All\ directory\ entries\ in\ 'path'\ must\ exist\ on\ the\ filesystem.}}
\DoxyCodeLine{00110\ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classdoris_1_1_status}{Status}}\ \mbox{\hyperlink{classdoris_1_1_file_utils_a9c02e8f4a14fb0f64b5d8631e964be77}{canonicalize}}(\textcolor{keyword}{const}\ std::string\&\ path,\ std::string*\ real\_path);}
\DoxyCodeLine{00111\ \};}
\DoxyCodeLine{00112\ }
\DoxyCodeLine{00113\ \}\ \textcolor{comment}{//\ namespace\ doris}}

\end{DoxyCode}
