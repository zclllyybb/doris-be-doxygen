\hypertarget{classdoris_1_1_timestamped_version_tracker}{}\doxysection{Timestamped\+Version\+Tracker类 参考}
\label{classdoris_1_1_timestamped_version_tracker}\index{TimestampedVersionTracker@{TimestampedVersionTracker}}


{\ttfamily \#include $<$version\+\_\+graph.\+h$>$}



Timestamped\+Version\+Tracker 的协作图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=222pt]{df/d10/classdoris_1_1_timestamped_version_tracker__coll__graph}
\end{center}
\end{figure}
\doxysubsection*{Public 成员函数}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{classdoris_1_1_timestamped_version_tracker_a3cc04e0a970cc92a0e26ff9be2fa8393}{construct\+\_\+versioned\+\_\+tracker}} (const std\+::vector$<$ \mbox{\hyperlink{namespacedoris_a8e1aa733e7ffe7bd29887ebdf7c1303d}{Rowset\+Meta\+Shared\+Ptr}} $>$ \&rs\+\_\+metas)
\begin{DoxyCompactList}\small\item\em Construct rowsets version tracker by main path rowset meta. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classdoris_1_1_timestamped_version_tracker_ad3f963237c7c7f69c44c1c6d1e2f680a}{construct\+\_\+versioned\+\_\+tracker}} (const std\+::vector$<$ \mbox{\hyperlink{namespacedoris_a8e1aa733e7ffe7bd29887ebdf7c1303d}{Rowset\+Meta\+Shared\+Ptr}} $>$ \&rs\+\_\+metas, const std\+::vector$<$ \mbox{\hyperlink{namespacedoris_a8e1aa733e7ffe7bd29887ebdf7c1303d}{Rowset\+Meta\+Shared\+Ptr}} $>$ \&stale\+\_\+metas)
\begin{DoxyCompactList}\small\item\em Construct rowsets version tracker by main path rowset meta and stale rowset meta. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classdoris_1_1_timestamped_version_tracker_a625735081db557fc694829b951bfc573}{recover\+\_\+versioned\+\_\+tracker}} (const std\+::map$<$ int64\+\_\+t, \mbox{\hyperlink{namespacedoris_a8c762a1e6b0e50750316db48a4aa4f9a}{Path\+Version\+List\+Shared\+Ptr}} $>$ \&stale\+\_\+version\+\_\+path\+\_\+map)
\item 
void \mbox{\hyperlink{classdoris_1_1_timestamped_version_tracker_aa4d7de09e01e358a593893cee2c71534}{add\+\_\+version}} (const \mbox{\hyperlink{structdoris_1_1_version}{Version}} \&\mbox{\hyperlink{file__header_8h_acd99bb05ca015e7d74448acb1deba7ca}{version}})
\begin{DoxyCompactList}\small\item\em Add a version to tracker, this version is a new version rowset, not merged rowset. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classdoris_1_1_timestamped_version_tracker_a552b313c2b270cf754695ef44864b9e6}{delete\+\_\+version}} (const \mbox{\hyperlink{structdoris_1_1_version}{Version}} \&\mbox{\hyperlink{file__header_8h_acd99bb05ca015e7d74448acb1deba7ca}{version}})
\item 
void \mbox{\hyperlink{classdoris_1_1_timestamped_version_tracker_aa60696ace793c3c79df556f0c601783b}{add\+\_\+stale\+\_\+path\+\_\+version}} (const std\+::vector$<$ \mbox{\hyperlink{namespacedoris_a8e1aa733e7ffe7bd29887ebdf7c1303d}{Rowset\+Meta\+Shared\+Ptr}} $>$ \&stale\+\_\+rs\+\_\+metas)
\item 
\mbox{\hyperlink{classdoris_1_1_status}{Status}} \mbox{\hyperlink{classdoris_1_1_timestamped_version_tracker_a94ab67a25c8b6994b01b65da2fa27550}{capture\+\_\+consistent\+\_\+versions}} (const \mbox{\hyperlink{structdoris_1_1_version}{Version}} \&spec\+\_\+version, std\+::vector$<$ \mbox{\hyperlink{structdoris_1_1_version}{Version}} $>$ $\ast$version\+\_\+path) const
\item 
void \mbox{\hyperlink{classdoris_1_1_timestamped_version_tracker_a6be36c47eaed5893c1cee5c08596af7e}{capture\+\_\+expired\+\_\+paths}} (int64\+\_\+t stale\+\_\+sweep\+\_\+endtime, std\+::vector$<$ int64\+\_\+t $>$ $\ast$path\+\_\+version) const
\item 
\mbox{\hyperlink{namespacedoris_a8c762a1e6b0e50750316db48a4aa4f9a}{Path\+Version\+List\+Shared\+Ptr}} \mbox{\hyperlink{classdoris_1_1_timestamped_version_tracker_a44b07cde3fcf6fe7f2466531d5159edd}{fetch\+\_\+path\+\_\+version\+\_\+by\+\_\+id}} (int64\+\_\+t path\+\_\+id)
\begin{DoxyCompactList}\small\item\em Fetch all versions with a path\+\_\+version. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacedoris_a8c762a1e6b0e50750316db48a4aa4f9a}{Path\+Version\+List\+Shared\+Ptr}} \mbox{\hyperlink{classdoris_1_1_timestamped_version_tracker_a930cf91ffb756ee1287d568cf5eec6ac}{fetch\+\_\+and\+\_\+delete\+\_\+path\+\_\+by\+\_\+id}} (int64\+\_\+t path\+\_\+id)
\item 
std\+::string \mbox{\hyperlink{classdoris_1_1_timestamped_version_tracker_a1459b619072a73e802aa03ec57094591}{get\+\_\+current\+\_\+path\+\_\+map\+\_\+str}} ()
\begin{DoxyCompactList}\small\item\em Print all expired version path in a tablet. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classdoris_1_1_timestamped_version_tracker_aef5cd67f06f78dd63a5f67020d68651c}{get\+\_\+stale\+\_\+version\+\_\+path\+\_\+json\+\_\+doc}} (rapidjson\+::\+Document \&path\+\_\+arr)
\item 
double \mbox{\hyperlink{classdoris_1_1_timestamped_version_tracker_aa57202365d6e158acbcddbaf35913861}{get\+\_\+orphan\+\_\+vertex\+\_\+ratio}} ()
\end{DoxyCompactItemize}
\doxysubsection*{Private 成员函数}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{classdoris_1_1_timestamped_version_tracker_ac5781ac461242853993e4a2c3f81aae6}{\+\_\+construct\+\_\+versioned\+\_\+tracker}} (const std\+::vector$<$ \mbox{\hyperlink{namespacedoris_a8e1aa733e7ffe7bd29887ebdf7c1303d}{Rowset\+Meta\+Shared\+Ptr}} $>$ \&rs\+\_\+metas)
\begin{DoxyCompactList}\small\item\em Construct rowsets version tracker with main path rowset meta. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classdoris_1_1_timestamped_version_tracker_a2de741d43aaa6c622969465c10af9920}{\+\_\+init\+\_\+stale\+\_\+version\+\_\+path\+\_\+map}} (const std\+::vector$<$ \mbox{\hyperlink{namespacedoris_a8e1aa733e7ffe7bd29887ebdf7c1303d}{Rowset\+Meta\+Shared\+Ptr}} $>$ \&rs\+\_\+metas, const std\+::vector$<$ \mbox{\hyperlink{namespacedoris_a8e1aa733e7ffe7bd29887ebdf7c1303d}{Rowset\+Meta\+Shared\+Ptr}} $>$ \&stale\+\_\+metas)
\begin{DoxyCompactList}\small\item\em init stale\+\_\+version\+\_\+path\+\_\+map by main path rowset meta and stale rowset meta. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classdoris_1_1_timestamped_version_tracker_af04281fe8b4f45fde59b5a189f37a20b}{\+\_\+find\+\_\+path\+\_\+from\+\_\+stale\+\_\+map}} (const std\+::unordered\+\_\+map$<$ int64\+\_\+t, std\+::unordered\+\_\+map$<$ int64\+\_\+t, \mbox{\hyperlink{namespacedoris_a8e1aa733e7ffe7bd29887ebdf7c1303d}{Rowset\+Meta\+Shared\+Ptr}} $>$ $>$ \&stale\+\_\+map, int64\+\_\+t first\+\_\+version, int64\+\_\+t second\+\_\+version, std\+::vector$<$ \mbox{\hyperlink{namespacedoris_a8e1aa733e7ffe7bd29887ebdf7c1303d}{Rowset\+Meta\+Shared\+Ptr}} $>$ $\ast$stale\+\_\+path)
\begin{DoxyCompactList}\small\item\em find a path in stale\+\_\+map from first\+\_\+version to second\+\_\+version, stale\+\_\+path is used as result. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Private 属性}
\begin{DoxyCompactItemize}
\item 
int64\+\_\+t \mbox{\hyperlink{classdoris_1_1_timestamped_version_tracker_af00bfaec7596f6615986a5e57177ba88}{\+\_\+next\+\_\+path\+\_\+id}} = 1
\item 
std\+::map$<$ int64\+\_\+t, \mbox{\hyperlink{namespacedoris_a8c762a1e6b0e50750316db48a4aa4f9a}{Path\+Version\+List\+Shared\+Ptr}} $>$ \mbox{\hyperlink{classdoris_1_1_timestamped_version_tracker_a80febc4cee0c1d6d1c2dd8090f06f4e4}{\+\_\+stale\+\_\+version\+\_\+path\+\_\+map}}
\item 
\mbox{\hyperlink{classdoris_1_1_version_graph}{Version\+Graph}} \mbox{\hyperlink{classdoris_1_1_timestamped_version_tracker_ac95791d4acde53b6e750b5004c162cf5}{\+\_\+version\+\_\+graph}}
\end{DoxyCompactItemize}


\doxysubsection{详细描述}
\mbox{\hyperlink{classdoris_1_1_timestamped_version_tracker}{Timestamped\+Version\+Tracker}} class is responsible to track all rowsets version links of a tablet. This class not only records the graph of all versions, but also records the paths which will be removed after the path is expired. 

\doxysubsection{成员函数说明}
\mbox{\Hypertarget{classdoris_1_1_timestamped_version_tracker_a3cc04e0a970cc92a0e26ff9be2fa8393}\label{classdoris_1_1_timestamped_version_tracker_a3cc04e0a970cc92a0e26ff9be2fa8393}} 
\index{TimestampedVersionTracker@{TimestampedVersionTracker}!construct\_versioned\_tracker@{construct\_versioned\_tracker}}
\index{construct\_versioned\_tracker@{construct\_versioned\_tracker}!TimestampedVersionTracker@{TimestampedVersionTracker}}
\doxysubsubsection{\texorpdfstring{construct\_versioned\_tracker()}{construct\_versioned\_tracker()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void construct\+\_\+versioned\+\_\+tracker (\begin{DoxyParamCaption}\item[{const std\+::vector$<$ \mbox{\hyperlink{namespacedoris_a8e1aa733e7ffe7bd29887ebdf7c1303d}{Rowset\+Meta\+Shared\+Ptr}} $>$ \&}]{rs\+\_\+metas }\end{DoxyParamCaption})}



Construct rowsets version tracker by main path rowset meta. 

函数调用图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d1/dee/classdoris_1_1_timestamped_version_tracker_a3cc04e0a970cc92a0e26ff9be2fa8393_cgraph}
\end{center}
\end{figure}
这是这个函数的调用关系图\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d1/dee/classdoris_1_1_timestamped_version_tracker_a3cc04e0a970cc92a0e26ff9be2fa8393_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1_timestamped_version_tracker_ad3f963237c7c7f69c44c1c6d1e2f680a}\label{classdoris_1_1_timestamped_version_tracker_ad3f963237c7c7f69c44c1c6d1e2f680a}} 
\index{TimestampedVersionTracker@{TimestampedVersionTracker}!construct\_versioned\_tracker@{construct\_versioned\_tracker}}
\index{construct\_versioned\_tracker@{construct\_versioned\_tracker}!TimestampedVersionTracker@{TimestampedVersionTracker}}
\doxysubsubsection{\texorpdfstring{construct\_versioned\_tracker()}{construct\_versioned\_tracker()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void construct\+\_\+versioned\+\_\+tracker (\begin{DoxyParamCaption}\item[{const std\+::vector$<$ \mbox{\hyperlink{namespacedoris_a8e1aa733e7ffe7bd29887ebdf7c1303d}{Rowset\+Meta\+Shared\+Ptr}} $>$ \&}]{rs\+\_\+metas,  }\item[{const std\+::vector$<$ \mbox{\hyperlink{namespacedoris_a8e1aa733e7ffe7bd29887ebdf7c1303d}{Rowset\+Meta\+Shared\+Ptr}} $>$ \&}]{stale\+\_\+metas }\end{DoxyParamCaption})}



Construct rowsets version tracker by main path rowset meta and stale rowset meta. 

函数调用图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d1/dee/classdoris_1_1_timestamped_version_tracker_ad3f963237c7c7f69c44c1c6d1e2f680a_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1_timestamped_version_tracker_a625735081db557fc694829b951bfc573}\label{classdoris_1_1_timestamped_version_tracker_a625735081db557fc694829b951bfc573}} 
\index{TimestampedVersionTracker@{TimestampedVersionTracker}!recover\_versioned\_tracker@{recover\_versioned\_tracker}}
\index{recover\_versioned\_tracker@{recover\_versioned\_tracker}!TimestampedVersionTracker@{TimestampedVersionTracker}}
\doxysubsubsection{\texorpdfstring{recover\_versioned\_tracker()}{recover\_versioned\_tracker()}}
{\footnotesize\ttfamily void recover\+\_\+versioned\+\_\+tracker (\begin{DoxyParamCaption}\item[{const std\+::map$<$ int64\+\_\+t, \mbox{\hyperlink{namespacedoris_a8c762a1e6b0e50750316db48a4aa4f9a}{Path\+Version\+List\+Shared\+Ptr}} $>$ \&}]{stale\+\_\+version\+\_\+path\+\_\+map }\end{DoxyParamCaption})}

Recover rowsets version tracker from stale version path map. When delete operation fails, the tracker can be recovered from deleted stale\+\_\+version\+\_\+path\+\_\+map. 函数调用图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d1/dee/classdoris_1_1_timestamped_version_tracker_a625735081db557fc694829b951bfc573_cgraph}
\end{center}
\end{figure}
这是这个函数的调用关系图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d1/dee/classdoris_1_1_timestamped_version_tracker_a625735081db557fc694829b951bfc573_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1_timestamped_version_tracker_aa4d7de09e01e358a593893cee2c71534}\label{classdoris_1_1_timestamped_version_tracker_aa4d7de09e01e358a593893cee2c71534}} 
\index{TimestampedVersionTracker@{TimestampedVersionTracker}!add\_version@{add\_version}}
\index{add\_version@{add\_version}!TimestampedVersionTracker@{TimestampedVersionTracker}}
\doxysubsubsection{\texorpdfstring{add\_version()}{add\_version()}}
{\footnotesize\ttfamily void add\+\_\+version (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structdoris_1_1_version}{Version}} \&}]{version }\end{DoxyParamCaption})}



Add a version to tracker, this version is a new version rowset, not merged rowset. 

函数调用图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d1/dee/classdoris_1_1_timestamped_version_tracker_aa4d7de09e01e358a593893cee2c71534_cgraph}
\end{center}
\end{figure}
这是这个函数的调用关系图\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d1/dee/classdoris_1_1_timestamped_version_tracker_aa4d7de09e01e358a593893cee2c71534_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1_timestamped_version_tracker_a552b313c2b270cf754695ef44864b9e6}\label{classdoris_1_1_timestamped_version_tracker_a552b313c2b270cf754695ef44864b9e6}} 
\index{TimestampedVersionTracker@{TimestampedVersionTracker}!delete\_version@{delete\_version}}
\index{delete\_version@{delete\_version}!TimestampedVersionTracker@{TimestampedVersionTracker}}
\doxysubsubsection{\texorpdfstring{delete\_version()}{delete\_version()}}
{\footnotesize\ttfamily void delete\+\_\+version (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structdoris_1_1_version}{Version}} \&}]{version }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

函数调用图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d1/dee/classdoris_1_1_timestamped_version_tracker_a552b313c2b270cf754695ef44864b9e6_cgraph}
\end{center}
\end{figure}
这是这个函数的调用关系图\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d1/dee/classdoris_1_1_timestamped_version_tracker_a552b313c2b270cf754695ef44864b9e6_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1_timestamped_version_tracker_aa60696ace793c3c79df556f0c601783b}\label{classdoris_1_1_timestamped_version_tracker_aa60696ace793c3c79df556f0c601783b}} 
\index{TimestampedVersionTracker@{TimestampedVersionTracker}!add\_stale\_path\_version@{add\_stale\_path\_version}}
\index{add\_stale\_path\_version@{add\_stale\_path\_version}!TimestampedVersionTracker@{TimestampedVersionTracker}}
\doxysubsubsection{\texorpdfstring{add\_stale\_path\_version()}{add\_stale\_path\_version()}}
{\footnotesize\ttfamily void add\+\_\+stale\+\_\+path\+\_\+version (\begin{DoxyParamCaption}\item[{const std\+::vector$<$ \mbox{\hyperlink{namespacedoris_a8e1aa733e7ffe7bd29887ebdf7c1303d}{Rowset\+Meta\+Shared\+Ptr}} $>$ \&}]{stale\+\_\+rs\+\_\+metas }\end{DoxyParamCaption})}

Add a version path with stale\+\_\+rs\+\_\+metas, this versions in version path are merged rowsets. These rowsets are tracked and removed after they are expired. \mbox{\hyperlink{classdoris_1_1_tablet_manager}{Tablet\+Manager}} sweep these rowsets using tracker by timing. 这是这个函数的调用关系图\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d1/dee/classdoris_1_1_timestamped_version_tracker_aa60696ace793c3c79df556f0c601783b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1_timestamped_version_tracker_a94ab67a25c8b6994b01b65da2fa27550}\label{classdoris_1_1_timestamped_version_tracker_a94ab67a25c8b6994b01b65da2fa27550}} 
\index{TimestampedVersionTracker@{TimestampedVersionTracker}!capture\_consistent\_versions@{capture\_consistent\_versions}}
\index{capture\_consistent\_versions@{capture\_consistent\_versions}!TimestampedVersionTracker@{TimestampedVersionTracker}}
\doxysubsubsection{\texorpdfstring{capture\_consistent\_versions()}{capture\_consistent\_versions()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classdoris_1_1_status}{Status}} capture\+\_\+consistent\+\_\+versions (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structdoris_1_1_version}{Version}} \&}]{spec\+\_\+version,  }\item[{std\+::vector$<$ \mbox{\hyperlink{structdoris_1_1_version}{Version}} $>$ $\ast$}]{version\+\_\+path }\end{DoxyParamCaption}) const}

Given a spec\+\_\+version, this method can find a version path which is the shortest path in the graph. The version paths are added to version\+\_\+path as return info. If this version not in main version, version\+\_\+path can be included expired rowset. 函数调用图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d1/dee/classdoris_1_1_timestamped_version_tracker_a94ab67a25c8b6994b01b65da2fa27550_cgraph}
\end{center}
\end{figure}
这是这个函数的调用关系图\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d1/dee/classdoris_1_1_timestamped_version_tracker_a94ab67a25c8b6994b01b65da2fa27550_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1_timestamped_version_tracker_a6be36c47eaed5893c1cee5c08596af7e}\label{classdoris_1_1_timestamped_version_tracker_a6be36c47eaed5893c1cee5c08596af7e}} 
\index{TimestampedVersionTracker@{TimestampedVersionTracker}!capture\_expired\_paths@{capture\_expired\_paths}}
\index{capture\_expired\_paths@{capture\_expired\_paths}!TimestampedVersionTracker@{TimestampedVersionTracker}}
\doxysubsubsection{\texorpdfstring{capture\_expired\_paths()}{capture\_expired\_paths()}}
{\footnotesize\ttfamily void capture\+\_\+expired\+\_\+paths (\begin{DoxyParamCaption}\item[{int64\+\_\+t}]{stale\+\_\+sweep\+\_\+endtime,  }\item[{std\+::vector$<$ int64\+\_\+t $>$ $\ast$}]{path\+\_\+version }\end{DoxyParamCaption}) const}

Capture all expired path version. When the last rowset create time of a path greater than expired time which can be expressed \char`\"{}now() -\/ tablet\+\_\+rowset\+\_\+stale\+\_\+sweep\+\_\+time\+\_\+sec\char`\"{} , this path will be remained. Otherwise, this path will be added to path\+\_\+version. 这是这个函数的调用关系图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=345pt]{d1/dee/classdoris_1_1_timestamped_version_tracker_a6be36c47eaed5893c1cee5c08596af7e_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1_timestamped_version_tracker_a44b07cde3fcf6fe7f2466531d5159edd}\label{classdoris_1_1_timestamped_version_tracker_a44b07cde3fcf6fe7f2466531d5159edd}} 
\index{TimestampedVersionTracker@{TimestampedVersionTracker}!fetch\_path\_version\_by\_id@{fetch\_path\_version\_by\_id}}
\index{fetch\_path\_version\_by\_id@{fetch\_path\_version\_by\_id}!TimestampedVersionTracker@{TimestampedVersionTracker}}
\doxysubsubsection{\texorpdfstring{fetch\_path\_version\_by\_id()}{fetch\_path\_version\_by\_id()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacedoris_a8c762a1e6b0e50750316db48a4aa4f9a}{Path\+Version\+List\+Shared\+Ptr}} fetch\+\_\+path\+\_\+version\+\_\+by\+\_\+id (\begin{DoxyParamCaption}\item[{int64\+\_\+t}]{path\+\_\+id }\end{DoxyParamCaption})}



Fetch all versions with a path\+\_\+version. 

这是这个函数的调用关系图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d1/dee/classdoris_1_1_timestamped_version_tracker_a44b07cde3fcf6fe7f2466531d5159edd_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1_timestamped_version_tracker_a930cf91ffb756ee1287d568cf5eec6ac}\label{classdoris_1_1_timestamped_version_tracker_a930cf91ffb756ee1287d568cf5eec6ac}} 
\index{TimestampedVersionTracker@{TimestampedVersionTracker}!fetch\_and\_delete\_path\_by\_id@{fetch\_and\_delete\_path\_by\_id}}
\index{fetch\_and\_delete\_path\_by\_id@{fetch\_and\_delete\_path\_by\_id}!TimestampedVersionTracker@{TimestampedVersionTracker}}
\doxysubsubsection{\texorpdfstring{fetch\_and\_delete\_path\_by\_id()}{fetch\_and\_delete\_path\_by\_id()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespacedoris_a8c762a1e6b0e50750316db48a4aa4f9a}{Path\+Version\+List\+Shared\+Ptr}} fetch\+\_\+and\+\_\+delete\+\_\+path\+\_\+by\+\_\+id (\begin{DoxyParamCaption}\item[{int64\+\_\+t}]{path\+\_\+id }\end{DoxyParamCaption})}

Fetch all versions with a path\+\_\+version, at the same time remove this path from the tracker. Next time, fetch this path, it will return empty. 函数调用图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d1/dee/classdoris_1_1_timestamped_version_tracker_a930cf91ffb756ee1287d568cf5eec6ac_cgraph}
\end{center}
\end{figure}
这是这个函数的调用关系图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=345pt]{d1/dee/classdoris_1_1_timestamped_version_tracker_a930cf91ffb756ee1287d568cf5eec6ac_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1_timestamped_version_tracker_a1459b619072a73e802aa03ec57094591}\label{classdoris_1_1_timestamped_version_tracker_a1459b619072a73e802aa03ec57094591}} 
\index{TimestampedVersionTracker@{TimestampedVersionTracker}!get\_current\_path\_map\_str@{get\_current\_path\_map\_str}}
\index{get\_current\_path\_map\_str@{get\_current\_path\_map\_str}!TimestampedVersionTracker@{TimestampedVersionTracker}}
\doxysubsubsection{\texorpdfstring{get\_current\_path\_map\_str()}{get\_current\_path\_map\_str()}}
{\footnotesize\ttfamily std\+::string get\+\_\+current\+\_\+path\+\_\+map\+\_\+str (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Print all expired version path in a tablet. 

这是这个函数的调用关系图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d1/dee/classdoris_1_1_timestamped_version_tracker_a1459b619072a73e802aa03ec57094591_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1_timestamped_version_tracker_aef5cd67f06f78dd63a5f67020d68651c}\label{classdoris_1_1_timestamped_version_tracker_aef5cd67f06f78dd63a5f67020d68651c}} 
\index{TimestampedVersionTracker@{TimestampedVersionTracker}!get\_stale\_version\_path\_json\_doc@{get\_stale\_version\_path\_json\_doc}}
\index{get\_stale\_version\_path\_json\_doc@{get\_stale\_version\_path\_json\_doc}!TimestampedVersionTracker@{TimestampedVersionTracker}}
\doxysubsubsection{\texorpdfstring{get\_stale\_version\_path\_json\_doc()}{get\_stale\_version\_path\_json\_doc()}}
{\footnotesize\ttfamily void get\+\_\+stale\+\_\+version\+\_\+path\+\_\+json\+\_\+doc (\begin{DoxyParamCaption}\item[{rapidjson\+::\+Document \&}]{path\+\_\+arr }\end{DoxyParamCaption})}

Get json document of \+\_\+stale\+\_\+version\+\_\+path\+\_\+map. Fill the path\+\_\+id and version\+\_\+path list in the document. The parameter path arr is used as return variable. 这是这个函数的调用关系图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=337pt]{d1/dee/classdoris_1_1_timestamped_version_tracker_aef5cd67f06f78dd63a5f67020d68651c_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1_timestamped_version_tracker_aa57202365d6e158acbcddbaf35913861}\label{classdoris_1_1_timestamped_version_tracker_aa57202365d6e158acbcddbaf35913861}} 
\index{TimestampedVersionTracker@{TimestampedVersionTracker}!get\_orphan\_vertex\_ratio@{get\_orphan\_vertex\_ratio}}
\index{get\_orphan\_vertex\_ratio@{get\_orphan\_vertex\_ratio}!TimestampedVersionTracker@{TimestampedVersionTracker}}
\doxysubsubsection{\texorpdfstring{get\_orphan\_vertex\_ratio()}{get\_orphan\_vertex\_ratio()}}
{\footnotesize\ttfamily double get\+\_\+orphan\+\_\+vertex\+\_\+ratio (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

函数调用图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d1/dee/classdoris_1_1_timestamped_version_tracker_aa57202365d6e158acbcddbaf35913861_cgraph}
\end{center}
\end{figure}
这是这个函数的调用关系图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d1/dee/classdoris_1_1_timestamped_version_tracker_aa57202365d6e158acbcddbaf35913861_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1_timestamped_version_tracker_ac5781ac461242853993e4a2c3f81aae6}\label{classdoris_1_1_timestamped_version_tracker_ac5781ac461242853993e4a2c3f81aae6}} 
\index{TimestampedVersionTracker@{TimestampedVersionTracker}!\_construct\_versioned\_tracker@{\_construct\_versioned\_tracker}}
\index{\_construct\_versioned\_tracker@{\_construct\_versioned\_tracker}!TimestampedVersionTracker@{TimestampedVersionTracker}}
\doxysubsubsection{\texorpdfstring{\_construct\_versioned\_tracker()}{\_construct\_versioned\_tracker()}}
{\footnotesize\ttfamily void \+\_\+construct\+\_\+versioned\+\_\+tracker (\begin{DoxyParamCaption}\item[{const std\+::vector$<$ \mbox{\hyperlink{namespacedoris_a8e1aa733e7ffe7bd29887ebdf7c1303d}{Rowset\+Meta\+Shared\+Ptr}} $>$ \&}]{rs\+\_\+metas }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Construct rowsets version tracker with main path rowset meta. 

函数调用图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d1/dee/classdoris_1_1_timestamped_version_tracker_ac5781ac461242853993e4a2c3f81aae6_cgraph}
\end{center}
\end{figure}
这是这个函数的调用关系图\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d1/dee/classdoris_1_1_timestamped_version_tracker_ac5781ac461242853993e4a2c3f81aae6_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1_timestamped_version_tracker_a2de741d43aaa6c622969465c10af9920}\label{classdoris_1_1_timestamped_version_tracker_a2de741d43aaa6c622969465c10af9920}} 
\index{TimestampedVersionTracker@{TimestampedVersionTracker}!\_init\_stale\_version\_path\_map@{\_init\_stale\_version\_path\_map}}
\index{\_init\_stale\_version\_path\_map@{\_init\_stale\_version\_path\_map}!TimestampedVersionTracker@{TimestampedVersionTracker}}
\doxysubsubsection{\texorpdfstring{\_init\_stale\_version\_path\_map()}{\_init\_stale\_version\_path\_map()}}
{\footnotesize\ttfamily void \+\_\+init\+\_\+stale\+\_\+version\+\_\+path\+\_\+map (\begin{DoxyParamCaption}\item[{const std\+::vector$<$ \mbox{\hyperlink{namespacedoris_a8e1aa733e7ffe7bd29887ebdf7c1303d}{Rowset\+Meta\+Shared\+Ptr}} $>$ \&}]{rs\+\_\+metas,  }\item[{const std\+::vector$<$ \mbox{\hyperlink{namespacedoris_a8e1aa733e7ffe7bd29887ebdf7c1303d}{Rowset\+Meta\+Shared\+Ptr}} $>$ \&}]{stale\+\_\+metas }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



init stale\+\_\+version\+\_\+path\+\_\+map by main path rowset meta and stale rowset meta. 

函数调用图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d1/dee/classdoris_1_1_timestamped_version_tracker_a2de741d43aaa6c622969465c10af9920_cgraph}
\end{center}
\end{figure}
这是这个函数的调用关系图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=318pt]{d1/dee/classdoris_1_1_timestamped_version_tracker_a2de741d43aaa6c622969465c10af9920_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdoris_1_1_timestamped_version_tracker_af04281fe8b4f45fde59b5a189f37a20b}\label{classdoris_1_1_timestamped_version_tracker_af04281fe8b4f45fde59b5a189f37a20b}} 
\index{TimestampedVersionTracker@{TimestampedVersionTracker}!\_find\_path\_from\_stale\_map@{\_find\_path\_from\_stale\_map}}
\index{\_find\_path\_from\_stale\_map@{\_find\_path\_from\_stale\_map}!TimestampedVersionTracker@{TimestampedVersionTracker}}
\doxysubsubsection{\texorpdfstring{\_find\_path\_from\_stale\_map()}{\_find\_path\_from\_stale\_map()}}
{\footnotesize\ttfamily bool \+\_\+find\+\_\+path\+\_\+from\+\_\+stale\+\_\+map (\begin{DoxyParamCaption}\item[{const std\+::unordered\+\_\+map$<$ int64\+\_\+t, std\+::unordered\+\_\+map$<$ int64\+\_\+t, \mbox{\hyperlink{namespacedoris_a8e1aa733e7ffe7bd29887ebdf7c1303d}{Rowset\+Meta\+Shared\+Ptr}} $>$ $>$ \&}]{stale\+\_\+map,  }\item[{int64\+\_\+t}]{first\+\_\+version,  }\item[{int64\+\_\+t}]{second\+\_\+version,  }\item[{std\+::vector$<$ \mbox{\hyperlink{namespacedoris_a8e1aa733e7ffe7bd29887ebdf7c1303d}{Rowset\+Meta\+Shared\+Ptr}} $>$ $\ast$}]{stale\+\_\+path }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



find a path in stale\+\_\+map from first\+\_\+version to second\+\_\+version, stale\+\_\+path is used as result. 

函数调用图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=217pt]{d1/dee/classdoris_1_1_timestamped_version_tracker_af04281fe8b4f45fde59b5a189f37a20b_cgraph}
\end{center}
\end{figure}
这是这个函数的调用关系图\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d1/dee/classdoris_1_1_timestamped_version_tracker_af04281fe8b4f45fde59b5a189f37a20b_icgraph}
\end{center}
\end{figure}


\doxysubsection{类成员变量说明}
\mbox{\Hypertarget{classdoris_1_1_timestamped_version_tracker_af00bfaec7596f6615986a5e57177ba88}\label{classdoris_1_1_timestamped_version_tracker_af00bfaec7596f6615986a5e57177ba88}} 
\index{TimestampedVersionTracker@{TimestampedVersionTracker}!\_next\_path\_id@{\_next\_path\_id}}
\index{\_next\_path\_id@{\_next\_path\_id}!TimestampedVersionTracker@{TimestampedVersionTracker}}
\doxysubsubsection{\texorpdfstring{\_next\_path\_id}{\_next\_path\_id}}
{\footnotesize\ttfamily int64\+\_\+t \+\_\+next\+\_\+path\+\_\+id = 1\hspace{0.3cm}{\ttfamily [private]}}

\mbox{\Hypertarget{classdoris_1_1_timestamped_version_tracker_a80febc4cee0c1d6d1c2dd8090f06f4e4}\label{classdoris_1_1_timestamped_version_tracker_a80febc4cee0c1d6d1c2dd8090f06f4e4}} 
\index{TimestampedVersionTracker@{TimestampedVersionTracker}!\_stale\_version\_path\_map@{\_stale\_version\_path\_map}}
\index{\_stale\_version\_path\_map@{\_stale\_version\_path\_map}!TimestampedVersionTracker@{TimestampedVersionTracker}}
\doxysubsubsection{\texorpdfstring{\_stale\_version\_path\_map}{\_stale\_version\_path\_map}}
{\footnotesize\ttfamily std\+::map$<$int64\+\_\+t, \mbox{\hyperlink{namespacedoris_a8c762a1e6b0e50750316db48a4aa4f9a}{Path\+Version\+List\+Shared\+Ptr}}$>$ \+\_\+stale\+\_\+version\+\_\+path\+\_\+map\hspace{0.3cm}{\ttfamily [private]}}

\mbox{\Hypertarget{classdoris_1_1_timestamped_version_tracker_ac95791d4acde53b6e750b5004c162cf5}\label{classdoris_1_1_timestamped_version_tracker_ac95791d4acde53b6e750b5004c162cf5}} 
\index{TimestampedVersionTracker@{TimestampedVersionTracker}!\_version\_graph@{\_version\_graph}}
\index{\_version\_graph@{\_version\_graph}!TimestampedVersionTracker@{TimestampedVersionTracker}}
\doxysubsubsection{\texorpdfstring{\_version\_graph}{\_version\_graph}}
{\footnotesize\ttfamily \mbox{\hyperlink{classdoris_1_1_version_graph}{Version\+Graph}} \+\_\+version\+\_\+graph\hspace{0.3cm}{\ttfamily [private]}}



该类的文档由以下文件生成\+:\begin{DoxyCompactItemize}
\item 
/\+Users/dabowang/doris/be/src/olap/\mbox{\hyperlink{version__graph_8h}{version\+\_\+graph.\+h}}\item 
/\+Users/dabowang/doris/be/src/olap/\mbox{\hyperlink{version__graph_8cpp}{version\+\_\+graph.\+cpp}}\end{DoxyCompactItemize}
